// app v0.3.1; Copyright 2016-2018 Swim
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("mapbox-gl")):"function"==typeof define&&define.amd?define(["exports","mapbox-gl"],e):e(t.swim={},t.mapboxgl)}(this,function(t,e){"use strict";var i=new ArrayBuffer(8),r=new Float64Array(i),o=new Int32Array(i),n={hash:function(t){if(null===t)return 0;if("string"==typeof t){for(var e=0,i=0,s=t.length;i<s;i+=1)e=n.mix(e,t.charCodeAt(i));return e=n.mash(e)}if("number"==typeof t)return~~t===t?~~t:(r[0]=t,o[0]^o[1]);throw new TypeError(""+t)},mix:function(t,e){return e=s(e*=3432918353,15),t=5*(t=s(t^=e*=461845907,13))+3864292196},mash:function(t){return t^=t>>>16,t*=2246822507,t^=t>>>13,t*=3266489909,t^=t>>>16}};function s(t,e){return t<<e|t>>>32-e}var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};function u(t,e){function i(){this.constructor=t}a(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var h=function(){function t(){}return t.prototype.set=function(t){throw new Error("immutable")},t.prototype.delete=function(){throw new Error("immutable")},t.Empty=void 0,t}(),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.isEmpty=function(){return!0},e.prototype.head=function(){throw new Error("empty head")},e.prototype.step=function(){throw new Error("empty step")},e.prototype.skip=function(t){},e.prototype.hasNext=function(){return!1},e.prototype.nextIndex=function(){return 0},e.prototype.next=function(){return{done:!0}},e.prototype.hasPrevious=function(){return!1},e.prototype.previousIndex=function(){return-1},e.prototype.previous=function(){return{done:!0}},e}(h);h.Empty=new l;var p=function(t){function e(e){var i=t.call(this)||this;return i._value=e,i._index=0,i}return u(e,t),e.prototype.isEmpty=function(){return 0!==this._index},e.prototype.head=function(){if(0===this._index)return this._value;throw new Error("empty head")},e.prototype.step=function(){if(0!==this._index)throw new Error("empty step");this._index=1},e.prototype.skip=function(t){this._index=Math.min(Math.max(0,this._index+t),1)},e.prototype.hasNext=function(){return 0===this._index},e.prototype.nextIndex=function(){return this._index},e.prototype.next=function(){return 0===this._index?(this._index=1,{value:this._value,done:!0}):{done:!0}},e.prototype.hasPrevious=function(){return 1===this._index},e.prototype.previousIndex=function(){return this._index-1},e.prototype.previous=function(){return 1===this._index?(this._index=0,{value:this._value,done:!0}):{done:!0}},e}(h),c=function(t){function e(e){var i=t.call(this)||this;return i.cursor=e,i}return u(e,t),e.prototype.isEmpty=function(){return this.cursor.isEmpty()},e.prototype.head=function(){return this.cursor.head()[0]},e.prototype.step=function(){this.cursor.step()},e.prototype.skip=function(t){this.cursor.skip(t)},e.prototype.hasNext=function(){return this.cursor.hasNext()},e.prototype.nextIndex=function(){return this.cursor.nextIndex()},e.prototype.next=function(){var t=this.cursor.next(),e=t.value,i=t.done;return{value:e&&e[0],done:i}},e.prototype.hasPrevious=function(){return this.cursor.hasPrevious()},e.prototype.previousIndex=function(){return this.cursor.previousIndex()},e.prototype.previous=function(){var t=this.cursor.next(),e=t.value,i=t.done;return{value:e&&e[0],done:i}},e.prototype.delete=function(){this.cursor.delete()},e}(h),d=function(t){function e(e){var i=t.call(this)||this;return i.cursor=e,i}return u(e,t),e.prototype.isEmpty=function(){return this.cursor.isEmpty()},e.prototype.head=function(){return this.cursor.head()[1]},e.prototype.step=function(){this.cursor.step()},e.prototype.skip=function(t){this.cursor.skip(t)},e.prototype.hasNext=function(){return this.cursor.hasNext()},e.prototype.nextIndex=function(){return this.cursor.nextIndex()},e.prototype.next=function(){var t=this.cursor.next(),e=t.value,i=t.done;return{value:e&&e[1],done:i}},e.prototype.hasPrevious=function(){return this.cursor.hasPrevious()},e.prototype.previousIndex=function(){return this.cursor.previousIndex()},e.prototype.previous=function(){var t=this.cursor.next(),e=t.value,i=t.done;return{value:e&&e[1],done:i}},e.prototype.delete=function(){this.cursor.delete()},e}(h),f=function(t){function e(e,i){void 0===i&&(i=0);var r=t.call(this)||this;return r._array=e,r._index=i,r}return u(e,t),e.prototype.isEmpty=function(){return this._index>=this._array.length},e.prototype.head=function(){if(this._index<this._array.length)return this._array[this._index];throw new Error("empty head")},e.prototype.step=function(){if(!(this._index<this._array.length))throw new Error("empty step");this._index=1},e.prototype.skip=function(t){this._index=Math.min(this._index+t,this._array.length)},e.prototype.hasNext=function(){return this._index<this._array.length},e.prototype.nextIndex=function(){return this._index},e.prototype.next=function(){var t=this._index;return t<this._array.length?(this._index=t+1,{value:this._array[t],done:this._index===this._array.length}):(this._index=this._array.length,{done:!0})},e.prototype.hasPrevious=function(){return this._index>0},e.prototype.previousIndex=function(){return this._index-1},e.prototype.previous=function(){var t=this._index-1;return t>=0?(this._index=t,{value:this._array[t],done:0===t}):(this._index=0,{done:!0})},e}(h),y=function(t){function e(e,i,r,o){void 0===i&&(i=0),void 0===r&&(r=0);var n=t.call(this)||this;return n.pages=e,n._index=i,n._pageIndex=r,n._subCursor=o,n}return u(e,t),e.prototype.isEmpty=function(){for(;;)if(this._subCursor){if(!this._subCursor.isEmpty())return!1;this._subCursor=void 0}else{if(!(this._pageIndex<this.pages.length))return this._pageIndex=this.pages.length,!0;this._subCursor=this.pageCursor(this.pages[this._pageIndex]),this._pageIndex+=1}},e.prototype.head=function(){for(;;)if(this._subCursor){if(!this._subCursor.isEmpty())return this._subCursor.head();this._subCursor=void 0}else{if(!(this._pageIndex<this.pages.length))throw this._pageIndex=this.pages.length,new Error("empty head");this._subCursor=this.pageCursor(this.pages[this._pageIndex]),this._pageIndex+=1}},e.prototype.step=function(){for(;;)if(this._subCursor){if(!this._subCursor.isEmpty())return void(this._index+=1);this._subCursor=void 0}else{if(!(this._pageIndex<this.pages.length))throw this._pageIndex=this.pages.length,new Error("empty step");this._subCursor=this.pageCursor(this.pages[this._pageIndex]),this._pageIndex+=1}},e.prototype.skip=function(t){for(;t>0;)if(this._subCursor)this._subCursor.hasNext()?(this._index+=1,t-=1,this._subCursor.next()):this._subCursor=void 0;else{if(!(this._pageIndex<this.pages.length))break;var e=this.pages[this._pageIndex],i=this.pageSize(e);if(this._pageIndex+=1,i<t){this._subCursor=this.pageCursor(e),t>0&&(this._index+=t,this._subCursor.skip(t),t=0);break}this._index+=i,t-=i}},e.prototype.hasNext=function(){for(;;)if(this._subCursor){if(this._subCursor.hasNext())return!0;this._subCursor=void 0}else{if(!(this._pageIndex<this.pages.length))return this._pageIndex=this.pages.length,!1;this._subCursor=this.pageCursor(this.pages[this._pageIndex]),this._pageIndex+=1}},e.prototype.nextIndex=function(){return this._index},e.prototype.next=function(){for(;;)if(this._subCursor){if(this._subCursor.hasNext())return this._index+=1,this._subCursor.next();this._subCursor=void 0}else{if(!(this._pageIndex<this.pages.length))return this._pageIndex=this.pages.length,{done:!0};this._subCursor=this.pageCursor(this.pages[this._pageIndex]),this._pageIndex+=1}},e.prototype.hasPrevious=function(){for(;;)if(this._subCursor){if(this._subCursor.hasPrevious())return!0;this._subCursor=void 0}else{if(!(this._pageIndex>0))return this._pageIndex=0,!1;this._subCursor=this.reversePageCursor(this.pages[this._pageIndex-1]),this._pageIndex-=1}},e.prototype.previousIndex=function(){return this._index-1},e.prototype.previous=function(){for(;;)if(this._subCursor){if(this._subCursor.hasPrevious())return this._index-=1,this._subCursor.previous();this._subCursor=void 0}else{if(!(this._pageIndex>0))return this._pageIndex=0,{done:!0};this._subCursor=this.reversePageCursor(this.pages[this._pageIndex-1]),this._pageIndex-=1}},e.prototype.set=function(t){this._subCursor.set(t)},e.prototype.delete=function(){this._subCursor.delete()},e}(h),m=function(){function t(){}return t.done=function(){return new v("")},t}(),v=function(t){function e(e,i,r){void 0===i&&(i=0),void 0===r&&(r=!1);var o=t.call(this)||this;return o.buffer=e,o.index=i,o.more=r,o}return u(e,t),e.prototype.isDone=function(){return this.isEmpty()&&!this.more},e.prototype.isEmpty=function(){return this.index>=this.buffer.length},e.prototype.head=function(){var t=this.buffer.charCodeAt(this.index);if(t<=55295||t>=57344)return t;if(t<=56319&&this.index+1<this.buffer.length){var e=this.buffer.charCodeAt(this.index+1);return e>=56320&&e<=57343?65536+((1023&t)<<10|1023&e):65533}return 65533},e.prototype.step=function(){var t=this.buffer.charCodeAt(this.index);if(t<=55295||t>=57344)this.index+=1;else if(t<=56319&&this.index+1<this.buffer.length){var e=this.buffer.charCodeAt(this.index+1);this.index+=e>=56320&&e<=57343?2:1}else this.index+=1},e.prototype.clone=function(){return new e(this.buffer,this.index,this.more)},e}(m),g=function(){function t(t){void 0===t&&(t=""),this.buffer=t}return t.prototype.isDone=function(){return!1},t.prototype.isFull=function(){return!1},t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,r=t.length;i<r;i+=1){var o=t[i];if("number"==typeof o)if(o>=0&&o<=55295||o>=57344&&o<=65535)this.buffer+=String.fromCharCode(o);else if(o>=65536&&o<=1114111){var n=o-65536;this.buffer+=String.fromCharCode(55296|n>>>10,56320|1023&n)}else this.buffer+=String.fromCharCode(65533);else if("string"==typeof o)for(var s=new v(o);!s.isEmpty();)this.push(s.head()),s.step()}},t.prototype.bind=function(){return this.buffer},t}(),w=function(){function t(){}return t.prototype.isDefined=function(){return!0},t.prototype.isDistinct=function(){return!0},t.prototype.isEmpty=function(){return!1},t.prototype.stringValue=function(t){return t},t.prototype.numberValue=function(t){return t},t.prototype.booleanValue=function(t){return t},t.prototype.concat=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=t.empty();r.push(this);for(var o=0,n=e.length;o<n;o+=1){t.fromAny(e[o]).forEach(function(t){r.push(t)})}return r},t.prototype.withField=function(e,i){var r=t.empty(2);return r.push(this),r.withField(e,i)},t.prototype.withAttr=function(e,i){var r=t.empty(2);return r.push(this),r.withAttr(e,i)},t.prototype.withSlot=function(e,i){var r=t.empty(2);return r.push(this),r.withSlot(e,i)},t.prototype.withItem=function(e){var i=t.empty(2);return i.push(this),i.withItem(e)},t.prototype.withItems=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=t.empty(1+arguments.length);return r.push(this),r.withItems.apply(r,arguments)},t.prototype.forEach=function(t,e){return t.call(e,this,0)},t.prototype.iterator=function(){return new p(this)},t.prototype.lt=function(e){return e=t.of(e),this.compare(e)<0?t.True:t.Absent},t.prototype.le=function(e){return e=t.of(e),this.compare(e)<=0?t.True:t.Absent},t.prototype.eq=function(e){return e=t.of(e),this.equals(e)?t.True:t.Absent},t.prototype.ne=function(e){return e=t.of(e),this.equals(e)?t.Absent:t.True},t.prototype.ge=function(e){return e=t.of(e),this.compare(e)>=0?t.True:t.Absent},t.prototype.gt=function(e){return e=t.of(e),this.compare(e)>0?t.True:t.Absent},t.prototype.filter=function(e){var i=t.Selector.literal(this);return i.filter.apply(i,arguments)},t.prototype.max=function(t){return this.compare(t)>=0?this:t},t.prototype.min=function(t){return this.compare(t)<=0?this:t},t.prototype.evaluate=function(t){return this},t.prototype.substitute=function(t){return this},Object.defineProperty(t.prototype,"precedence",{get:function(){return 10},enumerable:!0,configurable:!0}),t.prototype.writeReconBlock=function(t){return this.writeRecon(t)},t.prototype.toRecon=function(){var t=new g;return this.writeRecon(t),t.bind()},t.prototype.toReconBlock=function(){var t=new g;return this.writeReconBlock(t),t.bind()},t.prototype.writeString=function(t){t.push(this.toString())},t.Recon=void 0,t.Field=void 0,t.Attr=void 0,t.Slot=void 0,t.Value=void 0,t.Record=void 0,t.Data=void 0,t.Text=void 0,t.Num=void 0,t.Bool=void 0,t.DynamicValue=void 0,t.Selector=void 0,t.IdentitySelector=void 0,t.LiteralSelector=void 0,t.GetSelector=void 0,t.GetAttrSelector=void 0,t.GetItemSelector=void 0,t.KeysSelector=void 0,t.ChildrenSelector=void 0,t.DescendantsSelector=void 0,t.FilterSelector=void 0,t.Func=void 0,t.Expr=void 0,t.CondExpr=void 0,t.OrExpr=void 0,t.AndExpr=void 0,t.NotExpr=void 0,t.LtExpr=void 0,t.LeExpr=void 0,t.EqExpr=void 0,t.NeExpr=void 0,t.GeExpr=void 0,t.GtExpr=void 0,t.AddExpr=void 0,t.SubExpr=void 0,t.NegExpr=void 0,t.MulExpr=void 0,t.DivExpr=void 0,t.ModExpr=void 0,t.InvokeExpr=void 0,t.Empty=void 0,t.True=void 0,t.False=void 0,t.Extant=void 0,t.Absent=void 0,t.GlobalScope=void 0,t.empty=void 0,t.of=void 0,t.fromAny=void 0,t}(),b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return e.Absent},enumerable:!0,configurable:!0}),e.prototype.toValue=function(){return this},Object.defineProperty(e.prototype,"length",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tag",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this},enumerable:!0,configurable:!0}),e.prototype.flattened=function(){return this},e.prototype.header=function(t){return e.Absent},e.prototype.headers=function(t){},e.prototype.head=function(){return e.Absent},e.prototype.tail=function(){return e.Empty},e.prototype.body=function(){return this},e.prototype.get=function(t){return e.Absent},e.prototype.getAttr=function(t){return e.Absent},e.prototype.getItem=function(t){return e.Absent},e.prototype.withoutKey=function(t){return this},e.prototype.cond=function(t,e){return t=w.of(t)},e.prototype.or=function(t){return this},e.prototype.and=function(t){return t=w.of(t)},e.prototype.not=function(){return e.Absent},e.prototype.lt=function(e){return(e=w.of(e))instanceof w.DynamicValue?new w.LtExpr(this,e):t.prototype.lt.call(this,e)},e.prototype.le=function(e){return(e=w.of(e))instanceof w.DynamicValue?new w.LeExpr(this,e):t.prototype.le.call(this,e)},e.prototype.eq=function(e){return(e=w.of(e))instanceof w.DynamicValue?new w.EqExpr(this,e):t.prototype.eq.call(this,e)},e.prototype.ne=function(e){return(e=w.of(e))instanceof w.DynamicValue?new w.NeExpr(this,e):t.prototype.ne.call(this,e)},e.prototype.ge=function(e){return(e=w.of(e))instanceof w.DynamicValue?new w.GeExpr(this,e):t.prototype.ge.call(this,e)},e.prototype.gt=function(e){return(e=w.of(e))instanceof w.DynamicValue?new w.GtExpr(this,e):t.prototype.gt.call(this,e)},e.prototype.plus=function(t){if((t=w.of(t))instanceof w.DynamicValue)return new w.AddExpr(this,t);if(t instanceof w.Attr){if((i=this.plus(t.value)).isDefined())return new w.Attr(t.key,i)}else if(t instanceof w.Slot){var i;if((i=this.plus(t.value)).isDefined())return new w.Slot(t.key,i)}return e.Absent},e.prototype.minus=function(t){if((t=w.of(t))instanceof w.DynamicValue)return new w.SubExpr(this,t);if(t instanceof w.Attr){if((i=this.minus(t.value)).isDefined())return new w.Attr(t.key,i)}else if(t instanceof w.Slot){var i;if((i=this.minus(t.value)).isDefined())return new w.Slot(t.key,i)}return e.Absent},e.prototype.opposite=function(){return e.Absent},e.prototype.times=function(t){if((t=w.of(t))instanceof w.DynamicValue)return new w.MulExpr(this,t);if(t instanceof w.Attr){if((i=this.times(t.value)).isDefined())return new w.Attr(t.key,i)}else if(t instanceof w.Slot){var i;if((i=this.times(t.value)).isDefined())return new w.Slot(t.key,i)}return e.Absent},e.prototype.divide=function(t){if((t=w.of(t))instanceof w.DynamicValue)return new w.DivExpr(this,t);if(t instanceof w.Attr){if((i=this.divide(t.value)).isDefined())return new w.Attr(t.key,i)}else if(t instanceof w.Slot){var i;if((i=this.divide(t.value)).isDefined())return new w.Slot(t.key,i)}return e.Absent},e.prototype.modulo=function(t){if((t=w.of(t))instanceof w.DynamicValue)return new w.ModExpr(this,t);if(t instanceof w.Attr){if((i=this.modulo(t.value)).isDefined())return new w.Attr(t.key,i)}else if(t instanceof w.Slot){var i;if((i=this.modulo(t.value)).isDefined())return new w.Slot(t.key,i)}return e.Absent},e.prototype.inverse=function(){return e.Absent},e.prototype.isAliased=function(){return!1},e.prototype.isMutable=function(){return!1},e.prototype.alias=function(){},e.prototype.branch=function(){return this},e.prototype.clone=function(){return this},e.prototype.commit=function(){return this},e.prototype.cast=function(t,e){var i=t.cast(this);return void 0===i&&(i=e),i},e.prototype.coerce=function(t){var e=t.cast(this);return void 0===e&&(e=t.unit),e},e.of=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return 0===t.length?e.Absent:1===t.length?e.fromAny(t[0]):e.Record.fromArray(arguments)},e.fromAny=function(t){if(void 0===t)return e.Absent;if(null===t)return e.Extant;if(t instanceof e)return t;if(t instanceof w)return t.toValue();if(t instanceof Uint8Array)return e.Data.valueOf(t);if("string"==typeof t)return e.Text.valueOf(t);if("number"==typeof t)return e.Num.valueOf(t);if("boolean"==typeof t)return e.Bool.valueOf(t);if(Array.isArray(t))return e.Record.fromArray(t);if("object"==typeof t)return e.Record.fromObject(t);throw new TypeError(""+t)},e.parseRecon=function(t){return e.Recon.Factory.parseRecon(t)},e.Empty=void 0,e.True=void 0,e.False=void 0,e.Extant=void 0,e.Absent=void 0,e.empty=void 0,e}(w);w.Value=b,w.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?b.Absent:1===t.length?w.fromAny(t[0]):b.Record.fromArray(arguments)},w.fromAny=function(t){return t instanceof w?t:b.fromAny(t)};var _=function(){function t(){}return t.prototype.isCont=function(){return!0},t.prototype.isDone=function(){return!1},t.prototype.isError=function(){return!1},t.prototype.run=function(t){for(var e=this;e.isCont()&&(!t.isEmpty()||t.isDone());)e=e.feed(t);return e.isCont()&&t.isEmpty()&&!t.isDone()&&(e=e.feed(m.done())),e},t.prototype.parse=function(e){"string"==typeof e&&(e=new v(e));var i=this.run(e);return!e.isEmpty()&&i.isDone()&&(i=t.unexpected(e)),i.bind()},t.prototype.bind=function(){throw this},t.prototype.trap=function(){throw this},t.prototype.asVariant=function(){return this},t.prototype.asError=function(){throw this},t.done=function(t){return new x(t)},t.error=function(t){return new A(t)},t.unexpected=function(e){var i="unexpected ";return e.isEmpty()?i+="end of input":i+=JSON.stringify(String.fromCharCode(e.head())),t.error(i)},t.expected=function(e,i){"number"==typeof e&&(e=String.fromCharCode(e)),1===e.length&&(e=JSON.stringify(e));var r="expected "+e;return i.isEmpty()||(r+=", but found "+JSON.stringify(String.fromCharCode(i.head()))),t.error(r)},t.isSpace=function(t){return 32===t||9===t},t.isNewline=function(t){return 10===t||13===t},t.isWhitespace=function(e){return t.isSpace(e)||t.isNewline(e)},t.isAlpha=function(t){return t>=65&&t<=90||t>=97&&t<=122},t.toLowerCase=function(t){return t>=65&&t<=90?t+32:t},t.isDigit=function(t){return t>=48&&t<=57},t.decodeDigit=function(t){if(t>=48&&t<=57)return t-48;throw t},t.isHexChar=function(t){return t>=65&&t<=70||t>=97&&t<=102||t>=48&&t<=57},t.decodeHexChar=function(t){if(t>=48&&t<=57)return t-48;if(t>=65&&t<=70)return t-65+10;if(t>=97&&t<=102)return t-97+10;throw t},t.isBase64Char=function(t){return t>=48&&t<=57||t>=65&&t<=90||t>=97&&t<=122||43===t||45===t||47===t||95===t},t.decodeBase64Digit=function(t){if(t>=65&&t<=90)return t-65;if(t>=97&&t<=122)return t-71;if(t>=48&&t<=57)return t+4;if(43===t||45===t)return 62;if(47===t||95===t)return 63;throw t},t}(),x=function(t){function e(e){var i=t.call(this)||this;return i.value=e,i}return u(e,t),e.prototype.isCont=function(){return!1},e.prototype.isDone=function(){return!0},e.prototype.feed=function(t){return this},e.prototype.bind=function(){return this.value},e}(_),A=function(t){function e(e){var i=t.call(this)||this;return i.cause=e,i}return u(e,t),e.prototype.isCont=function(){return!1},e.prototype.isError=function(){return!0},e.prototype.feed=function(t){return this},e.prototype.bind=function(){throw this.cause},e.prototype.trap=function(){return this.cause},e.prototype.asError=function(){return this},e}(_),k=function(t){function e(e,i,r){var o=t.call(this)||this;return o._array=e,o._size=i,o._flags=r,o}return u(e,t),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),e.prototype.isDone=function(){return!1},e.prototype.isFull=function(){return!1},e.prototype.push=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(0!=(this._flags&e.IMMUTABLE))throw new Error("immutable");0!=(this._flags&e.ALIASED)?this.pushAliased.apply(this,t):this.pushMutable.apply(this,t)},e.prototype.pushAliased=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=t.length,o=this._size,n=this._array,s=new Uint8Array(e.expand(o+r));null!==n&&s.set(n);for(var a=0;a<r;a+=1)s[o+a]=t[a];this._array=s,this._size=o+r,this._flags&=~e.ALIASED},e.prototype.pushMutable=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r,o=t.length,n=this._size,s=this._array;null===s||n+o>s.length?(r=new Uint8Array(e.expand(n+o)),null!==s&&r.set(s),this._array=r):r=s;for(var a=0;a<o;a+=1)r[n+a]=t[a];this._size=n+o},e.prototype.isAliased=function(){return 0!=(this._flags&e.ALIASED)},e.prototype.isMutable=function(){return 0==(this._flags&e.IMMUTABLE)},e.prototype.alias=function(){this._flags|=e.ALIASED},e.prototype.branch=function(){return this._flags|=e.ALIASED,new e(this._array,this._size,e.ALIASED)},e.prototype.clone=function(){return this.branch()},e.prototype.commit=function(){return this._flags|=e.IMMUTABLE,this},e.prototype.bind=function(){return this},e.prototype.toAny=function(){return this.valueOf()},e.prototype.valueOf=function(){var t=this._size,i=this._array;if(0!=(this._flags&(e.ALIASED|e.IMMUTABLE))||t!==i.length){var r=null!==i?i.slice(0,t):new Uint8Array(0);return 0==(this._flags&e.IMMUTABLE)&&(this._array=r,this._size=t,this._flags&=~e.ALIASED),r}return i},e.prototype.writeRecon=function(t){t.push(37),e.writeBase64(this._array,this._size,t)},e.writeBase64=function(t,i,r){for(var o=0;o+2<i;){var n=t[o],s=t[o+1],a=t[o+2];r.push(e.encodeBase64Digit(n>>>2),e.encodeBase64Digit(63&(n<<4|s>>>4)),e.encodeBase64Digit(63&(s<<2|a>>>6)),e.encodeBase64Digit(63&a)),o+=3}if(o+1<i){n=t[o],s=t[o+1];r.push(e.encodeBase64Digit(n>>>2),e.encodeBase64Digit(63&(n<<4|s>>>4)),e.encodeBase64Digit(s<<2&63),61),o+=2}else if(o<i){n=t[o];r.push(e.encodeBase64Digit(n>>>2),e.encodeBase64Digit(n<<4&63),61,61),o+=1}},e.prototype.toBase64=function(){var t=new g;return e.writeBase64(this._array,this._size,t),t.bind()},e.prototype.compare=function(t){if(t instanceof e){for(var i=this._size,r=t._size,o=this._array,n=t._array,s=0,a=0;0===s&&a<i&&a<r;)s=o[a]-n[a],a+=1;return s>0?1:s<0?-1:i>r?1:i<r?-1:0}return t instanceof w.Field||t instanceof w.Record?1:-1},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){var i=this._size;if(i!==t._size)return!1;for(var r=this._array,o=t._array,n=0;n<i;n+=1)if(r[n]!==o[n])return!1;return!0}return!1},e.prototype.hashCode=function(){for(var t=1375461820,e=this._array,i=0,r=this._size;i<r;i+=1)t=n.mix(t,e[i]);return n.mash(t)},e.prototype.toString=function(){return this.toBase64()},e.empty=function(t){return new e(void 0===t?null:new Uint8Array(t),0,0)},e.valueOf=function(t){return new e(t,t.length,e.ALIASED)},e.of=function(t){if(t instanceof e)return t;if(t instanceof Uint8Array)return e.valueOf(t);throw new TypeError(""+t)},e.base64=function(t){"string"==typeof t&&(t=new v(t));var e=b.Recon.Factory.parseBase64(t);return e.isDone()&&(t.isEmpty()||(e=_.unexpected(t))),e.bind()},e.expand=function(t){return t=Math.max(32,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},e.encodeBase64Digit=function(t){if(t>=0&&t<26)return t+65;if(t>=26&&t<52)return t+71;if(t>=52&&t<62)return t-4;if(62===t)return 43;if(63===t)return 47;throw t},e.ALIASED=1,e.IMMUTABLE=2,e.Empty=new e(null,0,e.ALIASED|e.IMMUTABLE),e}(b);w.Data=k;var E="undefined"!=typeof window&&(window.crypto||window.msCrypto);var C={fillBytes:E?function(t){E.getRandomValues(t)}:function(t){if(t instanceof Int8Array)for(var e=0;e<t.length;e+=1)t[e]=128-Math.round(256*Math.random());else if(t instanceof Uint8Array)for(e=0;e<t.length;e+=1)t[e]=Math.round(256*Math.random());else if(t instanceof Int16Array)for(e=0;e<t.length;e+=1)t[e]=32768-Math.round(65536*Math.random());else if(t instanceof Uint16Array)for(e=0;e<t.length;e+=1)t[e]=Math.round(65536*Math.random());else if(t instanceof Int32Array)for(e=0;e<t.length;e+=1)t[e]=2147483648-Math.round(4294967296*Math.random());else{if(!(t instanceof Uint32Array))throw new TypeError(""+t);for(e=0;e<t.length;e+=1)t[e]=Math.round(4294967296*Math.random())}},generateId:function(t){void 0===t&&(t=12);var e=new Uint8Array(t);C.fillBytes(e);var i=new g;return k.writeBase64(e,t,i),i.bind()}};function S(t,e){if(t instanceof Date&&(t=t.getTime()),e instanceof Date&&(e=e.getTime()),t===e)return!0;if(t&&"object"==typeof t&&"function"==typeof t.equals)return t.equals(e);if(Array.isArray(t)){if(Array.isArray(e))return function(t,e){var i=t.length;if(i!==e.length)return!1;for(var r=0;r<i;r+=1)if(!S(t[r],e[r]))return!1;return!0}(t,e)}else if(t&&"object"==typeof t&&e&&"object"==typeof e)return function(t,e){var i=Object.keys(t),r=Object.keys(e),o=i.length;if(o!==r.length)return!1;for(var n=0;n<o;n+=1){var s=i[n];if(s!==r[n]||!S(t[s],e[s]))return!1}return!0}(t,e);return!1}function V(t,e){return t instanceof Date&&(t=t.getTime()),e instanceof Date&&(e=e.getTime()),void 0===t?void 0===e?0:1:null===t?void 0===e?-1:null===e?0:1:"number"==typeof t?null==e?-1:"number"==typeof e?t<e?-1:t>e?1:0:1:"string"==typeof t?null==e||"number"==typeof e?-1:"string"==typeof e?t<e?-1:t>e?1:0:1:"object"==typeof t&&"function"==typeof t.compare?t.compare(e):Array.isArray(t)?null==e||"number"==typeof e||"string"==typeof e?-1:Array.isArray(e)?function(t,e){for(var i=t.length,r=e.length,o=0,n=0,s=Math.min(i,r);n<s&&0===o;n+=1)o=V(t[n],e[n]);return 0!==o?o:i>r?1:i<r?-1:0}(t,e):1:null==e||"number"==typeof e||"string"==typeof e||Array.isArray(e)?-1:function(t,e){for(var i=Object.keys(t),r=Object.keys(e),o=i.length,n=r.length,s=Math.min(o,n),a=0,u=0;u<s&&0===a;u+=1){var h=i[u],l=r[u];0===(a=V(h,l))&&(a=V(t[h],e[l]))}return 0!==a?a:o>n?1:o<n?-1:0}(t,e)}var D=function(){function t(e,i,r){void 0===e&&(e=null),void 0===i&&(i=0),void 0===r&&(r=t.Capacity),this._array=e,this._size=i,this._capacity=r}return t.prototype.isEmpty=function(){return 0===this._size},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"capacity",{get:function(){return this._capacity},enumerable:!0,configurable:!0}),t.prototype.get=function(t){t=b.fromAny(t);for(var e=b.Absent,i=this._size-1;i>=0&&!(e=this._array[i].get(t)).isDefined();i-=1);return e},t.prototype.peek=function(){var t=this._size;return t>0?this._array[t-1]:void 0},t.prototype.item=function(){var t=this._size;if(t>0)return this._array[t-1];throw new RangeError},t.prototype.getItem=function(t){if(0<=t&&t<this._size)return this._array[t];throw new RangeError(""+t)},t.prototype.offer=function(e){var i=this._size;if(i<this._capacity){var r=this._array,o=void 0;if(null===r||i+1>r.length){if(o=new Array(t.expand(i+1)),null!==r)for(var n=0;n<i;n+=1)o[n]=r[n];this._array=o}else o=r;return o[i]=e,this._size=i+1,!0}return!1},t.prototype.push=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];var r=this._size,o=arguments.length;if(0===o)return r;if(r+o<this._capacity){var n=this._array,s=void 0;if(null===n||r+o>n.length){if(s=new Array(t.expand(r+o)),null!==n)for(var a=0;a<r;a+=1)s[a]=n[a]}else s=n;for(a=0;a<o;a+=1)s[r]=arguments[a],r+=1;return this._array=s,this._size=r,r}throw new RangeError(""+(r+o))},t.prototype.replace=function(t){var e=this._size;if(e>0){var i=this._array,r=i[e-1];return i[e-1]=t,r}throw new RangeError},t.prototype.poll=function(){var t=this._size;if(t>0){var e=this._array,i=e[t-1];return e[t-1]=void 0,this._size=t-1,i}},t.prototype.pop=function(){var t=this._size;if(t>0){var e=this._array,i=e[t-1];return e[t-1]=void 0,this._size=t-1,i}throw new RangeError},t.prototype.clear=function(){for(var t=this._array,e=this._size-1;e>=0;e-=1)t[e]=void 0;this._size=0},t.prototype.forEach=function(t,e){for(var i=this._array,r=0,o=this._size;r<o;r+=1){var n=t.call(e,i[r],r);if(void 0!==n)return n}},t.prototype.iterator=function(){return this._size>0?new f(this._array):h.Empty},t.prototype.equals=function(e){if(this===e)return!0;if(e instanceof t){var i=this._size;if(i!==e._size)return!1;for(var r=this._array,o=e._array,n=0;n<i;n+=1)if(!r[n].equals(o[n]))return!1;return!0}return!1},t.prototype.hashCode=function(){for(var t=2079781727,e=this._array,i=0,r=this._size;i<r;i+=1)t=n.mix(t,e[i].hashCode());return n.mash(t)},t.prototype.toString=function(){var t=new g;t.push("EvalStack",46,"of",40);var e=this._size;if(e>0){var i=this._array;i[0].writeString(t);for(var r=1;r<e;r+=1)t.push(", "),i[r].writeString(t)}return t.push(")"),t.bind()},t.of=function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];for(var r=arguments.length,o=new Array(t.expand(r)),n=0;n<r;n+=1){var s=w.fromAny(arguments[n]);o[n]=s}return new t(o,r,Math.max(r,t.Capacity))},t.fromAny=function(e,i){if(void 0===i&&(i=t.GlobalScope),!(e instanceof t)){var r=w.fromAny(e);return e=new t,i&&e.push(i),e.push(r),e}return e},t.expand=function(t){return t=Math.max(32,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},t.Capacity=1024,t.GlobalScope=void 0,t}(),M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.toValue=function(){return this.value},Object.defineProperty(e.prototype,"length",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tag",{get:function(){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return w.Absent},enumerable:!0,configurable:!0}),e.prototype.flattened=function(){return w.Absent},e.prototype.header=function(t){return w.Absent},e.prototype.headers=function(t){},e.prototype.head=function(){return w.Absent},e.prototype.tail=function(){return w.Empty},e.prototype.body=function(){return w.Absent},e.prototype.get=function(t){return w.Absent},e.prototype.getAttr=function(t){return w.Absent},e.prototype.getItem=function(t){return w.Absent},e.prototype.stringValue=function(t){return this.value.stringValue(t)},e.prototype.numberValue=function(t){return this.value.numberValue(t)},e.prototype.booleanValue=function(t){return this.value.booleanValue(t)},e.prototype.withoutKey=function(t){return this},e.prototype.cond=function(t,e){return t=w.of(t)},e.prototype.or=function(t){return this},e.prototype.and=function(t){return t=w.of(t)},e.prototype.isAliased=function(){return!1},e.prototype.cast=function(t,e){return this.value.cast(t,e)},e.prototype.coerce=function(t){return this.value.coerce(t)},e.of=function(t,e){var i;return"string"==typeof t?i=t:t instanceof w.Text&&(i=t.value),void 0!==i&&64===i.charCodeAt(0)?w.Attr.of.apply(void 0,arguments):w.Slot.of.apply(void 0,arguments)},e.IMMUTABLE=1,e}(w);w.Field=M;var R=function(t){function e(e,i,r){void 0===i&&(i=b.Extant),void 0===r&&(r=0);var o=t.call(this)||this;return o._key=e,o._value=i,o._flags=r,o}return u(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.setValue=function(t){if(0!=(this._flags&M.IMMUTABLE))throw new Error("immutable");var e=this._value;return this._value=t,e},e.prototype.withValue=function(t){return new e(this._key,t)},e.prototype.not=function(){var t=this._value.not();return t.isDefined()?new e(this._key,t):b.Absent},e.prototype.plus=function(t){return(t=w.of(t))instanceof w.DynamicValue?new w.AddExpr(this,t):(i=t instanceof e&&this._key.equals(t._key)?this._value.plus(t._value):t instanceof b?this._value.plus(t):b.Absent).isDefined()?new e(this._key,i):b.Absent;var i},e.prototype.minus=function(t){return(t=w.of(t))instanceof w.DynamicValue?new w.SubExpr(this,t):(i=t instanceof e&&this._key.equals(t._key)?this._value.minus(t._value):t instanceof b?this._value.minus(t):b.Absent).isDefined()?new e(this._key,i):b.Absent;var i},e.prototype.opposite=function(){var t=this._value.opposite();return t.isDefined()?new e(this._key,t):b.Absent},e.prototype.times=function(t){return(t=w.of(t))instanceof w.DynamicValue?new w.MulExpr(this,t):(i=t instanceof e&&this._key.equals(t._key)?this._value.times(t._value):t instanceof b?this._value.times(t):b.Absent).isDefined()?new e(this._key,i):b.Absent;var i},e.prototype.divide=function(t){return(t=w.of(t))instanceof w.DynamicValue?new w.DivExpr(this,t):(i=t instanceof e&&this._key.equals(t._key)?this._value.divide(t._value):t instanceof b?this._value.divide(t):b.Absent).isDefined()?new e(this._key,i):b.Absent;var i},e.prototype.modulo=function(t){return(t=w.of(t))instanceof w.DynamicValue?new w.ModExpr(this,t):(i=t instanceof e&&this._key.equals(t._key)?this._value.modulo(t._value):t instanceof b?this._value.modulo(t):b.Absent).isDefined()?new e(this._key,i):b.Absent;var i},e.prototype.inverse=function(){var t=this._value.inverse();return t.isDefined()?new e(this._key,t):b.Absent},e.prototype.evaluate=function(t){t=D.fromAny(t);var i=this._key.evaluate(t).toValue(),r=this._value.evaluate(t).toValue();return i===this._key&&r===this._value?this:i.isDefined()&&r.isDefined()?i instanceof w.Text?new e(i,r):new w.Slot(i,r):w.Absent},e.prototype.substitute=function(t){t=D.fromAny(t);var i=this._key.substitute(t).toValue(),r=this._value.substitute(t).toValue();return i===this._key&&r===this._value?this:i.isDefined()&&r.isDefined()?i instanceof w.Text?new e(i,r):new w.Slot(i,r):w.Absent},e.prototype.isMutable=function(){return 0==(this._flags&M.IMMUTABLE)},e.prototype.alias=function(){this._flags|=M.IMMUTABLE},e.prototype.branch=function(){return 0!=(this._flags&M.IMMUTABLE)?new e(this._key,this._value,this._flags&~M.IMMUTABLE):this},e.prototype.clone=function(){return new e(this._key.clone(),this._value.clone())},e.prototype.commit=function(){return 0==(this._flags&M.IMMUTABLE)&&(this._flags|=M.IMMUTABLE,this._value.commit()),this},e.prototype.writeRecon=function(t){t.push(64),this._key.writeRecon(t),this._value!==b.Extant&&(t.push(40),this._value.writeReconBlock(t),t.push(41))},e.prototype.compare=function(t){if(t instanceof e){var i=this._key.compare(t._key);return 0===i&&(i=this._value.compare(t._value)),i}return-1},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._key.equals(t._key)&&this._value.equals(t._value))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(687268585,this._key.hashCode()),this._value.hashCode()))},e.prototype.toString=function(){return this.toRecon()},e.of=function(t,i){return new e(t=w.Text.of(t),i=2===arguments.length?w.Value.of(i):w.Value.Extant)},e}(M);w.Attr=R;var T=function(t){function e(e,i,r){void 0===i&&(i=b.Extant),void 0===r&&(r=0);var o=t.call(this)||this;return o._key=e,o._value=i,o._flags=r,o}return u(e,t),Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.setValue=function(t){if(0!=(this._flags&M.IMMUTABLE))throw new Error("immutable");var e=this._value;return this._value=t,e},e.prototype.withValue=function(t){return new e(this._key,t)},e.prototype.not=function(){var t=this._value.not();return t.isDefined()?new e(this._key,t):b.Absent},e.prototype.plus=function(t){return(t=w.of(t))instanceof w.DynamicValue?new w.AddExpr(this,t):(i=t instanceof e&&this._key.equals(t._key)?this._value.plus(t._value):t instanceof b?this._value.plus(t):b.Absent).isDefined()?new e(this._key,i):b.Absent;var i},e.prototype.minus=function(t){return(t=w.of(t))instanceof w.DynamicValue?new w.SubExpr(this,t):(i=t instanceof e&&this._key.equals(t._key)?this._value.minus(t._value):t instanceof b?this._value.minus(t):b.Absent).isDefined()?new e(this._key,i):b.Absent;var i},e.prototype.opposite=function(){var t=this._value.opposite();return t.isDefined()?new e(this._key,t):b.Absent},e.prototype.times=function(t){return(t=w.of(t))instanceof w.DynamicValue?new w.MulExpr(this,t):(i=t instanceof e&&this._key.equals(t._key)?this._value.times(t._value):t instanceof b?this._value.times(t):b.Absent).isDefined()?new e(this._key,i):b.Absent;var i},e.prototype.divide=function(t){return(t=w.of(t))instanceof w.DynamicValue?new w.DivExpr(this,t):(i=t instanceof e&&this._key.equals(t._key)?this._value.divide(t._value):t instanceof b?this._value.divide(t):b.Absent).isDefined()?new e(this._key,i):b.Absent;var i},e.prototype.modulo=function(t){return(t=w.of(t))instanceof w.DynamicValue?new w.ModExpr(this,t):(i=t instanceof e&&this._key.equals(t._key)?this._value.modulo(t._value):t instanceof b?this._value.modulo(t):b.Absent).isDefined()?new e(this._key,i):b.Absent;var i},e.prototype.inverse=function(){var t=this._value.inverse();return t.isDefined()?new e(this._key,t):b.Absent},e.prototype.evaluate=function(t){t=D.fromAny(t);var i=this._key.evaluate(t).toValue(),r=this._value.evaluate(t).toValue();return i===this._key&&r===this._value?this:i.isDefined()&&r.isDefined()?new e(i,r):w.Absent},e.prototype.substitute=function(t){t=D.fromAny(t);var i=this._key.substitute(t).toValue(),r=this._value.substitute(t).toValue();return i===this._key&&r===this._value?this:i.isDefined()&&r.isDefined()?new e(i,r):w.Absent},e.prototype.isMutable=function(){return 0==(this._flags&M.IMMUTABLE)},e.prototype.alias=function(){this._flags|=M.IMMUTABLE},e.prototype.branch=function(){return 0!=(this._flags&M.IMMUTABLE)?new e(this._key,this._value,this._flags&~M.IMMUTABLE):this},e.prototype.clone=function(){return new e(this._key.clone(),this._value.clone())},e.prototype.commit=function(){return 0==(this._flags&M.IMMUTABLE)&&(this._flags|=M.IMMUTABLE,this._value.commit()),this},e.prototype.writeRecon=function(t){this._key.writeRecon(t),t.push(58),this._value!==w.Extant&&this._value.writeRecon(t)},e.prototype.compare=function(t){if(t instanceof e){var i=this._key.compare(t._key);return 0===i&&(i=this._value.compare(t._value)),i}return t instanceof w.Attr?1:-1},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._key.equals(t._key)&&this._value.equals(t._value))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(1237723953,this._key.hashCode()),this._value.hashCode()))},e.prototype.toString=function(){return this.toRecon()},e.of=function(t,i){return new e(t=w.Value.of(t),i=2===arguments.length?w.Value.of(i):w.Value.Extant)},e}(M);w.Slot=T;var P=function(t){function e(e,i,r,o){void 0===i&&(i=0),void 0===r&&(r=e.length),void 0===o&&(o=i);var n=t.call(this)||this;return n._record=e,n._lower=i,n._upper=r,n._index=o,n._direction=0,n}return u(e,t),e.prototype.isEmpty=function(){return this._index>=this._upper},e.prototype.head=function(){if(this._direction=0,this._index<this._upper)return this._record.getItem(this._index);throw new Error("empty head")},e.prototype.step=function(){if(this._direction=0,!(this._index<this._upper))throw new Error("empty step");this._index+=1},e.prototype.skip=function(t){this._index=Math.min(Math.max(this._lower,this._index+t,this._upper))},e.prototype.hasNext=function(){return this._index<this._upper},e.prototype.nextIndex=function(){return this._index-this._lower},e.prototype.next=function(){this._direction=1;var t=this._index;return t<this._upper?(this._index=t+1,{value:this._record.getItem(t),done:this._index===this._upper}):(this._index=this._upper,{done:!0})},e.prototype.hasPrevious=function(){return this._index>this._lower},e.prototype.previousIndex=function(){return this._index-this._lower-1},e.prototype.previous=function(){this._direction=-1;var t=this._index-1;return t>=this._lower?(this._index=t,{value:this._record.getItem(t),done:t===this._lower}):(this._index=0,{done:!0})},e.prototype.set=function(t){this._direction>0?this._record.setItem(this._index-1,t):this._record.setItem(this._index,t)},e.prototype.delete=function(){this._direction>0&&(this._index-=1),this._record.splice(this._index,1),this._direction=0},e}(h),L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.isArray=function(){return!this.forEach(function(t){return t instanceof w.Field||void 0},this)},e.prototype.isObject=function(){return!this.forEach(function(t){return t instanceof w.Value||void 0},this)},Object.defineProperty(e.prototype,"fieldCount",{get:function(){var t=0;return this.forEach(function(e){e instanceof w.Field&&(t+=1)},this),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueCount",{get:function(){var t=0;return this.forEach(function(e){e instanceof w.Value&&(t+=1)},this),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tag",{get:function(){var t=this.head();if(t instanceof w.Attr)return t.key.value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this.forEach(function(t){return t instanceof b?t:void 0},this)||b.Absent},enumerable:!0,configurable:!0}),e.prototype.flattened=function(){var t=this.iterator();if(!t.isEmpty()){var e=t.head();return t.step(),t.isEmpty()&&e instanceof b?e:this.branch()}return b.Extant},e.prototype.header=function(t){var e=this.head();return e instanceof w.Attr&&e.key.value===t?e.value:b.Absent},e.prototype.headers=function(t){var i=this.head();if(i instanceof w.Attr&&i.key.value===t){var r=i.value;return r instanceof e?r:e.of(r)}},e.prototype.head=function(){return this.forEach(function(t){return t},this)||w.Absent},e.prototype.tail=function(){var t=e.empty();return this.forEach(function(e,i){i>0&&t.push(e)},this),t},e.prototype.body=function(){var t=this.iterator();if(!t.isEmpty()&&(t.step(),!t.isEmpty())){var i=t.head();return t.step(),t.isEmpty()?(i instanceof w.Value||(i=e.of(i)),i):this.tail().branch()}return b.Absent},e.prototype.has=function(t){return t=b.of(t),this.forEach(function(e){return!!(e instanceof w.Field&&e.key.equals(t))||void 0},this)||!1},e.prototype.get=function(t){return t=b.of(t),this.forEach(function(e){return e instanceof w.Field&&e.key.equals(t)?e.value:void 0},this)||b.Absent},e.prototype.getAttr=function(t){return t=w.Text.of(t),this.forEach(function(e){return e instanceof w.Attr&&e.key.equals(t)?e.value:void 0},this)||b.Absent},e.prototype.getField=function(t){return t=b.of(t),this.forEach(function(e){return e instanceof w.Field&&e.key.equals(t)?e:void 0},this)},e.prototype.set=function(t,e){t=b.of(t),e=b.of(e);for(var i=this.iterator();!i.isEmpty();){var r=i.head();if(r instanceof w.Field&&r.key.equals(t))return r.isMutable()?r.setValue(e):i.set(r.withValue(e)),this;i.step()}var o=new w.Slot(t,e);return this.push(o),this},e.prototype.setAttr=function(t,e){t=w.Text.of(t),e=b.of(e);for(var i=this.iterator();!i.isEmpty();){var r=i.head();if(r instanceof w.Field&&r.key.equals(t))return r instanceof w.Attr&&r.isMutable()?r.setValue(e):i.set(new w.Attr(t,e)),this;i.step()}var o=new w.Attr(t,e);return this.push(o),this},e.prototype.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=this.branch(),r=0,o=t.length;r<o;r+=1){w.fromAny(t[r]).forEach(function(t){i.push(t)},this)}return i},e.prototype.withField=function(t,e){t=b.of(t),e=b.of(e);for(var i=this.isMutable()?this:this.branch(),r=i.iterator();!r.isEmpty();){var o=r.head();if(o.key.equals(t))return o instanceof w.Field&&o.isMutable()?o.setValue(e):r.set(w.Slot.of(t,e)),i;r.step()}var n=w.Slot.of(t,e);return i.push(n),i},e.prototype.withAttr=function(t,e){t=w.Text.of(t),e=b.of(e);for(var i=this.isMutable()?this:this.branch(),r=i.iterator();!r.isEmpty();){var o=r.head();if(o.key.equals(t))return o instanceof w.Attr&&o.isMutable()?o.setValue(e):r.set(w.Attr.of(t,e)),i;r.step()}var n=w.Attr.of(t,e);return i.push(n),i},e.prototype.withSlot=function(t,e){t=b.of(t),e=b.of(e);for(var i=this.isMutable()?this:this.branch(),r=i.iterator();!r.isEmpty();){var o=r.head();if(o.key.equals(t))return o instanceof w.Slot&&o.isMutable()?o.setValue(e):r.set(w.Slot.of(t,e)),i;r.step()}var n=w.Slot.of(t,e);return i.push(n),i},e.prototype.withItem=function(t){var e=this.isMutable()?this:this.branch();return e.push(t),e},e.prototype.withItems=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this.isMutable()?this:this.branch();return i.push.apply(i,arguments),i},e.prototype.withoutKey=function(t){var e=this.isMutable()?this:this.branch();return e.delete(t),e},e.prototype.slice=function(t,e){return this.subRecord.apply(this,arguments).branch()},e.prototype.subRecord=function(t,i){var r=this.length;void 0===t?t=0:t<0&&(t=r+t),t=Math.min(Math.max(0,t),r),void 0===i?i=r:i<0&&(i=r+i);var o=e.empty();return this.forEach(function(e,r){return r<t?void 0:r<i?void o.push(e):null},this),o},e.prototype.attr=function(t,e){return this.push(w.Attr.of.apply(void 0,arguments)),this},e.prototype.slot=function(t,e){return this.push(w.Slot.of.apply(void 0,arguments)),this},e.prototype.item=function(t){return this.push(w.fromAny(t)),this},e.prototype.items=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.push.apply(this,arguments),this},e.prototype.iterator=function(){return new P(this)},e.prototype.indexOf=function(t,e){void 0===e&&(e=0),t=w.of(t);var i=this.length;e<0&&(e=i+e),e=Math.max(0,e);var r=-1;return this.forEach(function(i,o){if(o>=e&&i.equals(t))return r=o,null},this),r},e.prototype.lastIndexOf=function(t,e){t=w.of(t);var i=this.length;void 0===e?e=i-1:e<0&&(e=i+e),e=Math.min(e,i-1);var r=-1;return this.forEach(function(i,o){if(o>e)return null;i.equals(t)&&(r=o)},this),r},e.prototype.evaluate=function(t){t=D.fromAny(t);var i=e.empty();t.push(i);var r=!1;return this.forEach(function(e){var o=e.evaluate(t);o.isDefined()&&i.push(o),r=r||e!==o},this),t.pop(),r?i:this},e.prototype.substitute=function(t){t=D.fromAny(t);var i=e.empty();t.push(i);var r=!1;return this.forEach(function(e){var o=e.substitute(t);o.isDefined()&&i.push(o),r=r||e!==o},this),t.pop(),r?i:this},e.prototype.isAliased=function(){return!1},e.prototype.isMutable=function(){return!0},e.prototype.alias=function(){},e.prototype.branch=function(){var t=e.empty();return this.forEach(function(e){t.push(e)},this),t},e.prototype.clone=function(){var t=e.empty();return this.forEach(function(e){t.push(e.clone())},this),t},e.prototype.commit=function(){return this},e.prototype.toAny=function(){return!this.isEmpty()&&this.isArray()?this.toArray():this.toObject()},e.prototype.toArray=function(){var t=new Array(this.length);return this.forEach(function(e,i){e instanceof w.Value?t[i]=e.toAny():e instanceof w.Field&&(t[i]={$key:e.key.toAny(),$value:e.value.toAny()})},this),t},e.prototype.toObject=function(){var t={};return this.forEach(function(e,i){e instanceof w.Attr?t["@"+e.key.value]=e.value.toAny():e instanceof w.Slot?e.key instanceof w.Text?t[e.key.value]=e.value.toAny():t["$"+i]={$key:e.key.toAny(),$value:e.value.toAny()}:e instanceof w.Value&&(t["$"+i]=e.toAny())},this),t},e.prototype.stringValue=function(t){var e="";return void 0===this.forEach(function(t){if(t instanceof w.Value){var i=t.stringValue();if(void 0!==i)return void(e+=i)}return null},this)?e:void 0},e.prototype.bind=function(){return this},e.prototype.isBlockSafe=function(){return void 0===this.forEach(function(t){return!(t instanceof w.Attr)&&void 0},this)},e.prototype.isMarkupSafe=function(){var t=0;return void 0===this.forEach(function(e,i){if(t+=1,0===i){if(!(e instanceof w.Attr))return!1}else if(e instanceof w.Attr)return!1},this)&&t>0},e.prototype.writeRecon=function(t){var i=this.iterator();i.isEmpty()?t.push(123,125):e.writeItems(i,!1,!1,t)},e.prototype.writeReconBlock=function(t){var i=this.iterator();i.isEmpty()?t.push(123,125):e.writeItems(i,this.isBlockSafe(),!1,t)},e.writeItems=function(t,i,r,o){for(var n=!1,s=!1,a=!0,u=!0;!t.isEmpty();){var h=t.head();(h instanceof w.Expr||h instanceof w.Selector)&&(u=!1),t.step(),s&&h instanceof w.Attr&&(n&&(o.push(125),n=!1),o.push(93),s=!1),h instanceof w.Attr?(n?(o.push(125),n=!1):s&&(o.push(93),s=!1),h.writeRecon(o),a=!1):s&&h instanceof w.Text?(n&&(o.push(125),n=!1),w.Text.writeMarkup(h.value,o)):n?(a?a=!1:o.push(44),h.writeRecon(o)):s?h instanceof e&&h.isMarkupSafe()?(e.writeItems(h.iterator(),!1,!0,o),!t.isEmpty()&&t.head()instanceof w.Text?(w.Text.writeMarkup(t.head().stringValue(),o),t.step()):t.isEmpty()||t.head()instanceof w.Attr?(o.push(93),s=!1):(o.push(123),n=!0,a=!0)):(o.push(123),h.writeRecon(o),n=!0,a=!1):!(u&&h instanceof w.Text)||t.isEmpty()||t.head()instanceof w.Field||t.head()instanceof w.Text||t.head()instanceof w.Bool?i&&!n?(a?a=!1:o.push(44),h.writeRecon(o)):r&&h instanceof w.Text&&t.isEmpty()?(o.push(91),w.Text.writeMarkup(h.value,o),o.push(93)):!r&&h instanceof b&&!(h instanceof e)&&(!a&&t.isEmpty()||!t.isEmpty()&&t.head()instanceof w.Attr)?(!a&&(h instanceof w.Text&&h.isIdent()||h instanceof w.Num||h instanceof w.Bool)&&o.push(32),h.writeRecon(o)):(o.push(123),h.writeRecon(o),n=!0,a=!1):(o.push(91),w.Text.writeMarkup(h.value,o),s=!0)}n&&o.push(125),s&&o.push(93)},e.prototype.compare=function(t){if(t instanceof e){for(var i=this.iterator(),r=t.iterator(),o=0;0===o&&!i.isEmpty()&&!r.isEmpty();)o=i.head().compare(r.head()),i.step(),r.step();return 0!==o?o:i.isEmpty()&&!r.isEmpty()?-1:!i.isEmpty()&&r.isEmpty()?1:0}return t instanceof w.Field?1:-1},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){for(var i=this.iterator(),r=t.iterator();!i.isEmpty()&&!r.isEmpty();){if(!i.head().equals(r.head()))return!1;i.step(),r.step()}return i.isEmpty()===r.isEmpty()}return!1},e.prototype.hashCode=function(){var t=3401408391;return this.forEach(function(e){t=n.mix(t,e.hashCode())},this),n.mash(t)},e.prototype.toString=function(){return this.toRecon()},e.fromAny=function(t){if(t instanceof e)return t;if(Array.isArray(t))return e.fromArray(t);if("object"==typeof t)return e.fromObject(t);throw new TypeError(""+t)},e.fromArray=function(t){for(var i=t.length||0,r=e.empty(i),o=0;o<i;o+=1)r.push(w.fromAny(t[o]));return r},e.fromObject=function(t){var i=e.empty(),r=0;for(var o in t){var n=t[o];36===o.charCodeAt(0)&&o==="$"+r?n&&"object"==typeof n&&n.hasOwnProperty("$key")?i.push(w.Field.of(n.$key,n.$value)):i.push(b.of(n)):i.push(w.Field.of(o,n)),r+=1}return i},e.parseRecon=function(t){var i=b.parseRecon(t);return i instanceof e?i:i.isDefined()?e.of(i):e.empty()},e.expand=function(t){return t=Math.max(8,t)-1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},e.ALIASED=1,e.IMMUTABLE=2,e.Empty=void 0,e.empty=void 0,e.of=void 0,e}(b);w.Record=L;var F=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s._array=e,s._table=i,s._itemCount=r,s._fieldCount=o,s._flags=n,s}return u(e,t),e.prototype.isEmpty=function(){return 0===this._itemCount},e.prototype.isArray=function(){return 0===this._fieldCount},e.prototype.isObject=function(){return this._itemCount===this._fieldCount},Object.defineProperty(e.prototype,"length",{get:function(){return this._itemCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._itemCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldCount",{get:function(){return this._itemCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueCount",{get:function(){return this._itemCount-this._fieldCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tag",{get:function(){if(this._fieldCount>0){var t=this._array[0];if(t instanceof w.Attr)return t.key.value}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){for(var t=this._array,e=0,i=this._itemCount;e<i;e+=1){var r=t[e];if(r instanceof b)return r}return this},enumerable:!0,configurable:!0}),e.prototype.head=function(){return this._itemCount>0?this._array[0]:b.Absent},e.prototype.tail=function(){var t=this._itemCount;return t>0?new e.View(this,1,t):L.Empty},e.prototype.body=function(){var t=this._itemCount;if(t>2)return new e.View(this,1,t).branch();if(2===t){var i=this._array[1];return i instanceof w.Value||(i=L.of(i)),i}return b.Absent},e.prototype.has=function(t){if(this._fieldCount>0){t=b.of(t),this.hash();var e=this._table,i=e.length,r=Math.abs(t.hashCode()%i),o=r;do{var n=e[o];if(void 0===n)break;if(n.key.equals(t))return!0;o=(o+1)%i}while(o!==r)}return!1},e.prototype.get=function(t){if(this._fieldCount>0){t=b.of(t),this.hash();var e=this._table,i=e.length,r=Math.abs(t.hashCode()%i),o=r;do{var n=e[o];if(void 0===n)break;if(n.key.equals(t))return n.value;o=(o+1)%i}while(o!==r)}return b.Absent},e.prototype.getAttr=function(t){if(this._fieldCount>0){t=w.Text.of(t),this.hash();var e=this._table,i=e.length,r=Math.abs(t.hashCode()%i),o=r;do{var n=e[o];if(void 0===n)break;if(n instanceof w.Attr&&n.key.equals(t))return n.value;o=(o+1)%i}while(o!==r)}return b.Absent},e.prototype.getField=function(t){if(this._fieldCount>0){t=b.of(t),this.hash();var e=this._table,i=e.length,r=Math.abs(t.hashCode()%i),o=r;do{var n=e[o];if(void 0===n)break;if(n.key.equals(t))return n;o=(o+1)%i}while(o!==r)}},e.prototype.getItem=function(t){t instanceof w.Num&&(t=t.value);var e=this._itemCount;return t<0&&(t=e+t),(t=Math.min(Math.max(0,t),e-1))>=0?this._array[t]:w.Absent},e.prototype.set=function(t,e){if(0!=(this._flags&L.IMMUTABLE))throw new Error("immutable");return t=b.of(t),e=b.of(e),0!=(this._flags&L.ALIASED)?this._fieldCount>0?this.setAliased(t,e):this.pushAliased(new w.Slot(t,e)):this._fieldCount>0?null!==this._table?this.setMutable(t,e):this.putMutable(t,e):this.pushMutable(new w.Slot(t,e)),this},e.prototype.setAliased=function(t,e){for(var i=this._itemCount,r=this._array,o=new Array(L.expand(i+1)),n=0;n<i;n+=1){var s=r[n];if(s instanceof w.Field&&s.key.equals(t)){for(o[n]=s.withValue(e),n+=1;n<i;)o[n]=r[n],n+=1;return this._array=o,this._table=null,void(this._flags&=~L.ALIASED)}o[n]=s}this._array=o,this._table=null,this._flags&=~L.ALIASED;var a=new w.Slot(t,e);this.pushMutable(a)},e.prototype.setMutable=function(t,i){var r=this._table,o=r.length,n=Math.abs(t.hashCode()%o),s=n;do{var a=r[s];if(void 0===a)break;if(a.key.equals(t))return a.isMutable()?void a.setValue(i):void this.putMutable(t,i);s=(s+1)%o}while(s!==n);var u=new w.Slot(t,i);this.pushMutable(u),e.put(u,r)},e.prototype.putMutable=function(t,i){for(var r=this._array,o=0,n=this._itemCount;o<n;o+=1){var s=r[o];if(s instanceof w.Field&&s.key.equals(t))return r[o]=s.withValue(i),void(this._table=null)}var a=new w.Slot(t,i);this.pushMutable(a),e.put(a,this._table)},e.prototype.setAttr=function(t,e){if(0!=(this._flags&L.IMMUTABLE))throw new Error("immutable");return t=w.Text.of(t),e=b.of(e),0!=(this._flags&L.ALIASED)?this._fieldCount>0?this.setAttrAliased(t,e):this.pushAliased(new w.Attr(t,e)):this._fieldCount>0?null!==this._table?this.setAttrMutable(t,e):this.putAttrMutable(t,e):this.pushMutable(new w.Attr(t,e)),this},e.prototype.setAttrAliased=function(t,e){for(var i=this._itemCount,r=this._array,o=new Array(L.expand(i+1)),n=0;n<i;n+=1){var s=r[n];if(s instanceof w.Field&&s.key.equals(t)){for(o[n]=w.Attr.of(t,e),n+=1;n<i;)o[n]=r[n],n+=1;return this._array=o,this._table=null,void(this._flags&=~L.ALIASED)}o[n]=s}o[i]=w.Attr.of(t,e),this._array=o,this._table=null,this._itemCount=i+1,this._fieldCount+=1,this._flags&=~L.ALIASED},e.prototype.setAttrMutable=function(t,i){var r=this._table,o=r.length,n=Math.abs(t.hashCode()%o),s=n;do{var a=r[s];if(void 0===a)break;if(a.key.equals(t))return void(a instanceof w.Attr&&a.isMutable()?a.setValue(i):this.putAttrMutable(t,i));s=(s+1)%o}while(s!==n);var u=w.Attr.of(t,i);this.push(u),e.put(u,r)},e.prototype.putAttrMutable=function(t,i){for(var r=this._array,o=this._itemCount,n=0;n<o;n+=1){if(r[n].key.equals(t))return r[n]=w.Attr.of(t,i),void(this._table=null)}var s=w.Attr.of(t,i);this.push(s),e.put(s,this._table)},e.prototype.setItem=function(t,e){if(0!=(this._flags&L.IMMUTABLE))throw new Error("immutable");t instanceof w.Num&&(t=t.value),e=w.of(e);var i=this.length;return t<0&&(t=i+t),(t=Math.min(Math.max(0,t),i-1))>=0&&(0!=(this._flags&L.ALIASED)?this.setIndexAliased(t,e):this.setIndexMutable(t,e)),this},e.prototype.setIndexAliased=function(t,e){for(var i=this._itemCount,r=this._array,o=new Array(L.expand(i)),n=0;n<i;n+=1)o[n]=r[n];var s=r[t];o[t]=e,this._array=o,this._table=null,e instanceof w.Field?s instanceof w.Field||(this._fieldCount+=1):s instanceof w.Field&&(this._fieldCount-=1),this._flags&=~L.ALIASED},e.prototype.setIndexMutable=function(t,e){var i=this._array,r=i[t];i[t]=e,e instanceof w.Field?(this._table=null,r instanceof w.Field||(this._fieldCount+=1)):r instanceof w.Field&&(this._table=null,this._fieldCount-=1)},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0!=(this._flags&L.IMMUTABLE))throw new Error("immutable");return 0!=(this._flags&L.ALIASED)?this.pushAliased.apply(this,arguments):this.pushMutable.apply(this,arguments),this._itemCount},e.prototype.pushAliased=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t.length,r=this._itemCount,o=this._fieldCount,n=this._array,s=new Array(L.expand(r+i));if(null!==n)for(var a=0;a<r;a+=1)s[a]=n[a];for(a=0;a<i;a+=1){var u=w.fromAny(t[a]);s[r]=u,r+=1,u instanceof w.Field&&(o+=1)}this._array=s,this._table=null,this._itemCount=r,this._fieldCount=o,this._flags&=~L.ALIASED},e.prototype.pushMutable=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=t.length,o=this._itemCount,n=this._fieldCount,s=this._array;if(null===s||o+r>s.length){if(i=new Array(L.expand(o+r)),null!==s)for(var a=0;a<o;a+=1)i[a]=s[a]}else i=s;for(a=0;a<r;a+=1){var u=w.fromAny(t[a]);i[o]=u,o+=1,u instanceof w.Field&&(n+=1,this._table=null)}this._array=i,this._itemCount=o,this._fieldCount=n},e.prototype.splice=function(t,e){void 0===e&&(e=0);for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(0!=(this._flags&L.IMMUTABLE))throw new Error("immutable");var o=this._itemCount;return t<0&&(t=o+t),t=Math.min(Math.max(0,t),o),e=Math.min(Math.max(0,e),o-t),0!=(this._flags&L.ALIASED)?this.spliceAliased.apply(this,arguments):this.spliceMutable.apply(this,arguments)},e.prototype.spliceAliased=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];for(var o=i.length,n=this._itemCount,s=this._fieldCount,a=this._array,u=new Array(L.expand(n-e+o)),h=0;h<t;h+=1)u[h]=a[h];var l=[];for(h=t;h<t+e;h+=1){var p=a[h];l.push(p),n-=1,p instanceof w.Field&&(s-=1)}for(h=t;h<n;h+=1)u[h+o]=a[h+e];for(h=0;h<o;h+=1){var c=w.of(i[h]);u[h+t]=c,n+=1,c instanceof w.Field&&(s+=1)}return this._array=u,this._table=null,this._itemCount=n,this._fieldCount=s,this._flags&=~L.ALIASED,l},e.prototype.spliceMutable=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o,n=i.length,s=this._itemCount,a=this._fieldCount,u=this._array;if(null===u||s-e+n>u.length){if(o=new Array(L.expand(s-e+n)),null!==u)for(var h=0;h<t;h+=1)o[h]=u[h]}else o=u;var l=[];for(h=t;h<t+e;h+=1){var p=u[h];l.push(p),s-=1,p instanceof w.Field&&(a-=1)}if(n>e)for(h=s-1;h>=t;h-=1)o[h+n]=u[h+e];else for(h=t;h<s;h+=1)o[h+n]=u[h+e];for(h=0;h<n;h+=1){var c=w.of(i[h]);o[h+t]=c,s+=1,c instanceof w.Field&&(a+=1)}return this._array=o,this._itemCount=s,this._fieldCount=a,l},e.prototype.delete=function(t){if(0!=(this._flags&L.IMMUTABLE))throw new Error("immutable");return t=b.of(t),0!=(this._flags&L.ALIASED)?this.deleteAliased(t):this.deleteMutable(t)},e.prototype.deleteAliased=function(t){for(var e=this._itemCount,i=this._array,r=new Array(L.expand(e)),o=0;o<e;o+=1){var n=i[o];if(n instanceof w.Field&&n.key.equals(t)){for(var s=o+1;s<e;s+=1,o+=1)r[o]=i[s];return this._array=r,this._table=null,this._itemCount=e-1,this._fieldCount-=1,this._flags&=~L.ALIASED,n}r[o]=n}return w.Absent},e.prototype.deleteMutable=function(t){for(var e=this._itemCount,i=this._array,r=0;r<e;r+=1){var o=i[r];if(o instanceof w.Field&&o.key.equals(t)){for(var n=r+1;n<e;n+=1,r+=1)i[r]=i[n];return i[e-1]=void 0,this._table=null,this._itemCount=e-1,this._fieldCount-=1,o}}return w.Absent},e.prototype.clear=function(){if(0!=(this._flags&L.IMMUTABLE))throw new Error("immutable");this._array=null,this._table=null,this._itemCount=0,this._fieldCount=0,this._flags=0},e.prototype.withField=function(t,e){t=b.of(t),e=b.of(e);var i=0==(this._flags&L.IMMUTABLE)?this:this.branch();return 0!=(i._flags&L.ALIASED)?i._fieldCount>0?i.setAliased(t,e):i.pushAliased(w.Slot.of(t,e)):i.fieldCount>0?null!==i._table?i.setMutable(t,e):i.putMutable(t,e):i.pushMutable(w.Slot.of(t,e)),i},e.prototype.withAttr=function(t,e){t=w.Text.of(t),e=b.of(e);var i=0==(this._flags&L.IMMUTABLE)?this:this.branch();return 0!=(i._flags&L.ALIASED)?i._fieldCount>0?i.setAttrAliased(t,e):i.pushAliased(w.Attr.of(t,e)):i.fieldCount>0?null!==i._table?i.setAttrMutable(t,e):i.putAttrMutable(t,e):i.pushMutable(w.Attr.of(t,e)),i},e.prototype.withSlot=function(t,e){t=b.of(t),e=b.of(e);var i=0==(this._flags&L.IMMUTABLE)?this:this.branch();return 0!=(i._flags&L.ALIASED)?i._fieldCount>0?i.setSlotAliased(t,e):i.pushAliased(w.Slot.of(t,e)):i.fieldCount>0?null!==i._table?i.setSlotMutable(t,e):i.putSlotMutable(t,e):i.pushMutable(w.Slot.of(t,e)),i},e.prototype.setSlotAliased=function(t,e){for(var i=this._itemCount,r=this._array,o=new Array(L.expand(i+1)),n=0;n<i;n+=1){var s=r[n];if(s instanceof w.Field&&s.key.equals(t)){for(o[n]=w.Slot.of(t,e),n+=1;n<i;)o[n]=r[n],n+=1;return this._array=o,this._table=null,void(this._flags&=~L.ALIASED)}o[n]=s}o[i]=w.Slot.of(t,e),this._array=o,this._table=null,this._itemCount=i+1,this._fieldCount+=1,this._flags&=~L.ALIASED},e.prototype.setSlotMutable=function(t,i){var r=this._table,o=r.length,n=Math.abs(t.hashCode()%o),s=n;do{var a=r[s];if(void 0===a)break;if(a.key.equals(t))return void(a instanceof w.Slot&&a.isMutable()?a.setValue(i):this.putSlotMutable(t,i));s=(s+1)%o}while(s!==n);var u=w.Slot.of(t,i);this.push(u),e.put(u,r)},e.prototype.putSlotMutable=function(t,i){for(var r=this._array,o=this._itemCount,n=0;n<o;n+=1){if(r[n].key.equals(t))return r[n]=w.Slot.of(t,i),void(this._table=null)}var s=w.Slot.of(t,i);this.push(s),e.put(s,this._table)},e.prototype.subRecord=function(t,i){var r=this._itemCount;return void 0===t?t=0:t<0&&(t=r+t),t=Math.min(Math.max(0,t),r),void 0===i?i=r:i<0&&(i=r+i),i=Math.min(Math.max(t,i),r),new e.View(this,t,i)},e.prototype.forEach=function(t,e){for(var i=this._array,r=0,o=this._itemCount;r<o;r+=1){var n=t.call(e,i[r],r);if(void 0!==n)return n}},e.prototype.indexOf=function(t,e){void 0===e&&(e=0),t=w.of(t);var i=this._array,r=this._itemCount;for(e<0&&(e=r+e),e=Math.max(0,e);e<r;){if(t.equals(i[e]))return e;e+=1}return-1},e.prototype.lastIndexOf=function(t,e){t=w.of(t);var i=this._array,r=this._itemCount;for(void 0===e?e=r-1:e<0&&(e=r+e),e=Math.min(e,r-1);e>=0;){if(t.equals(i[e]))return e;e-=1}return-1},e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this._array,i=this._itemCount,r=L.empty(i);t.push(r);for(var o=!1,n=0;n<i;n+=1){var s=e[n],a=s.evaluate(t);a.isDefined()&&r.push(a),o=o||s!==a}return t.pop(),o?r:this},e.prototype.substitute=function(t){t=D.fromAny(t);var e=this._array,i=this._itemCount,r=L.empty(i);t.push(r);for(var o=!1,n=0;n<i;n+=1){var s=e[n],a=s.substitute(t);a.isDefined()&&r.push(a),o=o||s!==a}return t.pop(),o?r:this},e.prototype.isAliased=function(){return 0!=(this._flags&L.ALIASED)},e.prototype.isMutable=function(){return 0==(this._flags&L.IMMUTABLE)},e.prototype.alias=function(){this._flags|=L.ALIASED},e.prototype.branch=function(){if(0==(this._flags&(L.ALIASED|L.IMMUTABLE)))for(var t=this._array,i=0,r=this._itemCount;i<r;i+=1)t[i].alias();return this._flags|=L.ALIASED,new e(this._array,this._table,this._itemCount,this._fieldCount,L.ALIASED)},e.prototype.clone=function(){for(var t=this._itemCount,i=this._array,r=new Array(t),o=0;o<t;o+=1)r[o]=i[o].clone();return new e(r,null,t,this._fieldCount,0)},e.prototype.commit=function(){if(0==(this._flags&L.IMMUTABLE)){this._flags|=L.IMMUTABLE;for(var t=this._array,e=0,i=this._itemCount;e<i;e+=1)t[e].commit()}return this},e.prototype.hash=function(){var t=this._fieldCount;if(t>0&&null===this._table){for(var i=new Array(L.expand(Math.max(t,10*t/7))),r=this._array,o=0,n=this._itemCount;o<n;o+=1){var s=r[o];s instanceof w.Field&&e.put(s,i)}this._table=i}},e.put=function(t,e){if(null!==e){var i=e.length,r=Math.abs(t.key.hashCode()%i),o=r;do{var n=e[o];if(void 0===n)return void(e[o]=t);if(t.key.equals(n.key))return void(e[o]=t);o=(o+1)%i}while(o!==r);throw new Error}},e.empty=function(t){return new e(void 0===t?null:new Array(t),null,0,0,0)},e.of=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var r=t.length;if(0===r)return new e(null,null,0,0,0);for(var o=new Array(r),n=0,s=0,a=0;a<r;a+=1){var u=w.fromAny(t[a]);o[a]=u,n+=1,u instanceof w.Field&&(s+=1)}return new e(o,null,n,s,0)},e.View=void 0,e.Empty=new e(null,null,0,0,L.ALIASED|L.IMMUTABLE),e}(L);w.Empty=F.Empty,b.Empty=F.Empty,L.Empty=F.Empty,w.empty=F.empty,b.empty=F.empty,L.empty=F.empty,L.of=F.of;var z=function(t){function e(e,i,r){var o=t.call(this)||this;return o._record=e,o._lower=i,o._upper=r,o}return u(e,t),e.prototype.isEmpty=function(){return this._lower===this._upper},e.prototype.isArray=function(){for(var t=this._record._array,e=this._lower,i=this._upper;e<i;e+=1)if(t[e]instanceof w.Field)return!1;return!0},e.prototype.isObject=function(){for(var t=this._record._array,e=this._lower,i=this._upper;e<i;e+=1)if(t[e]instanceof w.Value)return!1;return!0},Object.defineProperty(e.prototype,"length",{get:function(){return this._upper-this._lower},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._upper-this._lower},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldCount",{get:function(){for(var t=0,e=this._record._array,i=this._lower,r=this._upper;i<r;i+=1)e[i]instanceof w.Field&&(t+=1);return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueCount",{get:function(){for(var t=0,e=this._record._array,i=this._lower,r=this._upper;i<r;i+=1)e[i]instanceof b&&(t+=1);return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tag",{get:function(){if(this.length>0){var t=this._record._array[this._lower];if(t instanceof w.Attr)return t.key.value}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){for(var t=this._record._array,e=this._lower,i=this._upper;e<i;e+=1){var r=t[e];if(r instanceof b)return r}return this},enumerable:!0,configurable:!0}),e.prototype.head=function(){return this.length>0?this._record._array[this._lower]:b.Absent},e.prototype.tail=function(){return this.length>0?new e(this._record,this._lower+1,this._upper):L.Empty},e.prototype.body=function(){var t=this.length;if(t>2)return new e(this._record,this._lower+1,this._upper).branch();if(2===t){var i=this._record._array[this._lower+1];return i instanceof w.Value||(i=L.of(i)),i}return b.Absent},e.prototype.getItem=function(t){t instanceof w.Num&&(t=t.value);var e=this.length;return t<0&&(t=e+t),(t=Math.min(Math.max(0,t),e-1))>=0?this._record._array[this._lower+t]:w.Absent},e.prototype.setItem=function(t,e){if(0!=(this._record._flags&L.IMMUTABLE))throw new Error("immutable");t instanceof w.Num&&(t=t.value),e=w.of(e);var i=this.length;return t<0&&(t=i+t),(t=Math.min(Math.max(0,t),i-1))>=0&&(0!=(this._record._flags&L.ALIASED)?this.setIndexAliased(t,e):this.setIndexMutable(t,e)),this},e.prototype.setIndexAliased=function(t,e){for(var i=this._record._itemCount,r=this._record._array,o=new Array(L.expand(i)),n=0;n<i;n+=1)o[n]=r[n];var s=r[this._lower+t];o[this._lower+t]=e,this._record._array=o,this._record._table=null,e instanceof w.Field?s instanceof w.Field||(this._record._fieldCount+=1):s instanceof w.Field&&(this._record._fieldCount-=1),this._record._flags&=~L.ALIASED},e.prototype.setIndexMutable=function(t,e){var i=this._record._array,r=i[this._lower+t];i[this._lower+t]=e,e instanceof w.Field?(this._record._table=null,r instanceof w.Field||(this._record._fieldCount+=1)):r instanceof w.Field&&(this._record._table=null,this._record._fieldCount-=1)},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0!=(this._record._flags&L.IMMUTABLE))throw new Error("immutable");return 0!=(this._record._flags&L.ALIASED)?this.pushAliased.apply(this,arguments):this.pushMutable.apply(this,arguments),this.length},e.prototype.pushAliased=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=t.length,r=this._record._itemCount,o=this._record._fieldCount,n=this._record._array,s=new Array(L.expand(r+i));if(null!==n){for(var a=0;a<this._upper;a+=1)s[a]=n[a];for(a=this._upper;a<r;a+=1)s[a+i]=n[a]}for(a=0;a<i;a+=1){var u=w.fromAny(t[a]);s[a+this._upper]=u,r+=1,u instanceof w.Field&&(o+=1)}this._record._array=s,this._record._table=null,this._record._itemCount=r,this._record._fieldCount=o,this._record._flags&=~L.ALIASED,this._upper+=i},e.prototype.pushMutable=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i,r=t.length,o=this._record._itemCount,n=this._record._fieldCount,s=this._record._array;if(null===s||o+r>s.length){if(i=new Array(L.expand(o+r)),null!==s)for(var a=0;a<this._upper;a+=1)i[a]=s[a]}else i=s;for(a=o-1;a>=this._upper;a-=1)i[a+r]=s[a];for(a=0;a<r;a+=1){var u=w.fromAny(t[a]);i[a+this._upper]=u,o+=1,u instanceof w.Field&&(n+=1,this._record._table=null)}this._record._array=i,this._record._itemCount=o,this._record._fieldCount=n,this._upper+=r},e.prototype.splice=function(t,e){void 0===e&&(e=0);for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];if(0!=(this._record._flags&L.IMMUTABLE))throw new Error("immutable");var o,n,s,a=this.length;return t<0&&(t=a+t),t=Math.min(Math.max(0,t),a),e=Math.min(Math.max(0,e),a-t),o=0!=(this._record._flags&L.ALIASED)?(n=this._record).spliceAliased.apply(n,[this._lower+t,e].concat(i)):(s=this._record).spliceMutable.apply(s,[this._lower+t,e].concat(i)),this._upper+=i.length-o.length,o},e.prototype.delete=function(t){if(0!=(this._record._flags&L.IMMUTABLE))throw new Error("immutable");return t=b.of(t),0!=(this._record._flags&L.ALIASED)?this.deleteAliased(t):this.deleteMutable(t)},e.prototype.deleteAliased=function(t){for(var e=this._record._itemCount,i=this._record._array,r=new Array(L.expand(e)),o=this._lower;o<this._upper;o+=1){var n=i[o];if(n instanceof w.Field&&n.key.equals(t)){for(var s=o+1;s<e;s+=1,o+=1)r[o]=i[s];return this._record._array=r,this._record._table=null,this._record._itemCount=e-1,this._record._fieldCount-=1,this._record._flags&=~L.ALIASED,this._upper-=1,n}r[o]=n}return w.Absent},e.prototype.deleteMutable=function(t){for(var e=this._record._itemCount,i=this._record._array,r=this._lower;r<this._upper;r+=1){var o=i[r];if(o instanceof w.Field&&o.key.equals(t)){for(var n=r+1;n<e;n+=1,r+=1)i[r]=i[n];return i[e-1]=void 0,this._record._table=null,this._record._itemCount-=1,this._record._fieldCount-=1,this._upper-=1,o}}return w.Absent},e.prototype.clear=function(){if(0!=(this._record._flags&L.IMMUTABLE))throw new Error("immutable");0!=(this._record._flags&L.ALIASED)?this.clearAliased():this.clearMutable()},e.prototype.clearAliased=function(){for(var t=this._record._itemCount,e=this._record._fieldCount,i=t-this.length,r=this._record._array,o=new Array(L.expand(i)),n=0;n<this._lower;)o[n]=r[n],n+=1;for(;n<this._upper;)r[n]instanceof w.Field&&(e-=1),n+=1;n=this._lower;for(var s=this._upper;s<t;)o[n]=r[s],n+=1,s+=1;this._record._array=o,this._record._table=null,this._record._itemCount=i,this._record._fieldCount=e,this._record._flags&=~L.ALIASED,this._upper=this._lower},e.prototype.clearMutable=function(){for(var t=this._record._itemCount,e=this._record._fieldCount,i=this._record._array,r=this._lower;r<this._upper;)i[r]instanceof w.Field&&(e-=1),r+=1;r=this._lower;for(var o=this._upper;o<t;){var n=i[o];n instanceof w.Field&&(this._record._table=null),i[r]=n,r+=1,o+=1}for(this._record._itemCount=r,this._record._fieldCount=e;r<t;)i[r]=void 0,r+=1;this._upper=this._lower},e.prototype.subRecord=function(t,i){var r=this.length;return void 0===t?t=0:t<0&&(t=r+t),t=Math.min(Math.max(0,t),r),void 0===i?i=r:i<0&&(i=r+i),i=Math.min(Math.max(t,i),r),new e(this._record,this._lower+t,this._upper+i)},e.prototype.forEach=function(t,e){for(var i=this._record._array,r=this._lower,o=this._upper;r<o;r+=1){var n=t.call(e,i[r],r);if(void 0!==n)return n}},e.prototype.indexOf=function(t,e){void 0===e&&(e=0),t=w.of(t);var i=this._record._array,r=this.length;for(e<0&&(e=r+e),e=this._lower+Math.max(0,e);e<this._upper;){if(t.equals(i[e]))return e-this._lower;e+=1}return-1},e.prototype.lastIndexOf=function(t,e){t=w.of(t);var i=this._record._array,r=this.length;for(void 0===e?e=r-1:e<0&&(e=r+e),e=this._lower+Math.min(e,r-1);e>=this._lower;){if(t.equals(i[e]))return e-this._lower;e-=1}return-1},e.prototype.isAliased=function(){return 0!=(this._record._flags&L.ALIASED)},e.prototype.isMutable=function(){return 0==(this._record._flags&L.IMMUTABLE)},e.prototype.alias=function(){this._record._flags|=L.ALIASED},e.prototype.branch=function(){for(var t=this.length,e=0,i=this._record._array,r=new Array(L.expand(t)),o=this._lower,n=0;n<t;){var s=i[o];r[n]=s,s instanceof w.Field&&(e+=1),o+=1,n+=1}return new F(r,null,t,e,0)},e.prototype.clone=function(){for(var t=this.length,e=0,i=this._record._array,r=new Array(L.expand(t)),o=this._lower,n=0;n<t;){var s=i[o];r[n]=s.clone(),s instanceof w.Field&&(e+=1),o+=1,n+=1}return new F(r,null,t,e,0)},e.prototype.commit=function(){return this._record.commit(),this},e}(L);F.View=z;var I=function(t){function e(e,i){var r=t.call(this)||this;return r._value=e,r._flags=i,r}return u(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._value.length},enumerable:!0,configurable:!0}),e.prototype.isIdent=function(){var t=new v(this._value);if(t.isEmpty()||!w.Recon.isIdentStartChar(t.head()))return!1;for(t.step();!t.isEmpty()&&w.Recon.isIdentChar(t.head());)t.step();return t.isEmpty()},e.prototype.isDone=function(){return!1},e.prototype.isFull=function(){return!1},e.prototype.push=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];if(0!=(this._flags&e.IMMUTABLE))throw new Error("immutable");for(var r=0,o=t.length;r<o;r+=1){var n=t[r];if("number"==typeof n)if(n>=0&&n<=55295||n>=57344&&n<=65535)this._value+=String.fromCharCode(n);else if(n>=65536&&n<=1114111){var s=n-65536;this._value+=String.fromCharCode(55296|s>>>10,56320|1023&s)}else this._value+=String.fromCharCode(65533);else if("string"==typeof n)for(var a=new v(n);!a.isEmpty();)this.push(a.head()),a.step()}},e.prototype.isMutable=function(){return 0==(this._flags&e.IMMUTABLE)},e.prototype.branch=function(){return this.clone()},e.prototype.clone=function(){return new e(this._value,0)},e.prototype.commit=function(){return this._flags|=e.IMMUTABLE,this},e.prototype.bind=function(){return this},e.prototype.stringValue=function(){return this._value},e.prototype.numberValue=function(){var t=+this._value;if(isFinite(t))return t},e.prototype.toAny=function(){return this._value},e.prototype.valueOf=function(){return this._value},e.prototype.writeRecon=function(t){this.isIdent()?e.writeIdent(this._value,t):e.writeString(this._value,t)},e.writeIdent=function(t,e){for(var i=new v(t);!i.isEmpty();)e.push(i.head()),i.step()},e.writeString=function(t,e){var i=new v(t);for(e.push(34);!i.isEmpty();){var r=i.head();switch(r){case 34:case 92:e.push(92,r);break;case 8:e.push(92,98);break;case 12:e.push(92,102);break;case 10:e.push(92,110);break;case 13:e.push(92,114);break;case 9:e.push(92,116);break;default:e.push(r)}i.step()}e.push(34)},e.writeMarkup=function(t,e){for(var i=new v(t);!i.isEmpty();){var r=i.head();switch(r){case 36:case 64:case 91:case 92:case 93:case 123:case 125:e.push(92,r);break;case 8:e.push(92,98);break;case 12:e.push(92,102);break;case 10:e.push(92,110);break;case 13:e.push(92,114);break;case 9:e.push(92,116);break;default:e.push(r)}i.step()}},e.prototype.compare=function(t){if(t instanceof e){var i=this._value.localeCompare(t._value);return i<0?-1:i>0?1:0}return t instanceof w.Field||t instanceof w.Record||t instanceof w.Data?1:-1},e.prototype.equals=function(t){return this===t||t instanceof e&&this._value===t._value},e.prototype.hashCode=function(){return n.hash(this._value)},e.prototype.toString=function(){return this._value},e.empty=function(){return new e("",0)},e.valueOf=function(t){return 0===t.length?e.Empty:new e(t,e.IMMUTABLE)},e.of=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.valueOf(t);throw new TypeError(""+t)},e.IMMUTABLE=1,e.Empty=new e("",e.IMMUTABLE),e}(b);w.Text=I;var U=function(t){function e(e){var i=t.call(this)||this;return i._value=e,i}return u(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.plus=function(i){return(i=w.of(i))instanceof w.Num?e.valueOf(this.value+i.value):t.prototype.plus.call(this,i)},e.prototype.minus=function(i){return(i=w.of(i))instanceof w.Num?e.valueOf(this.value-i.value):t.prototype.minus.call(this,i)},e.prototype.opposite=function(){return e.valueOf(-this.value)},e.prototype.times=function(i){return(i=w.of(i))instanceof w.Num?e.valueOf(this.value*i.value):t.prototype.times.call(this,i)},e.prototype.divide=function(i){return(i=w.of(i))instanceof w.Num?e.valueOf(this.value/i.value):t.prototype.divide.call(this,i)},e.prototype.modulo=function(i){return(i=w.of(i))instanceof w.Num?e.valueOf(this.value%i.value):t.prototype.modulo.call(this,i)},e.prototype.inverse=function(){return e.valueOf(1/this.value)},e.prototype.stringValue=function(){return""+this._value},e.prototype.numberValue=function(){return this._value},e.prototype.toAny=function(){return this._value},e.prototype.valueOf=function(){return this._value},e.prototype.writeRecon=function(t){var i=this._value;if(isFinite(i)&&i===Math.floor(i)&&i>=-2147483648&&i<=2147483647)return e.writeInteger(i,t);w.Text.writeIdent(String(i),t)},e.writeInteger=function(t,e){if(t<0&&(e.push(45),t=-t),t<10)e.push(48+t);else{for(var i=new Uint8Array(19),r=18;0!==t;)i[r]=t%10,t=Math.floor(t/10),r-=1;for(r+=1;r<19;)e.push(48+i[r]),r+=1}},e.prototype.compare=function(t){if(t instanceof e){var i=this._value,r=t._value;return i<r?-1:i>r?1:0}return t instanceof w.Field||t instanceof w.Record||t instanceof w.Data||t instanceof w.Text?1:-1},e.prototype.equals=function(t){return this===t||t instanceof e&&this._value===t._value},e.prototype.hashCode=function(){return n.mash(n.mix(950747444,n.hash(this._value)))},e.prototype.toString=function(){return this.toRecon()},e.valueOf=function(t){return 0===t?e.Zero:1===t?e.One:new e(t)},e.of=function(t){if(t instanceof e)return t;if("number"==typeof t)return e.valueOf(t);throw new TypeError(""+t)},e.Zero=new e(0),e.One=new e(1),e}(b);w.Num=U;var W=function(t){function e(e){var i=t.call(this)||this;return i._value=e,i}return u(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.or=function(t){return this},e.prototype.and=function(t){return t},e.prototype.not=function(){return this._value?b.False:b.True},e.prototype.stringValue=function(){return this._value?"true":"false"},e.prototype.booleanValue=function(){return this._value},e.prototype.toAny=function(){return this._value},e.prototype.valueOf=function(){return this._value},e.prototype.writeRecon=function(t){this._value?t.push(116,114,117,101):t.push(102,97,108,115,101)},e.prototype.toRecon=function(){return this._value?"true":"false"},e.prototype.toReconBlock=function(){return this._value?"true":"false"},e.prototype.compare=function(t){return t instanceof e?this._value&&!t._value?-1:!this._value&&t._value?1:0:t instanceof w.Field||t instanceof w.Record||t instanceof w.Data||t instanceof w.Text||t instanceof w.Num?1:-1},e.prototype.equals=function(t){return this===t||t instanceof e&&this._value===t._value},e.prototype.hashCode=function(){return this._value?1205540039:2682565394},e.prototype.toString=function(){return this.toRecon()},e.valueOf=function(t){return t?e.True:e.False},e.of=function(t){if(t instanceof e)return t;if("boolean"==typeof t)return e.valueOf(t);throw new TypeError(""+t)},e.True=new e(!0),e.False=new e(!1),e}(b);w.Bool=W,w.True=W.True,w.False=W.False,b.True=W.True,b.False=W.False;var O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.cond=function(t,e){return t=w.of(t),e=w.of(e),new w.CondExpr(this,t,e)},e.prototype.or=function(t){return t=w.of(t),new w.OrExpr(this,t)},e.prototype.and=function(t){return t=w.of(t),new w.AndExpr(this,t)},e.prototype.not=function(){return new w.NotExpr(this)},e.prototype.lt=function(t){return t=w.of(t),new w.LtExpr(this,t)},e.prototype.le=function(t){return t=w.of(t),new w.LeExpr(this,t)},e.prototype.eq=function(t){return t=w.of(t),new w.EqExpr(this,t)},e.prototype.ne=function(t){return t=w.of(t),new w.NeExpr(this,t)},e.prototype.ge=function(t){return t=w.of(t),new w.GeExpr(this,t)},e.prototype.gt=function(t){return t=w.of(t),new w.GtExpr(this,t)},e.prototype.plus=function(t){return t=w.of(t),new w.AddExpr(this,t)},e.prototype.minus=function(t){return t=w.of(t),new w.SubExpr(this,t)},e.prototype.opposite=function(){return new w.NegExpr(this)},e.prototype.times=function(t){return t=w.of(t),new w.MulExpr(this,t)},e.prototype.divide=function(t){return t=w.of(t),new w.DivExpr(this,t)},e.prototype.modulo=function(t){return t=w.of(t),new w.ModExpr(this,t)},e.prototype.inverse=function(){return new w.DivExpr(w.Num.One,this)},e.prototype.toAny=function(){return this},e}(b);w.DynamicValue=O;var B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=b.empty();return this.forSelected(t,function(t){var i=t.peek();i&&e.push(i)},this),e.isEmpty()?b.Absent:e.flattened()},e.prototype.update=function(t,e){return t=D.fromAny(t),this.mapSelected(t,function(t){return t.peek()||w.Absent},this)},e.prototype.remove=function(t){return t=D.fromAny(t),this.mapSelected(t,function(t){return w.Absent},this)},e.prototype.get=function(t){return t=b.of(t),this.andThen(new H(t))},e.prototype.getAttr=function(t){return t=w.Text.of(t),this.andThen(new N(t))},e.prototype.getItem=function(t){return t=w.Num.of(t),this.andThen(new j(t))},e.prototype.keys=function(){return this.andThen(e.Keys)},e.prototype.children=function(){return this.andThen(e.Children)},e.prototype.descendants=function(){return this.andThen(e.Descendants)},e.prototype.invoke=function(t){return new w.InvokeExpr(this,t)},e.prototype.filter=function(t){return 0===arguments.length?new Q(this):(t=w.of(t),this.andThen(t.filter()))},Object.defineProperty(e.prototype,"precedence",{get:function(){return 6},enumerable:!0,configurable:!0}),e.prototype.writeRecon=function(t){this.writeThen(t)},e.prototype.compare=function(t){return t instanceof e?0:t instanceof w.Func||t instanceof w.Expr||t===b.Extant||t===b.Absent?-1:1},e.prototype.toString=function(){return this.toRecon()},e.literal=function(t){return(t=w.of(t))instanceof e||(t=new G(t)),t},e.get=function(t){return t=b.of(t),new H(t,!0)},e.getAttr=function(t){return t=w.Text.of(t),new N(t,!0)},e.getItem=function(t){return t=w.Num.of(t),new j(t)},e.Identity=void 0,e.Keys=void 0,e.Children=void 0,e.Descendants=void 0,e}(O);w.Selector=B;var q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.forSelected=function(t,e,i){var r;if(!t.isEmpty()){var o=t.pop(),n=o.evaluate(t);t.push(n),r=e.call(i,t),t.replace(o)}return r},e.prototype.mapSelected=function(t,e,i){return e.call(i,t)},e.prototype.substitute=function(t){return(t=D.fromAny(t)).item().substitute(t)},e.prototype.get=function(t){return t=b.of(t),this.andThen(new H(t,!0))},e.prototype.getAttr=function(t){return t=w.Text.of(t),this.andThen(new N(t,!0))},e.prototype.andThen=function(t){return t},e.prototype.writeRecon=function(t){},e.prototype.writeThen=function(t){},e.prototype.toRecon=function(){return""},e.prototype.clone=function(){return this},e.prototype.equals=function(t){return t instanceof e},e.prototype.hashCode=function(){return 2996637180},e}(B);B.Identity=new q,w.IdentitySelector=q;var G=function(t){function e(e,i){void 0===i&&(i=B.Identity);var r=t.call(this)||this;return r._item=e.commit(),r.then=i,r}return u(e,t),e.prototype.forSelected=function(t,e,i){var r;if(!t.isEmpty()){var o=this._item.evaluate(t);o.isDefined()&&(t.push(o),r=this.then.forSelected(t,e,i),t.pop())}return r},e.prototype.mapSelected=function(t,e,i){if(!t.isEmpty()){var r=this._item.substitute(t);return r.isDefined()&&(t.push(r),r=this.then.mapSelected(t,e,i),t.pop()),t.item()}return w.Absent},e.prototype.substitute=function(t){t=D.fromAny(t);var i=this._item.substitute(t),r=this.then.substitute(t);return r instanceof B||(r=this.then),new e(i,r)},e.prototype.andThen=function(t){return new e(this._item,this.then.andThen(t))},Object.defineProperty(e.prototype,"precedence",{get:function(){return this._item.precedence},enumerable:!0,configurable:!0}),e.prototype.writeRecon=function(t){this._item.precedence<this.then.precedence?(t.push(40),this._item.writeRecon(t),t.push(41)):this._item.writeRecon(t),this.then.writeThen(t)},e.prototype.writeThen=function(t){},e.prototype.clone=function(){return new e(this._item.clone(),this.then.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._item.equals(t._item)&&this.then.equals(t.then))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(2538907887,this._item.hashCode()),this.then.hashCode()))},e}(B);w.LiteralSelector=G;var H=function(t){function e(e,i,r){void 0===i&&(i=!1),void 0===r&&(r=B.Identity);var o=t.call(this)||this;return o._key=e.commit(),o._top=i,o.then=r,o}return u(e,t),e.prototype.forSelected=function(t,e,i){for(var r=this._key.evaluate(t).toValue(),o=t.size-1;o>=0;o-=1){var n=t.getItem(o).toValue();if(n instanceof w.Record){var s=n.get(r);if(s.isDefined()){t.push(s);var a=this.then.forSelected(t,e,i);return t.pop(),a}}}},e.prototype.mapSelected=function(t,e,i){var r=this._key.substitute(t).toValue();if(!t.isEmpty()){var o=t.item().toValue();if(o instanceof w.Record){var n=o.get(r);t.push(n);var s=this.then.mapSelected(t,e,i);t.pop(),s.isDefined()?o.set(this._key,s.toValue()):o.delete(this._key)}return t.item()}return w.Absent},e.prototype.substitute=function(t){t=D.fromAny(t);for(var i=this._key.evaluate(t).toValue(),r=t.size-1;r>=0;r-=1){var o=t.getItem(r).toValue();if(o instanceof w.Record){var n=o.get(i);if(n.isDefined())return n.substitute(t)}}var s=this.then.substitute(t);return s instanceof B||(s=this.then),new e(this._key,this._top,s)},e.prototype.andThen=function(t){return new e(this._key,this._top,this.then.andThen(t))},e.prototype.writeRecon=function(t){t.push(36),this._key instanceof w.Record?(t.push(123),this._key.writeReconBlock(t),t.push(125)):this._key.writeRecon(t),this.then.writeThen(t)},e.prototype.writeThen=function(t){t.push(46),this._key instanceof w.Record?(t.push(123),this._key.writeReconBlock(t),t.push(125)):this._key.writeRecon(t),this.then.writeThen(t)},e.prototype.clone=function(){return new e(this._key.clone(),this._top,this.then.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._key.equals(t._key)&&this._top===t._top&&this.then.equals(t.then))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(n.mix(3761108264,this._key.hashCode()),this._top?1:0),this.then.hashCode()))},e}(B);w.GetSelector=H;var N=function(t){function e(e,i,r){void 0===i&&(i=!1),void 0===r&&(r=B.Identity);var o=t.call(this)||this;return o._key=e.commit(),o._top=i,o.then=r,o}return u(e,t),e.prototype.forSelected=function(t,e,i){for(var r=t.size-1;r>=0;r-=1){var o=t.getItem(r).toValue();if(o instanceof w.Record){var n=o.getAttr(this._key);if(n.isDefined()){t.push(n);var s=this.then.forSelected(t,e,i);return t.pop(),s}}}},e.prototype.mapSelected=function(t,e,i){if(!t.isEmpty()){var r=t.item().toValue();if(r instanceof w.Record){var o=r.getAttr(this._key);t.push(o);var n=this.then.mapSelected(t,e,i);t.pop(),n.isDefined()?r.setAttr(this._key,n.toValue()):r.delete(this._key)}return t.item()}return w.Absent},e.prototype.substitute=function(t){t=D.fromAny(t);var i=this._key.substitute(t).toValue();i instanceof I||(i=this._key);var r=this.then.substitute(t);return r instanceof B||(r=this.then),new e(i,this._top,r)},e.prototype.andThen=function(t){return new e(this._key,this._top,this.then.andThen(t))},e.prototype.writeRecon=function(t){t.push(36),t.push(64),this._key.writeRecon(t),this.then.writeThen(t)},e.prototype.writeThen=function(t){t.push(46),t.push(64),this._key.writeRecon(t),this.then.writeThen(t)},e.prototype.clone=function(){return new e(this._key.clone(),this._top,this.then.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._key.equals(t._key)&&this._top===t._top&&this.then.equals(t.then))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(n.mix(1576701278,this._key.hashCode()),this._top?1:0),this.then.hashCode()))},e}(B);w.GetAttrSelector=N;var j=function(t){function e(e,i){void 0===i&&(i=B.Identity);var r=t.call(this)||this;return r._index=e,r.then=i,r}return u(e,t),e.prototype.forSelected=function(t,e,i){if(!t.isEmpty()){var r=t.item().toValue(),o=this._index.numberValue();if(r instanceof w.Record&&o<r.length){var n=r.getItem(o);t.push(n);var s=this.then.forSelected(t,e,i);return t.pop(),s}}},e.prototype.mapSelected=function(t,e,i){if(!t.isEmpty()){var r=t.item().toValue(),o=this._index.numberValue();if(r instanceof w.Record&&o<r.length){var n=r.getItem(o);t.push(n);var s=this.then.mapSelected(t,e,i);t.pop(),s.isDefined()?r.setItem(o,s):r.splice(o,1)}return t.item()}return w.Absent},e.prototype.substitute=function(t){t=D.fromAny(t);var i=this.then.substitute(t);return i instanceof B||(i=this.then),new e(this._index,i)},e.prototype.andThen=function(t){return new e(this._index,this.then.andThen(t))},e.prototype.writeRecon=function(t){t.push(36),this.writeThen(t)},e.prototype.writeThen=function(t){t.push(35),this._index.writeRecon(t),this.then.writeThen(t)},e.prototype.clone=function(){return new e(this._index,this.then.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this._index.equals(t._index)&&this.then.equals(t.then))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(2148128349,this._index.hashCode()),this.then.hashCode()))},e}(B);w.GetItemSelector=j;var Y=function(t){function e(e){void 0===e&&(e=B.Identity);var i=t.call(this)||this;return i.then=e,i}return u(e,t),e.prototype.forSelected=function(t,e,i){var r;if(!t.isEmpty()){var o=t.pop();o instanceof w.Field?(t.push(o.key),r=this.then.forSelected(t,e,i),t.pop()):o instanceof w.Record&&(r=o.forEach(function(r){var o;return r instanceof w.Field&&(t.push(r.key),o=this.then.forSelected(t,e,i),t.pop()),o},this)),t.push(o)}return r},e.prototype.mapSelected=function(t,e,i){if(!t.isEmpty()){var r=t.pop();if(r instanceof w.Field){var o=r.key;t.push(o);var n=this.then.mapSelected(t,e,i);t.pop(),n.isDefined()&&n instanceof w.Value?n!==o&&(r=r instanceof w.Attr&&n instanceof w.Text?w.Attr.of(n,r.value):w.Slot.of(n,r.value)):r=w.Absent}else if(r instanceof w.Record)for(var s=r.iterator();s.hasNext();){var a=s.next().value;if(a instanceof w.Field){o=a.key;t.push(o);n=this.then.mapSelected(t,e,i);t.pop(),n.isDefined()&&n instanceof w.Value?n!==o&&(a instanceof w.Attr&&n instanceof w.Text?s.set(w.Attr.of(n,a.value)):s.set(w.Slot.of(n,a.value))):s.delete()}}return t.push(r),r}return w.Absent},e.prototype.substitute=function(t){t=D.fromAny(t);var i=this.then.substitute(t);return i instanceof B||(i=this.then),new e(i)},e.prototype.andThen=function(t){return new e(this.then.andThen(t))},e.prototype.writeRecon=function(t){t.push(36),t.push(42),t.push(58),this.then.writeThen(t)},e.prototype.writeThen=function(t){t.push(46),t.push(42),t.push(58),this.then.writeThen(t)},e.prototype.clone=function(){return new e(this.then.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&this.then.equals(t.then)},e.prototype.hashCode=function(){return n.mash(n.mix(2698220346,this.then.hashCode()))},e}(B);B.Keys=new Y,w.KeysSelector=Y;var X=function(t){function e(e){void 0===e&&(e=B.Identity);var i=t.call(this)||this;return i.then=e,i}return u(e,t),e.prototype.forSelected=function(t,e,i){var r;if(!t.isEmpty()){var o=t.pop();o.toValue()instanceof w.Record&&(r=o.toValue().forEach(function(r){t.push(r);var o=this.then.forSelected(t,e,i);return t.pop(),o},this)),t.push(o)}return r},e.prototype.mapSelected=function(t,e,i){if(!t.isEmpty()){var r=t.pop();if(r.toValue()instanceof w.Record)for(var o=r.toValue().iterator();o.hasNext();){var n=o.next().value;t.push(n);var s=this.then.mapSelected(t,e,i);t.pop(),s.isDefined()?s!==n&&o.set(s):o.delete()}return t.push(r),r}return w.Absent},e.prototype.substitute=function(t){t=D.fromAny(t);var i=this.then.substitute(t);return i instanceof B||(i=this.then),new e(i)},e.prototype.andThen=function(t){return new e(this.then.andThen(t))},e.prototype.writeRecon=function(t){t.push(36),t.push(42),this.then.writeThen(t)},e.prototype.writeThen=function(t){t.push(46),t.push(42),this.then.writeThen(t)},e.prototype.clone=function(){return new e(this.then.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&this.then.equals(t.then)},e.prototype.hashCode=function(){return n.mash(n.mix(41095964,this.then.hashCode()))},e}(B);B.Children=new X,w.ChildrenSelector=X;var K=function(t){function e(e){void 0===e&&(e=B.Identity);var i=t.call(this)||this;return i.then=e,i}return u(e,t),e.prototype.forSelected=function(t,e,i){var r;if(!t.isEmpty()){var o=t.pop();o.toValue()instanceof w.Record&&(r=o.toValue().forEach(function(r){t.push(r);var o=this.then.forSelected(t,e,i);return void 0===o&&this.forSelected(t,e,i),t.pop(),o},this)),t.push(o)}return r},e.prototype.mapSelected=function(t,e,i){if(!t.isEmpty()){var r=t.pop();if(r.toValue()instanceof w.Record)for(var o=r.toValue().iterator();o.hasNext();){var n=o.next().value;t.push(n);var s=this.then.mapSelected(t,e,i);s.isDefined()&&(s=this.mapSelected(t,e,i)),t.pop(),s.isDefined()?s!==n&&o.set(s):o.delete()}return t.push(r),r}return w.Absent},e.prototype.substitute=function(t){t=D.fromAny(t);var i=this.then.substitute(t);return i instanceof B||(i=this.then),new e(i)},e.prototype.andThen=function(t){return new e(this.then.andThen(t))},e.prototype.writeRecon=function(t){t.push(36),t.push(42),t.push(42),this.then.writeThen(t)},e.prototype.writeThen=function(t){t.push(46),t.push(42),t.push(42),this.then.writeThen(t)},e.prototype.clone=function(){return new e(this.then.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&this.then.equals(t.then)},e.prototype.hashCode=function(){return n.mash(n.mix(693096588,this.then.hashCode()))},e}(B);B.Descendants=new K,w.DescendantsSelector=K;var Q=function(t){function e(e,i){void 0===i&&(i=B.Identity);var r=t.call(this)||this;return r.predicate=e,r.then=i,r}return u(e,t),e.prototype.forSelected=function(t,e,i){var r;return t.isEmpty()||this.filterSelected(t)&&(r=this.then.forSelected(t,e,i)),r},e.prototype.mapSelected=function(t,e,i){return t.isEmpty()?w.Absent:this.filterSelected(t)?this.then.mapSelected(t,e,i):t.item()},e.prototype.filterSelected=function(t){return void 0!==this.predicate.forSelected(t,this.selected,this)},e.prototype.selected=function(t){return null},e.prototype.filter=function(t){return 0===arguments.length?this:(t=w.of(t),this.andThen(t.filter()))},e.prototype.substitute=function(t){t=D.fromAny(t);var i=this.predicate.substitute(t);i instanceof B||(i=this.predicate);var r=this.then.substitute(t);return r instanceof B||(r=this.then),new e(i,r)},e.prototype.andThen=function(t){return new e(this.predicate,this.then.andThen(t))},e.prototype.writeRecon=function(t){t.push(36),this.writeThen(t)},e.prototype.writeThen=function(t){t.push(91),this.predicate.writeRecon(t),t.push(93),this.then.writeThen(t)},e.prototype.clone=function(){return new e(this.predicate.clone(),this.then.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.predicate.equals(t.predicate)&&this.then.equals(t.then))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(982049112,this.predicate.hashCode()),this.then.hashCode()))},e}(B);w.FilterSelector=Q;var Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.partialInvoke=function(t,e,i){},e.prototype.toAny=function(){return this},e.prototype.writeRecon=function(t){},e.prototype.toRecon=function(){return""},e.prototype.toReconBlock=function(){return""},e.prototype.compare=function(t){if(t instanceof e){var i=this.name.localeCompare(t.name);return i<0?-1:i>0?1:0}return t instanceof w.Expr||t===b.Extant||t===b.Absent?-1:1},e.prototype.equals=function(t){return t instanceof e&&this.name===t.name},e.prototype.hashCode=function(){return n.mash(n.mix(3046025140,n.hash(this.name)))},e.prototype.toString=function(){return"[Func "+this.name+"]"},e.Eager=void 0,e.Abs=void 0,e.Ceil=void 0,e.Floor=void 0,e.Round=void 0,e.Pow=void 0,e.Sqrt=void 0,e.Max=void 0,e.Min=void 0,e.Count=void 0,e.Random=void 0,e.Rate=void 0,e.Percent=void 0,e.Number=void 0,e.String=void 0,e.ConsoleLog=void 0,e}(b);w.Func=Z;var J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"eager"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){return t.evaluate(e)},e.prototype.partialInvoke=function(t,e,i){return t.evaluate(e)},e}(Z);Z.Eager=new J;var $=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"abs"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){var i=(t=t.evaluate(e).toValue()).numberValue();return void 0!==i?w.Num.valueOf(Math.abs(i)):b.Absent},e}(Z);Z.Abs=new $;var tt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"ceil"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){var i=(t=t.evaluate(e).toValue()).numberValue();return void 0!==i?w.Num.valueOf(Math.ceil(i)):b.Absent},e}(Z);Z.Ceil=new tt;var et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"floor"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){var i=(t=t.evaluate(e).toValue()).numberValue();return void 0!==i?w.Num.valueOf(Math.floor(i)):b.Absent},e}(Z);Z.Floor=new et;var it=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"round"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){var i=(t=t.evaluate(e).toValue()).numberValue();return void 0!==i?w.Num.valueOf(Math.round(i)):b.Absent},e}(Z);Z.Round=new it;var rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"pow"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e,i){var r=t.getItem(0).evaluate(e).numberValue(),o=t.getItem(1).evaluate(e).numberValue();return void 0!==r&&void 0!==o?w.Num.valueOf(Math.pow(r,o)):b.Absent},e}(Z);Z.Pow=new rt;var ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"sqrt"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){var i=(t=t.evaluate(e).toValue()).numberValue();return void 0!==i?w.Num.valueOf(Math.sqrt(i)):b.Absent},e}(Z);Z.Sqrt=new ot;var nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"max"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e,i){var r,o;return t.length>=2?(r=t.getItem(0).evaluate(e).numberValue(),o=t.getItem(1).evaluate(e).numberValue()):r=t.evaluate(e).numberValue(),void 0!==r&&isFinite(r)&&(i.state=i.state||{},void 0===o&&(o=Math.max(r,i.state.nax||r),i.state.nax=o),void 0!==o&&isFinite(o))?w.Num.valueOf(Math.max(r,o)):b.Absent},e.prototype.partialInvoke=function(t,e,i){if(1===t.length)return t=t.evaluate(e).toValue(),this.invoke(t,e,i)},e}(Z);Z.Max=new nt;var st=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"min"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e,i){var r,o;return t.length>=2?(r=t.getItem(0).evaluate(e).numberValue(),o=t.getItem(1).evaluate(e).numberValue()):r=t.evaluate(e).numberValue(),void 0!==r&&isFinite(r)&&(i.state=i.state||{},void 0===o&&(o=Math.min(r,i.state.min||r),i.state.min=o),void 0!==o&&isFinite(o))?w.Num.valueOf(Math.min(r,o)):b.Absent},e.prototype.partialInvoke=function(t,e,i){if(1===t.length)return t=t.evaluate(e).toValue(),this.invoke(t,e,i)},e}(Z);Z.Min=new st;var at=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"count"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e,i){if(t instanceof B){var r=0;return t.forSelected(e,function(t){r+=1},this),w.Num.valueOf(r)}return t instanceof L?w.Num.valueOf(t.length):b.Absent},e}(Z);Z.Count=new at;var ut=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"percent"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e,i){var r,o;return t.length>=2?(r=t.getItem(0).evaluate(e).numberValue(),o=t.getItem(1).evaluate(e).numberValue()):r=t.evaluate(e).numberValue(),void 0!==r&&isFinite(r)&&(i.state=i.state||{},void 0===o&&(o=Math.max(r,i.state.total||r),i.state.total=o),0!==o&&isFinite(o))?w.Text.valueOf(Math.round(100*r/o)+"%"):b.Absent},e.prototype.partialInvoke=function(t,e,i){if(1===t.length)return t=t.evaluate(e).toValue(),this.invoke(t,e,i)},e}(Z);Z.Percent=new ut;var ht=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"random"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){var i=t.length>=1?t.getItem(0).evaluate(e).numberValue(0):0,r=t.length>=2?t.getItem(1).evaluate(e).numberValue(i+1):i+1,o=i+Math.random()*(r-i);return w.Num.valueOf(o)},e}(Z);Z.Random=new ht;var lt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"rate"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e,i){var r,o;if(t.length>=2?(r=t.getItem(0).evaluate(e).numberValue(),o=t.getItem(1).evaluate(e).numberValue()):r=t.evaluate(e).numberValue(),void 0!==r&&isFinite(r))if(i.state=i.state||{},void 0===o&&(o=1e3),void 0===i.state.t0)i.state.t0=Date.now(),i.state.v0=r;else{var n=Date.now(),s=n-i.state.t0;if(s>o&&n>i.state.t0||s>2*o){var a=r-i.state.v0;i.state.t0=n,i.state.v0=r,i.state.dt=s,i.state.dv=a}if(void 0!==i.state.dt){var u=o*i.state.dv/(i.state.dt||1);return w.Num.valueOf(u)}}return b.Absent},e.prototype.partialInvoke=function(t,e,i){return t=t.evaluate(e).toValue(),this.invoke(t,e,i)},e}(Z);Z.Rate=new lt;var pt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"number"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){if((t=t.evaluate(e).toValue())instanceof w.Num)return t;var i=t.numberValue();return void 0!==i?w.Num.valueOf(i):b.Absent},e}(Z);Z.Number=new pt;var ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"string"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){if((t=t.evaluate(e).toValue())instanceof w.Text)return t;var i=t.stringValue();return void 0!==i?w.Text.valueOf(i):b.Absent},e}(Z);Z.String=new ct;var dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"console.log"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){return t=t.evaluate(e).toValue(),console.log(t.toAny()),w.Absent},e}(Z);Z.ConsoleLog=new dt,w.GlobalScope=b.empty().slot("eager",Z.Eager).slot("abs",Z.Abs).slot("ceil",Z.Ceil).slot("floor",Z.Floor).slot("round",Z.Round).slot("pow",Z.Pow).slot("sqrt",Z.Sqrt).slot("max",Z.Max).slot("min",Z.Min).slot("count",Z.Count).slot("random",Z.Random).slot("rate",Z.Rate).slot("percent",Z.Percent).slot("number",Z.Number).slot("string",Z.String).slot("console",b.empty().slot("log",Z.ConsoleLog)).slot("log",Z.ConsoleLog).commit(),D.GlobalScope=w.GlobalScope;var ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.compare=function(t){return t instanceof e?0:t===b.Extant||t===b.Absent?-1:1},e.prototype.toString=function(){return this.toRecon()},e}(O);w.Expr=ft;var yt=function(t){function e(e,i){var r=t.call(this)||this;return r.lhs=e.commit(),r.rhs=i.commit(),r}return u(e,t),e.prototype.writeRecon=function(t){this.lhs.precedence<this.precedence?(t.push(40),this.lhs.writeRecon(t),t.push(41)):this.lhs.writeRecon(t),t.push(32),w.Text.writeIdent(this.operator,t),t.push(32),this.rhs.precedence<this.precedence?(t.push(40),this.rhs.writeRecon(t),t.push(41)):this.rhs.writeRecon(t)},e}(ft),mt=function(t){function e(e){var i=t.call(this)||this;return i.rhs=e.commit(),i}return u(e,t),e.prototype.writeRecon=function(t){w.Text.writeIdent(this.operator,t),this.rhs.precedence<this.precedence?(t.push(40),this.rhs.writeRecon(t),t.push(41)):this.rhs.writeRecon(t)},e}(ft),vt=function(t){function e(e,i,r){var o=t.call(this)||this;return o.predExpr=e.commit(),o.thenExpr=i.commit(),o.elseExpr=r.commit(),o}return u(e,t),Object.defineProperty(e.prototype,"precedence",{get:function(){return 1},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){return t=D.fromAny(t),this.predExpr.evaluate(t).isDefined()?this.thenExpr.evaluate(t):this.elseExpr.evaluate(t)},e.prototype.substitute=function(t){return t=D.fromAny(t),new e(this.predExpr.substitute(t).toValue(),this.thenExpr.substitute(t).toValue(),this.elseExpr.substitute(t).toValue())},e.prototype.writeRecon=function(t){this.predExpr instanceof e?(t.push(40),this.predExpr.writeRecon(t),t.push(41)):this.predExpr.writeRecon(t),t.push(32),t.push(63),t.push(32),this.thenExpr.writeRecon(t),t.push(32),t.push(58),t.push(32),this.elseExpr.writeRecon(t)},e.prototype.clone=function(){return new e(this.predExpr.clone(),this.thenExpr.clone(),this.elseExpr.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.predExpr.equals(t.predExpr)&&this.thenExpr.equals(t.thenExpr)&&this.elseExpr.equals(t.elseExpr))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(n.mix(2686268657,this.predExpr.hashCode()),this.thenExpr.hashCode()),this.elseExpr.hashCode()))},e}(ft);w.CondExpr=vt;var gt=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"||"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 2},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this.lhs.evaluate(t);return e.isDefined()?e:this.rhs.evaluate(t)},e.prototype.substitute=function(t){t=D.fromAny(t);var e=this.lhs.substitute(t),i=this.rhs.substitute(t);return e.or(i)},e.prototype.clone=function(){return new e(this.lhs.clone(),this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lhs.equals(t.lhs)&&this.rhs.equals(t.rhs))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(2654137140,this.lhs.hashCode()),this.rhs.hashCode()))},e}(yt);w.OrExpr=gt;var wt=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"&&"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 3},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this.lhs.evaluate(t);return e.isDefined()?this.rhs.evaluate(t):e},e.prototype.substitute=function(t){t=D.fromAny(t);var e=this.lhs.substitute(t),i=this.rhs.substitute(t);return e.and(i)},e.prototype.clone=function(){return new e(this.lhs.clone(),this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lhs.equals(t.lhs)&&this.rhs.equals(t.rhs))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(33449114,this.lhs.hashCode()),this.rhs.hashCode()))},e}(yt);w.AndExpr=wt;var bt=function(t){function e(e){return t.call(this,e)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"!"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 6},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){return t=D.fromAny(t),this.rhs.evaluate(t).not()},e.prototype.substitute=function(t){return t=D.fromAny(t),this.rhs.substitute(t).not()},e.prototype.clone=function(){return new e(this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&this.rhs.equals(t.rhs)},e.prototype.hashCode=function(){return n.mash(n.mix(1547485870,this.rhs.hashCode()))},e}(mt);w.NotExpr=bt;var _t=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"<"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this.lhs.evaluate(t),i=this.rhs.evaluate(t);return e.lt(i)},e.prototype.substitute=function(t){t=D.fromAny(t);var e=this.lhs.substitute(t),i=this.rhs.substitute(t);return e.lt(i)},e.prototype.clone=function(){return new e(this.lhs.clone(),this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lhs.equals(t.lhs)&&this.rhs.equals(t.rhs))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(967086719,this.lhs.hashCode()),this.rhs.hashCode()))},e}(yt);w.LtExpr=_t;var xt=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"<="},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this.lhs.evaluate(t),i=this.rhs.evaluate(t);return e.le(i)},e.prototype.substitute=function(t){t=D.fromAny(t);var e=this.lhs.substitute(t),i=this.rhs.substitute(t);return e.le(i)},e.prototype.clone=function(){return new e(this.lhs.clone(),this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lhs.equals(t.lhs)&&this.rhs.equals(t.rhs))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(1658676620,this.lhs.hashCode()),this.rhs.hashCode()))},e}(yt);w.LeExpr=xt;var At=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"=="},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this.lhs.evaluate(t),i=this.rhs.evaluate(t);return e.eq(i)},e.prototype.substitute=function(t){t=D.fromAny(t);var e=this.lhs.substitute(t),i=this.rhs.substitute(t);return e.eq(i)},e.prototype.clone=function(){return new e(this.lhs.clone(),this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lhs.equals(t.lhs)&&this.rhs.equals(t.rhs))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(151025720,this.lhs.hashCode()),this.rhs.hashCode()))},e}(yt);w.EqExpr=At;var kt=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"!="},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this.lhs.evaluate(t),i=this.rhs.evaluate(t);return e.ne(i)},e.prototype.substitute=function(t){t=D.fromAny(t);var e=this.lhs.substitute(t),i=this.rhs.substitute(t);return e.ne(i)},e.prototype.clone=function(){return new e(this.lhs.clone(),this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lhs.equals(t.lhs)&&this.rhs.equals(t.rhs))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(3400743354,this.lhs.hashCode()),this.rhs.hashCode()))},e}(yt);w.NeExpr=kt;var Et=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return">="},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this.lhs.evaluate(t),i=this.rhs.evaluate(t);return e.ge(i)},e.prototype.substitute=function(t){t=D.fromAny(t);var e=this.lhs.substitute(t),i=this.rhs.substitute(t);return e.ge(i)},e.prototype.clone=function(){return new e(this.lhs.clone(),this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lhs.equals(t.lhs)&&this.rhs.equals(t.rhs))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(553703941,this.lhs.hashCode()),this.rhs.hashCode()))},e}(yt);w.GeExpr=Et;var Ct=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return">"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 0},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this.lhs.evaluate(t),i=this.rhs.evaluate(t);return e.gt(i)},e.prototype.substitute=function(t){t=D.fromAny(t);var e=this.lhs.substitute(t),i=this.rhs.substitute(t);return e.gt(i)},e.prototype.clone=function(){return new e(this.lhs.clone(),this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lhs.equals(t.lhs)&&this.rhs.equals(t.rhs))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(2388803765,this.lhs.hashCode()),this.rhs.hashCode()))},e}(yt);w.GtExpr=Ct;var St=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"+"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 4},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this.lhs.evaluate(t),i=this.rhs.evaluate(t);return e.plus(i)},e.prototype.substitute=function(t){t=D.fromAny(t);var e=this.lhs.substitute(t),i=this.rhs.substitute(t);return e.plus(i)},e.prototype.clone=function(){return new e(this.lhs.clone(),this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lhs.equals(t.lhs)&&this.rhs.equals(t.rhs))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(3143282824,this.lhs.hashCode()),this.rhs.hashCode()))},e}(yt);w.AddExpr=St;var Vt=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"-"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 4},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this.lhs.evaluate(t),i=this.rhs.evaluate(t);return e.minus(i)},e.prototype.substitute=function(t){t=D.fromAny(t);var e=this.lhs.substitute(t),i=this.rhs.substitute(t);return e.minus(i)},e.prototype.clone=function(){return new e(this.lhs.clone(),this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lhs.equals(t.lhs)&&this.rhs.equals(t.rhs))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(2002724678,this.lhs.hashCode()),this.rhs.hashCode()))},e}(yt);w.SubExpr=Vt;var Dt=function(t){function e(e){return t.call(this,e)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"-"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 6},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){return t=D.fromAny(t),this.rhs.evaluate(t).opposite()},e.prototype.substitute=function(t){return t=D.fromAny(t),this.rhs.substitute(t).opposite()},e.prototype.clone=function(){return new e(this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&this.rhs.equals(t.rhs)},e.prototype.hashCode=function(){return n.mash(n.mix(542257997,this.rhs.hashCode()))},e}(mt);w.NegExpr=Dt;var Mt=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"*"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 5},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this.lhs.evaluate(t),i=this.rhs.evaluate(t);return e.times(i)},e.prototype.substitute=function(t){t=D.fromAny(t);var e=this.lhs.substitute(t),i=this.rhs.substitute(t);return e.times(i)},e.prototype.clone=function(){return new e(this.lhs.clone(),this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lhs.equals(t.lhs)&&this.rhs.equals(t.rhs))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(3516846473,this.lhs.hashCode()),this.rhs.hashCode()))},e}(yt);w.MulExpr=Mt;var Rt=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"/"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 5},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this.lhs.evaluate(t),i=this.rhs.evaluate(t);return e.divide(i)},e.prototype.substitute=function(t){t=D.fromAny(t);var e=this.lhs.substitute(t),i=this.rhs.substitute(t);return e.divide(i)},e.prototype.clone=function(){return new e(this.lhs.clone(),this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lhs.equals(t.lhs)&&this.rhs.equals(t.rhs))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(588817478,this.lhs.hashCode()),this.rhs.hashCode()))},e}(yt);w.DivExpr=Rt;var Tt=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),Object.defineProperty(e.prototype,"operator",{get:function(){return"%"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"precedence",{get:function(){return 5},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this.lhs.evaluate(t),i=this.rhs.evaluate(t);return e.modulo(i)},e.prototype.substitute=function(t){t=D.fromAny(t);var e=this.lhs.substitute(t),i=this.rhs.substitute(t);return e.modulo(i)},e.prototype.clone=function(){return new e(this.lhs.clone(),this.rhs.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lhs.equals(t.lhs)&&this.rhs.equals(t.rhs))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(1939882810,this.lhs.hashCode()),this.rhs.hashCode()))},e}(yt);w.ModExpr=Tt;var Pt=function(t){function e(e,i){var r=t.call(this)||this;return r.func=e,r.args=i.commit(),r}return u(e,t),Object.defineProperty(e.prototype,"precedence",{get:function(){return 7},enumerable:!0,configurable:!0}),e.prototype.evaluate=function(t){t=D.fromAny(t);var e=this.func.evaluate(t);return e instanceof w.Func?e.invoke(this.args,t,this):b.Absent},e.prototype.substitute=function(t){t=D.fromAny(t);var i=this.func.evaluate(t);if(i instanceof w.Func){var r=i.partialInvoke(this.args,t,this);if(r)return r}var o=this.args.substitute(t).toValue();return new e(this.func,o)},e.prototype.writeRecon=function(t){this.func.writeRecon(t),t.push(40),this.args.writeReconBlock(t),t.push(41)},e.prototype.clone=function(){return new e(this.func.clone(),this.args.clone())},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.func.equals(t.func)&&this.args.equals(t.args))},e.prototype.hashCode=function(){return n.mash(n.mix(n.mix(2719252876,this.func.hashCode()),this.args.hashCode()))},e}(ft);w.InvokeExpr=Pt;var Lt=function(t){function e(){return t.call(this)||this}return u(e,t),e.prototype.isDistinct=function(){return!1},e.prototype.not=function(){return b.Absent},e.prototype.stringValue=function(){return""},e.prototype.booleanValue=function(){return!0},e.prototype.toAny=function(){return null},e.prototype.valueOf=function(){return null},e.prototype.writeRecon=function(t){},e.prototype.toRecon=function(){return""},e.prototype.toReconBlock=function(){return""},e.prototype.compare=function(t){return t instanceof e?0:t===b.Absent?-1:1},e.prototype.equals=function(t){return this===t},e.prototype.hashCode=function(){return 4137424647},e.prototype.toString=function(){return"extant"},e}(b);w.Extant=new Lt,b.Extant=w.Extant;var Ft=function(t){function e(){return t.call(this)||this}return u(e,t),e.prototype.isDefined=function(){return!1},e.prototype.isDistinct=function(){return!1},e.prototype.isEmpty=function(){return!0},e.prototype.concat=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=b.empty(),r=0,o=t.length;r<o;r+=1)t[r].forEach(function(t){i.push(t)});return i},e.prototype.withField=function(t,e){return b.empty(1).withField(t,e)},e.prototype.withAttr=function(t,e){return b.empty(1).withAttr(t,e)},e.prototype.withSlot=function(t,e){return b.empty(1).withSlot(t,e)},e.prototype.withItem=function(t){return b.empty(1).withItem(t)},e.prototype.forEach=function(t,e){},e.prototype.iterator=function(){return h.Empty},e.prototype.cond=function(t,e){return e=w.of(e)},e.prototype.or=function(t){return t=w.of(t)},e.prototype.and=function(t){return this},e.prototype.not=function(){return b.Extant},e.prototype.booleanValue=function(){return!1},e.prototype.toAny=function(){},e.prototype.valueOf=function(){},e.prototype.writeRecon=function(t){},e.prototype.toRecon=function(){return""},e.prototype.toReconBlock=function(){return""},e.prototype.compare=function(t){return t instanceof e?0:1},e.prototype.equals=function(t){return this===t},e.prototype.hashCode=function(){return 4156558542},e.prototype.toString=function(){return"absent"},e}(b);w.Absent=new Ft,b.Absent=w.Absent;var zt=function(){function t(t){this.buckets=new Array(t),this.gen4Hits=0,this.gen3Hits=0,this.gen2Hits=0,this.gen1Hits=0,this.misses=0}return t.prototype.get=function(t){if(0!==this.buckets.length){var e=Math.abs(t.hashCode())%this.buckets.length,i=this.buckets[e];if(i){var r=i.gen4Key;if(void 0!==r&&t.equals(r)){var o=i.gen4Val;if(void 0!==o)return this.gen4Hits+=1,i.gen4Weight++,o;i.gen4Key=void 0}var n=i.gen3Key;if(void 0!==n&&t.equals(n)){var s=i.gen3Val;if(void 0!==s)return this.gen3Hits+=1,i.gen3Weight++>i.gen4Weight&&(this.buckets[e]=new It(i.gen3Key,i.gen3Val,i.gen3Weight,i.gen4Key,i.gen4Val,i.gen4Weight,i.gen2Key,i.gen2Val,i.gen2Weight,i.gen1Key,i.gen1Val,i.gen1Weight)),s;i.gen3Key=void 0}var a=i.gen2Key;if(void 0!==a&&t.equals(a)){var u=i.gen2Val;if(void 0!==u)return this.gen2Hits+=1,i.gen2Weight++>i.gen3Weight&&(this.buckets[e]=new It(i.gen4Key,i.gen4Val,i.gen4Weight,i.gen2Key,i.gen2Val,i.gen2Weight,i.gen3Key,i.gen3Val,i.gen3Weight,i.gen1Key,i.gen1Val,i.gen1Weight)),u;i.gen2Key=void 0}var h=i.gen1Key;if(void 0!==h&&t.equals(h)){var l=i.gen1Val;if(void 0!==l)return this.gen1Hits+=1,i.gen1Weight++>i.gen2Weight&&(this.buckets[e]=new It(i.gen4Key,i.gen4Val,i.gen4Weight,i.gen3Key,i.gen3Val,i.gen3Weight,i.gen1Key,i.gen1Val,i.gen1Weight,i.gen2Key,i.gen2Val,i.gen2Weight)),l;i.gen1Key=void 0}this.misses+=1}}},t.prototype.set=function(t,e){if(0!==this.buckets.length){var i=Math.abs(t.hashCode())%this.buckets.length,r=this.buckets[i]||new It,o=r.gen4Key;if(void 0!==o&&t.equals(o)){var n=r.gen4Val;if(void 0!==n)return this.gen4Hits+=1,r.gen4Weight++,n;r.gen4Key=void 0,o=void 0}var s=r.gen3Key;if(void 0!==s&&t.equals(s)){var a=r.gen3Val;if(void 0!==a)return this.gen3Hits+=1,r.gen3Weight++>r.gen4Weight&&(this.buckets[i]=new It(r.gen3Key,r.gen3Val,r.gen3Weight,r.gen4Key,r.gen4Val,r.gen4Weight,r.gen2Key,r.gen2Val,r.gen2Weight,r.gen1Key,r.gen1Val,r.gen1Weight)),a;r.gen3Key=void 0,s=void 0}var u=r.gen2Key;if(void 0!==u&&t.equals(u)){var h=r.gen2Val;if(void 0!==h)return this.gen2Hits+=1,r.gen2Weight++>r.gen3Weight&&(this.buckets[i]=new It(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen2Key,r.gen2Val,r.gen2Weight,r.gen3Key,r.gen3Val,r.gen3Weight,r.gen1Key,r.gen1Val,r.gen1Weight)),h;r.gen2Key=void 0,u=void 0}var l=r.gen1Key;if(void 0!==l&&t.equals(l)){var p=r.gen1Val;if(void 0!==p)return this.gen1Hits+=1,r.gen1Weight++>r.gen2Weight&&(this.buckets[i]=new It(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen3Key,r.gen3Val,r.gen3Weight,r.gen1Key,r.gen1Val,r.gen1Weight,r.gen2Key,r.gen2Val,r.gen2Weight)),p;r.gen1Key=void 0,l=void 0}this.misses+=1,this.buckets[i]=null==o?new It(r.gen3Key,r.gen3Val,r.gen3Weight,r.gen2Key,r.gen2Val,r.gen2Weight,r.gen1Key,r.gen1Val,r.gen1Weight,t,e,1):null==s?new It(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen2Key,r.gen2Val,r.gen2Weight,r.gen1Key,r.gen1Val,r.gen1Weight,t,e,1):null==u?new It(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen3Key,r.gen3Val,r.gen3Weight,r.gen1Key,r.gen1Val,r.gen1Weight,t,e,1):null==l?new It(r.gen4Key,r.gen4Val,r.gen4Weight,r.gen3Key,r.gen3Val,r.gen3Weight,r.gen2Key,r.gen2Val,r.gen2Weight,t,e,1):new It(r.gen4Key,r.gen4Val,r.gen4Weight-1,r.gen3Key,r.gen3Val,r.gen3Weight-1,r.gen1Key,r.gen1Val,r.gen1Weight,t,e,1)}},t.prototype.delete=function(t){if(0!==this.buckets.length){var e=Math.abs(t.hashCode())%this.buckets.length,i=this.buckets[e];if(i){var r=i.gen4Key;if(void 0!==r&&t.equals(r)){var o=i.gen4Val;return this.buckets[e]=new It(i.gen3Key,i.gen3Val,i.gen3Weight,i.gen2Key,i.gen2Val,i.gen2Weight,i.gen1Key,i.gen1Val,i.gen1Weight,void 0,void 0,0),o}var n=i.gen3Key;if(void 0!==n&&t.equals(n)){var s=i.gen3Val;return this.buckets[e]=new It(i.gen4Key,i.gen4Val,i.gen4Weight,i.gen2Key,i.gen2Val,i.gen2Weight,i.gen1Key,i.gen1Val,i.gen1Weight,void 0,void 0,0),s}var a=i.gen2Key;if(void 0!==a&&t.equals(a)){var u=i.gen2Val;return this.buckets[e]=new It(i.gen4Key,i.gen4Val,i.gen4Weight,i.gen3Key,i.gen3Val,i.gen3Weight,i.gen1Key,i.gen1Val,i.gen1Weight,void 0,void 0,0),u}var h=i.gen1Key;if(void 0!==h&&t.equals(h)){var l=i.gen1Val;return this.buckets[e]=new It(i.gen4Key,i.gen4Val,i.gen4Weight,i.gen3Key,i.gen3Val,i.gen3Weight,i.gen2Key,i.gen2Val,i.gen2Weight,void 0,void 0,0),l}}}},t.prototype.clear=function(){for(var t=0;t<this.buckets.length;t+=1)this.buckets[t]=void 0},Object.defineProperty(t.prototype,"hits",{get:function(){return this.gen4Hits+this.gen3Hits+this.gen2Hits+this.gen1Hits},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hitRatio",{get:function(){var t=this.hits;return t/(t+this.misses)},enumerable:!0,configurable:!0}),t.prototype.toString=function(){for(var t=this.hits,e="@cache(gen4Hits: "+this.gen4Hits+", gen3Hits: "+this.gen3Hits+", gen2Hits: "+this.gen2Hits+", gen1Hits: "+this.gen1Hits+", hits: "+t+", misses: "+this.misses+", hitRatio: "+t/(t+this.misses)+") {\n",i=0;i<this.buckets.length;i+=1){var r=this.buckets[i];e+="  "+(null!=r?r.toString():"null")+"\n"}return e+="}"},t}(),It=function(){function t(t,e,i,r,o,n,s,a,u,h,l,p){void 0===i&&(i=0),void 0===n&&(n=0),void 0===u&&(u=0),void 0===p&&(p=0),this.gen4Key=t,this.gen4Val=e,this.gen4Weight=i,this.gen3Key=r,this.gen3Val=o,this.gen3Weight=n,this.gen2Key=s,this.gen2Val=a,this.gen2Weight=u,this.gen1Key=h,this.gen1Val=l,this.gen1Weight=p}return t.prototype.toString=function(){return"@bucket(gen4Key: "+this.gen4Key+"; gen4Val: "+this.gen4Val+"; gen4Weight: "+this.gen4Weight+"; gen3Key: "+this.gen3Key+"; gen3Val: "+this.gen3Val+"; gen3Weight: "+this.gen3Weight+"; gen24Key: "+this.gen2Key+"; gen24Val: "+this.gen2Val+"; gen24Weight: "+this.gen2Weight+"; gen1Key: "+this.gen1Key+"; gen1Val: "+this.gen1Val+"; gen1Weight: "+this.gen1Weight+")"},t}(),Ut=function(t){function e(e,i,r,o,n,s){var a=t.call(this)||this;return a.schemeParser=e,a.authorityParser=i,a.pathParser=r,a.queryParser=o,a.fragmentParser=n,a.step=s,a}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.schemeParser,this.authorityParser,this.pathParser,this.queryParser,this.fragmentParser,this.step)},e.parse=function(t,i,r,o,n,s,a){void 0===a&&(a=1);var u=0;if(1===a)if(t.isEmpty())t.isDone()&&(a=3);else{for(var h=t.clone();!h.isEmpty()&&(u=h.head(),Kt.isSchemeChar(u));)h.step();a=h.isEmpty()||58!==u?3:2}if(2===a){for(i||(i=Wt.parse(t));i.isCont()&&(!t.isEmpty()||t.isDone());)i=i.feed(t);if(i.isDone())if(t.isEmpty()||58!==t.head()){if(!t.isEmpty())return _.expected("':'",t);if(t.isDone())return _.unexpected(t)}else t.step(),a=3;else if(i.isError())return i.asError()}if(3===a)if(t.isEmpty()){if(t.isDone())return _.done(Kt.of(i&&i.bind()))}else 47===(u=t.head())?(t.step(),a=4):63===u?(t.step(),a=7):35===u?(t.step(),a=8):a=6;if(4===a)if(t.isEmpty()||47!==t.head())if(t.isEmpty()){if(t.isDone())return _.done(Kt.of(i&&i.bind(),void 0,ne.Slash))}else{var l=new he;l.push("/"),o=jt.parse(t,l),a=6}else t.step(),a=5;if(5===a){for(r||(r=Ot.parse(t));r.isCont()&&(!t.isEmpty()||t.isDone());)r=r.feed(t);if(r.isDone())if(t.isEmpty()){if(t.isDone())return _.done(Kt.of(i&&i.bind(),r&&r.bind()))}else 63===(u=t.head())?(t.step(),a=7):35===u?(t.step(),a=8):a=6;else if(r.isError())return r.asError()}if(6===a){for(o||(o=jt.parse(t));o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())if(t.isEmpty()||63!==t.head())if(t.isEmpty()||35!==t.head()){if(!t.isEmpty()||t.isDone())return _.done(Kt.of(i&&i.bind(),r&&r.bind(),o.bind()))}else t.step(),a=8;else t.step(),a=7;else if(o.isError())return o.asError()}if(7===a){for(n||(n=Yt.parse(t));n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())if(t.isEmpty()||35!==t.head()){if(!t.isEmpty()||t.isDone())return _.done(Kt.of(i&&i.bind(),r&&r.bind(),o&&o.bind(),n.bind()))}else t.step(),a=8;else if(n.isError())return n.asError()}if(8===a){for(s||(s=Xt.parse(t));s.isCont()&&(!t.isEmpty()||t.isDone());)s=s.feed(t);if(s.isDone())return _.done(Kt.of(i&&i.bind(),r&&r.bind(),o&&o.bind(),n&&n.bind(),s.bind()));if(s.isError())return s.asError()}return new e(i,r,o,n,s,a)},e}(_),Wt=function(t){function e(e,i){var r=t.call(this)||this;return r.output=e,r.step=i,r}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.output,this.step)},e.parse=function(t,i,r){void 0===r&&(r=1);var o=0;if(1===r)if(!t.isEmpty()&&(o=t.head(),_.isAlpha(o)))t.step(),(i=i||new g).push(_.toLowerCase(o)),r=2;else if(!t.isEmpty()||t.isDone())return _.expected("scheme",t);if(2===r){for(;!t.isEmpty()&&(o=t.head(),Kt.isSchemeChar(o));)t.step(),i.push(_.toLowerCase(o));if(!t.isEmpty()||t.isDone())return _.done(Qt.of(i.bind()))}return new e(i,r)},e}(_),Ot=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.userParser=e,n.hostParser=i,n.portParser=r,n.step=o,n}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.userParser,this.hostParser,this.portParser,this.step)},e.parse=function(t,i,r,o,n){void 0===n&&(n=1);var s=0;if(1===n)if(t.isEmpty())t.isDone()&&(n=3);else{for(var a=t.clone();!a.isEmpty()&&(64!==(s=a.head())&&47!==s);)a.step();n=a.isEmpty()||64!==s?3:2}if(2===n){for(i||(i=Bt.parse(t));i.isCont()&&(!t.isEmpty()||t.isDone());)i=i.feed(t);if(i.isDone())if(t.isEmpty()||64!==t.head()){if(!t.isEmpty())return _.expected(64,t);if(t.isDone())return _.unexpected(t)}else t.step(),n=3;else if(i.isError())return i.asError()}if(3===n){for(r||(r=qt.parse(t));r.isCont()&&(!t.isEmpty()||t.isDone());)r=r.feed(t);if(r.isDone())if(t.isEmpty()||58!==t.head()){if(!t.isEmpty()||t.isDone())return _.done(Zt.of(i&&i.bind(),r.bind()))}else t.step(),n=4;else if(r.isError())return r.asError()}if(4===n){for(o||(o=Nt.parse(t));o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isError())return o.asError();if(!t.isEmpty()||t.isDone())return _.done(Zt.of(i&&i.bind(),r.bind(),o.bind()))}return new e(i,r,o,n)},e}(_),Bt=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.usernameOutput=e,n.passwordOutput=i,n.c1=r,n.step=o,n}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.usernameOutput,this.passwordOutput,this.c1,this.step)},e.parse=function(t,i,r,o,n){void 0===o&&(o=0),void 0===n&&(n=1);for(var s=0;!t.isEmpty()||t.isDone();){if(1===n){for(i||(i=new g);!t.isEmpty()&&(s=t.head(),Kt.isUserChar(s));)t.step(),i.push(s);if(t.isEmpty()||58!==s)if(t.isEmpty()||37!==s){if(!t.isEmpty()||t.isDone())return _.done(Jt.of(i.bind()))}else t.step(),n=2;else t.step(),n=4}if(2===n)if(!t.isEmpty()&&(s=t.head(),_.isHexChar(s)))t.step(),o=s,n=3;else{if(!t.isEmpty())return _.expected("hex digit",t);if(t.isDone())return _.unexpected(t)}if(3===n)if(!t.isEmpty()&&(s=t.head(),_.isHexChar(s)))t.step(),i.push((_.decodeHexChar(o)<<4)+_.decodeHexChar(s)),o=0,n=1;else{if(!t.isEmpty())return _.expected("hex digit",t);if(t.isDone())return _.unexpected(t)}if(4===n){for(r=r||new g;!t.isEmpty()&&(s=t.head(),Kt.isUserInfoChar(s));)t.step(),r.push(s);if(t.isEmpty()||37!==s){if(!t.isEmpty()||t.isDone())return _.done(Jt.of(i.bind(),r.bind()))}else t.step(),n=5}if(5===n)if(!t.isEmpty()&&(s=t.head(),_.isHexChar(s)))t.step(),o=s,n=6;else{if(!t.isEmpty())return _.expected("hex digit",t);if(t.isDone())return _.unexpected(t)}if(6===n)if(!t.isEmpty()&&(s=t.head(),_.isHexChar(s)))t.step(),r.push((_.decodeHexChar(o)<<4)+_.decodeHexChar(s)),o=0,n=4;else{if(!t.isEmpty())return _.expected("hex digit",t);if(t.isDone())return _.unexpected(t)}}return new e(i,r,o,n)},e}(_),qt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.feed=function(t){return e.parse(t)},e.parse=function(t){return t.isEmpty()?t.isDone()?_.done(te.of("")):new e:91===t.head()?Ht.parse(t):Gt.parse(t)},e}(_),Gt=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.output=e,n.c1=i,n.x=r,n.step=o,n}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.output,this.c1,this.x,this.step)},e.parse=function(t,i,r,o,n){void 0===r&&(r=0),void 0===o&&(o=0),void 0===n&&(n=1);for(var s=0;n<=4&&(!t.isEmpty()||t.isDone());){for(i=i||new g;!t.isEmpty()&&(s=t.head(),_.isDigit(s));)t.step(),i.push(s),o=10*o+_.decodeDigit(s);if(t.isEmpty()){if(t.isDone())return 4===n&&o<=255?_.done(ee.of(i.bind())):_.done(te.of(i.bind()))}else if(46===s&&n<4&&o<=255)t.step(),i.push(s),o=0,n+=1;else{if(!Kt.isHostChar(s)&&37!==s&&4===n&&o<=255)return _.done(ee.of(i.bind()));o=0,n=5}}for(;!t.isEmpty()||t.isDone();){if(i=i,5===n){for(;!t.isEmpty()&&(s=t.head(),Kt.isHostChar(s));)t.step(),i.push(_.toLowerCase(s));if(t.isEmpty()||37!==s){if(!t.isEmpty()||t.isDone())return _.done(te.of(i.bind()))}else t.step(),n=6}if(6===n)if(!t.isEmpty()&&(s=t.head(),_.isHexChar(s)))t.step(),r=s,n=7;else{if(!t.isEmpty())return _.expected("hex digit",t);if(t.isDone())return _.unexpected(t)}if(7===n)if(!t.isEmpty()&&(s=t.head(),_.isHexChar(s)))t.step(),i.push((_.decodeHexChar(r)<<4)+_.decodeHexChar(s)),r=0,n=5;else{if(!t.isEmpty())return _.expected("hex digit",t);if(t.isDone())return _.unexpected(t)}}return new e(i,r,o,n)},e}(_),Ht=function(t){function e(e,i){var r=t.call(this)||this;return r.output=e,r.step=i,r}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.output,this.step)},e.parse=function(t,i,r){void 0===r&&(r=1);var o=0;if(1===r)if(t.isEmpty()||91!==(o=t.head())){if(!t.isEmpty())return _.expected("'['",t);if(t.isDone())return _.unexpected(t)}else t.step(),r=2;if(2===r){for(i=i||new g;!t.isEmpty()&&(o=t.head(),Kt.isHostChar(o)||58===o);)t.step(),i.push(_.toLowerCase(o));if(!t.isEmpty()&&93===o)return t.step(),_.done(ie.of(i.bind()));if(!t.isEmpty()||t.isDone())return _.unexpected(t)}return new e(i,r)},e}(_),Nt=function(t){function e(e){var i=t.call(this)||this;return i.port=e,i}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.port)},e.parse=function(t,i){void 0===i&&(i=0);for(var r=0;!t.isEmpty()&&(r=t.head(),_.isDigit(r));)t.step(),i=10*i+_.decodeDigit(r);return!t.isEmpty()||t.isDone()?_.done(oe.of(i)):new e(i)},e}(_),jt=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.builder=e,n.output=i,n.c1=r,n.step=o,n}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.builder,this.output,this.c1,this.step)},e.parse=function(t,i,r,o,n){void 0===o&&(o=0),void 0===n&&(n=1);for(var s=0;!t.isEmpty()||t.isDone();){if(1===n){for(;!t.isEmpty()&&(s=t.head(),Kt.isPathChar(s));)r=r||new g,t.step(),r.push(s);if(t.isEmpty()||47!==s)if(t.isEmpty()||37!==s){if(!t.isEmpty()||t.isDone())return i=i||new he,r&&i.push(r.bind()),_.done(i.bind())}else t.step(),n=2;else t.step(),i=i||new he,r&&(i.push(r.bind()),r=void 0),i.push("/")}if(2===n)if(!t.isEmpty()&&(s=t.head(),_.isHexChar(s)))t.step(),o=s,n=3;else{if(!t.isEmpty())return _.expected("hex digit",t);if(t.isDone())return _.unexpected(t)}if(3===n)if(!t.isEmpty()&&(s=t.head(),_.isHexChar(s)))r=r||new g,t.step(),r.push((_.decodeHexChar(o)<<4)+_.decodeHexChar(s)),o=0,n=1;else{if(!t.isEmpty())return _.expected("hex digit",t);if(t.isDone())return _.unexpected(t)}}return new e(i,r,o,n)},e}(_),Yt=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.keyOutput=e,s.valueOutput=i,s.builder=r,s.c1=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.keyOutput,this.valueOutput,this.builder,this.c1,this.step)},e.parse=function(t,i,r,o,n,s){void 0===n&&(n=0),void 0===s&&(s=1);for(var a=0;!t.isEmpty()||t.isDone();){if(1===s){for(i=i||new g;!t.isEmpty()&&(a=t.head(),Kt.isParamChar(a));)t.step(),i.push(a);if(t.isEmpty()||61!==a)if(t.isEmpty()||38!==a)if(t.isEmpty()||37!==a){if(!t.isEmpty()||t.isDone())return(o=o||new de).param(null,i.bind()),_.done(o.bind())}else t.step(),s=2;else t.step(),(o=o||new de).param(null,i.bind()),i=void 0,s=1;else t.step(),s=4}if(2===s)if(!t.isEmpty()&&(a=t.head(),_.isHexChar(a)))t.step(),n=a,s=3;else{if(!t.isEmpty())return _.expected("hex digit",t);if(t.isDone())return _.unexpected(t)}if(3===s)if(!t.isEmpty()&&(a=t.head(),_.isHexChar(a)))t.step(),i.push((_.decodeHexChar(n)<<4)+_.decodeHexChar(a)),n=0,s=1;else{if(!t.isEmpty())return _.expected("hex digit",t);if(t.isDone())return _.unexpected(t)}if(4===s){for(r=r||new g;!t.isEmpty()&&(a=t.head(),Kt.isParamChar(a)||61===a);)t.step(),r.push(a);if(t.isEmpty()||38!==a)if(t.isEmpty()||38!==a){if(!t.isEmpty()||t.isDone())return(o=o||new de).param(i.bind(),r.bind()),_.done(o.bind())}else t.step(),s=5;else t.step(),(o=o||new de).param(i.bind(),r.bind()),i=void 0,r=void 0,s=1}if(5===s)if(!t.isEmpty()&&(a=t.head(),_.isHexChar(a)))t.step(),n=a,s=6;else{if(!t.isEmpty())return _.expected("hex digit",t);if(t.isDone())return _.unexpected(t)}if(6===s)if(!t.isEmpty()&&(a=t.head(),_.isHexChar(a)))t.step(),r.push((_.decodeHexChar(n)<<4)+_.decodeHexChar(a)),n=0,s=4;else{if(!t.isEmpty())return _.expected("hex digit",t);if(t.isDone())return _.unexpected(t)}}return new e(i,r,o,n,s)},e}(_),Xt=function(t){function e(e,i,r){var o=t.call(this)||this;return o.output=e,o.c1=i,o.step=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.output,this.c1,this.step)},e.parse=function(t,i,r,o){void 0===i&&(i=new g),void 0===r&&(r=0),void 0===o&&(o=1);for(var n=0;!t.isEmpty()||t.isDone();){if(1===o){for(;!t.isEmpty()&&(n=t.head(),Kt.isFragmentChar(n));)t.step(),i.push(n);if(t.isEmpty()||37!==n){if(!t.isEmpty()||t.isDone())return _.done(fe.of(i.bind()))}else t.step(),o=2}if(2===o)if(!t.isEmpty()&&(n=t.head(),_.isHexChar(n)))t.step(),r=n,o=3;else{if(!t.isEmpty())return _.expected("hex digit",t);if(t.isDone())return _.unexpected(t)}if(3===o)if(!t.isEmpty()&&(n=t.head(),_.isHexChar(n)))t.step(),i.push((_.decodeHexChar(r)<<4)+_.decodeHexChar(n)),r=0,o=1;else{if(!t.isEmpty())return _.expected("hex digit",t);if(t.isDone())return _.unexpected(t)}}return new e(i,r,o)},e}(_),Kt=function(){function t(t,e,i,r,o){this._scheme=t,this._authority=e,this._path=i,this._query=r,this._fragment=o}return t.prototype.isDefined=function(){return this._scheme.isDefined()||this._authority.isDefined()||this._path.isDefined()||this._query.isDefined()||this._fragment.isDefined()},t.prototype.isEmpty=function(){return!(this._scheme.isDefined()||this._authority.isDefined()||this._path.isDefined()||this._query.isDefined()||this._fragment.isDefined())},t.prototype.scheme=function(e){return void 0===e?this._scheme:(e=Qt.fromAny(e),t.of(e,this._authority,this._path,this._query,this._fragment))},t.prototype.authority=function(e){return void 0===e?this._authority:(e=Zt.fromAny(e),t.of(this._scheme,e,this._path,this._query,this._fragment))},t.prototype.user=function(e){if(void 0===e)return this._authority._user;var i=this._authority.user(e);return t.of(this._scheme,i,this._path,this._query,this._fragment)},t.prototype.username=function(e,i){if(void 0===e)return this._authority._user._username||"";var r=this._authority.username(e,i);return t.of(this._scheme,r,this._path,this._query,this._fragment)},t.prototype.password=function(e){if(void 0===e)return this._authority._user._password;var i=this._authority.password(e);return t.of(this._scheme,i,this._path,this._query,this._fragment)},t.prototype.host=function(e){if(void 0===e)return this._authority._host;var i=this._authority.host(e);return t.of(this._scheme,i,this._path,this._query,this._fragment)},t.prototype.hostName=function(e){if(void 0===e)return this._authority._host.name();var i=this._authority.hostName(e);return t.of(this._scheme,i,this._path,this._query,this._fragment)},t.prototype.hostIPv4=function(e){if(void 0===e)return this._authority._host.ipv4();var i=this._authority.hostIPv4(e);return t.of(this._scheme,i,this._path,this._query,this._fragment)},t.prototype.hostIPv6=function(e){if(void 0===e)return this._authority._host.ipv6();var i=this._authority.hostIPv6(e);return t.of(this._scheme,i,this._path,this._query,this._fragment)},t.prototype.port=function(e){if(void 0===e)return this._authority._port;var i=this._authority.port(e);return t.of(this._scheme,i,this._path,this._query,this._fragment)},t.prototype.path=function(e){return void 0===e?this._path:(e=ne.fromAny(e),t.of(this._scheme,this._authority,e,this._query,this._fragment))},t.prototype.query=function(e){return void 0===e?this._query:(e=le.fromAny(e),t.of(this._scheme,this._authority,this._path,e,this._fragment))},t.prototype.param=function(e,i){if(void 0===i)return this._query.get(e);var r=this._query.param(e,i);return t.of(this._scheme,this._authority,this._path,r,this._fragment)},t.prototype.fragment=function(e){return void 0===e?this._fragment:(e=fe.fromAny(e),t.of(this._scheme,this._authority,this._path,this._query,e))},t.prototype.base=function(){return this._path.isDefined()||this._query.isDefined()||this._fragment.isDefined()?t.of(this._scheme,this._authority):this},t.prototype.resolve=function(e){return(e=t.fromAny(e))._scheme.isDefined()?t.of(e._scheme,e._authority,e._path.removeDotSegments(),e._query,e._fragment):e._authority.isDefined()?t.of(this._scheme,e._authority,e._path.removeDotSegments(),e._query,e._fragment):e._path.isEmpty()?t.of(this._scheme,this._authority,this._path,e._query.isDefined()?e._query:this._query,e._fragment):"/"===e._path.head()?t.of(this._scheme,this._authority,e._path.removeDotSegments(),e._query,e._fragment):t.of(this._scheme,this._authority,this.merge(e._path).removeDotSegments(),e._query,e._fragment)},t.prototype.merge=function(t){return this._authority.isDefined()&&this._path.isEmpty()?new ae(t):this._path.isEmpty()?t:this._path.merge(t)},t.prototype.unresolve=function(e){return e=t.fromAny(e),this._scheme.equals(e._scheme)&&this._authority.equals(e._authority)?t.of(Qt.Undefined,Zt.Undefined,this._path.unmerge(e._path),e._query,e._fragment):e},t.prototype.writeUri=function(t){this._scheme.isDefined()&&(this._scheme.writeUri(t),t.push(58)),this._authority.isDefined()&&(t.push(47,47),this._authority.writeUri(t)),this._path.writeUri(t),this._query.isDefined()&&(t.push(63),this._query.writeUri(t)),this._fragment.isDefined()&&(t.push(35),this._fragment.writeUri(t))},t.prototype.toUri=function(){var t=this._string;if(void 0===t){var e=new g;this.writeUri(e),t=e.bind(),this._string=t}return t},t.prototype.compare=function(t){var e=this.toUri().localeCompare(t.toUri());return e<0?-1:e>0?1:0},t.prototype.equals=function(e){return this===e||e instanceof t&&((void 0===this._hashCode||void 0===e._hashCode||this._hashCode===e._hashCode)&&(this._scheme.equals(e._scheme)&&this._authority.equals(e._authority)&&this._path.equals(e._path)&&this._query.equals(e._query)&&this._fragment.equals(e._fragment)))},t.prototype.hashCode=function(){var t=this._hashCode;return void 0===t&&(t=n.mash(n.mix(n.mix(n.mix(n.mix(n.mix(4118306580,this._scheme.hashCode()),this._authority.hashCode()),this._path.hashCode()),this._query.hashCode()),this._fragment.hashCode())),this._hashCode=t),t},t.prototype.toString=function(){return this.toUri()},t.parse=function(e){var i=I.valueOf(e);if(e.length<=128){var r=t.ParseCache.get(i);if(void 0!==r)return r}var o=new v(e),n=Ut.parse(o);!o.isEmpty()&&n.isDone()&&(n=_.unexpected(o));var s=n.bind();return t.ParseCache.set(i,s),s},t.of=function(e,i,r,o,n){return void 0===e&&(e=Qt.Undefined),void 0===i&&(i=Zt.Undefined),void 0===r&&(r=ne.Empty),void 0===o&&(o=le.Undefined),void 0===n&&(n=fe.Undefined),e.isDefined()||i.isDefined()||r.isDefined()||o.isDefined()||n.isDefined()?new t(e,i,r,o,n):t.Empty},t.scheme=function(e){return e=Qt.fromAny(e),t.of(e,void 0,void 0,void 0,void 0)},t.authority=function(e){return e=Zt.fromAny(e),t.of(void 0,e,void 0,void 0,void 0)},t.user=function(e){var i=Zt.user(e);return t.of(void 0,i,void 0,void 0,void 0)},t.username=function(e,i){var r=Zt.username(e,i);return t.of(void 0,r,void 0,void 0,void 0)},t.password=function(e){var i=Zt.password(e);return t.of(void 0,i,void 0,void 0,void 0)},t.host=function(e){var i=Zt.host(e);return t.of(void 0,i,void 0,void 0,void 0)},t.hostName=function(e){var i=Zt.hostName(e);return t.of(void 0,i,void 0,void 0,void 0)},t.hostIPv4=function(e){var i=Zt.hostIPv4(e);return t.of(void 0,i,void 0,void 0,void 0)},t.hostIPv6=function(e){var i=Zt.hostIPv6(e);return t.of(void 0,i,void 0,void 0,void 0)},t.port=function(e){var i=Zt.port(e);return t.of(void 0,i,void 0,void 0,void 0)},t.path=function(e){return e=ne.fromAny(e),t.of(void 0,void 0,e,void 0,void 0)},t.query=function(e){return e=le.fromAny(e),t.of(void 0,void 0,void 0,e,void 0)},t.param=function(e,i){var r=le.param(e,i);return t.of(void 0,void 0,void 0,r,void 0)},t.fragment=function(e){return e=fe.fromAny(e),t.of(void 0,void 0,void 0,void 0,e)},t.fromAny=function(e){if(null==e)return t.Empty;if(e instanceof t)return e;if("object"==typeof e){var i=Qt.fromAny(e.scheme),r=Zt.fromAny(e.authority||e),o=ne.fromAny(e.path),n=le.fromAny(e.query),s=fe.fromAny(e.fragment);return i.isDefined()||r.isDefined()||o.isDefined()||n.isDefined()||s.isDefined()?new t(i,r,o,n,s):t.Empty}if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.resolve=function(e,i){return t.fromAny(e).resolve(i)},t.unresolve=function(e,i){return t.fromAny(e).unresolve(i)},t.isUnreservedChar=function(t){return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||45===t||46===t||95===t||126===t},t.isSubDelimChar=function(t){return 33===t||36===t||38===t||40===t||41===t||42===t||43===t||44===t||59===t||61===t||39===t},t.isSchemeChar=function(t){return t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||43===t||45===t||46===t},t.isUserInfoChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||58===e},t.isUserChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)},t.isHostChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)},t.isPathChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||58===e||64===e},t.isQueryChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||47===e||58===e||63===e||64===e},t.isParamChar=function(e){return t.isUnreservedChar(e)||33===e||36===e||40===e||41===e||42===e||43===e||44===e||47===e||58===e||59===e||63===e||64===e||39===e},t.isFragmentChar=function(e){return t.isUnreservedChar(e)||t.isSubDelimChar(e)||47===e||58===e||63===e||64===e},t.writeScheme=function(e,i){for(var r=0,o=e.length;r<o;r+=1){var n=e.charCodeAt(r);if(!(r>0&&t.isSchemeChar(n)||0===r&&_.isAlpha(n)))throw new Error("invalid scheme: "+e);i.push(n)}},t.writeUserInfo=function(e,i){for(var r=0,o=e.length;r<o;r+=1){var n=e.charCodeAt(r);t.isUserInfoChar(n)?i.push(n):t.writeEncoded(n,i)}},t.writeUser=function(e,i){for(var r=0,o=e.length;r<o;r+=1){var n=e.charCodeAt(r);t.isUserChar(n)?i.push(n):t.writeEncoded(n,i)}},t.writeHost=function(e,i){for(var r=0,o=e.length;r<o;r+=1){var n=e.charCodeAt(r);t.isHostChar(n)?i.push(n):t.writeEncoded(n,i)}},t.writeHostLiteral=function(e,i){for(var r=0,o=e.length;r<o;r+=1){var n=e.charCodeAt(r);t.isHostChar(n)||58===n?i.push(n):t.writeEncoded(n,i)}},t.writePort=function(t,e){for(var i=9,r=new Array(10);t>0;)r[i]=t%10,t=Math.floor(t/10),i-=1;for(i+=1;i<10;)e.push(48+r[i]),i+=1},t.writePathSegment=function(e,i){for(var r=0,o=e.length;r<o;r+=1){var n=e.charCodeAt(r);t.isPathChar(n)?i.push(n):t.writeEncoded(n,i)}},t.writeQuery=function(e,i){for(var r=0,o=e.length;r<o;r+=1){var n=e.charCodeAt(r);t.isQueryChar(n)?i.push(n):t.writeEncoded(n,i)}},t.writeParam=function(e,i){for(var r=0,o=e.length;r<o;r+=1){var n=e.charCodeAt(r);t.isParamChar(n)?i.push(n):t.writeEncoded(n,i)}},t.writeFragment=function(e,i){for(var r=0,o=e.length;r<o;r+=1){var n=e.charCodeAt(r);t.isFragmentChar(n)?i.push(n):t.writeEncoded(n,i)}},t.writeEncoded=function(e,i){0===e?(t.writePctEncoded(192,i),t.writePctEncoded(128,i)):e>=0&&e<=127?t.writePctEncoded(e,i):e>=128&&e<=2047?(t.writePctEncoded(192|e>>>6,i),t.writePctEncoded(128|63&e,i)):e>=2048&&e<=65535||e>=57344&&e<=65535?(t.writePctEncoded(224|e>>>12,i),t.writePctEncoded(128|e>>>6&63,i),t.writePctEncoded(128|63&e,i)):e>=65536&&e<=1114111?(t.writePctEncoded(240|e>>>18,i),t.writePctEncoded(128|e>>>12&63,i),t.writePctEncoded(128|e>>>6&63,i),t.writePctEncoded(128|63&e,i)):(t.writePctEncoded(239,i),t.writePctEncoded(191,i),t.writePctEncoded(189,i))},t.writePctEncoded=function(e,i){i.push(37,t.encodeHexChar(e>>>4&15),t.encodeHexChar(15&e))},t.encodeHexChar=function(t){return t<10?48+t:t-10+97},t.Empty=void 0,t.ParseCache=new zt(64),t}(),Qt=function(){function t(t){this._name=t}return t.prototype.isDefined=function(){return 0!==this._name.length},Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),t.prototype.valueOf=function(){return this._name},t.prototype.writeUri=function(t){Kt.writeScheme(this._name,t)},t.prototype.toUri=function(){var t=new g;return this.writeUri(t),t.bind()},t.prototype.equals=function(e){return this===e||e instanceof t&&this._name===e._name},t.prototype.hashCode=function(){return n.mash(n.mix(2043922308,n.hash(this._name)))},t.prototype.toString=function(){return this._name},t.parse=function(t){"string"==typeof t&&(t=new v(t));var e=Wt.parse(t);return!t.isEmpty()&&e.isDone()&&(e=_.unexpected(t)),e.bind()},t.of=function(e){return 0!==e.length?new t(e):t.Undefined},t.fromAny=function(e){if(null==e)return t.Undefined;if(e instanceof t)return e;if("string"==typeof e)return t.of(e);throw new TypeError(""+e)},t.Undefined=new t(""),t}(),Zt=function(){function t(t,e,i){this._user=t,this._host=e,this._port=i}return t.prototype.isDefined=function(){return this._user.isDefined()||this._host.isDefined()||this._port.isDefined()},t.prototype.user=function(e){return void 0===e?this._user:(e=Jt.fromAny(e),t.of(e,this._host,this._port))},t.prototype.username=function(e,i){if(void 0===e)return this._user._username||"";var r=this._user.username(e,i);return t.of(r,this._host,this._port)},t.prototype.password=function(e){if(void 0===e)return this._user._password;var i=this._user.password(e);return t.of(i,this._host,this._port)},t.prototype.host=function(e){return void 0===e?this._host:(e=$t.fromAny(e),t.of(this._user,e,this._port))},t.prototype.hostName=function(e){if(void 0===e)return this._host.name();var i=te.of(e);return t.of(this._user,i,this._port)},t.prototype.hostIPv4=function(e){if(void 0===e)return this._host.ipv4();var i=ee.of(e);return t.of(this._user,i,this._port)},t.prototype.hostIPv6=function(e){if(void 0===e)return this._host.ipv6();var i=ie.of(e);return t.of(this._user,i,this._port)},t.prototype.port=function(e){return void 0===e?this._port:(e=oe.fromAny(e),t.of(this._user,this._host,e))},t.prototype.writeUri=function(t){this._user.isDefined()&&(this._user.writeUri(t),t.push(64)),this._host.writeUri(t),this._port.isDefined()&&(t.push(58),this._port.writeUri(t))},t.prototype.toUri=function(){var t=new g;return this.writeUri(t),t.bind()},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._user.equals(e._user)&&this._host.equals(e._host)&&this._port.equals(e._port))},t.prototype.hashCode=function(){return n.mash(n.mix(n.mix(n.mix(1835556802,this._user.hashCode()),this._host.hashCode()),this._port.hashCode()))},t.prototype.toString=function(){return this.toUri()},t.parse=function(t){"string"==typeof t&&(t=new v(t));var e=Ot.parse(t);return!t.isEmpty()&&e.isDone()&&(e=_.unexpected(t)),e.bind()},t.of=function(e,i,r){return void 0===e&&(e=Jt.Undefined),void 0===i&&(i=$t.Undefined),void 0===r&&(r=oe.Undefined),e.isDefined()||i.isDefined()||r.isDefined()?new t(e,i,r):t.Undefined},t.user=function(e){return e=Jt.fromAny(e),t.of(e,void 0,void 0)},t.username=function(e,i){var r=Jt.of(e,i);return t.of(r,void 0,void 0)},t.password=function(e){var i=Jt.of("",e);return t.of(i,void 0,void 0)},t.host=function(e){return e=$t.fromAny(e),t.of(void 0,e,void 0)},t.hostName=function(e){var i=te.of(e);return t.of(void 0,i,void 0)},t.hostIPv4=function(e){var i=ee.of(e);return t.of(void 0,i,void 0)},t.hostIPv6=function(e){var i=ie.of(e);return t.of(void 0,i,void 0)},t.port=function(e){return e=oe.fromAny(e),t.of(void 0,void 0,e)},t.fromAny=function(e){if(null==e)return t.Undefined;if(e instanceof t)return e;if("object"==typeof e){var i=Jt.fromAny(e.user||e),r=$t.fromAny(e.host),o=oe.fromAny(e.port);return t.of(i,r,o)}if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.Undefined=void 0,t}(),Jt=function(){function t(t,e){void 0===e&&(e=null),this._username=t,this._password=e}return t.prototype.isDefined=function(){return null!==this._username},t.prototype.username=function(e,i){return void 0===i&&(i=this._password),void 0===e?this._username||"":t.of(e,this._password)},t.prototype.password=function(e){return void 0===e?this._password:t.of(this._username,e)},t.prototype.writeUri=function(t){null!==this._username&&(Kt.writeUser(this._username,t),null!==this._password&&(t.push(58),Kt.writeUser(this._password,t)))},t.prototype.toUri=function(){var t=new g;return this.writeUri(t),t.bind()},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._username===e._username&&this._password===e._password)},t.prototype.hashCode=function(){return n.mash(n.mix(n.mix(2091562833,n.hash(this._username)),n.hash(this._password)))},t.prototype.toString=function(){return this.toUri()},t.parse=function(t){"string"==typeof t&&(t=new v(t));var e=Bt.parse(t);return!t.isEmpty()&&e.isDone()&&(e=_.unexpected(t)),e.bind()},t.of=function(e,i){return void 0===i&&(i=null),null!==e||null!==i?new t(e||"",i):t.Undefined},t.fromAny=function(e){if(null==e)return t.Undefined;if(e instanceof t)return e;if("object"==typeof e){var i="string"==typeof e.username?e.username:null,r="string"==typeof e.password?e.password:null;return t.of(i,r)}if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.Undefined=new t(null,null),t}(),$t=function(){function t(){}return t.prototype.name=function(){return null},t.prototype.ipv4=function(){return null},t.prototype.ipv6=function(){return null},t.prototype.toUri=function(){var t=new g;return this.writeUri(t),t.bind()},t.prototype.toString=function(){return this.toUri()},t.parse=function(t){"string"==typeof t&&(t=new v(t));var e=qt.parse(t);return!t.isEmpty()&&e.isDone()&&(e=_.unexpected(t)),e.bind()},t.fromAny=function(e){if(null==e)return t.Undefined;if(e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.Undefined=void 0,t}(),te=function(t){function e(e){var i=t.call(this)||this;return i._address=e,i}return u(e,t),e.prototype.isDefined=function(){return!0},Object.defineProperty(e.prototype,"address",{get:function(){return this._address},enumerable:!0,configurable:!0}),e.prototype.name=function(){return this._address},e.prototype.writeUri=function(t){Kt.writeHost(this._address,t)},e.prototype.equals=function(t){return this===t||t instanceof e&&this._address===t._address},e.prototype.hashCode=function(){return n.mash(n.mix(3937679e3,n.hash(this._address)))},e.of=function(t){return new e(t)},e}($t),ee=function(t){function e(e){var i=t.call(this)||this;return i._address=e,i}return u(e,t),e.prototype.isDefined=function(){return!0},Object.defineProperty(e.prototype,"address",{get:function(){return this._address},enumerable:!0,configurable:!0}),e.prototype.ipv4=function(){return this._address},e.prototype.writeUri=function(t){Kt.writeHost(this._address,t)},e.prototype.equals=function(t){return this===t||t instanceof e&&this._address===t._address},e.prototype.hashCode=function(){return n.mash(n.mix(2745781626,n.hash(this._address)))},e.of=function(t){return new e(t)},e}($t),ie=function(t){function e(e){var i=t.call(this)||this;return i._address=e,i}return u(e,t),e.prototype.isDefined=function(){return!0},Object.defineProperty(e.prototype,"address",{get:function(){return this._address},enumerable:!0,configurable:!0}),e.prototype.ipv6=function(){return this._address},e.prototype.writeUri=function(t){t.push(91),Kt.writeHostLiteral(this._address,t),t.push(93)},e.prototype.equals=function(t){return this===t||t instanceof e&&this._address===t._address},e.prototype.hashCode=function(){return n.mash(n.mix(1131060913,n.hash(this._address)))},e.of=function(t){return new e(t)},e}($t),re=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.isDefined=function(){return!1},Object.defineProperty(e.prototype,"address",{get:function(){return""},enumerable:!0,configurable:!0}),e.prototype.writeUri=function(t){},e.prototype.equals=function(t){return t instanceof e},e.prototype.hashCode=function(){return 2406756600},e}($t);$t.Undefined=new re;var oe=function(){function t(t){this._number=t}return t.prototype.isDefined=function(){return 0!==this._number},Object.defineProperty(t.prototype,"number",{get:function(){return this._number},enumerable:!0,configurable:!0}),t.prototype.valueOf=function(){return this._number},t.prototype.writeUri=function(t){Kt.writePort(this._number,t)},t.prototype.toUri=function(){var t=new g;return this.writeUri(t),t.bind()},t.prototype.equals=function(e){return this===e||e instanceof t&&this._number===e._number},t.prototype.hashCode=function(){return n.mash(n.mix(213942493,this._number))},t.prototype.toString=function(){return this.toUri()},t.parse=function(t){"string"==typeof t&&(t=new v(t));var e=Nt.parse(t);return!t.isEmpty()&&e.isDone()&&(e=_.unexpected(t)),e.bind()},t.of=function(e){return 0!==e?new t(e):t.Undefined},t.fromAny=function(e){if(null==e)return t.Undefined;if(e instanceof t)return e;if("number"==typeof e)return t.of(e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.Undefined=new t(0),t}(),ne=function(){function t(){}return Object.defineProperty(t.prototype,"length",{get:function(){for(var t=0,e=this;!e.isEmpty();)t+=1,e=e.tail();return t},enumerable:!0,configurable:!0}),t.prototype.removeDotSegments=function(){for(var e=this,i=new he;!e.isEmpty();){var r=e.head();if("."===r||".."===r)(e=e.tail()).isEmpty()||(e=e.tail());else if("/"===r){var o=e.tail();if(o.isEmpty())i.push(e.head()),e=e.tail();else{var n=o.head();"."===n?(e=o.tail()).isEmpty()&&(e=t.Slash):".."===n?((e=o.tail()).isEmpty()&&(e=t.Slash),i.isEmpty()||"/"===i.pop()||i.isEmpty()||i.pop()):(i.push(r,n),e=o.tail())}}else i.push(e.head()),e=e.tail()}return i.bind()},t.prototype.merge=function(t){for(var e=new he,i=this.head(),r=this.tail();!r.isEmpty();)e.push(i),i=r.head(),r=r.tail();return"/"===i&&e.push(i),e.push(t),e.bind()},t.prototype.unmerge=function(e,i){void 0===i&&(i=e);for(var r=this;;){if(r.isEmpty())return e.isEmpty()||e.tail().isEmpty()?e:e.tail();if(r.isRelative())return e;if(e.isRelative())return new ae(e);var o=r.tail(),n=e.tail();if(!o.isEmpty()&&n.isEmpty())return t.Slash;if(o.isEmpty()||n.isEmpty()||o.head()!==n.head())return n;if(o=o.tail(),n=n.tail(),!o.isEmpty()&&n.isEmpty())return i;r=o,e=n}},t.prototype.toArray=function(){for(var t=[],e=this;!e.isEmpty();)t.push(e.head()),e=e.tail();return t},t.prototype.writeUri=function(t){for(var e=this;!e.isEmpty();)e instanceof ae?t.push(47):Kt.writePathSegment(e.head(),t),e=e.tail()},t.prototype.toUri=function(){var t=new g;return this.writeUri(t),t.bind()},t.prototype.equals=function(e){if(this===e)return!0;if(e instanceof t){for(var i=this,r=e;!i.isEmpty()&&!r.isEmpty();){if(i.head()!==r.head())return!1;i=i.tail(),r=r.tail()}return i.isEmpty()===r.isEmpty()}return!1},t.prototype.hashCode=function(){for(var t=3618688081,e=this;!e.isEmpty();)t=n.mix(t,n.hash(e.head())),e=e.tail();return n.mash(t)},t.prototype.toString=function(){return this.toUri()},t.builder=function(){return new he},t.parse=function(t){"string"==typeof t&&(t=new v(t));var e=jt.parse(t);return!t.isEmpty()&&e.isDone()&&(e=_.unexpected(t)),e.bind()},t.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=new he;return i.push.apply(i,arguments),i.bind()},t.fromAny=function(e){if(null==e)return t.Empty;if(e instanceof t)return e;if(Array.isArray(e))return t.of.apply(void 0,e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.Empty=void 0,t.Slash=void 0,t}(),se=function(t){function e(e,i){var r=t.call(this)||this;return r._head=e,r._tail=i,r}return u(e,t),e.prototype.isDefined=function(){return!0},e.prototype.isAbsolute=function(){return!1},e.prototype.isRelative=function(){return!0},e.prototype.isEmpty=function(){return!1},e.prototype.head=function(){return this._head},e.prototype.tail=function(){return this._tail},e.prototype.setTail=function(t){t instanceof e&&(t=new ae(t)),this._tail=t},e}(ne),ae=function(t){function e(e){var i=t.call(this)||this;return i._tail=e,i}return u(e,t),e.prototype.isDefined=function(){return!0},e.prototype.isAbsolute=function(){return!0},e.prototype.isRelative=function(){return!1},e.prototype.isEmpty=function(){return!1},e.prototype.head=function(){return"/"},e.prototype.tail=function(){return this._tail},e.prototype.setTail=function(t){this._tail=t},e}(ne),ue=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.isDefined=function(){return!1},e.prototype.isAbsolute=function(){return!1},e.prototype.isRelative=function(){return!0},e.prototype.isEmpty=function(){return!0},e.prototype.head=function(){return""},e.prototype.tail=function(){throw new Error("empty path")},e.prototype.setTail=function(t){throw new Error("empty path")},e}(ne);ne.Empty=new ue,ne.Slash=new ae(ne.Empty);var he=function(){function t(){this._first=ne.Empty,this._last=null,this._size=0,this._aliased=0}return t.prototype.isEmpty=function(){return 0===this._size},t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<t.length;i+=1){var r=t[i];if(r instanceof ne){if(!r.isEmpty()){for(0===this._size?this._first=r:this.dealias(this._size-1).setTail(r),this._size+=1;!r.tail().isEmpty();)r=r.tail(),this._size+=1;this._last=r}}else if(Array.isArray(r))this.push.apply(this,r);else{if("string"!=typeof r)throw new TypeError(""+r);var o=void 0;o="/"===r?new ae(ne.Empty):new se(r,ne.Empty),0===this._size?this._first=o:this.dealias(this._size-1).setTail(o),this._last=o,this._size+=1,this._aliased+=1}}},t.prototype.pop=function(){if(0===this._size)throw new Error;if(1===this._size){var t=this._first,e=t.head();return this._first=t.tail(),t.tail().isEmpty()&&(this._last=null),this._size-=1,this._aliased>0&&(this._aliased-=1),e}var i=this.dealias(this._size-2);e=i.tail().head();return i.setTail(ne.Empty),this._last=i,this._size-=1,this._aliased-=1,e},t.prototype.bind=function(){return this._aliased=0,this._first},t.prototype.dealias=function(t){var e=0,i=null,r=this._first;if(this._aliased<=t){for(;e<this._aliased;)i=r,r=r.tail(),e+=1;for(;e<=t;){var o=void 0;o=r instanceof ae?new ae(r.tail()):new se(r.head(),r.tail()),0===e?this._first=o:i.setTail(o),i=o,r=r.tail(),e+=1}e===this._size&&(this._last=i),this._aliased=e}else if(0===t)i=this._first;else if(t===this._size-1)i=this._last;else for(;e<=t;)i=r,r=r.tail(),e+=1;return i},t}(),le=function(){function t(){}return Object.defineProperty(t.prototype,"length",{get:function(){for(var t=0,e=this;!e.isEmpty();)t+=1,e=e.tail();return t},enumerable:!0,configurable:!0}),t.prototype.get=function(t){for(var e=this;!e.isEmpty();){if(t===e.key)return e.value;e=e.tail()}},t.prototype.param=function(t,e){if(void 0===e)return this.get(t);for(var i=new de,r=this,o=!1;!r.isEmpty();)o||null===t||t!==r.key?i.param(r.key,r.value):(i.param(t,e),o=!0),r=r.tail();return o||i.param(t,e),i.bind()},t.prototype.toObject=function(){for(var t={},e=this,i=0;!e.isEmpty();)null!==e.key?t[e.key]=e.value:t["$"+i]=e.value,e=e.tail(),i+=1;return t},t.prototype.writeUri=function(t){for(var e=this,i=!0;!e.isEmpty();)i?i=!1:t.push(38),null!==e.key&&(Kt.writeParam(e.key,t),t.push(61)),Kt.writeParam(e.value,t),e=e.tail()},t.prototype.toUri=function(){var t=new g;return this.writeUri(t),t.bind()},t.prototype.equals=function(e){if(this===e)return!0;if(e instanceof t){for(var i=this,r=e;!i.isEmpty()&&!r.isEmpty();){if(i.key!==r.key||i.value!==r.value)return!1;i=i.tail(),r=r.tail()}return i.isEmpty()===r.isEmpty()}return!1},t.prototype.hashCode=function(){for(var t=922545508,e=this;!e.isEmpty();)t=n.mix(n.mix(t,n.hash(e.key)),n.hash(e.value)),e=e.tail();return n.mash(t)},t.prototype.toString=function(){return this.toUri()},t.builder=function(){return new de},t.parse=function(t){"string"==typeof t&&(t=new v(t));var e=Yt.parse(t);return!t.isEmpty()&&e.isDone()&&(e=_.unexpected(t)),e.bind()},t.fromAny=function(e){if(null==e)return t.Undefined;if(e instanceof t)return e;if("object"==typeof e)return t.fromObject(e);if("string"==typeof e)return t.parse(e);throw new TypeError(""+e)},t.param=function(e,i){return new pe(e,i,t.Undefined)},t.fromObject=function(e){var i=t.Undefined,r=null,o=0;for(var n in e){var s=n,a=e[n];36===n.charCodeAt(0)&&n==="$"+o&&(s=null);var u=new pe(s,a,t.Undefined);null===r?i=u:r.setTail(u),r=u,o+=1}return i},t.Undefined=void 0,t}(),pe=function(t){function e(e,i,r){var o=t.call(this)||this;return o._key=e,o._value=i,o._tail=r,o}return u(e,t),e.prototype.isDefined=function(){return!0},e.prototype.isEmpty=function(){return!1},Object.defineProperty(e.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),e.prototype.tail=function(){return this._tail},e.prototype.setTail=function(t){this._tail=t},e}(le),ce=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.isDefined=function(){return!1},e.prototype.isEmpty=function(){return!0},Object.defineProperty(e.prototype,"key",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return""},enumerable:!0,configurable:!0}),e.prototype.tail=function(){throw new Error("undefined query")},e.prototype.setTail=function(t){throw new Error("undefined query")},e}(le);le.Undefined=new ce;var de=function(){function t(){this._first=le.Undefined,this._last=null,this._size=0,this._aliased=0}return t.prototype.isEmpty=function(){return 0===this._size},t.prototype.param=function(t,e){var i=new pe(t,e,le.Undefined);0===this._size?this._first=i:this.dealias(this._size-1).setTail(i),this._last=i,this._size+=1,this._aliased+=1},t.prototype.bind=function(){return this._aliased=0,this._first},t.prototype.dealias=function(t){var e=0,i=null,r=this._first;if(this._aliased<=t){for(;e<this._aliased;)i=r,r=r.tail(),e+=1;for(;e<=t;){var o=new pe(r.key,r.value,r.tail());0===e?this._first=o:i.setTail(o),i=o,r=r.tail(),e+=1}e===this._size&&(this._last=i),this._aliased=e}else if(0===t)i=this._first;else if(t===this._size-1)i=this._last;else for(;e<=t;)i=r,r=r.tail(),e+=1;return i},t}(),fe=function(){function t(t){this._part=t}return t.prototype.isDefined=function(){return null!==this._part},Object.defineProperty(t.prototype,"part",{get:function(){return this._part||""},enumerable:!0,configurable:!0}),t.prototype.writeUri=function(t){null!==this._part&&Kt.writeFragment(this._part,t)},t.prototype.toUri=function(){var t=new g;return this.writeUri(t),t.bind()},t.prototype.equals=function(e){return this===e||e instanceof t&&this._part===e._part},t.prototype.hashCode=function(){return n.mash(n.mix(395776270,n.hash(this._part)))},t.prototype.toString=function(){return this.toUri()},t.parse=function(t){"string"==typeof t&&(t=new v(t));var e=Xt.parse(t);return!t.isEmpty()&&e.isDone()&&(e=_.unexpected(t)),e.bind()},t.of=function(e){return null!==e?new t(e):t.Undefined},t.fromAny=function(e){if(null==e)return t.Undefined;if(e instanceof t)return e;if("string"==typeof e)return t.of(e);throw new TypeError(""+e)},t.Undefined=new t(null),t}();Zt.Undefined=new Zt(Jt.Undefined,$t.Undefined,oe.Undefined),Kt.Empty=new Kt(Qt.Undefined,Zt.Undefined,ne.Empty,le.Undefined,fe.Undefined);var ye=function(){function t(){}return Object.defineProperty(t.prototype,"tag",{get:function(){},enumerable:!0,configurable:!0}),t.Any=void 0,t.Value=void 0,t.String=void 0,t.Number=void 0,t.Boolean=void 0,t.Uri=void 0,t}(),me=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"unit",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.mold=function(t){return b.fromAny(t)},e.prototype.cast=function(t){return t.toAny()},e}(ye);ye.Any=new me;var ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"unit",{get:function(){return b.Absent},enumerable:!0,configurable:!0}),e.prototype.mold=function(t){return b.fromAny(t)},e.prototype.cast=function(t){return t},e}(ye);ye.Value=new ve;var ge=function(t){function e(e){void 0===e&&(e="");var i=t.call(this)||this;return i.unit=e,i}return u(e,t),e.prototype.mold=function(t){return I.valueOf(t)},e.prototype.cast=function(t){return t.target.stringValue()},e}(ye);ye.String=new ge;var we=function(t){function e(e){void 0===e&&(e=0);var i=t.call(this)||this;return i.unit=e,i}return u(e,t),e.prototype.mold=function(t){return U.valueOf(t)},e.prototype.cast=function(t){return t.target.numberValue()},e}(ye);ye.Number=new we;var be=function(t){function e(e){void 0===e&&(e=!1);var i=t.call(this)||this;return i.unit=e,i}return u(e,t),e.prototype.mold=function(t){return W.valueOf(t)},e.prototype.cast=function(t){return t.target.booleanValue()},e}(ye);ye.Boolean=new be;var _e=function(t){function e(e){void 0===e&&(e=Kt.Empty);var i=t.call(this)||this;return i.unit=e,i}return u(e,t),e.prototype.mold=function(t){return I.valueOf(t.toUri())},e.prototype.cast=function(t){try{var e=t.target.stringValue();if(void 0!==e)return Kt.parse(e)}catch(t){}},e}(ye);ye.Uri=new _e;var xe=function(t){function e(e,i){var r=t.call(this)||this;return r.cursor=e,r.form=i,r}return u(e,t),e.prototype.isEmpty=function(){return this.cursor.isEmpty()},e.prototype.head=function(){return this.cursor.head().coerce(this.form)},e.prototype.step=function(){this.cursor.step()},e.prototype.skip=function(t){this.cursor.skip(t)},e.prototype.hasNext=function(){return this.cursor.hasNext()},e.prototype.nextIndex=function(){return this.cursor.nextIndex()},e.prototype.next=function(){var t=this.cursor.next(),e=t.value,i=t.done;return{value:e&&e.coerce(this.form),done:i}},e.prototype.hasPrevious=function(){return this.cursor.hasPrevious()},e.prototype.previousIndex=function(){return this.cursor.previousIndex()},e.prototype.previous=function(){var t=this.cursor.next(),e=t.value,i=t.done;return{value:e&&e.coerce(this.form),done:i}},e.prototype.delete=function(){this.cursor.delete()},e}(h),Ae=function(t){function e(e,i,r){var o=t.call(this)||this;return o.cursor=e,o.keyForm=i,o.valueForm=r,o}return u(e,t),e.prototype.isEmpty=function(){return this.cursor.isEmpty()},e.prototype.head=function(){var t=this.cursor.head();return[t[0].coerce(this.keyForm),t[1].coerce(this.valueForm)]},e.prototype.step=function(){this.cursor.step()},e.prototype.skip=function(t){this.cursor.skip(t)},e.prototype.hasNext=function(){return this.cursor.hasNext()},e.prototype.nextIndex=function(){return this.cursor.nextIndex()},e.prototype.next=function(){var t=this.cursor.next(),e=t.value,i=t.done;return{value:e&&[e[0].coerce(this.keyForm),e[1].coerce(this.valueForm)],done:i}},e.prototype.hasPrevious=function(){return this.cursor.hasPrevious()},e.prototype.previousIndex=function(){return this.cursor.previousIndex()},e.prototype.previous=function(){var t=this.cursor.next(),e=t.value,i=t.done;return{value:e&&[e[0].coerce(this.keyForm),e[1].coerce(this.valueForm)],done:i}},e.prototype.delete=function(){this.cursor.delete()},e}(h),ke=function(){function t(){this._record=null,this._value=null}return t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0,r=t.length;i<r;i+=1){var o=t[i];o instanceof M?this.pushField(o):o instanceof b&&this.pushValue(o)}},t.prototype.pushField=function(t){null===this._record&&(this._record=L.empty(),null!==this._value&&(this._record.push(this._value),this._value=null)),this._record.push(t)},t.prototype.pushValue=function(t){null!==this._record?this._record.push(t):null!==this._value?(this._record=L.empty(),this._record.push(this._value,t),this._value=null):this._value=t},t.prototype.bind=function(){return null!==this._record?this._record:null!==this._value?this._value:b.Absent},t}(),Ee=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.builder=i,s.keyParser=r,s.valueParser=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.keyParser,this.valueParser,this.step)},e.parse=function(t,i,r,o,n,s){void 0===s&&(s=1);var a=0;t:for(;;){if(1===s){for(;!t.isEmpty()&&(a=t.head(),_.isWhitespace(a));)t.step();if(t.isEmpty()){if(t.isDone())return r?_.done(r.bind()):_.done(i.absent())}else if(33===a||34===a||36===a||37===a||39===a||40===a||45===a||a>=48&&a<=57||64===a||91===a||123===a||Xe.isIdentStartChar(a))r=r||i.valueBuilder(),s=2;else{if(35!==a)return r?_.done(r.bind()):_.done(i.absent());t.step(),s=7}}if(2===s){for(o||(o=i.parseBlockExpr(t));o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())s=3;else if(o.isError())return o}if(3===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()){if(t.isDone())return r.push(i.item(o.bind())),_.done(r.bind())}else 58===a?(t.step(),s=4):(r.push(i.item(o.bind())),o=void 0,s=6)}if(4===s){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();if(t.isEmpty()){if(t.isDone())return r.push(i.slot(o.bind())),_.done(r.bind())}else s=5}if(5===s){for(n||(n=i.parseBlockExpr(t));n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())r.push(i.slot(o.bind(),n.bind())),o=void 0,n=void 0,s=6;else if(n.isError())return n}if(6===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()){if(t.isDone())return _.done(r.bind())}else{if(44===a||59===a||_.isNewline(a)){t.step(),s=1;continue}if(35!==a)return _.done(r.bind());t.step(),s=7}}if(7===s){for(;!t.isEmpty();){if(a=t.head(),_.isNewline(a)){s=1;continue t}t.step()}if(t.isDone()){s=1;continue}}break}return new e(i,r,o,n,s)},e}(_),Ce=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.recon=e,n.keyParser=i,n.valueParser=r,n.step=o,n}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.keyParser,this.valueParser,this.step)},e.parse=function(t,i,r,o,n){void 0===n&&(n=1);var s=0;if(1===n)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(64!==(s=t.head()))return _.expected("@",t);t.step(),n=2}if(2===n){if(r)r=r.feed(t);else if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else if(34===(s=t.head())||39===s)r=i.parseString(t);else{if(!Xe.isIdentStartChar(s))return _.expected("attribute name",t);r=i.parseIdent(t)}if(r)if(r.isDone())n=3;else if(r.isError())return r.asError()}if(3===n)if(t.isEmpty()||40!==t.head()){if(!t.isEmpty()||t.isDone())return _.done(i.attr(r.bind()))}else t.step(),n=4;if(4===n){for(;!t.isEmpty()&&(s=t.head(),_.isWhitespace(s));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(41===s)return t.step(),_.done(i.attr(r.bind()));o||(o=i.parseBlock(t)),n=5}}if(5===n){for(o=o;o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())n=6;else if(o.isError())return o.asError()}if(6===n){for(;!t.isEmpty()&&(s=t.head(),_.isWhitespace(s));)t.step();if(!t.isEmpty())return 41===s?(t.step(),_.done(i.attr(r.bind(),o.bind()))):_.expected(")",t);if(t.isDone())return _.unexpected(t)}return new e(i,r,o,n)},e}(_),Se=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.recon=e,s.builder=i,s.fieldParser=r,s.valueParser=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.fieldParser,this.valueParser,this.step)},e.parse=function(t,i,r,o,n,s){void 0===s&&(s=1);for(var a=0;;){if(1===s)if(t.isEmpty()){if(t.isDone())return r?_.done(r.bind()):_.done(i.extant())}else if(64===(a=t.head()))o=i.parseAttr(t),s=2;else if(123===a)r=r||i.recordBuilder(),n=i.parseRecord(t,r),s=5;else if(91===a)r=r||i.recordBuilder(),n=i.parseMarkup(t,r),s=5;else if(Xe.isIdentStartChar(a))n=i.parseIdent(t),s=4;else if(34===a||39===a)n=i.parseString(t),s=4;else if(45===a||a>=48&&a<=57)n=i.parseNumber(t),s=4;else if(37===a)n=i.parseData(t),s=4;else{if(36!==a)return r?_.done(r.bind()):_.done(i.extant());n=i.parseSelector(t),s=4}if(2===s){for(o=o;o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())(r=r||i.valueBuilder()).push(o.bind()),o=void 0,s=3;else if(o.isError())return o.asError()}if(3===s){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();if(!t.isEmpty()){s=1;continue}if(t.isDone())return _.done(r.bind())}if(4===s){for(n=n;n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())(r=r||i.valueBuilder()).push(i.item(n.bind())),n=void 0,s=6;else if(n.isError())return n.asError()}if(5===s){for(n=n;n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())n=void 0,s=6;else if(n.isError())return n.asError()}if(6===s){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();if(!t.isEmpty()){if(64===t.head()){s=1;continue}return _.done(r.bind())}if(t.isDone())return _.done(r.bind())}break}return new e(i,r,o,n,s)},e}(_),Ve=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.recon=e,s.builder=i,s.fieldParser=r,s.valueParser=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.fieldParser,this.valueParser,this.step)},e.parse=function(t,i,r,o,n,s){void 0===s&&(s=1);var a=0;if(1===s)if(t.isEmpty()){if(t.isDone())return r?_.done(r.bind()):_.done(i.extant())}else if(64===(a=t.head()))o=i.parseAttr(t),s=2;else if(123===a)r?(n=i.parseRecord(t,r),s=5):(n=i.parseRecord(t),s=4);else{if(91!==a)return r?_.done(r.bind()):_.done(i.extant());r?(n=i.parseMarkup(t,r),s=5):(n=i.parseMarkup(t),s=4)}if(2===s){for(o=o;o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())(r=r||i.valueBuilder()).push(o.bind()),o=void 0,s=3;else if(o.isError())return o.asError()}if(3===s)if(t.isEmpty()){if(t.isDone())return _.done(r.bind())}else if(123===(a=t.head()))n=i.parseRecord(t,r),s=5;else{if(91!==a)return _.done(r.bind());n=i.parseMarkup(t,r),s=5}if(4===s){for(n=n;n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())return(r=r||i.valueBuilder()).push(i.item(n.bind())),_.done(r.bind());if(n.isError())return n.asError()}if(5===s){for(n=n;n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())return _.done(r.bind());if(n.isError())return n.asError()}return new e(i,r,o,n,s)},e}(_),De=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.recon=e,s.builder=i,s.keyParser=r,s.valueParser=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.keyParser,this.valueParser,this.step)},e.parse=function(t,i,r,o,n,s){void 0===s&&(s=1);var a=0;if(1===s)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(123!==(a=t.head()))return _.expected("{",t);t.step(),s=2}t:for(;;){if(2===s){for(;!t.isEmpty()&&(a=t.head(),_.isWhitespace(a));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(r=r||i.recordBuilder(),125===a)return t.step(),_.done(r.bind());35===a?(t.step(),s=8):s=3}}if(3===s){for(o||(o=i.parseBlockExpr(t));o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())s=4;else if(o.isError())return o.asError()}if(4===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else 58===a?(t.step(),s=5):(r.push(i.item(o.bind())),o=void 0,s=7)}if(5===s){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();if(t.isEmpty()){if(t.isDone())return r.push(i.slot(o.bind())),_.done(r.bind())}else s=6}if(6===s){for(n||(n=i.parseBlockExpr(t));n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())r.push(i.slot(o.bind(),n.bind())),o=void 0,n=void 0,s=7;else if(n.isError())return n.asError()}if(7===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(44===a||59===a||_.isNewline(a)){t.step(),s=2;continue}if(35!==a)return 125===a?(t.step(),_.done(r.bind())):_.expected('"}", ";", ",", or newline',t);t.step(),s=8}}if(8===s){for(;!t.isEmpty();){if(a=t.head(),_.isNewline(a)){s=2;continue t}t.step()}if(t.isDone()){s=2;continue}}break}return new e(i,r,o,n,s)},e}(_),Me=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.recon=e,s.builder=i,s.textOutput=r,s.valueParser=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.textOutput,this.valueParser,this.step)},e.parse=function(t,i,r,o,n,s){void 0===s&&(s=1);var a=0;if(1===s)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(91!==(a=t.head()))return _.expected("[",t);t.step(),s=2}for(;;){if(2===s){for(;!t.isEmpty()&&(64!==(a=t.head())&&91!==a&&92!==a&&93!==a&&123!==a&&125!==a);)t.step(),(o=o||i.textOutput()).push(a);if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(93===a)return t.step(),r=r||i.recordBuilder(),o&&r.push(i.item(o.bind())),_.done(r.bind());if(64===a)r=r||i.recordBuilder(),o&&(r.push(i.item(o.bind())),o=void 0),n=i.parseInlineValue(t),s=3;else if(123===a)r=r||i.recordBuilder(),o&&(r.push(i.item(o.bind())),o=void 0),n=i.parseRecord(t,r),s=4;else if(91===a)r=r||i.recordBuilder(),o&&(r.push(i.item(o.bind())),o=void 0),n=i.parseMarkup(t,r),s=4;else{if(92!==a)return _.unexpected(t);t.step(),s=5}}}if(3===s){for(n=n;n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone()){r.push(i.item(n.bind())),n=void 0,s=2;continue}if(n.isError())return n.asError()}if(4===s){for(n=n;n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone()){n=void 0,s=2;continue}if(n.isError())return n.asError()}if(5===s){if(!t.isEmpty()){if(a=t.head(),o=o||i.textOutput(),34===a||36===a||39===a||47===a||64===a||91===a||92===a||93===a||123===a||125===a)t.step(),o.push(a),s=2;else if(98===a)t.step(),o.push(8),s=2;else if(102===a)t.step(),o.push(12),s=2;else if(110===a)t.step(),o.push(10),s=2;else if(114===a)t.step(),o.push(13),s=2;else{if(116!==a)return _.expected("escape character",t);t.step(),o.push(9),s=2}continue}if(t.isDone())return _.unexpected(t)}break}return new e(i,r,o,n,s)},e}(_),Re=function(t){function e(e,i,r,o,n,s){var a=t.call(this)||this;return a.recon=e,a.dataOutput=i,a.p=r,a.q=o,a.r=n,a.step=s,a}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.dataOutput,this.p,this.q,this.r,this.step)},e.parse=function(t,i,r,o,n,s,a){void 0===o&&(o=0),void 0===n&&(n=0),void 0===s&&(s=0),void 0===a&&(a=1);var u=0;if(1===a)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(37!==(u=t.head()))return _.expected("%",t);t.step(),r=r||i.dataOutput(),a=2}for(;;){if(2===a)if(t.isEmpty()){if(t.isDone())return _.done(r.bind())}else{if(u=t.head(),!_.isBase64Char(u))return _.done(r.bind());t.step(),o=u,a=3}if(3===a)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(u=t.head(),!_.isBase64Char(u))return _.expected("base64 digit",t);t.step(),n=u,a=4}if(4===a)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(u=t.head(),!_.isBase64Char(u)&&61!==u)return _.expected("base64 digit",t);t.step(),s=u,a=61!==u?5:6}if(5===a){if(!t.isEmpty()){if(u=t.head(),_.isBase64Char(u)||61===u){if(t.step(),e.decodeBase64Quantum(o,n,s,u,r),s=0,n=0,o=0,61!==u){a=2;continue}return _.done(r.bind())}return _.expected("base64 digit",t)}if(t.isDone())return _.unexpected(t)}else if(6===a){if(!t.isEmpty())return 61===(u=t.head())?(t.step(),e.decodeBase64Quantum(o,n,s,u,r),s=0,n=0,o=0,_.done(r.bind())):_.expected("=",t);if(t.isDone())return _.unexpected(t)}break}return new e(i,r,o,n,s,a)},e.parseBase64=function(t,i){return e.parse(t,i,i.dataOutput(),void 0,void 0,void 0,2)},e.decodeBase64Quantum=function(t,e,i,r,o){var n=_.decodeBase64Digit(t),s=_.decodeBase64Digit(e);if(61!==i){var a=_.decodeBase64Digit(i);if(61!==r){var u=_.decodeBase64Digit(r);o.push(n<<2|s>>>4,s<<4|a>>>2,a<<6|u)}else o.push(n<<2|s>>>4,s<<4|a>>>2)}else{if(61!==r)throw"incomplete base64 quantum";o.push(n<<2|s>>>4)}},e}(_),Te=function(t){function e(e,i,r){var o=t.call(this)||this;return o.lang=e,o.output=i,o.step=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.lang,this.output,this.step)},e.parse=function(t,i,r,o){void 0===o&&(o=1);var n=0;if(1===o)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(n=t.head(),!Xe.isIdentStartChar(n))return _.expected("identifier",t);t.step(),(r=r||i.textOutput()).push(n),o=2}if(2===o){for(;!t.isEmpty()&&(n=t.head(),Xe.isIdentChar(n));)t.step(),r.push(n);if(!t.isEmpty()||t.isDone())return _.done(i.ident(r.bind()))}return new e(i,r,o)},e}(_),Pe=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.lang=e,s.output=i,s.quote=r,s.code=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.lang,this.output,this.quote,this.code,this.step)},e.parse=function(t,i,r,o,n,s){void 0===o&&(o=0),void 0===n&&(n=0),void 0===s&&(s=1);var a=0;if(1===s){for(;!t.isEmpty()&&(a=t.head(),_.isWhitespace(a));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(34!==a&&(39!==a||o!==a&&0!==o))return _.expected("string",t);t.step(),r=r||i.textOutput(),o=a,s=2}}t:for(;;){if(r=r,2===s){for(;!t.isEmpty()&&((a=t.head())!==o&&92!==a);)t.step(),r.push(a);if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(a===o)return t.step(),_.done(r.bind());if(92!==a)return _.unexpected(t);t.step(),s=3}}if(3===s)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(34===(a=t.head())||36===a||39===a||47===a||64===a||91===a||92===a||93===a||123===a||125===a){t.step(),r.push(a),s=2;continue}if(98===a){t.step(),r.push(8),s=2;continue}if(102===a){t.step(),r.push(12),s=2;continue}if(110===a){t.step(),r.push(10),s=2;continue}if(114===a){t.step(),r.push(13),s=2;continue}if(116===a){t.step(),r.push(9),s=2;continue}if(117!==a)return _.expected("escape character",t);t.step(),s=4}if(s>=4)for(;;){if(!t.isEmpty()){if(a=t.head(),_.isHexChar(a)){if(t.step(),n=16*n+_.decodeHexChar(a),s<=6){s+=1;continue}r.push(n),n=0,s=2;continue t}return _.expected("hex digit",t)}if(t.isDone())return _.unexpected(t);break}break}return new e(i,r,o,n,s)},e}(_),Le=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.lang=e,s.sign=i,s.value=r,s.mode=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.lang,this.sign,this.value,this.mode,this.step)},e.parse=function(t,i,r,o,n,s){void 0===r&&(r=1),void 0===o&&(o=0),void 0===n&&(n=2),void 0===s&&(s=1);var a=0;if(1===s){for(;!t.isEmpty()&&(a=t.head(),_.isWhitespace(a));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else 45===a&&(t.step(),r=-1),s=2}if(2===s)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else if(48===(a=t.head()))t.step(),s=4;else{if(!(a>=49&&a<=57))return _.expected("digit",t);t.step(),o=r*(a-48),s=3}if(3===s){for(;!t.isEmpty()&&((a=t.head())>=48&&a<=57);)t.step(),o=10*o+r*(a-48);if(t.isEmpty()){if(t.isDone())return _.done(i.number(o))}else s=4}if(4===s){if(!t.isEmpty()){if(a=t.head(),n>0&&(46===a||69===a||101===a)){var u=new g;return r<0&&0===o?u.push(45,48):u.push(o.toString()),Fe.parse(t,i,u,n)}return 120===a&&r>0&&0===o?(t.step(),ze.parse(t,i)):_.done(i.number(o))}if(t.isDone())return _.done(i.number(o))}return new e(i,r,o,n,s)},e.parseInteger=function(t,e){return this.parse(t,e,void 0,void 0,0)},e.parseDecimal=function(t,e){return this.parse(t,e,void 0,void 0,1)},e}(_),Fe=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.lang=e,n.output=i,n.mode=r,n.step=o,n}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.lang,this.output,this.mode,this.step)},e.parse=function(t,i,r,o,n){void 0===o&&(o=2),void 0===n&&(n=1);var s=0;if(1===n)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else if(46===(s=t.head()))t.step(),r.push(s),n=2;else{if(!(o>1)||69!==s&&101!==s)return _.expected("fraction or exponent",t);t.step(),r.push(s),n=5}if(2===n)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(!((s=t.head())>=48&&s<=57))return _.expected("digit",t);t.step(),r.push(s),n=3}if(3===n){for(;!t.isEmpty()&&((s=t.head())>=48&&s<=57);)t.step(),r.push(s);if(t.isEmpty()){if(t.isDone())return _.done(i.number(r.bind()))}else{if(!(o>1))return _.done(i.number(r.bind()));n=4}}if(4===n){if(69!==(s=t.head())&&101!==s)return _.done(i.number(r.bind()));t.step(),r.push(s),n=5}if(5===n)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else 43!==(s=t.head())&&45!==s||(t.step(),r.push(s)),n=6;if(6===n)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(!((s=t.head())>=48&&s<=57))return _.expected("digit",t);t.step(),r.push(s),n=7}if(7===n){for(;!t.isEmpty()&&((s=t.head())>=48&&s<=57);)t.step(),r.push(s);if(!t.isEmpty()||t.isDone())return _.done(i.number(r.bind()))}return new e(i,r,o,n)},e}(_),ze=function(t){function e(e,i,r){var o=t.call(this)||this;return o.lang=e,o.value=i,o.size=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.lang,this.value,this.size)},e.parse=function(t,i,r,o){void 0===r&&(r=0),void 0===o&&(o=0);for(var n=0;!t.isEmpty()&&(n=t.head(),_.isHexChar(n));)t.step(),r=16*r+_.decodeHexChar(n),o+=1;return!t.isEmpty()||t.isDone()?o>0?_.done(i.number(r)):_.expected("hex number",t):new e(i,r,o)},e}(_),Ie=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.recon=e,s.builder=i,s.selector=r,s.valueParser=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.selector,this.valueParser,this.step)},e.parse=function(t,i,r,o,n,s){void 0===o&&(o=i.selector()),void 0===s&&(s=1);var a=0;if(1===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()||36!==a){if(t.isDone())return _.unexpected(t)}else t.step(),s=2}if(2===s)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else 91===(a=t.head())?(t.step(),s=7):64===a?(t.step(),s=6):42===a?(t.step(),s=5):35===a?(t.step(),s=4):s=3;for(;;){if(3===s){for(n||(n=i.parseLiteral(t,i.valueBuilder()));n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())o=i.get(o,n.bind()),n=void 0,s=9;else if(n.isError())return n.asError()}if(4===s){for(n||(n=i.parseInteger(t));n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())o=i.value(i.getItem(o,n.bind())),n=void 0,s=9;else if(n.isError())return n.asError()}if(5===s&&(t.isEmpty()?t.isDone()&&(o=i.children(o),s=9):(58===(a=t.head())?(t.step(),o=i.keys(o)):42===a?(t.step(),o=i.descendants(o)):o=i.children(o),s=9)),6===s){for(n||(n=i.parseIdent(t));n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())o=i.getAttr(o,n.bind()),n=void 0,s=9;else if(n.isError())return n.asError()}if(7===s){for(n||(n=i.parseBlockExpr(t));n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())s=8;else if(n.isError())return n.asError()}if(8===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(93!==a)return _.expected("]",t);t.step(),o=i.filter(o,n.bind()),n=void 0,s=9}}if(9===s)if(t.isEmpty()){if(t.isDone())return r?(r.push(i.item(o)),_.done(r.bind())):_.done(o)}else{if(91===(a=t.head())){t.step(),s=7;continue}if(42===a){t.step(),s=5;continue}if(35===a){t.step(),s=4;continue}if(46!==a)return r?(r.push(i.item(o)),_.done(r.bind())):_.done(o);t.step(),s=10}if(10===s)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(64!==(a=t.head())){if(42===a){t.step(),s=5;continue}s=3;continue}t.step(),s=6}break}return new e(i,r,o,n,s)},e}(_),Ue=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.recon=e,n.builder=i,n.valueParser=r,n.step=o,n}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.valueParser,this.step)},e.parse=function(t,i,r,o,n){void 0===n&&(n=1);var s=0;if(1===n){for(;!t.isEmpty()&&(s=t.head(),_.isSpace(s));)t.step();if(t.isEmpty()){if(t.isDone())return r?_.done(r.bind()):_.done(i.extant())}else if(40===s)t.step(),n=5;else if(123===s)r=r||i.recordBuilder(),o=i.parseRecord(t,r),n=4;else if(91===s)r=r||i.recordBuilder(),o=i.parseMarkup(t,r),n=4;else if(Xe.isIdentStartChar(s))o=i.parseIdent(t),n=2;else if(34===s||39===s)o=i.parseString(t),n=2;else if(45===s||s>=48&&s<=57)o=i.parseNumber(t),n=2;else if(37===s)o=i.parseData(t),n=2;else{if(36!==s)return r?_.done(r.bind()):_.done(i.extant());o=i.parseSelector(t),n=2}}if(2===n){for(o=o;o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())return(r=r||i.valueBuilder()).push(i.item(o.bind())),_.done(r.bind());if(o.isError())return o.asError()}if(4===n){for(o=o;o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())return _.done(r.bind());if(o.isError())return o.asError()}if(5===n){for(o||(o=i.parseBlockExpr(t));o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())n=6;else if(o.isError())return o.asError()}if(6===n){for(;!t.isEmpty()&&(s=t.head(),_.isSpace(s));)t.step();if(!t.isEmpty())return 41===s?(t.step(),(r=r||i.valueBuilder()).push(i.item(o.bind())),_.done(r.bind())):_.expected(")",t);if(t.isDone())return _.unexpected(t)}return new e(i,r,o,n)},e}(_),We=function(t){function e(e,i,r,o,n,s){var a=t.call(this)||this;return a.recon=e,a.builder=i,a.predParser=r,a.thenParser=o,a.elseParser=n,a.step=s,a}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.predParser,this.thenParser,this.elseParser,this.step)},e.parse=function(t,i,r,o,n,s,a){void 0===a&&(a=1);var u=0;if(1===a){for(o||(o=i.parseOrExpr(t,r));o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())a=2;else if(o.isError())return o.asError()}if(2===a){for(;!t.isEmpty()&&(u=t.head(),_.isSpace(u));)t.step();if(t.isEmpty()){if(t.isDone())return o}else{if(63!==u)return o;t.step(),a=3}}if(3===a){for(n||(n=i.parseCondExpr(t,r));n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())a=4;else if(n.isError())return n.asError()}if(4===a){for(;!t.isEmpty()&&(u=t.head(),_.isSpace(u));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(58!==u)return _.expected(":",t);t.step(),a=5}}if(5===a){for(s||(s=i.parseCondExpr(t,r));s.isCont()&&(!t.isEmpty()||t.isDone());)s=s.feed(t);if(s.isDone()){var h=o.bind(),l=n.bind(),p=s.bind();return _.done(i.cond(h,l,p))}if(s.isError())return s.asError()}return new e(i,r,o,n,s,a)},e}(_),Oe=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.recon=e,s.builder=i,s.lhsParser=r,s.rhsParser=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)},e.parse=function(t,i,r,o,n,s){void 0===s&&(s=1);for(var a=0;;){if(1===s){for(o||(o=i.parseAndExpr(t,r));o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())s=2;else if(o.isError())return o.asError()}if(2===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()){if(t.isDone())return o}else{if(124!==a)return o;t.step(),s=3}}if(3===s)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(124!==(a=t.head()))return _.expected("|",t);t.step(),s=4}if(4===s){for(n||(n=i.parseAndExpr(t,r));n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone()){var u=o.bind(),h=n.bind();o=_.done(i.or(u,h)),n=void 0,s=2;continue}if(n.isError())return n.asError()}break}return new e(i,r,o,n,s)},e}(_),Be=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.recon=e,s.builder=i,s.lhsParser=r,s.rhsParser=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.lhsParser,this.rhsParser,this.step)},e.parse=function(t,i,r,o,n,s){void 0===s&&(s=1);for(var a=0;;){if(1===s){for(o||(o=i.parseCompExpr(t,r));o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())s=2;else if(o.isError())return o.asError()}if(2===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()){if(t.isDone())return o}else{if(38!==a)return o;t.step(),s=3}}if(3===s)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(38!==(a=t.head()))return _.expected("&",t);t.step(),s=4}if(4===s){for(n||(n=i.parseCompExpr(t,r));n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone()){var u=o.bind(),h=n.bind();o=_.done(i.and(u,h)),n=void 0,s=2;continue}if(n.isError())return n.asError()}break}return new e(i,r,o,n,s)},e}(_),qe=function(t){function e(e,i,r,o,n,s){var a=t.call(this)||this;return a.recon=e,a.builder=i,a.lhsParser=r,a.operator=o,a.rhsParser=n,a.step=s,a}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.lhsParser,this.operator,this.rhsParser,this.step)},e.parse=function(t,i,r,o,n,s,a){void 0===a&&(a=1);var u=0;if(1===a){for(o||(o=i.parseAttrExpr(t,r));o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())a=2;else if(o.isError())return o.asError()}if(2===a){for(;!t.isEmpty()&&(u=t.head(),_.isSpace(u));)t.step();if(t.isEmpty()){if(t.isDone())return o}else if(33===u)t.step(),a=3;else if(60===u)t.step(),a=4;else if(62===u)t.step(),a=5;else{if(61!==u)return o;t.step(),a=6}}if(3===a)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else 61===(u=t.head())?(t.step(),n="!=",a=7):(n="!",a=7);if(4===a)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else 61===(u=t.head())?(t.step(),n="<=",a=7):(n="<",a=7);if(5===a)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else 61===(u=t.head())?(t.step(),n=">=",a=7):(n=">",a=7);if(6===a)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else 61===(u=t.head())?(t.step(),n="==",a=7):(n="=",a=7);if(7===a){for(s||(s=i.parseAttrExpr(t,r));s.isCont()&&(!t.isEmpty()||t.isDone());)s=s.feed(t);if(s.isDone()){var h=o.bind(),l=s.bind();return"<"===n?_.done(i.lt(h,l)):"<="===n?_.done(i.le(h,l)):"=="===n?_.done(i.eq(h,l)):"!="===n?_.done(i.ne(h,l)):">="===n?_.done(i.ge(h,l)):">"===n?_.done(i.gt(h,l)):_.error(n)}if(s.isError())return s.asError()}return new e(i,r,o,n,s,a)},e}(_),Ge=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.recon=e,s.builder=i,s.fieldParser=r,s.valueParser=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.fieldParser,this.valueParser,this.step)},e.parse=function(t,i,r,o,n,s){void 0===s&&(s=1);for(var a=0;;){if(1===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()){if(t.isDone())return r?_.done(r.bind()):_.done(i.extant())}else if(64===a)s=2;else if(123===a||91===a)r=r||i.recordBuilder(),s=5;else{if(!(33===a||34===a||36===a||37===a||39===a||40===a||45===a||a>=48&&a<=57||Xe.isIdentStartChar(a)))return r?_.done(r.bind()):_.done(i.extant());s=4}}if(2===s){for(o||(o=i.parseAttr(t));o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())(r=r||i.valueBuilder()).push(o.bind()),o=void 0,s=3;else if(o.isError())return o.asError()}if(3===s){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();if(!t.isEmpty()){s=1;continue}if(t.isDone())return _.done(r.bind())}if(4===s){for(n||(n=i.parseAddRingExpr(t));n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())(r=r||i.valueBuilder()).push(i.item(n.bind())),n=void 0,s=6;else if(n.isError())return n.asError()}if(5===s){for(n||(n=i.parseAddRingExpr(t,r));n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())n=void 0,s=6;else if(n.isError())return n.asError()}if(6===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(!t.isEmpty()){if(64===a){s=1;continue}return _.done(r.bind())}if(t.isDone())return _.done(r.bind())}break}return new e(i,r,o,n,s)},e}(_),He=function(t){function e(e,i,r,o,n,s){var a=t.call(this)||this;return a.recon=e,a.builder=i,a.lhsParser=r,a.operator=o,a.rhsParser=n,a.step=s,a}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.lhsParser,this.operator,this.rhsParser,this.step)},e.parse=function(t,i,r,o,n,s,a){void 0===a&&(a=1);for(var u=0;;){if(1===a){for(o||(o=i.parseMulRingExpr(t,r));o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())a=2;else if(o.isError())return o.asError()}if(2===a){for(;!t.isEmpty()&&(u=t.head(),_.isSpace(u));)t.step();if(t.isEmpty()){if(t.isDone())return o}else if(43===u)t.step(),n="+",a=3;else{if(45!==u)return o;t.step(),n="-",a=3}}if(3===a){for(s||(s=i.parseMulRingExpr(t,r));s.isCont()&&(!t.isEmpty()||t.isDone());)s=s.feed(t);if(s.isDone()){var h=o.bind(),l=s.bind();if("+"===n)o=_.done(i.add(h,l));else{if("-"!==n)return _.error(n);o=_.done(i.sub(h,l))}s=void 0,n=void 0,a=2;continue}if(s.isError())return s.asError()}break}return new e(i,r,o,n,s,a)},e}(_),Ne=function(t){function e(e,i,r,o,n,s){var a=t.call(this)||this;return a.recon=e,a.builder=i,a.lhsParser=r,a.operator=o,a.rhsParser=n,a.step=s,a}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.lhsParser,this.operator,this.rhsParser,this.step)},e.parse=function(t,i,r,o,n,s,a){void 0===a&&(a=1);for(var u=0;;){if(1===a){for(o||(o=i.parsePrefixExpr(t,r));o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())a=2;else if(o.isError())return o.asError()}if(2===a){for(;!t.isEmpty()&&(u=t.head(),_.isSpace(u));)t.step();if(t.isEmpty()){if(t.isDone())return o}else if(42===u)t.step(),n="*",a=3;else if(47===u)t.step(),n="/",a=3;else{if(37!==u)return o;t.step(),n="%",a=3}}if(3===a){for(s||(s=i.parsePrefixExpr(t,r));s.isCont()&&(!t.isEmpty()||t.isDone());)s=s.feed(t);if(s.isDone()){var h=o.bind(),l=s.bind();if("*"===n)o=_.done(i.mul(h,l));else if("/"===n)o=_.done(i.div(h,l));else{if("%"!==n)return _.error(n);o=_.done(i.mod(h,l))}s=void 0,n=void 0,a=2;continue}if(s.isError())return s.asError()}break}return new e(i,r,o,n,s,a)},e}(_),je=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.recon=e,s.builder=i,s.operator=r,s.rhsParser=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.operator,this.rhsParser,this.step)},e.parse=function(t,i,r,o,n,s){void 0===s&&(s=1);var a=0;if(1===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()){if(t.isDone())return i.parsePrimaryExpr(t,r)}else{if(33===a)t.step(),o="!";else{if(45!==a)return i.parsePrimaryExpr(t,r);t.step(),o="-"}s=2}}if(2===s){for(n||(n=i.parsePrefixExpr(t,r));n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone()){var u=n.bind();return i.isDistinct(u)?"!"===o?_.done(i.not(u)):"-"===o?_.done(i.neg(u)):_.error(o):_.expected("value",t)}if(n.isError())return n.asError()}return new e(i,r,o,n,s)},e}(_),Ye=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.recon=e,s.builder=i,s.exprParser=r,s.argsParser=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.recon,this.builder,this.exprParser,this.argsParser,this.step)},e.parse=function(t,i,r,o,n,s){void 0===s&&(s=1);var a=0;if(1===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();t.isEmpty()?t.isDone()&&(s=2):40===a?(t.step(),s=3):s=2}if(2===s){for(o||(o=i.parseLiteral(t,r));o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())s=5;else if(o.isError())return o.asError()}if(3===s){for(o||(o=i.parseBlockExpr(t));o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())s=4;else if(o.isError())return o.asError()}if(4===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(41!==a)return _.expected(")",t);t.step(),s=5}}for(;;){if(5===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()){if(t.isDone())return o}else{if(40!==a)return o;t.step(),s=6}}if(6===s){for(;!t.isEmpty()&&(a=t.head(),_.isWhitespace(a));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(41===a){t.step();var u=o.bind();o=_.done(i.invoke(u,i.extant())),s=5;continue}s=7}}if(7===s){for(n||(n=i.parseBlock(t));n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())s=8;else if(n.isError())return n.asError()}if(8===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(!t.isEmpty()){if(41===a){t.step();u=o.bind();var h=n.bind();o=_.done(i.invoke(u,h)),n=void 0,s=5;continue}return _.expected(")",t)}if(t.isDone())return _.unexpected(t)}break}return new e(i,r,o,n,s)},e}(_),Xe=function(){function t(){}return t.prototype.parseRecon=function(t){for("string"==typeof t&&(t=new v(t));!t.isEmpty()&&_.isWhitespace(t.head());)t.step();var e=this.parseBlock(t);if(e.isDone()){for(;!t.isEmpty()&&_.isWhitespace(t.head());)t.step();t.isEmpty()||(e=_.unexpected(t))}return e.bind()},t.prototype.parseAttr=function(t){return Ce.parse(t,this)},t.prototype.parseBlock=function(t){return Ee.parse(t,this)},t.prototype.parseBlockValue=function(t){return Se.parse(t,this)},t.prototype.parseInlineValue=function(t){return Ve.parse(t,this)},t.prototype.parseRecord=function(t,e){return De.parse(t,this,e)},t.prototype.parseMarkup=function(t,e){return Me.parse(t,this,e)},t.prototype.parseData=function(t){return Re.parse(t,this)},t.prototype.parseBase64=function(t){return Re.parseBase64(t,this)},t.prototype.parseIdent=function(t){return Te.parse(t,this)},t.prototype.parseString=function(t){return Pe.parse(t,this)},t.prototype.parseNumber=function(t){return Le.parse(t,this)},t.prototype.parseInteger=function(t){return Le.parseInteger(t,this)},t.prototype.parseDecimal=function(t){return Le.parseDecimal(t,this)},t.prototype.parseBlockExpr=function(t,e){return this.parseCondExpr(t,e)},t.prototype.parseCondExpr=function(t,e){return We.parse(t,this,e)},t.prototype.parseOrExpr=function(t,e){return Oe.parse(t,this,e)},t.prototype.parseAndExpr=function(t,e){return Be.parse(t,this,e)},t.prototype.parseCompExpr=function(t,e){return qe.parse(t,this,e)},t.prototype.parseAttrExpr=function(t,e){return Ge.parse(t,this,e)},t.prototype.parseAddRingExpr=function(t,e){return He.parse(t,this,e)},t.prototype.parseMulRingExpr=function(t,e){return Ne.parse(t,this,e)},t.prototype.parsePrefixExpr=function(t,e){return je.parse(t,this,e)},t.prototype.parsePrimaryExpr=function(t,e){return Ye.parse(t,this,e)},t.prototype.parseLiteral=function(t,e){return Ue.parse(t,this,e)},t.prototype.parseSelector=function(t,e){return Ie.parse(t,this,e)},t.prototype.blockParser=function(){return new Ee(this)},t.isIdentStartChar=function(t){return t>=65&&t<=90||95===t||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039},t.isIdentChar=function(t){return 45===t||t>=48&&t<=57||t>=65&&t<=90||95===t||t>=97&&t<=122||183===t||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8255&&t<=8256||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039},t.Factory=void 0,t}();w.Recon=Xe;var Ke=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.isDistinct=function(t){return t.isDistinct()},e.prototype.item=function(t){return t},e.prototype.value=function(t){return t.toValue()},e.prototype.attr=function(t,e){return new R(t,e)},e.prototype.slot=function(t,e){return new T(t,e)},e.prototype.valueBuilder=function(){return new ke},e.prototype.recordBuilder=function(){return L.empty()},e.prototype.dataOutput=function(){return k.empty()},e.prototype.textOutput=function(){return I.empty()},e.prototype.ident=function(t){if(t instanceof I){if("true"===t.value)return W.True;if("false"===t.value)return W.False}return t},e.prototype.number=function(t){if("number"==typeof t)return U.valueOf(t);if("string"==typeof t)return U.valueOf(+t);throw new TypeError(""+t)},e.prototype.boolean=function(t){return W.valueOf(t)},e.prototype.selector=function(){return B.Identity},e.prototype.extant=function(){return b.Extant},e.prototype.absent=function(){return b.Absent},e.prototype.cond=function(t,e,i){return t.cond(e,i)},e.prototype.or=function(t,e){return t.or(e)},e.prototype.and=function(t,e){return t.and(e)},e.prototype.not=function(t){return t.not()},e.prototype.lt=function(t,e){return t.lt(e)},e.prototype.le=function(t,e){return t.le(e)},e.prototype.eq=function(t,e){return t.eq(e)},e.prototype.ne=function(t,e){return t.ne(e)},e.prototype.ge=function(t,e){return t.ge(e)},e.prototype.gt=function(t,e){return t.gt(e)},e.prototype.add=function(t,e){return t.plus(e)},e.prototype.sub=function(t,e){return t.minus(e)},e.prototype.neg=function(t){return t.opposite()},e.prototype.mul=function(t,e){return t.times(e)},e.prototype.div=function(t,e){return t.divide(e)},e.prototype.mod=function(t,e){return t.modulo(e)},e.prototype.invoke=function(t,e){return B.literal(t).invoke(e)},e.prototype.get=function(t,e){return t.get(e)},e.prototype.getAttr=function(t,e){return t.getAttr(I.of(e))},e.prototype.getItem=function(t,e){return t.getItem(U.of(e))},e.prototype.children=function(t){return B.literal(t).children()},e.prototype.descendants=function(t){return B.literal(t).descendants()},e.prototype.keys=function(t){return B.literal(t).keys()},e.prototype.filter=function(t,e){return t.filter(e)},e}(Xe);Xe.Factory=new Ke;var Qe=function(t){function e(e){void 0===e&&(e=L.empty());var i=t.call(this)||this;return i._record=e,i}return u(e,t),Object.defineProperty(e.prototype,"record",{get:function(){return this._record},set:function(t){this._record=t,t.forEach(function(t,e){this.didChange(t,w.Absent,e)},this)},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){var t;return this._record.isEmpty()&&(!(t=this.parentScope)||t.isEmpty())},e.prototype.isArray=function(){var t;return this._record.isArray()&&(!(t=this.parentScope)||t.isArray())},e.prototype.isObject=function(){var t;return this._record.isObject()&&(!(t=this.parentScope)||t.isObject())},Object.defineProperty(e.prototype,"length",{get:function(){var t;return this._record.length+((t=this.parentScope)?t.length:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var t;return this._record.size+((t=this.parentScope)?t.size:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fieldCount",{get:function(){var t;return this._record.fieldCount+((t=this.parentScope)?t.fieldCount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueCount",{get:function(){var t;return this._record.valueCount+((t=this.parentScope)?t.valueCount:0)},enumerable:!0,configurable:!0}),e.prototype.has=function(t){var e;return t=b.of(t),this._record.has(t)||!!(e=this.parentScope)&&e.has(t)},e.prototype.get=function(t){t=b.of(t);var e,i=this._record.get(t);return!i.isDefined()&&(e=this.parentScope)&&(i=e.get(t)),i},e.prototype.getAttr=function(t){t=I.of(t);var e,i=this._record.getAttr(t);return!i.isDefined()&&(e=this.parentScope)&&(i=e.getAttr(t)),i},e.prototype.getField=function(t){t=b.of(t);var e,i=this._record.getField(t);return void 0===i&&(e=this.parentScope)&&(i=e.getField(t)),i},e.prototype.getItem=function(t){t instanceof U&&(t=t.value),t<0&&(t=this.length+t),t=Math.max(0,t);var e,i=this._record.length;return t<i?this._record.getItem(t):(e=this.parentScope)&&t<i+e.length?e.getItem(t-i):w.Absent},e.prototype.set=function(t,e){var i,r=this._record.getField(t);if(void 0!==r){this._record.set(t,e);var o=this._record.getField(t);this.didChange(o,r)}else if((i=this.parentScope)&&i.get(t).isDefined())i.set(t,e);else{this._record.set(t,e);o=this._record.getField(t);this.didChange(o,w.Absent)}return this},e.prototype.setAttr=function(t,e){var i,r=this._record.getField(t);if(void 0!==r&&r instanceof R){this._record.set(t,e);var o=this._record.getField(t);this.didChange(o,r)}else if((i=this.parentScope)&&i.getAttr(t).isDefined())i.set(t,e);else{this._record.set(t,e);o=this._record.getField(t);this.didChange(o,w.Absent)}return this},e.prototype.setItem=function(t,e){t instanceof U&&(t=t.value),t<0&&(t=this.length+t),t=Math.max(0,t);var i,r=this._record.length;if(t<r){var o=this._record.getItem(t);this._record.setItem(t,e);var n=this._record.getItem(t);this.didChange(n,o,t)}else(i=this.parentScope)&&t<r+i.length&&i.setItem(t-r,e);return this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=this._record.length,r=this._record.push.apply(this._record,arguments);i<r;){var o=this._record.get(i);this.didChange(o,w.Absent,i),i+=1}return r},e.prototype.splice=function(t,e){void 0===e&&(e=0);for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];t<0&&(t=this.length+t),t=Math.max(0,t);var o,n,s=this._record.length;if(e=Math.max(0,e),t<s){o=this._record.splice.apply(this._record,arguments);for(var a=0;a<o.length;a+=1)this.didChange(w.Absent,o[a],t+a);for(a=t;a<t+i.length;a+=1)this.didChange(this._record.get(a),w.Absent,a);if(t+e>s&&(n=this.parentScope)){var u=n.splice(s,t+e-s);o.push.apply(o,u)}}else(n=this.parentScope)&&(o=n.splice.apply(n,[t-s,e].concat(i)));return o},e.prototype.delete=function(t){var e,i=this._record.delete(t);return i.isDefined()?this.didChange(w.Absent,i):(e=this.parentScope)&&(i=e.delete(t)),i},e.prototype.clear=function(){var t=this._record.branch();this._record.clear(),t.forEach(function(t,e){this.didChange(w.Absent,t,e)},this);var e=this.parentScope;e&&e.clear()},e.prototype.withField=function(t,e){var i,r=this._record.getField(t);if(void 0!==r){this._record=this._record.withField(t,e);var o=this._record.getField(t);this.didChange(o,r)}else if((i=this.parentScope)&&i.has(t))i.set(t,e);else{this._record=this._record.withField(t,e);o=this._record.getField(t);this.didChange(o,w.Absent)}return this},e.prototype.withAttr=function(t,e){var i,r=this._record.getField(t);if(void 0!==r){this._record=this._record.withAttr(t,e);var o=this._record.getField(t);this.didChange(o,r)}else if((i=this.parentScope)&&i.has(t))i.set(t,e);else{this._record=this._record.withAttr(t,e);o=this._record.getField(t);this.didChange(o,w.Absent)}return this},e.prototype.withSlot=function(t,e){var i,r=this._record.getField(t);if(void 0!==r){this._record=this._record.withSlot(t,e);var o=this._record.getField(t);this.didChange(o,r)}else if((i=this.parentScope)&&i.has(t))i.set(t,e);else{this._record=this._record.withSlot(t,e);o=this._record.getField(t);this.didChange(o,w.Absent)}return this},e.prototype.forEach=function(t,e){var i=this._record.forEach(t,e);if(void 0===i){var r=this.parentScope;r&&(i=r.forEach(t,e))}return i},e.prototype.indexOf=function(t,e){void 0===e&&(e=0),e<0&&(e=this.length+e),e=Math.max(0,e);var i,r=this._record.length,o=-1;return e<r?(this._record.indexOf(t,e),e=0):e-=r,o<0&&(i=this.parentScope)&&(o=i.indexOf(t,e))>=0&&(o+=r),o},e.prototype.lastIndexOf=function(t,e){void 0===e&&(e=0),e<0&&(e=this.length+e),e=Math.max(0,e);var i,r=this._record.length,o=-1;return e>=r&&(i=this.parentScope)&&(o=i.lastIndexOf(t,e-r))>=0&&(o+=r),o<0&&(o=this._record.lastIndexOf(t,e)),o},e.prototype.isAliased=function(){return this._record.isAliased()},e.prototype.isMutable=function(){return this._record.isMutable()},e.prototype.alias=function(){this._record.alias();var t=this.parentScope;t&&t.alias()},e.prototype.branch=function(){return this._record=this._record.branch(),this},e.prototype.commit=function(){this._record.commit();var t=this.parentScope;return t&&t.commit(),this},e.prototype.didChange=function(t,e,i){},e.prototype.stack=function(){return D.of(w.GlobalScope,this)},e}(L),Ze=function(){function t(t){void 0===t&&(t=Je.Empty),this.root=t}return Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return this.root.isEmpty()},t.prototype.has=function(t){return this.root.has(t,this)},t.prototype.get=function(t){return this.root.get(t,this)},t.prototype.getEntry=function(t){return this.root.getEntry(t)},t.prototype.firstKey=function(){var t=this.root.firstEntry();return t?t[0]:void 0},t.prototype.firstValue=function(){var t=this.root.firstEntry();return t?t[1]:void 0},t.prototype.firstEntry=function(){return this.root.firstEntry()},t.prototype.lastKey=function(){var t=this.root.lastEntry();return t?t[0]:void 0},t.prototype.lastValue=function(){var t=this.root.lastEntry();return t?t[1]:void 0},t.prototype.lastEntry=function(){return this.root.lastEntry()},t.prototype.nextKey=function(t){var e=this.root.nextEntry(t,this);return e?e[0]:void 0},t.prototype.nextValue=function(t){var e=this.root.nextEntry(t,this);return e?e[1]:void 0},t.prototype.nextEntry=function(t){return this.root.nextEntry(t,this)},t.prototype.previousKey=function(t){var e=this.root.previousEntry(t,this);return e?e[0]:void 0},t.prototype.previousValue=function(t){var e=this.root.previousEntry(t,this);return e?e[1]:void 0},t.prototype.previousEntry=function(t){return this.root.previousEntry(t,this)},t.prototype.set=function(t,e){var i=this.root,r=this.root.updated(t,e,this);return i!==r&&(r.size>i.size&&(r=r.balanced(this)),this.root=r),this},t.prototype.delete=function(t){var e=this.root,i=this.root.removed(t,this);return e!==i&&(this.root=i,!0)},t.prototype.drop=function(t){return t>0&&this.root.size>0&&(t<this.root.size?this.root=this.root.drop(t,this):this.root=Je.Empty),this},t.prototype.take=function(t){return t<this.root.size&&this.root.size>0&&(this.root=t>0?this.root.take(t,this):Je.Empty),this},t.prototype.clear=function(){this.root=Je.Empty},t.prototype.updated=function(t,e){var i=this.root,r=i.updated(t,e,this);return i!==r?(r.size>i.size&&(r=r.balanced(this)),this.copy(r)):this},t.prototype.removed=function(t){var e=this.root,i=e.removed(t,this);return e!==i?this.copy(i):this},t.prototype.cleared=function(){return this.root.isEmpty()?this:this.copy(Je.Empty)},t.prototype.forEach=function(t,e){return this.root.forEach(t,e,this)},t.prototype.keys=function(){return this.root.keys()},t.prototype.values=function(){return this.root.values()},t.prototype.entries=function(){return this.root.entries()},t.prototype.reverseKeys=function(){return this.root.reverseKeys()},t.prototype.reverseValues=function(){return this.root.reverseValues()},t.prototype.reverseEntries=function(){return this.root.reverseEntries()},t.prototype.clone=function(){return this.copy(this.root)},t.prototype.copy=function(e){var i=new t(e);return i.compare!==this.compare&&(i.compare=this.compare),i.pageSplitSize!==this.pageSplitSize&&(i.pageSplitSize=this.pageSplitSize),i},t.prototype.toValue=function(){return this.root.toValue()},t.prototype.toRecon=function(){return this.toValue().toRecon()},t.prototype.compare=function(t,e){return V(t,e)},t.prototype.pageShouldSplit=function(t){return t.arity>this.pageSplitSize},t.prototype.pageShouldMerge=function(t){return t.arity<this.pageSplitSize>>>1},t}();Ze.prototype.pageSplitSize=32;var Je=function(){function t(){}return t.prototype.keys=function(){return new c(this.entries())},t.prototype.values=function(){return new d(this.entries())},t.prototype.reverseKeys=function(){return new c(this.reverseEntries())},t.prototype.reverseValues=function(){return new d(this.reverseEntries())},t.prototype.toRecon=function(){return this.toValue().toRecon()},t.Empty=void 0,t}(),$e=function(t){function e(e){var i=t.call(this)||this;return i.slots=e,i}return u(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this.slots.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.slots.length},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.slots.length},e.prototype.minKey=function(){return this.slots[0][0]},e.prototype.maxKey=function(){return this.slots[this.slots.length-1][0]},e.prototype.has=function(t,e){return this.lookup(t,e)>=0},e.prototype.get=function(t,e){var i=this.lookup(t,e);return i>=0?this.slots[i][1]:void 0},e.prototype.getEntry=function(t){return this.slots[t]},e.prototype.firstEntry=function(){return this.slots.length?this.slots[0]:void 0},e.prototype.lastEntry=function(){return this.slots.length?this.slots[this.slots.length-1]:void 0},e.prototype.nextEntry=function(t,e){var i=this.lookup(t,e);return i>=0?i+=1:i=-(i+1),this.slots[i]},e.prototype.previousEntry=function(t,e){var i=this.lookup(t,e);return i>=0?i-=1:i=-(i+2),this.slots[i]},e.prototype.updated=function(t,e,i){var r=this.lookup(t,i);return r>=0?this.updatedSlot(r,t,e):(r=-(r+1),this.insertedSlot(r,t,e))},e.prototype.updatedSlot=function(t,i,r){var o=this.slots;if(r!==o[t][1]){var n=o.slice(0);return n[t]=[i,r],new e(n)}return this},e.prototype.insertedSlot=function(t,i,r){for(var o=this.slots,n=new Array(o.length+1),s=0;s<t;s+=1)n[s]=o[s];n[t]=[i,r];for(s=t;s<o.length;s+=1)n[s+1]=o[s];return new e(n)},e.prototype.removed=function(t,e){var i=this.lookup(t,e);return i>=0?this.slots.length>1?this.removedSlot(i):Je.Empty:this},e.prototype.removedSlot=function(t){for(var i=this.slots,r=new Array(i.length-1),o=0;o<t;o+=1)r[o]=i[o];for(o=t;o<r.length;o+=1)r[o]=i[o+1];return new e(r)},e.prototype.drop=function(t,i){var r=this.slots;if(t>0&&r.length>0){if(t<r.length){for(var o=r.length-t,n=new Array(o),s=0;s<o;s+=1)n[s]=r[s+t];return new e(n)}return Je.Empty}return this},e.prototype.take=function(t,i){var r=this.slots;if(t<r.length&&r.length>0){if(t>0){for(var o=new Array(t),n=0;n<t;n+=1)o[n]=r[n];return new e(o)}return Je.Empty}return this},e.prototype.balanced=function(t){var e=this.slots.length;return e>1&&t.pageShouldSplit(this)?this.split(e>>>1):this},e.prototype.split=function(t){var e=new Array(2),i=this.splitLeft(t),r=this.splitRight(t);e[0]=i,e[1]=r;var o=new Array(1);return o[0]=r.minKey(),new ti(e,o,this.slots.length)},e.prototype.splitLeft=function(t){for(var i=this.slots,r=new Array(t),o=0;o<t;o+=1)r[o]=i[o];return new e(r)},e.prototype.splitRight=function(t){for(var i=this.slots,r=i.length-t,o=new Array(r),n=0;n<r;n+=1)o[n]=i[n+t];return new e(o)},e.prototype.forEach=function(t,e,i){for(var r=0;r<this.slots.length;r+=1){var o=this.slots[r],n=t.call(e,o[0],o[1],i);if(void 0!==n)return n}},e.prototype.entries=function(){return new f(this.slots)},e.prototype.reverseEntries=function(){return new f(this.slots,this.slots.length)},e.prototype.toValue=function(){var t=L.empty(1+this.slots.length);t.attr("bleaf",L.empty(1).slot("size",this.slots.length));for(var e=0;e<this.slots.length;e+=1){var i=this.slots[e];t.slot(b.fromAny(i[0]),b.fromAny(i[1]))}return t},e.prototype.lookup=function(t,e){for(var i=0,r=this.slots.length-1;i<=r;){var o=i+r>>>1,n=e.compare(t,this.slots[o][0]);if(n>0)i=o+1;else{if(!(n<0))return o;r=o-1}}return-(i+1)},e}(Je);Je.Empty=new $e([]);var ti=function(t){function e(e,i,r){var o=t.call(this)||this;return o.pages=e,o.knots=i,o.size=r,o}return u(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this.pages.length},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.size},e.prototype.minKey=function(){return this.pages[0].minKey()},e.prototype.maxKey=function(){return this.pages[this.pages.length-1].maxKey()},e.prototype.has=function(t,e){var i=this.lookup(t,e);if(i>0)i+=1;else{if(!(i<0))return!0;i=-(i+1)}return this.pages[i].has(t,e)},e.prototype.get=function(t,e){var i=this.lookup(t,e);return i>=0?i+=1:i=-(i+1),this.pages[i].get(t,e)},e.prototype.getEntry=function(t){for(var e=0;e<this.pages.length;e+=1){var i=this.pages[e];if(t<i.size)return i.getEntry(t);t-=i.size}},e.prototype.firstEntry=function(){return this.pages.length?this.pages[0].firstEntry():void 0},e.prototype.lastEntry=function(){return this.pages.length?this.pages[this.pages.length-1].lastEntry():void 0},e.prototype.nextEntry=function(t,e){var i=this.lookup(t,e);i>=0?i+=1:i=-(i+1);var r=this.pages[i].nextEntry(t,e);return void 0===r&&i+1<this.pages.length&&(r=this.pages[i+1].nextEntry(t,e)),r},e.prototype.previousEntry=function(t,e){var i=this.lookup(t,e);i>=0?i+=1:i=-(i+1);var r=this.pages[i].previousEntry(t,e);return void 0===r&&i>0&&(r=this.pages[i-1].previousEntry(t,e)),r},e.prototype.updated=function(t,e,i){var r=this.lookup(t,i);r>=0?r+=1:r=-(r+1);var o=this.pages[r],n=o.updated(t,e,i);return o!==n?o.size!==n.size&&i.pageShouldSplit(n)?this.updatedPageSplit(r,n,o):this.updatedPage(r,n,o):this},e.prototype.updatedPage=function(t,i,r){var o=this.pages.slice(0);o[t]=i;var n,s=this.knots;return s.length>0?(n=s.slice(0),t>0&&(n[t-1]=i.minKey())):n=[],new e(o,n,this.size-r.size+i.size)},e.prototype.updatedPageSplit=function(t,i,r){for(var o=this.pages,n=new Array(o.length+1),s=0;s<t;s+=1)n[s]=o[s];var a=i.splitLeft(i.arity>>>1),u=i.splitRight(i.arity>>>1);n[t]=a,n[t+1]=u;for(s=t+1;s<o.length;s+=1)n[s+1]=o[s];var h=this.knots,l=new Array(o.length);if(t>0){for(s=0;s<t-1;s+=1)l[s]=h[s];l[t-1]=a.minKey(),l[t]=u.minKey();for(s=t;s<h.length;s+=1)l[s+1]=h[s]}else{l[0]=u.minKey();for(s=0;s<h.length;s+=1)l[s+1]=h[s]}return new e(n,l,this.size-r.size+i.size)},e.prototype.updatedPageMerge=function(t,i,r){for(var o=this.pages,n=i.pages,s=new Array(o.length+n.length-1),a=0;a<t;a+=1)s[a]=o[a];for(a=0;a<n.length;a+=1)s[a+t]=n[a];for(a=t+1;a<o.length;a+=1)s[a+n.length-1]=o[a];var u=this.knots,h=i.knots,l=new Array(s.length-1);if(t>0){for(a=0;a<t-1;a+=1)l[a]=u[a];l[t-1]=n[0].minKey();for(a=0;a<h.length;a+=1)l[a+t]=h[a];for(a=t;a<u.length;a+=1)l[a+h.length]=u[a]}else{for(a=0;a<h.length;a+=1)l[a]=h[a];l[h.length]=o[1].minKey();for(a=1;a<u.length;a+=1)l[a+h.length]=u[a]}return new e(s,l,this.size-r.size+i.size)},e.prototype.removed=function(t,e){var i=this.lookup(t,e);i>=0?i+=1:i=-(i+1);var r=this.pages[i],o=r.removed(t,e);return r!==o?this.replacedPage(i,o,r,e):this},e.prototype.replacedPage=function(t,i,r,o){return i.isEmpty()?this.pages.length>2?this.removedPage(t,i,r):this.pages.length>1?0===t?this.pages[1]:this.pages[0]:Je.Empty:i instanceof e&&o.pageShouldMerge(i)?this.updatedPageMerge(t,i,r):this.updatedPage(t,i,r)},e.prototype.removedPage=function(t,i,r){for(var o=this.pages,n=new Array(o.length-1),s=0;s<t;s+=1)n[s]=o[s];for(s=t+1;s<o.length;s+=1)n[s-1]=o[s];var a=this.knots,u=new Array(a.length-1);if(t>0){for(s=0;s<t-1;s+=1)u[s]=a[s];for(s=t;s<a.length;s+=1)u[s-1]=a[s]}else for(s=1;s<a.length;s+=1)u[s-1]=a[s];return new e(n,u,this.size-r.size)},e.prototype.drop=function(t,i){if(t>0){var r=this.size;if(t<r){for(var o=this.pages,n=0;n<o.length;){var s=o[n].size;if(!(s<=t))break;r-=s,t-=s,n+=1}var a=o.length-n;if(a>1){var u=void 0;if(n>0){for(var h=new Array(a),l=0;l<a;l+=1)h[l]=o[l+n];var p=new Array(a-1);for(l=0;l<p.length;l+=1)p[l]=this.knots[l+n];u=new e(h,p,r)}else u=this;if(t>0){var c=o[n],d=c.drop(t,i);return u.replacedPage(0,d,c,i)}return u}return o[n].drop(t,i)}return Je.Empty}return this},e.prototype.take=function(t,i){if(t<this.size){if(t>0){for(var r=this.pages,o=0,n=0;n<r.length&&t>0;){var s=r[n].size;if(o+=s,n+=1,!(s<=t))break;t-=s}var a=0===t?n:n+1;if(a>1){var u=void 0;if(n<r.length){for(var h=new Array(a),l=0;l<a;l+=1)h[l]=r[l];var p=new Array(a-1);for(l=0;l<p.length;l+=1)p[l]=this.knots[l];u=new e(h,p,o)}else u=this;if(t>0){var c=r[n-1],d=c.take(t,i);return u.replacedPage(n-1,d,c,i)}return u}return t>0?r[0].take(t,i):r[0]}return Je.Empty}return this},e.prototype.balanced=function(t){return this.pages.length>1&&t.pageShouldSplit(this)?this.split(this.knots.length>>>1):this},e.prototype.split=function(t){var i=new Array(2),r=this.splitLeft(t),o=this.splitRight(t);i[0]=r,i[1]=o;var n=new Array(1);return n[0]=o.minKey(),new e(i,n,this.size)},e.prototype.splitLeft=function(t){for(var i=this.pages,r=new Array(t+1),o=0;o<t+1;o+=1)r[o]=i[o];var n=this.knots,s=new Array(t);for(o=0;o<t;o+=1)s[o]=n[o];var a=0;for(o=0;o<=t;o+=1)a+=r[o].size;return new e(r,s,a)},e.prototype.splitRight=function(t){for(var i=this.pages,r=i.length-(t+1),o=new Array(r),n=0;n<r;n+=1)o[n]=i[n+(t+1)];var s=this.knots,a=new Array(r-1);for(n=0;n<a.length;n+=1)a[n]=s[n+(t+1)];var u=0;for(n=0;n<r;n+=1)u+=o[n].size;return new e(o,a,u)},e.prototype.forEach=function(t,e,i){for(var r=0;r<this.pages.length;r+=1){var o=this.pages[r].forEach(t,e,i);if(void 0!==o)return o}},e.prototype.entries=function(){return new ei(this.pages)},e.prototype.reverseEntries=function(){return new ei(this.pages,this.size,this.pages.length)},e.prototype.toValue=function(){var t=L.empty(1+this.pages.length+this.knots.length);t.attr("bnode",L.empty(1).slot("size",this.size));for(var e=0;e<this.pages.length;e+=1){if(e>0){var i=b.fromAny(this.knots[e-1]);t.push(L.empty(1).attr("knot",L.empty(1).slot("key",i)))}t.push(this.pages[e].toValue())}return t},e.prototype.lookup=function(t,e){for(var i=0,r=this.knots.length-1;i<=r;){var o=i+r>>>1,n=e.compare(t,this.knots[o]);if(n>0)i=o+1;else{if(!(n<0))return o;r=o-1}}return-(i+1)},e}(Je),ei=function(t){function e(e,i,r,o){return t.call(this,e,i,r,o)||this}return u(e,t),e.prototype.pageSize=function(t){return t.size},e.prototype.pageCursor=function(t){return t.entries()},e.prototype.reversePageCursor=function(t){return t.reverseEntries()},e}(y),ii=function(){function t(t){void 0===t&&(t=ri.Empty),this.root=t}return Object.defineProperty(t.prototype,"length",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return this.root.isEmpty()},t.prototype.get=function(t,e){if(!(void 0!==e&&(t=this.lookup(e,t))<0))return this.root.get(t)},t.prototype.getEntry=function(t,e){if(!(void 0!==e&&(t=this.lookup(e,t))<0))return this.root.getEntry(t)},t.prototype.set=function(t,e,i){if(void 0!==i&&(t=this.lookup(i,t))<0)throw new RangeError(""+i);if(t<0||t>=this.root.size)throw new RangeError(""+t);return this.root=this.root.updated(t,e,this),this},t.prototype.insert=function(t,e,i){if(t<0||t>this.root.size)throw new RangeError(""+t);return this.root=this.root.inserted(t,e,i,this).balanced(this),this},t.prototype.remove=function(t,e){if(void 0!==e&&(t=this.lookup(e,t))<0)throw new RangeError(""+e);if(t<0||t>this.root.size)throw new RangeError(""+t);return this.root=this.root.removed(t,this),this},t.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<t.length;i+=1)this.root=this.root.inserted(this.root.size,t[i],void 0,this).balanced(this);return this.root.size},t.prototype.pop=function(){var t=this.root.size-1;if(t>=0){var e=this.root.get(t);return this.root=this.root.removed(t,this),e}},t.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=t.length-1;i>=0;i-=1)this.root=this.root.inserted(0,t[i],void 0,this).balanced(this);return this.root.size},t.prototype.shift=function(){if(this.root.size>0){var t=this.root.get(0);return this.root=this.root.removed(0,this),t}},t.prototype.move=function(t,e,i){if(void 0!==i&&(t=this.lookup(i,t))<0)throw new RangeError(""+i);if(t<0||t>=this.root.size)throw new RangeError(""+t);if(e<0||e>=this.root.size)throw new RangeError(""+e);if(t!==e){var r=this.root.getEntry(t);this.root=this.root.removed(t,this).inserted(e,r[1],r[0],this).balanced(this)}return this},t.prototype.splice=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];t<0&&(t=this.root.size+t),t=Math.min(Math.max(0,t),this.root.size),void 0===e&&(e=this.root.size-t);for(var o=[],n=t,s=t+e;n<s;n+=1)o.push(this.root.get(t)),this.root=this.root.removed(t,this);for(n=0;n<i.length;n+=1)this.root=this.root.inserted(t+n,i[n],void 0,this).balanced(this);return o},t.prototype.drop=function(t){return t>0&&this.root.size>0&&(t<this.root.size?this.root=this.root.drop(t,this):this.root=ri.Empty),this},t.prototype.take=function(t){return t<this.root.size&&this.root.size>0&&(this.root=t>0?this.root.take(t,this):ri.Empty),this},t.prototype.clear=function(){this.root=ri.Empty},t.prototype.forEach=function(t,e){return this.root.forEach(t,e,0,this)},t.prototype.keys=function(){return this.root.keys()},t.prototype.values=function(){return this.root.values()},t.prototype.entries=function(){return this.root.entries()},t.prototype.reverseKeys=function(){return this.root.reverseKeys()},t.prototype.reverseValues=function(){return this.root.reverseValues()},t.prototype.reverseEntries=function(){return this.root.reverseEntries()},t.prototype.clone=function(){return this.copy(this.root)},t.prototype.copy=function(e){var i=new t(e);return i.identify!==this.identify&&(i.identify=this.identify),i.compare!==this.compare&&(i.compare=this.compare),i.pageSplitSize!==this.pageSplitSize&&(i.pageSplitSize=this.pageSplitSize),i},t.prototype.toValue=function(){return this.root.toValue()},t.prototype.toRecon=function(){return this.toValue().toRecon()},t.prototype.identify=function(t){var e=new Uint8Array(6);return C.fillBytes(e),e},t.prototype.compare=function(t,e){return V(t,e)},t.prototype.pageShouldSplit=function(t){return t.arity>this.pageSplitSize},t.prototype.pageShouldMerge=function(t){return t.arity<this.pageSplitSize>>>1},t.prototype.lookup=function(t,e){void 0===e&&(e=0);var i=e=Math.min(Math.max(0,e),this.root.size-1);do{var r=this.root.getEntry(i);if(r&&0===this.compare(r[0],t))return i;i=(i+1)%this.root.size}while(isFinite(i)&&i!==e);return-1},t}();ii.prototype.pageSplitSize=32;var ri=function(){function t(){}return t.prototype.keys=function(){return new c(this.entries())},t.prototype.values=function(){return new d(this.entries())},t.prototype.reverseKeys=function(){return new c(this.reverseEntries())},t.prototype.reverseValues=function(){return new d(this.reverseEntries())},t.prototype.toRecon=function(){return this.toValue().toRecon()},t.Empty=void 0,t}(),oi=function(t){function e(e){var i=t.call(this)||this;return i.slots=e,i}return u(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this.slots.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.slots.length},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.slots.length},e.prototype.get=function(t){var e=this.slots[t];return e?e[1]:void 0},e.prototype.getEntry=function(t){return this.slots[t]},e.prototype.updated=function(t,e,i){if(t<0||t>=this.slots.length)throw new RangeError(""+t);return this.updatedItem(t,e)},e.prototype.updatedItem=function(t,i){var r=this.slots,o=r[t];if(i!==o[1]){var n=r.slice(0);return n[t]=[o[0],i],new e(n)}return this},e.prototype.inserted=function(t,e,i,r){if(t<0||t>this.slots.length)throw new RangeError(""+t);return this.insertedItem(t,e,i,r)},e.prototype.insertedItem=function(t,i,r,o){void 0===r&&(r=o.identify(i));for(var n=this.slots,s=new Array(n.length+1),a=0;a<t;a+=1)s[a]=n[a];s[t]=[r,i];for(a=t;a<n.length;a+=1)s[a+1]=n[a];return new e(s)},e.prototype.removed=function(t,e){if(t<0||t>=this.slots.length)throw new RangeError(""+t);return this.slots.length>1?this.removedSlot(t):ri.Empty},e.prototype.removedSlot=function(t){for(var i=this.slots,r=new Array(i.length-1),o=0;o<t;o+=1)r[o]=i[o];for(o=t;o<r.length;o+=1)r[o]=i[o+1];return new e(r)},e.prototype.drop=function(t,i){var r=this.slots;if(t>0&&r.length>0){if(t<r.length){for(var o=r.length-t,n=new Array(o),s=0;s<o;s+=1)n[s]=r[s+t];return new e(n)}return ri.Empty}return this},e.prototype.take=function(t,i){var r=this.slots;if(t<r.length&&r.length>0){if(t>0){for(var o=new Array(t),n=0;n<t;n+=1)o[n]=r[n];return new e(o)}return ri.Empty}return this},e.prototype.balanced=function(t){var e=this.slots.length;return e>1&&t.pageShouldSplit(this)?this.split(e>>>1):this},e.prototype.split=function(t){var e=new Array(2),i=this.splitLeft(t),r=this.splitRight(t);e[0]=i,e[1]=r;var o=new Array(1);return o[0]=t,new ai(e,o,this.slots.length)},e.prototype.splitLeft=function(t){for(var i=this.slots,r=new Array(t),o=0;o<t;o+=1)r[o]=i[o];return new e(r)},e.prototype.splitRight=function(t){for(var i=this.slots,r=i.length-t,o=new Array(r),n=0;n<r;n+=1)o[n]=i[n+t];return new e(o)},e.prototype.forEach=function(t,e,i,r){for(var o=0;o<this.slots.length;o+=1){var n=this.slots[o],s=t.call(e,n[1],i+o,r,n[0]);if(void 0!==s)return s}},e.prototype.entries=function(){return new f(this.slots)},e.prototype.reverseEntries=function(){return new f(this.slots,this.slots.length)},e.prototype.toValue=function(){var t=L.empty(1+this.slots.length);t.attr("sleaf",L.empty(1).slot("size",this.slots.length));for(var e=0;e<this.slots.length;e+=1){var i=this.slots[e];t.slot(b.of(i[0]),b.of(i[1]))}return t},e}(ri);ri.Empty=new oi([]);var ni,si,ai=function(t){function e(e,i,r){var o=t.call(this)||this;if(o.pages=e,void 0===i||void 0===r){i=new Array(e.length-1),r=0;for(var n=0;n<i.length;n+=1)r+=e[n].size,i[n]=r;r+=e[i.length].size}return o.knots=i,o.size=r,o}return u(e,t),Object.defineProperty(e.prototype,"arity",{get:function(){return this.pages.length},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return 0===this.size},e.prototype.get=function(t){var e=this.lookup(t);e>=0?e+=1:e=-(e+1);var i=0===e?t:t-this.knots[e-1];return this.pages[e].get(i)},e.prototype.getEntry=function(t){var e=this.lookup(t);e>=0?e+=1:e=-(e+1);var i=0===e?t:t-this.knots[e-1];return this.pages[e].getEntry(i)},e.prototype.updated=function(t,e,i){var r=this.lookup(t);r>=0?r+=1:r=-(r+1);var o=0===r?t:t-this.knots[r-1],n=this.pages[r],s=n.updated(o,e,i);return n!==s?n.size!==s.size&&i.pageShouldSplit(s)?this.updatedPageSplit(r,s,n):this.updatedPage(r,s,n):this},e.prototype.updatedPage=function(t,i,r){var o=this.pages,n=o.slice(0);n[t]=i;var s,a,u=this.knots;if(o.length-1>0){s=u.slice(0),a=t>0?u[t-1]:0;for(var h=t;h<s.length;h+=1)a+=n[h].size,s[h]=a;a+=n[s.length].size}else s=[],a=0;return new e(n,s,a)},e.prototype.updatedPageSplit=function(t,i,r){for(var o=this.pages,n=new Array(o.length+1),s=0;s<t;s+=1)n[s]=o[s];var a=i.splitLeft(i.arity>>>1),u=i.splitRight(i.arity>>>1);n[t]=a,n[t+1]=u;for(s=t+1;s<o.length;s+=1)n[s+1]=o[s];return new e(n)},e.prototype.updatedPageMerge=function(t,i,r){for(var o=this.pages,n=i.pages,s=new Array(o.length+n.length-1),a=0;a<t;a+=1)s[a]=o[a];for(a=0;a<n.length;a+=1)s[a+t]=n[a];for(a=t+1;a<o.length;a+=1)s[a+n.length-1]=o[a];return new e(s)},e.prototype.inserted=function(t,e,i,r){var o=this.lookup(t);o>=0?o+=1:o=-(o+1);var n=0===o?t:t-this.knots[o-1],s=this.pages[o],a=s.inserted(n,e,i,r);return s!==a?r.pageShouldSplit(a)?this.updatedPageSplit(o,a,s):this.updatedPage(o,a,s):this},e.prototype.removed=function(t,e){var i=this.lookup(t);i>=0?i+=1:i=-(i+1);var r=0===i?t:t-this.knots[i-1],o=this.pages[i],n=o.removed(r,e);return o!==n?this.replacedPage(i,n,o,e):this},e.prototype.replacedPage=function(t,i,r,o){return i.isEmpty()?this.pages.length>2?this.removedPage(t,i,r):this.pages.length>1?0===t?this.pages[1]:this.pages[0]:ri.Empty:i instanceof e&&o.pageShouldMerge(i)?this.updatedPageMerge(t,i,r):this.updatedPage(t,i,r)},e.prototype.removedPage=function(t,i,r){for(var o=this.pages,n=new Array(o.length-1),s=0;s<t;s+=1)n[s]=o[s];for(s=t+1;s<o.length;s+=1)n[s-1]=o[s];var a,u=this.knots,h=new Array(u.length-1);if(t>0){for(s=0;s<t;s+=1)h[s]=u[s];a=u[t-1]}else a=0;for(s=t;s<h.length;s+=1)a+=n[s].size,h[s]=a;return new e(n,h,a+=n[h.length].size)},e.prototype.drop=function(t,i){if(t>0){if(t<this.size){var r=this.lookup(t);r>=0?r+=1:r=-(r+1),t=0===r?t:t-this.knots[r-1];var o=this.pages,n=o.length-r;if(n>1){var s=void 0;if(r>0){for(var a=new Array(n),u=0;u<n;u+=1)a[u]=o[u+r];s=new e(a)}else s=this;if(t>0){var h=o[r],l=h.drop(t,i);return s.replacedPage(0,l,h,i)}return s}return o[r].drop(t,i)}return ri.Empty}return this},e.prototype.take=function(t,i){if(t<this.size){if(t>0){var r=this.lookup(t);r>=0?r+=1:r=-(r+1),t=0===r?t:t-this.knots[r-1];var o=this.pages,n=0===t?r:r+1;if(n>1){var s=void 0;if(r<o.length){for(var a=new Array(n),u=0;u<n;u+=1)a[u]=o[u];var h=new Array(n-1);for(u=0;u<h.length;u+=1)h[u]=this.knots[u];s=new e(a,h,h[n-2]+a[n-1].size)}else s=this;if(t>0){var l=o[r],p=l.take(t,i);return s.replacedPage(r,p,l,i)}return s}return t>0?o[0].take(t,i):o[0]}return ri.Empty}return this},e.prototype.balanced=function(t){return this.pages.length>1&&t.pageShouldSplit(this)?this.split(this.knots.length>>>1):this},e.prototype.split=function(t){var i=new Array(2),r=this.splitLeft(t),o=this.splitRight(t);i[0]=r,i[1]=o;var n=new Array(1);return n[0]=r.size,new e(i,n,this.size)},e.prototype.splitLeft=function(t){for(var i=this.pages,r=new Array(t+1),o=0;o<t+1;o+=1)r[o]=i[o];var n=this.knots,s=new Array(t);for(o=0;o<t;o+=1)s[o]=n[o];var a=0;for(o=0;o<=t;o+=1)a+=r[o].size;return new e(r,s,a)},e.prototype.splitRight=function(t){for(var i=this.pages,r=i.length-(t+1),o=new Array(r),n=0;n<r;n+=1)o[n]=i[n+(t+1)];var s,a=new Array(r-1);if(r>0){s=o[0].size;for(n=1;n<r;n+=1)a[n-1]=s,s+=o[n].size}else s=0;return new e(o,a,s)},e.prototype.forEach=function(t,e,i,r){for(var o=0;o<this.pages.length;o+=1){var n=this.pages[o],s=n.forEach(t,e,i,r);if(void 0!==s)return s;i+=n.size}},e.prototype.entries=function(){return new ui(this.pages)},e.prototype.reverseEntries=function(){return new ui(this.pages,this.size,this.pages.length)},e.prototype.toValue=function(){var t=L.empty(1+this.pages.length+this.knots.length);t.attr("snode",L.empty(1).slot("size",this.size));for(var e=0;e<this.pages.length;e+=1)e>0&&t.push(L.empty(1).attr("knot",L.empty(1).slot("index",this.knots[e-1]))),t.push(this.pages[e].toValue());return t},e.prototype.lookup=function(t){for(var e=0,i=this.knots.length-1;e<=i;){var r=e+i>>>1;if(t>this.knots[r])e=r+1;else{if(!(t<this.knots[r]))return r;i=r-1}}return-(e+1)},e}(ri),ui=function(t){function e(e,i,r,o){return t.call(this,e,i,r,o)||this}return u(e,t),e.prototype.pageSize=function(t){return t.size},e.prototype.pageCursor=function(t){return t.entries()},e.prototype.reversePageCursor=function(t){return t.reverseEntries()},e}(y),hi=function(){function t(t,e){void 0===e&&(e=32),this.base=t,this.resolveCache=new zt(e),this.unresolveCache=new zt(e)}return t.prototype.resolve=function(t){t=Kt.fromAny(t);var e=this.resolveCache.get(t);return void 0===e&&(e=this.base.resolve(t),this.resolveCache.set(t,e)),e},t.prototype.unresolve=function(t){t=Kt.fromAny(t);var e=this.unresolveCache.get(t);return void 0===e&&(e=this.base.unresolve(t),this.unresolveCache.set(t,e)),e},t}(),li=function(){function t(){}return Object.defineProperty(t.prototype,"tag",{get:function(){return this.constructor.tag},enumerable:!0,configurable:!0}),t.prototype.prio=function(t){return void 0===t?0:this},t.prototype.rate=function(t){return void 0===t?0:this},t.prototype.toRecon=function(){return this.toValue().toRecon()},Object.defineProperty(t,"tag",{get:function(){return""},enumerable:!0,configurable:!0}),t.fromValue=function(t){switch(t.tag){case"event":return fi.fromValue(t);case"command":return yi.fromValue(t);case"link":return mi.fromValue(t);case"linked":return vi.fromValue(t);case"sync":return gi.fromValue(t);case"synced":return wi.fromValue(t);case"unlink":return bi.fromValue(t);case"unlinked":return _i.fromValue(t);case"auth":return xi.fromValue(t);case"authed":return Ai.fromValue(t);case"deauth":return ki.fromValue(t);case"deauthed":return Ei.fromValue(t);default:return}},t.parseRecon=function(e){return t.fromValue(b.parseRecon(e))},t}(),pi=function(t){function e(e){var i=t.call(this)||this;return i._body=e,i}return u(e,t),e.prototype.node=function(t){return void 0===t?Kt.Empty:this},e.prototype.lane=function(t){return void 0===t?Kt.Empty:this},e.prototype.body=function(t){return void 0===t?this._body:(t=b.fromAny(t),this.copy(t))},e.prototype.toValue=function(){return R.of(this.tag).concat(this._body)},e.fromValue=function(t,e){if(t.header(e.tag).isDefined())return new e(t.body())},e}(li),ci=function(t){function e(e,i,r){var o=t.call(this)||this;return o._node=e,o._lane=i,o._body=r,o}return u(e,t),e.prototype.node=function(t){return void 0===t?this._node:(t=Kt.fromAny(t),this.copy(t,this._lane,this._body))},e.prototype.lane=function(t){return void 0===t?this._lane:(t=Kt.fromAny(t),this.copy(this._node,t,this._body))},e.prototype.body=function(t){return void 0===t?this._body:(t=b.fromAny(t),this.copy(this._node,this._lane,t))},e.prototype.toValue=function(){var t=L.empty(2).slot("node",this._node.toUri()).slot("lane",this._lane.toUri());return R.of(this.tag,t).concat(this._body)},e.fromValue=function(t,e){var i,r;if(t.header(e.tag).forEach(function(t,e){if(t.key instanceof I){var o=t.key.value;"node"===o?i=t.cast(ye.Uri,i):"lane"===o&&(r=t.cast(ye.Uri,r))}else t instanceof b&&(0===e?i=t.cast(ye.Uri,i):1===e&&(r=t.cast(ye.Uri,r)))},this),i&&r){var o=t.body();return new e(i,r,o)}},e}(li),di=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s._node=e,s._lane=i,s._prio=r,s._rate=o,s._body=n,s}return u(e,t),e.prototype.node=function(t){return void 0===t?this._node:(t=Kt.fromAny(t),this.copy(t,this._lane,this._prio,this._rate,this._body))},e.prototype.lane=function(t){return void 0===t?this._lane:(t=Kt.fromAny(t),this.copy(this._node,t,this._prio,this._rate,this._body))},e.prototype.prio=function(t){return void 0===t?this._prio:this.copy(this._node,this._lane,t,this._rate,this._body)},e.prototype.rate=function(t){return void 0===t?this._rate:this.copy(this._node,this._lane,this._prio,t,this._body)},e.prototype.body=function(t){return void 0===t?this._body:(t=b.fromAny(t),this.copy(this._node,this._lane,this._prio,this._rate,t))},e.prototype.toValue=function(){var t=L.empty(4).slot("node",this._node.toUri()).slot("lane",this._lane.toUri());return this._prio&&t.slot("prio",this._prio),this._rate&&t.slot("rate",this._rate),R.of(this.tag,t).concat(this._body)},e.fromValue=function(t,e){var i,r,o=0,n=0;if(t.header(e.tag).forEach(function(t,e){if(t.key instanceof I){var s=t.key.value;"node"===s?i=t.cast(ye.Uri,i):"lane"===s?r=t.cast(ye.Uri,r):"prio"===s?o=t.numberValue(o):"rate"===s&&(n=t.numberValue(n))}else t instanceof b&&(0===e?i=t.cast(ye.Uri,i):1===e&&(r=t.cast(ye.Uri,r)))},this),i&&r){var s=t.body();return new e(i,r,o,n,s)}},e}(li),fi=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.copy=function(t,i,r){return new e(t,i,r)},e.fromValue=function(t){return ci.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"event"},enumerable:!0,configurable:!0}),e.of=function(t,i,r){return void 0===r&&(r=b.Absent),new e(t=Kt.fromAny(t),i=Kt.fromAny(i),r=b.fromAny(r))},e}(ci),yi=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.copy=function(t,i,r){return new e(t,i,r)},e.fromValue=function(t){return ci.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"command"},enumerable:!0,configurable:!0}),e.of=function(t,i,r){return void 0===r&&(r=b.Absent),new e(t=Kt.fromAny(t),i=Kt.fromAny(i),r=b.fromAny(r))},e}(ci),mi=function(t){function e(e,i,r,o,n){return t.call(this,e,i,r,o,n)||this}return u(e,t),e.prototype.copy=function(t,i,r,o,n){return new e(t,i,r,o,n)},e.fromValue=function(t){return di.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"link"},enumerable:!0,configurable:!0}),e.of=function(t,i,r,o,n){return void 0===r&&(r=0),void 0===o&&(o=0),void 0===n&&(n=b.Absent),new e(t=Kt.fromAny(t),i=Kt.fromAny(i),r,o,n=b.fromAny(n))},e}(di),vi=function(t){function e(e,i,r,o,n){return t.call(this,e,i,r,o,n)||this}return u(e,t),e.prototype.copy=function(t,i,r,o,n){return new e(t,i,r,o,n)},e.fromValue=function(t){return di.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"linked"},enumerable:!0,configurable:!0}),e.of=function(t,i,r,o,n){return void 0===r&&(r=0),void 0===o&&(o=0),void 0===n&&(n=b.Absent),new e(t=Kt.fromAny(t),i=Kt.fromAny(i),r,o,n=b.fromAny(n))},e}(di),gi=function(t){function e(e,i,r,o,n){return t.call(this,e,i,r,o,n)||this}return u(e,t),e.prototype.copy=function(t,i,r,o,n){return new e(t,i,r,o,n)},e.fromValue=function(t){return di.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"sync"},enumerable:!0,configurable:!0}),e.of=function(t,i,r,o,n){return void 0===r&&(r=0),void 0===o&&(o=0),void 0===n&&(n=b.Absent),new e(t=Kt.fromAny(t),i=Kt.fromAny(i),r,o,n=b.fromAny(n))},e}(di),wi=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.copy=function(t,i,r){return new e(t,i,r)},e.fromValue=function(t){return ci.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"synced"},enumerable:!0,configurable:!0}),e.of=function(t,i,r){return void 0===r&&(r=b.Absent),new e(t=Kt.fromAny(t),i=Kt.fromAny(i),r=b.fromAny(r))},e}(ci),bi=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.copy=function(t,i,r){return new e(t,i,r)},e.fromValue=function(t){return ci.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"unlink"},enumerable:!0,configurable:!0}),e.of=function(t,i,r){return void 0===r&&(r=b.Absent),new e(t=Kt.fromAny(t),i=Kt.fromAny(i),r=b.fromAny(r))},e}(ci),_i=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.copy=function(t,i,r){return new e(t,i,r)},e.fromValue=function(t){return ci.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"unlinked"},enumerable:!0,configurable:!0}),e.of=function(t,i,r){return void 0===r&&(r=b.Absent),new e(t=Kt.fromAny(t),i=Kt.fromAny(i),r=b.fromAny(r))},e}(ci),xi=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.copy=function(t){return new e(t)},e.fromValue=function(t){return pi.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"auth"},enumerable:!0,configurable:!0}),e.of=function(t){return void 0===t&&(t=b.Absent),new e(t=b.fromAny(t))},e}(pi),Ai=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.copy=function(t){return new e(t)},e.fromValue=function(t){return pi.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"authed"},enumerable:!0,configurable:!0}),e.of=function(t){return void 0===t&&(t=b.Absent),new e(t=b.fromAny(t))},e}(pi),ki=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.copy=function(t){return new e(t)},e.fromValue=function(t){return pi.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"deauth"},enumerable:!0,configurable:!0}),e.of=function(t){return void 0===t&&(t=b.Absent),new e(t=b.fromAny(t))},e}(pi),Ei=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.copy=function(t){return new e(t)},e.fromValue=function(t){return pi.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"deauthed"},enumerable:!0,configurable:!0}),e.of=function(t){return void 0===t&&(t=b.Absent),new e(t=b.fromAny(t))},e}(pi),Ci=function(){function t(t,e,i){void 0===i&&(i={}),this._context=t,this._hostUri=e,this._options=i,this._downlinks=new Ze,this._downlinkCount=0,this._authenticated=!1,this._session=b.Absent,this._uriCache=new hi(e),this._sendBuffer=[],this._reconnectTimer=0,this._reconnectTimeout=0,this._idleTimer=0,this.open=this.open.bind(this),this.checkIdle=this.checkIdle.bind(this)}return Object.defineProperty(t.prototype,"hostUri",{get:function(){return this._hostUri},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"credentials",{get:function(){return this._options.credentials||b.Absent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxReconnectTimeout",{get:function(){return this._options.maxReconnectTimeout||3e4},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idleTimeout",{get:function(){return this._options.idleTimeout||1e3},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sendBufferSize",{get:function(){return this._options.sendBufferSize||1024},enumerable:!0,configurable:!0}),t.prototype.isAuthenticated=function(){return this._authenticated},Object.defineProperty(t.prototype,"session",{get:function(){return this._session},enumerable:!0,configurable:!0}),t.prototype.isIdle=function(){return!this._sendBuffer.length&&!this._downlinkCount},t.prototype.resolve=function(t){return this._uriCache.resolve(t)},t.prototype.unresolve=function(t){return this._uriCache.unresolve(t)},t.prototype.authenticate=function(t){if(!(t=b.fromAny(t)).equals(this._options.credentials))if(this._options.credentials=t,this.isConnected()){var e=xi.of(t);this.push(e)}else this.open()},t.prototype.openDownlink=function(t){this.clearIdle();var e=this.resolve(t.nodeUri()),i=t.laneUri();this._downlinkCount||this.open();var r=this._downlinks.get(e);if(r||(r=new Ze,this._downlinks.set(e,r)),r.get(i))throw new Error("duplicate downlink");r.set(i,t),this._downlinkCount+=1,t.openUp(this),this.isConnected()&&t.hostDidConnect(this)},t.prototype.unlinkDownlink=function(t){var e=this.resolve(t.nodeUri()),i=t.laneUri(),r=this._downlinks.get(e);if(r&&r.get(i)&&this.isConnected()){var o=bi.of(this.unresolve(e),i);t.onUnlinkRequest(o,this),this.push(o)}},t.prototype.closeDownlink=function(t){var e=this.resolve(t.nodeUri()),i=t.laneUri(),r=this._downlinks.get(e);r&&r.get(i)&&(this._downlinkCount-=1,r.delete(i),r.isEmpty()&&this._downlinks.delete(e),this._downlinkCount||this.watchIdle(),t.closeUp(this))},t.prototype.command=function(t,e,i){t=Kt.fromAny(t),t=this.resolve(t),e=Kt.fromAny(e),i=b.fromAny(i);var r=yi.of(this.unresolve(t),e,i);this.push(r)},t.prototype.onEnvelope=function(t){t instanceof fi?this.onEventMessage(t):t instanceof yi?this.onCommandMessage(t):t instanceof mi?this.onLinkRequest(t):t instanceof vi?this.onLinkedResponse(t):t instanceof gi?this.onSyncRequest(t):t instanceof wi?this.onSyncedResponse(t):t instanceof bi?this.onUnlinkRequest(t):t instanceof _i?this.onUnlinkedResponse(t):t instanceof xi?this.onAuthRequest(t):t instanceof Ai?this.onAuthedResponse(t):t instanceof ki?this.onDeauthRequest(t):t instanceof Ei?this.onDeauthedResponse(t):this.onUnknownEnvelope(t)},t.prototype.onEventMessage=function(t){var e=this.resolve(t.node()),i=t.lane(),r=this._downlinks.get(e);if(r){var o=r.get(i);if(o){var n=t.node(e);o.onEventMessage(n,this)}}},t.prototype.onCommandMessage=function(t){},t.prototype.onLinkRequest=function(t){},t.prototype.onLinkedResponse=function(t){var e=this.resolve(t.node()),i=t.lane(),r=this._downlinks.get(e);if(r){var o=r.get(i);if(o){var n=t.node(e);o.onLinkedResponse(n,this)}}},t.prototype.onSyncRequest=function(t){},t.prototype.onSyncedResponse=function(t){var e=this.resolve(t.node()),i=t.lane(),r=this._downlinks.get(e);if(r){var o=r.get(i);if(o){var n=t.node(e);o.onSyncedResponse(n,this)}}},t.prototype.onUnlinkRequest=function(t){},t.prototype.onUnlinkedResponse=function(t){var e=this.resolve(t.node()),i=t.lane(),r=this._downlinks.get(e);if(r){var o=r.get(i);if(o){var n=t.node(e);o.onUnlinkedResponse(n,this)}}},t.prototype.onAuthRequest=function(t){},t.prototype.onAuthedResponse=function(t){this._authenticated=!0,this._session=t.body(),this._context.hostDidAuthenticate(t.body(),this)},t.prototype.onDeauthRequest=function(t){},t.prototype.onDeauthedResponse=function(t){this._authenticated=!1,this._session=b.Absent,this._context.hostDidDeauthenticate(t.body(),this)},t.prototype.onUnknownEnvelope=function(t){},t.prototype.onConnect=function(){this._reconnectTimeout=0,this._context.hostDidConnect(this),this._downlinks.forEach(function(t,e){e.forEach(function(t,e){e.hostDidConnect(this)},this)},this)},t.prototype.onDisconnect=function(){this._authenticated=!1,this._session=b.Absent,this._context.hostDidDisconnect(this),this._downlinks.forEach(function(t,e){e.forEach(function(t,e){e.hostDidDisconnect(this)},this)},this)},t.prototype.onError=function(t){this._context.hostDidFail(t,this),this._downlinks.forEach(function(e,i){i.forEach(function(e,i){i.hostDidFail(t,this)},this)},this)},t.prototype.reconnect=function(){this._reconnectTimer||(this._reconnectTimeout?this._reconnectTimeout=Math.min(Math.floor(1.8*this._reconnectTimeout),this.maxReconnectTimeout):this._reconnectTimeout=Math.floor(500+1e3*Math.random()),this._reconnectTimer=setTimeout(this.open,this._reconnectTimeout))},t.prototype.clearReconnect=function(){this._reconnectTimer&&(clearTimeout(this._reconnectTimer),this._reconnectTimer=0)},t.prototype.watchIdle=function(){!this._idleTimer&&this.isConnected()&&this.isIdle()&&(this._idleTimer=setTimeout(this.checkIdle,this.idleTimeout))},t.prototype.clearIdle=function(){this._idleTimer&&(clearTimeout(this._idleTimer),this._idleTimer=0)},t.prototype.checkIdle=function(){this.isConnected()&&this.isIdle()&&this.close()},t.prototype.close=function(){this._context.closeHost(this)},t.prototype.closeUp=function(){this._downlinks.forEach(function(t,e){e.forEach(function(t,e){e.closeUp(this)},this)},this)},t}();(si=ni||(ni={}))[si.KeepLinked=1]="KeepLinked",si[si.KeepSynced=2]="KeepSynced",si[si.KeepLinkedSynced=3]="KeepLinkedSynced";var Si=function(){function t(t,e,i,r,o,n,s){void 0===o&&(o=0),void 0===n&&(n=0),void 0===s&&(s=b.Absent),this._context=t,this._hostUri=e,this._nodeUri=i,this._laneUri=r,this._prio=o,this._rate=n,this._body=s,this._views=[],this._host=null,this._status=0}return t.prototype.hostUri=function(){return this._hostUri},t.prototype.nodeUri=function(){return this._nodeUri},t.prototype.laneUri=function(){return this._laneUri},t.prototype.prio=function(){return this._prio},t.prototype.rate=function(){return this._rate},t.prototype.body=function(){return this._body},t.prototype.keepLinked=function(){for(var t=0;t<this._views.length;t+=1)if(this._views[t].keepLinked())return!0;return!1},t.prototype.keepSynced=function(){for(var t=0;t<this._views.length;t+=1)if(this._views[t].keepSynced())return!0;return!1},t.prototype.isConnected=function(){return!(!this._host||!this._host.isConnected())},t.prototype.isAuthenticated=function(){return!(!this._host||!this._host.isAuthenticated())},t.prototype.isLinked=function(){return 0!=(2&this._status)},t.prototype.isSynced=function(){return 0!=(8&this._status)},Object.defineProperty(t.prototype,"session",{get:function(){return this._host?this._host.session:b.Absent},enumerable:!0,configurable:!0}),t.prototype.addDownlink=function(t){this._views.push(t)},t.prototype.removeDownlink=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e]===t&&(this._views.splice(e,1),t.closeUp());0===this._views.length&&this.unlink()},t.prototype.onEventMessage=function(t,e){for(var i=0;i<this._views.length;i+=1)this._views[i].onEventMessage(t)},t.prototype.onCommandMessage=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].onCommandMessage(t)},t.prototype.onLinkRequest=function(t){this._status|=1;for(var e=0;e<this._views.length;e+=1)this._views[e].onLinkRequest(t)},t.prototype.onLinkedResponse=function(t,e){this._status=-2&this._status|2;for(var i=0;i<this._views.length;i+=1)this._views[i].onLinkedResponse(t)},t.prototype.onSyncRequest=function(t){this._status|=4;for(var e=0;e<this._views.length;e+=1)this._views[e].onSyncRequest(t)},t.prototype.onSyncedResponse=function(t,e){this._status=-5&this._status|8;for(var i=0;i<this._views.length;i+=1)this._views[i].onSyncedResponse(t)},t.prototype.onUnlinkRequest=function(t,e){this._status=-6&this._status|16;for(var i=0;i<this._views.length;i+=1)this._views[i].onUnlinkRequest(t)},t.prototype.onUnlinkedResponse=function(t,e){this._status&=-17;for(var i=0;i<this._views.length;i+=1)this._views[i].onUnlinkedResponse(t);0===this._status&&this.close()},t.prototype.hostDidConnect=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].hostDidConnect();var i,r=this._host.unresolve(this._nodeUri);this.keepSynced()?(i=gi.of(r,this._laneUri,this._prio,this._rate,this._body),this.onSyncRequest(i)):(i=mi.of(r,this._laneUri,this._prio,this._rate,this._body),this.onLinkRequest(i)),this._host.push(i)},t.prototype.hostDidDisconnect=function(t){this._status=0;for(var e=!1,i=0;i<this._views.length;i+=1){var r=this._views[i];r.hostDidDisconnect(),e=e||r.keepLinked()}e||this.close()},t.prototype.hostDidFail=function(t,e){for(var i=0;i<this._views.length;i+=1)this._views[i].hostDidFail(t)},t.prototype.command=function(t){t=b.fromAny(t),this.onCommandMessage(t),this._host.command(this._nodeUri,this._laneUri,t)},t.prototype.unlink=function(){this._status=16,this._context.unlinkDownlink(this)},t.prototype.close=function(){this._context.closeDownlink(this)},t.prototype.openUp=function(t){this._host=t;for(var e=0;e<this._views.length;e+=1)this._views[e].openUp(t)},t.prototype.closeUp=function(){var t=this._views;this._views=[];for(var e=0;e<t.length;e+=1)t[e].closeUp()},t}(),Vi=function(){function t(t,e,i,r,o,n,s,a,u,h,l){void 0===r&&(r=Kt.Empty),void 0===o&&(o=Kt.Empty),void 0===n&&(n=Kt.Empty),void 0===s&&(s=0),void 0===a&&(a=0),void 0===u&&(u=b.Absent),void 0===h&&(h=0),void 0===l&&(l={}),i&&(r=void 0!==i.hostUri?Kt.fromAny(i.hostUri):r,o=void 0!==i.nodeUri?Kt.fromAny(i.nodeUri):o,n=void 0!==i.laneUri?Kt.fromAny(i.laneUri):n,s=void 0!==i.prio?i.prio:s,a=void 0!==i.rate?i.rate:a,u=void 0!==i.body?b.fromAny(i.body):u,l.onEvent=i.onEvent||l.onEvent,l.onCommand=i.onCommand||l.onCommand,l.willLink=i.willLink||l.willLink,l.didLink=i.didLink||l.didLink,l.willSync=i.willSync||l.willSync,l.didSync=i.didSync||l.didSync,l.willUnlink=i.willUnlink||l.willUnlink,l.didUnlink=i.didUnlink||l.didUnlink,l.didConnect=i.didConnect||l.didConnect,l.didDisconnect=i.didDisconnect||l.didDisconnect,l.didClose=i.didClose||l.didClose,l.didFail=i.didFail||l.didFail),this._context=t,this._owner=e,this._hostUri=r,this._nodeUri=o,this._laneUri=n,this._prio=s,this._rate=a,this._body=u,this._flags=h,this._model=void 0,this.delegate=l}return t.prototype.hostUri=function(t){return void 0===t?this._hostUri:(t=Kt.fromAny(t),this.copy(this._context,this._owner,t,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this.delegate))},t.prototype.nodeUri=function(t){return void 0===t?this._nodeUri:(t=Kt.fromAny(t),this.copy(this._context,this._owner,this._hostUri,t,this._laneUri,this._prio,this._rate,this._body,this._flags,this.delegate))},t.prototype.laneUri=function(t){return void 0===t?this._laneUri:(t=Kt.fromAny(t),this.copy(this._context,this._owner,this._hostUri,this._nodeUri,t,this._prio,this._rate,this._body,this._flags,this.delegate))},t.prototype.prio=function(t){return void 0===t?this._prio:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,t,this._rate,this._body,this._flags,this.delegate)},t.prototype.rate=function(t){return void 0===t?this._rate:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,t,this._body,this._flags,this.delegate)},t.prototype.body=function(t){return void 0===t?this._body:(t=b.fromAny(t),this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,t,this._flags,this.delegate))},t.prototype.keepLinked=function(t){if(void 0===t)return 0!=(1&this._flags);var e=t?1|this._flags:-2&this._flags;return this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,e,this.delegate)},t.prototype.keepSynced=function(t){if(void 0===t)return 0!=(2&this._flags);var e=t?2|this._flags:-3&this._flags;return this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,e,this.delegate)},t.prototype.onEvent=function(t){return void 0===t?this.delegate.onEvent||null:(this.delegate.onEvent=t||void 0,this)},t.prototype.onCommand=function(t){return void 0===t?this.delegate.onCommand||null:(this.delegate.onCommand=t||void 0,this)},t.prototype.willLink=function(t){return void 0===t?this.delegate.willLink||null:(this.delegate.willLink=t||void 0,this)},t.prototype.didLink=function(t){return void 0===t?this.delegate.didLink||null:(this.delegate.didLink=t||void 0,this)},t.prototype.willSync=function(t){return void 0===t?this.delegate.willSync||null:(this.delegate.willSync=t||void 0,this)},t.prototype.didSync=function(t){return void 0===t?this.delegate.didSync||null:(this.delegate.didSync=t||void 0,this)},t.prototype.willUnlink=function(t){return void 0===t?this.delegate.willUnlink||null:(this.delegate.willUnlink=t||void 0,this)},t.prototype.didUnlink=function(t){return void 0===t?this.delegate.didUnlink||null:(this.delegate.didUnlink=t||void 0,this)},t.prototype.didConnect=function(t){return void 0===t?this.delegate.didConnect||null:(this.delegate.didConnect=t||void 0,this)},t.prototype.didDisconnect=function(t){return void 0===t?this.delegate.didDisconnect||null:(this.delegate.didDisconnect=t||void 0,this)},t.prototype.didClose=function(t){return void 0===t?this.delegate.didClose||null:(this.delegate.didClose=t||void 0,this)},t.prototype.didFail=function(t){return void 0===t?this.delegate.didFail||null:(this.delegate.didFail=t||void 0,this)},t.prototype.isConnected=function(){return!!this._model&&this._model.isConnected()},t.prototype.isAuthenticated=function(){return!!this._model&&this._model.isAuthenticated()},t.prototype.isLinked=function(){return!!this._model&&this._model.isLinked()},t.prototype.isSynced=function(){return!!this._model&&this._model.isSynced()},t.prototype.session=function(){return this._model?this._model.session:b.Absent},t.prototype.onEventMessage=function(t){this.delegate.onEvent&&this.delegate.onEvent(t.body(),this)},t.prototype.onCommandMessage=function(t){this.delegate.onCommand&&this.delegate.onCommand(t,this)},t.prototype.onLinkRequest=function(t){this.delegate.willLink&&this.delegate.willLink(this)},t.prototype.onLinkedResponse=function(t){this.delegate.didLink&&this.delegate.didLink(this)},t.prototype.onSyncRequest=function(t){this.delegate.willSync&&this.delegate.willSync(this)},t.prototype.onSyncedResponse=function(t){this.delegate.didSync&&this.delegate.didSync(this)},t.prototype.onUnlinkRequest=function(t){this.delegate.willUnlink&&this.delegate.willUnlink(this)},t.prototype.onUnlinkedResponse=function(t){this.delegate.didUnlink&&this.delegate.didUnlink(this)},t.prototype.hostDidConnect=function(){this.delegate.didConnect&&this.delegate.didConnect(this)},t.prototype.hostDidDisconnect=function(){this.delegate.didDisconnect&&this.delegate.didDisconnect(this)},t.prototype.hostDidFail=function(t){this.delegate.didFail&&this.delegate.didFail(t,this)},t.prototype.command=function(t){this._model.command(t)},t.prototype.close=function(){this._owner&&this._owner.removeDownlink(this),this._model&&this._model.removeDownlink(this)},t.prototype.openUp=function(t){},t.prototype.closeUp=function(){this.delegate.didClose&&this.delegate.didClose(this)},t.InitForm=void 0,t}(),Di=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"link"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unit",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.mold=function(t){if(t){var e=L.empty();return void 0!==t.hostUri&&e.slot("host",Kt.fromAny(t.hostUri).toUri()),void 0!==t.nodeUri&&e.slot("node",Kt.fromAny(t.nodeUri).toUri()),void 0!==t.laneUri&&e.slot("lane",Kt.fromAny(t.laneUri).toUri()),void 0!==t.prio&&e.slot("prio",t.prio),void 0!==t.rate&&e.slot("rate",t.rate),void 0!==t.body&&e.slot("body",t.body),void 0!==t.type&&e.slot("type",t.type),L.of(R.of("link",e))}return b.Absent},e.prototype.cast=function(t){var e=t.get("link");if(e.isDefined()){var i={},r=e.get("host");r.isDefined()&&(i.hostUri=r.cast(ye.Uri));var o=e.get("node");o.isDefined()&&(i.nodeUri=o.cast(ye.Uri));var n=e.get("lane");n.isDefined()&&(i.laneUri=n.cast(ye.Uri));var s=e.get("prio");s.isDefined()&&(i.prio=s.numberValue());var a=e.get("rate");a.isDefined()&&(i.rate=a.numberValue());var u=e.get("body");u.isDefined()&&(i.body=u);var h=e.get("type");return h.isDefined()&&(i.type=h.stringValue()),i}},e}(ye);Vi.InitForm=new Di;var Mi=function(t){function e(e,i,r,o,n,s,a){return t.call(this,e,i,r,o,n,s,a)||this}return u(e,t),e.prototype.type=function(){return"event"},e}(Si),Ri=function(t){function e(e,i,r,o,n,s,a,u,h,l,p){return void 0===l&&(l=1),void 0===p&&(p={}),t.call(this,e,i,r,o,n,s,a,u,h,l,p)||this}return u(e,t),e.prototype.copy=function(t,i,r,o,n,s,a,u,h,l){return new e(t,i,void 0,r,o,n,s,a,u,h,l)},e.prototype.type=function(){return"event"},e.prototype.open=function(){var t=this._laneUri;if(t.isEmpty())throw new Error("no lane");var e=this._nodeUri;if(e.isEmpty())throw new Error("no node");var i=this._hostUri;i.isEmpty()&&(i=e.base(),e=Kt.unresolve(i,e));var r=this._context.getDownlink(i,e,t);if(r){if(!(r instanceof Mi))throw new Error("downlink type mismatch");r.addDownlink(this)}else(r=new Mi(this._context,i,e,t,this._prio,this._rate,this._body)).addDownlink(this),this._context.openDownlink(r);return this._model=r,this._owner&&this._owner.addDownlink(this),this},e}(Vi),Ti=function(t){function e(e,i,r,o,n,s,a,u){void 0===u&&(u=new ii);var h=t.call(this,e,i,r,o,n,s,a)||this;return h._state=u,h}return u(e,t),e.prototype.type=function(){return"list"},e.prototype.isEmpty=function(){return this._state.isEmpty()},Object.defineProperty(e.prototype,"length",{get:function(){return this._state.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t,e){return this._state.get(t,e)||b.Absent},e.prototype.getEntry=function(t,e){return this._state.getEntry(t,e)},e.prototype.set=function(t,e,i){if(void 0!==i&&(t=this._state.lookup(i,t))<0)throw new RangeError(""+i);if(t<0||t>=this._state.length)throw new RangeError(""+t);e=this.listWillUpdate(t,e);var r=this._state.getEntry(t);this._state.set(t,e),this.listDidUpdate(t,e,r[1]);var o=L.empty(2).slot("id",r[0]).slot("index",t);return this.command(R.of("update",o).concat(e)),this},e.prototype.insert=function(t,e,i){if(t<0||t>this._state.length)throw new RangeError(""+t);e=this.listWillInsert(t,e),this._state.insert(t,e,i);var r=this._state.getEntry(t);this.listDidInsert(t,e);var o=L.empty(2).slot("id",r[0]).slot("index",t);return this.command(R.of("insert",o).concat(e)),this},e.prototype.remove=function(t,e){if(void 0!==e&&(t=this._state.lookup(e,t))<0)throw new RangeError(""+e);if(t<0||t>this._state.length)throw new RangeError(""+t);this.listWillRemove(t);var i=this._state.getEntry(t);this._state.remove(t),this.listDidRemove(t,i[1]);var r=L.empty(2).slot("id",i[0]).slot("index",t);return this.command(L.empty(1).attr("remove",r)),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=0;i<t.length;i+=1){var r=this._state.length+i,o=this.listWillInsert(r,t[i]);this._state.insert(r,o);var n=this._state.getEntry(r);this.listDidInsert(r,o);var s=L.empty(2).slot("id",n[0]).slot("index",r);this.command(R.of("insert",s).concat(o))}return this._state.length},e.prototype.pop=function(){var t=this._state.length-1;if(t>=0){this.listWillRemove(t);var e=this._state.getEntry(t);this._state.remove(t),this.listDidRemove(t,e[1]);var i=L.empty(2).slot("id",e[0]).slot("index",t);return this.command(L.empty(1).attr("remove",i)),e[1]}return b.Absent},e.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=t.length-1;i>=0;i-=1){var r=this.listWillInsert(0,t[i]);this._state.insert(0,r);var o=this._state.getEntry(0);this.listDidInsert(0,r);var n=L.empty(2).slot("id",o[0]).slot("index",0);this.command(R.of("insert",n).concat(r))}return this._state.length},e.prototype.shift=function(){if(this._state.length>0){this.listWillRemove(0);var t=this._state.getEntry(0);this._state.remove(0),this.listDidRemove(0,t[1]);var e=L.empty(2).slot("id",t[0]).slot("index",0);return this.command(L.empty(1).attr("remove",e)),t[1]}return b.Absent},e.prototype.move=function(t,e,i){if(void 0!==i&&(t=this._state.lookup(i,t))<0)throw new RangeError(""+i);if(t<0||t>=this._state.length)throw new RangeError(""+t);if(e<0||e>=this._state.length)throw new RangeError(""+e);if(t!==e){var r=this._state.getEntry(t);this.listWillMove(t,e,r[1]),this._state.remove(t).insert(e,r[1],r[0]),this.listDidMove(t,e,r[1]);var o=L.empty(2).slot("id",r[0]).slot("from",t).slot("to",e);this.command(L.empty(1).attr("move",o))}return this},e.prototype.splice=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];t<0&&(t=this._state.length+t),t=Math.min(Math.max(0,t),this._state.length),void 0===e&&(e=this._state.length-t);for(var o=[],n=t,s=t+e;n<s;n+=1){this.listWillRemove(t);var a=this._state.getEntry(t);o.push(a[1]),this._state.remove(t),this.listDidRemove(t,a[1]);var u=L.empty(2).slot("id",a[0]).slot("index",t);this.command(L.empty(1).attr("remove",u))}for(n=0;n<i.length;n+=1){var h=t+n,l=this.listWillInsert(h,i[n]);this._state.insert(h,l);var p=this._state.getEntry(h);this.listDidInsert(h,l);u=L.empty(2).slot("id",p[0]).slot("index",h);this.command(R.of("insert",u).concat(l))}return o},e.prototype.clear=function(){this.listWillClear(),this._state.clear(),this.listDidClear(),this.command(L.empty(1).attr("clear"))},e.prototype.forEach=function(t,e){return this._state.forEach(function(i,r,o,n){return t.call(e,i,r,this,n)},this)},e.prototype.values=function(){return this._state.values()},e.prototype.keys=function(){return this._state.keys()},e.prototype.entries=function(){return this._state.entries()},e.prototype.snapshot=function(){return this._state.clone()},e.prototype.setState=function(t){this._state=t},e.prototype.onEventMessage=function(e,i){t.prototype.onEventMessage.call(this,e,i);var r=e.body(),o=r.tag;if("update"===o){var n=r.head().toValue();(s=this._state.lookup(n.get("id"),n.get("index").numberValue()))>=0?this.onUpdateEvent(s,r.body(),n.get("id")):this.onInsertEvent(n.get("index").numberValue(0),r.body(),n.get("id"))}else if("insert"===o){n=r.head().toValue();(s=this._state.lookup(n.get("id"),n.get("index").numberValue()))<0?this.onInsertEvent(n.get("index").numberValue(0),r.body(),n.get("id")):this.onUpdateEvent(s,r.body(),n.get("id"))}else if("move"===o){n=r.head().toValue();(s=this._state.lookup(n.get("id"),n.get("from").numberValue()))>=0&&this.onMoveEvent(s,n.get("to").numberValue(0),n.get("id"))}else if("remove"===o){var s;n=r.head().toValue();(s=this._state.lookup(n.get("id"),n.get("index").numberValue()))>=0&&this.onRemoveEvent(s,n.get("id"))}else if("drop"===o){n=r.head();this.onDropEvent(n.numberValue(0))}else if("take"===o){n=r.head();this.onTakeEvent(n.numberValue(0))}else"clear"===o&&this.onClearEvent()},e.prototype.onUpdateEvent=function(t,e,i){e=this.listWillUpdate(t,e);var r=this._state.get(t)||b.Absent;this._state.set(t,e),this.listDidUpdate(t,e,r)},e.prototype.onInsertEvent=function(t,e,i){e=this.listWillInsert(t,e),this._state.insert(t,e,i),this.listDidInsert(t,e)},e.prototype.onMoveEvent=function(t,e,i){if(t!==(e=Math.min(Math.max(0,e),this._state.length))){var r=this._state.get(t)||b.Absent;this.listWillMove(t,e,r),this._state.remove(t).insert(e,r,i),this.listDidMove(t,e,r)}},e.prototype.onRemoveEvent=function(t,e){this.listWillRemove(t);var i=this._state.get(t)||b.Absent;this._state.remove(t),this.listDidRemove(t,i)},e.prototype.onDropEvent=function(t){this.listWillDrop(t),this._state.drop(t),this.listDidDrop(t)},e.prototype.onTakeEvent=function(t){this.listWillTake(t),this._state.take(t),this.listDidTake(t)},e.prototype.onClearEvent=function(){this.listWillClear(),this._state.clear(),this.listDidClear()},e.prototype.listWillInsert=function(t,e){for(var i=0;i<this._views.length;i+=1)e=this._views[i].listWillInsert(t,e);return e},e.prototype.listDidInsert=function(t,e){for(var i=0;i<this._views.length;i+=1)this._views[i].listDidInsert(t,e)},e.prototype.listWillUpdate=function(t,e){for(var i=0;i<this._views.length;i+=1)e=this._views[i].listWillUpdate(t,e);return e},e.prototype.listDidUpdate=function(t,e,i){for(var r=0;r<this._views.length;r+=1)this._views[r].listDidUpdate(t,e,i)},e.prototype.listWillMove=function(t,e,i){for(var r=0;r<this._views.length;r+=1)this._views[r].listWillMove(t,e,i)},e.prototype.listDidMove=function(t,e,i){for(var r=0;r<this._views.length;r+=1)this._views[r].listDidMove(t,e,i)},e.prototype.listWillRemove=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].listWillRemove(t)},e.prototype.listDidRemove=function(t,e){for(var i=0;i<this._views.length;i+=1)this._views[i].listDidRemove(t,e)},e.prototype.listWillDrop=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].listWillDrop(t)},e.prototype.listDidDrop=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].listDidDrop(t)},e.prototype.listWillTake=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].listWillTake(t)},e.prototype.listDidTake=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].listDidTake(t)},e.prototype.listWillClear=function(){for(var t=0;t<this._views.length;t+=1)this._views[t].listWillClear()},e.prototype.listDidClear=function(){for(var t=0;t<this._views.length;t+=1)this._views[t].listDidClear()},e}(Si),Pi=function(t){function e(e,i,r,o,n,s,a,u,h,l,p,c,d){void 0===l&&(l=3),void 0===p&&(p={});var f=t.call(this,e,i,r,o,n,s,a,u,h,l,p)||this;return r&&(p.willInsert=r.willInsert||p.willInsert,p.didInsert=r.didInsert||p.didInsert,p.willUpdate=r.willUpdate||p.willUpdate,p.didUpdate=r.didUpdate||p.didUpdate,p.willMove=r.willMove||p.willMove,p.didMove=r.didMove||p.didMove,p.willRemove=r.willRemove||p.willRemove,p.didRemove=r.didRemove||p.didRemove,p.willDrop=r.willDrop||p.willDrop,p.didDrop=r.didDrop||p.didDrop,p.willTake=r.willTake||p.willTake,p.didTake=r.didTake||p.didTake,p.willClear=r.willClear||p.willClear,p.didClear=r.didClear||p.didClear,c=r.valueForm?r.valueForm:c),f._valueForm=c||ye.Value,f._state0=d,f}return u(e,t),e.prototype.copy=function(t,i,r,o,n,s,a,u,h,l,p,c){return 10===arguments.length&&(p=this._valueForm,c=this._state0),new e(t,i,void 0,r,o,n,s,a,u,h,l,p,c)},e.prototype.type=function(){return"list"},e.prototype.valueForm=function(t){return void 0===t?this._valueForm:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this.delegate,t,this._state0)},e.prototype.isEmpty=function(){return this._model.isEmpty()},Object.defineProperty(e.prototype,"length",{get:function(){return this._model.length},enumerable:!0,configurable:!0}),e.prototype.get=function(t,e){return this._model.get(t,e).coerce(this._valueForm)},e.prototype.getEntry=function(t,e){var i=this._model.getEntry(t,e);if(i)return[i[0].coerce(this._valueForm),i[1]]},e.prototype.set=function(t,e,i){var r=this._valueForm.mold(e);return this._model.set(t,r,i),this},e.prototype.insert=function(t,e,i){var r=this._valueForm.mold(e);return this._model.insert(t,r,i),this},e.prototype.remove=function(t,e){return this._model.remove(t,e),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=new Array(t.length),r=0;r<t.length;r+=1)i[r]=this._valueForm.mold(t[r]);return this._model.push.apply(this._model,i)},e.prototype.pop=function(){return this._model.pop().coerce(this._valueForm)},e.prototype.unshift=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var i=new Array(t.length),r=0;r<t.length;r+=1)i[r]=this._valueForm.mold(t[r]);return this._model.unshift.apply(this._model,i)},e.prototype.shift=function(){return this._model.shift().coerce(this._valueForm)},e.prototype.move=function(t,e,i){return this._model.move(t,e,i),this},e.prototype.splice=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];for(var o=new Array(i.length),n=0;n<i.length;n+=1)o[n]=this._valueForm.mold(i[n]);var s,a=(s=this._model).splice.apply(s,[t,e].concat(o)),u=new Array(a.length);for(n=0;n<a.length;n+=1)u[n]=a[n].coerce(this._valueForm);return u},e.prototype.clear=function(){this._model.clear()},e.prototype.forEach=function(t,e){return this._valueForm===ye.Value?this._model._state.forEach(t,e):this._model._state.forEach(function(i,r,o,n){var s=i.coerce(this._valueForm);return t.call(e,s,r,this,n)},this)},e.prototype.values=function(){var t=this._model.values();return this._valueForm===ye.Value?t:new xe(t,this._valueForm)},e.prototype.keys=function(){return this._model.keys()},e.prototype.entries=function(){var t=this._model.entries();return this._valueForm===ye.Value?t:new Ae(t,ye.Value,this._valueForm)},e.prototype.snapshot=function(){return this._model.snapshot()},e.prototype.setState=function(t){this._model.setState(t)},e.prototype.willInsert=function(t){return void 0===t?this.delegate.willInsert||null:(this.delegate.willInsert=t||void 0,this)},e.prototype.didInsert=function(t){return void 0===t?this.delegate.didInsert||null:(this.delegate.didInsert=t||void 0,this)},e.prototype.willUpdate=function(t){return void 0===t?this.delegate.willUpdate||null:(this.delegate.willUpdate=t||void 0,this)},e.prototype.didUpdate=function(t){return void 0===t?this.delegate.didUpdate||null:(this.delegate.didUpdate=t||void 0,this)},e.prototype.willMove=function(t){return void 0===t?this.delegate.willMove||null:(this.delegate.willMove=t||void 0,this)},e.prototype.didMove=function(t){return void 0===t?this.delegate.didMove||null:(this.delegate.didMove=t||void 0,this)},e.prototype.willRemove=function(t){return void 0===t?this.delegate.willRemove||null:(this.delegate.willRemove=t||void 0,this)},e.prototype.didRemove=function(t){return void 0===t?this.delegate.didRemove||null:(this.delegate.didRemove=t||void 0,this)},e.prototype.willDrop=function(t){return void 0===t?this.delegate.willDrop||null:(this.delegate.willDrop=t||void 0,this)},e.prototype.didDrop=function(t){return void 0===t?this.delegate.didDrop||null:(this.delegate.didDrop=t||void 0,this)},e.prototype.willTake=function(t){return void 0===t?this.delegate.willTake||null:(this.delegate.willTake=t||void 0,this)},e.prototype.didTake=function(t){return void 0===t?this.delegate.didTake||null:(this.delegate.didTake=t||void 0,this)},e.prototype.willClear=function(t){return void 0===t?this.delegate.willClear||null:(this.delegate.willClear=t||void 0,this)},e.prototype.didClear=function(t){return void 0===t?this.delegate.didClear||null:(this.delegate.didClear=t||void 0,this)},e.prototype.listWillInsert=function(t,e){if(this.delegate.willInsert){var i=e.coerce(this._valueForm);void 0!==(i=this.delegate.willInsert(t,i,this))&&(e=this._valueForm.mold(i))}return e},e.prototype.listDidInsert=function(t,e){if(this.delegate.didInsert){var i=e.coerce(this._valueForm);this.delegate.didInsert(t,i,this)}},e.prototype.listWillUpdate=function(t,e){if(this.delegate.willUpdate){var i=e.coerce(this._valueForm);void 0!==(i=this.delegate.willUpdate(t,i,this))&&(e=this._valueForm.mold(i))}return e},e.prototype.listDidUpdate=function(t,e,i){if(this.delegate.didUpdate){var r=e.coerce(this._valueForm),o=i.coerce(this._valueForm);this.delegate.didUpdate(t,r,o,this)}},e.prototype.listWillMove=function(t,e,i){if(this.delegate.willMove){var r=i.coerce(this._valueForm);this.delegate.willMove(t,e,r,this)}},e.prototype.listDidMove=function(t,e,i){if(this.delegate.didMove){var r=i.coerce(this._valueForm);this.delegate.didMove(t,e,r,this)}},e.prototype.listWillRemove=function(t){this.delegate.willRemove&&this.delegate.willRemove(t,this)},e.prototype.listDidRemove=function(t,e){if(this.delegate.didRemove){var i=e.coerce(this._valueForm);this.delegate.didRemove(t,i,this)}},e.prototype.listWillDrop=function(t){this.delegate.willDrop&&this.delegate.willDrop(t,this)},e.prototype.listDidDrop=function(t){this.delegate.didDrop&&this.delegate.didDrop(t,this)},e.prototype.listWillTake=function(t){this.delegate.willTake&&this.delegate.willTake(t,this)},e.prototype.listDidTake=function(t){this.delegate.didTake&&this.delegate.didTake(t,this)},e.prototype.listWillClear=function(){this.delegate.willClear&&this.delegate.willClear(this)},e.prototype.listDidClear=function(){this.delegate.didClear&&this.delegate.didClear(this)},e.prototype.initialState=function(t){return void 0===t?this._state0||null:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this.delegate,this._valueForm,t||void 0)},e.prototype.didAliasModel=function(){this.onLinkedResponse(),this._model._state.forEach(function(t,e){this.listDidInsert(e,t)},this),this.onSyncedResponse()},e.prototype.open=function(){var t=this._laneUri;if(t.isEmpty())throw new Error("no lane");var e=this._nodeUri;if(e.isEmpty())throw new Error("no node");var i=this._hostUri;i.isEmpty()&&(i=e.base(),e=Kt.unresolve(i,e));var r=this._context.getDownlink(i,e,t);if(r){if(!(r instanceof Ti))throw new Error("downlink type mismatch");r.addDownlink(this),this._model=r,this.didAliasModel()}else(r=new Ti(this._context,i,e,t,this._prio,this._rate,this._body,this._state0)).addDownlink(this),this._context.openDownlink(r),this._model=r;return this._owner&&this._owner.addDownlink(this),this},e}(Vi),Li=function(t){function e(e){var i=t.call(this)||this;return i._downlink=e,i}return u(e,t),Object.defineProperty(e.prototype,"downlink",{get:function(){return this._downlink},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this._downlink.isEmpty()},e.prototype.isArray=function(){return!0},e.prototype.isObject=function(){return this._downlink.isEmpty()},Object.defineProperty(e.prototype,"length",{get:function(){return this._downlink.length},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._downlink.length},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return!1},e.prototype.get=function(t){return b.Absent},e.prototype.getAttr=function(t){return b.Absent},e.prototype.getItem=function(t){t instanceof U&&(t=t.value);var e=this._downlink.length;return t<0&&(t=e+t),(t=Math.min(Math.max(0,t),e-1))>=0?this._downlink.get(t):w.Absent},e.prototype.set=function(t,e){throw new Error("unsupported")},e.prototype.setAttr=function(t,e){throw new Error("unsupported")},e.prototype.setItem=function(t,e){t instanceof U&&(t=t.value);var i=this._downlink.length;return t<0&&(t=i+t),(t=Math.min(Math.max(0,t),i-1))>=0&&this._downlink.set(t,b.fromAny(e)),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._downlink.push.apply(this._downlink,arguments)},e.prototype.splice=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];return this._downlink.splice.apply(this._downlink,arguments)},e.prototype.delete=function(t){return w.Absent},e.prototype.clear=function(){this._downlink.clear()},e.prototype.forEach=function(t,e){return this._downlink.forEach(function(i,r){return t.call(e,i,r)})},e}(L),Fi=function(t){function e(e,i,r,o,n,s,a,u){void 0===u&&(u=new Ze);var h=t.call(this,e,i,r,o,n,s,a)||this;return h._state=u,h}return u(e,t),e.prototype.type=function(){return"map"},Object.defineProperty(e.prototype,"size",{get:function(){return this._state.size},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this._state.isEmpty()},e.prototype.has=function(t){return this._state.has(t)},e.prototype.get=function(t){return this._state.get(t)||b.Absent},e.prototype.getEntry=function(t){return this._state.getEntry(t)},e.prototype.set=function(t,e){e=this.mapWillUpdate(t,e);var i=this._state.get(t)||b.Absent;this._state.set(t,e),this.mapDidUpdate(t,e,i);var r=L.empty(1).slot("key",t);return this.command(R.of("update",r).concat(e)),this},e.prototype.delete=function(t){if(this._state.has(t)){this.mapWillRemove(t);var e=this._state.get(t)||b.Absent;this._state.delete(t),this.mapDidRemove(t,e);var i=L.empty(1).slot("key",t);return this.command(L.empty(1).attr("remove",i)),!0}return!1},e.prototype.drop=function(t){return this.mapWillDrop(t),this._state.drop(t),this.mapDidDrop(t),this.command(L.empty(1).attr("drop",t)),this},e.prototype.take=function(t){return this.mapWillTake(t),this._state.take(t),this.mapDidTake(t),this.command(L.empty(1).attr("take",t)),this},e.prototype.clear=function(){this.mapWillClear(),this._state.clear(),this.mapDidClear(),this.command(L.empty(1).attr("clear"))},e.prototype.forEach=function(t,e){return this._state.forEach(function(i,r){return t.call(e,i,r,this)},this)},e.prototype.keys=function(){return this._state.keys()},e.prototype.values=function(){return this._state.values()},e.prototype.entries=function(){return this._state.entries()},e.prototype.snapshot=function(){return this._state.clone()},e.prototype.setState=function(t){this._state=t},e.prototype.onEventMessage=function(e,i){t.prototype.onEventMessage.call(this,e,i);var r=e.body(),o=r.tag;if("update"===o){var n=r.head().toValue();this.onUpdateEvent(n.get("key"),r.body())}else if("remove"===o){n=r.head().toValue();this.onRemoveEvent(n.get("key"))}else if("drop"===o){n=r.head().toValue();this.onDropEvent(n.numberValue(0))}else if("take"===o){n=r.head().toValue();this.onTakeEvent(n.numberValue(0))}else"clear"===o&&this.onClearEvent()},e.prototype.onUpdateEvent=function(t,e){e=this.mapWillUpdate(t,e);var i=this._state.get(t)||b.Absent;this._state.set(t,e),this.mapDidUpdate(t,e,i)},e.prototype.onRemoveEvent=function(t){this.mapWillRemove(t);var e=this._state.get(t)||b.Absent;this._state.delete(t),this.mapDidRemove(t,e)},e.prototype.onDropEvent=function(t){this.mapWillDrop(t),this._state.drop(t),this.mapDidDrop(t)},e.prototype.onTakeEvent=function(t){this.mapWillTake(t),this._state.take(t),this.mapDidTake(t)},e.prototype.onClearEvent=function(){this.mapWillClear(),this._state.clear(),this.mapDidClear()},e.prototype.mapWillUpdate=function(t,e){for(var i=0;i<this._views.length;i+=1)e=this._views[i].mapWillUpdate(t,e);return e},e.prototype.mapDidUpdate=function(t,e,i){for(var r=0;r<this._views.length;r+=1)this._views[r].mapDidUpdate(t,e,i)},e.prototype.mapWillRemove=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].mapWillRemove(t)},e.prototype.mapDidRemove=function(t,e){for(var i=0;i<this._views.length;i+=1)this._views[i].mapDidRemove(t,e)},e.prototype.mapWillDrop=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].mapWillDrop(t)},e.prototype.mapDidDrop=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].mapDidDrop(t)},e.prototype.mapWillTake=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].mapWillTake(t)},e.prototype.mapDidTake=function(t){for(var e=0;e<this._views.length;e+=1)this._views[e].mapDidTake(t)},e.prototype.mapWillClear=function(){for(var t=0;t<this._views.length;t+=1)this._views[t].mapWillClear()},e.prototype.mapDidClear=function(){for(var t=0;t<this._views.length;t+=1)this._views[t].mapDidClear()},e}(Si),zi=function(t){function e(e,i,r,o,n,s,a,u,h,l,p,c,d,f){void 0===l&&(l=3),void 0===p&&(p={});var y=t.call(this,e,i,r,o,n,s,a,u,h,l,p)||this;return r&&(p.willUpdate=r.willUpdate||p.willUpdate,p.didUpdate=r.didUpdate||p.didUpdate,p.willRemove=r.willRemove||p.willRemove,p.didRemove=r.didRemove||p.didRemove,p.willDrop=r.willDrop||p.willDrop,p.didDrop=r.didDrop||p.didDrop,p.willTake=r.willTake||p.willTake,p.didTake=r.didTake||p.didTake,p.willClear=r.willClear||p.willClear,p.didClear=r.didClear||p.didClear,c=r.keyForm?r.keyForm:c,d=r.valueForm?r.valueForm:d),y._keyForm=c||ye.Value,y._valueForm=d||ye.Value,y._state0=f,y}return u(e,t),e.prototype.copy=function(t,i,r,o,n,s,a,u,h,l,p,c,d){return 10===arguments.length&&(d=this._state0,p=this._keyForm,c=this._valueForm),new e(t,i,void 0,r,o,n,s,a,u,h,l,p,c,d)},e.prototype.type=function(){return"map"},e.prototype.keyForm=function(t){return void 0===t?this._keyForm:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this.delegate,t,this._valueForm,this._state0)},e.prototype.valueForm=function(t){return void 0===t?this._valueForm:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this.delegate,this._keyForm,t,this._state0)},Object.defineProperty(e.prototype,"size",{get:function(){return this._model.size},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this._model.isEmpty()},e.prototype.has=function(t){var e=this._keyForm.mold(t);return this._model.has(e)},e.prototype.get=function(t){var e=this._keyForm.mold(t);return this._model.get(e).coerce(this._valueForm)},e.prototype.getEntry=function(t){var e=this._model.getEntry(t);if(e)return[e[0].coerce(this._keyForm),e[1].coerce(this._valueForm)]},e.prototype.set=function(t,e){var i=this._keyForm.mold(t),r=this._valueForm.mold(e);return this._model.set(i,r),this},e.prototype.delete=function(t){var e=this._keyForm.mold(t);return this._model.delete(e)},e.prototype.drop=function(t){return this._model.drop(t),this},e.prototype.take=function(t){return this._model.take(t),this},e.prototype.clear=function(){this._model.clear()},e.prototype.forEach=function(t,e){return this._keyForm===ye.Value&&this._valueForm===ye.Value?this._model._state.forEach(t,e):this._model._state.forEach(function(i,r){var o=i.coerce(this._keyForm),n=r.coerce(this._valueForm);return t.call(e,o,n,this)},this)},e.prototype.keys=function(){var t=this._model.keys();return this._keyForm===ye.Value?t:new xe(t,this._keyForm)},e.prototype.values=function(){var t=this._model.values();return this._valueForm===ye.Value?t:new xe(t,this._valueForm)},e.prototype.entries=function(){var t=this._model.entries();return this._keyForm===ye.Value&&this._valueForm===ye.Value?t:new Ae(t,this._keyForm,this._valueForm)},e.prototype.snapshot=function(){return this._model.snapshot()},e.prototype.setState=function(t){this._model.setState(t)},e.prototype.willUpdate=function(t){return void 0===t?this.delegate.willUpdate||null:(this.delegate.willUpdate=t||void 0,this)},e.prototype.didUpdate=function(t){return void 0===t?this.delegate.didUpdate||null:(this.delegate.didUpdate=t||void 0,this)},e.prototype.willRemove=function(t){return void 0===t?this.delegate.willRemove||null:(this.delegate.willRemove=t||void 0,this)},e.prototype.didRemove=function(t){return void 0===t?this.delegate.didRemove||null:(this.delegate.didRemove=t||void 0,this)},e.prototype.willDrop=function(t){return void 0===t?this.delegate.willDrop||null:(this.delegate.willDrop=t||void 0,this)},e.prototype.didDrop=function(t){return void 0===t?this.delegate.didDrop||null:(this.delegate.didDrop=t||void 0,this)},e.prototype.willTake=function(t){return void 0===t?this.delegate.willTake||null:(this.delegate.willTake=t||void 0,this)},e.prototype.didTake=function(t){return void 0===t?this.delegate.didTake||null:(this.delegate.didTake=t||void 0,this)},e.prototype.willClear=function(t){return void 0===t?this.delegate.willClear||null:(this.delegate.willClear=t||void 0,this)},e.prototype.didClear=function(t){return void 0===t?this.delegate.didClear||null:(this.delegate.didClear=t||void 0,this)},e.prototype.mapWillUpdate=function(t,e){if(this.delegate.willUpdate){var i=t.coerce(this._keyForm),r=e.coerce(this._valueForm);void 0!==(r=this.delegate.willUpdate(i,r,this))&&(e=this._valueForm.mold(r))}return e},e.prototype.mapDidUpdate=function(t,e,i){if(this.delegate.didUpdate){var r=t.coerce(this._keyForm),o=e.coerce(this._valueForm),n=i.coerce(this._valueForm);this.delegate.didUpdate(r,o,n,this)}},e.prototype.mapWillRemove=function(t){if(this.delegate.willRemove){var e=t.coerce(this._keyForm);this.delegate.willRemove(e,this)}},e.prototype.mapDidRemove=function(t,e){if(this.delegate.didRemove){var i=t.coerce(this._keyForm),r=e.coerce(this._valueForm);this.delegate.didRemove(i,r,this)}},e.prototype.mapWillDrop=function(t){this.delegate.willDrop&&this.delegate.willDrop(t,this)},e.prototype.mapDidDrop=function(t){this.delegate.didDrop&&this.delegate.didDrop(t,this)},e.prototype.mapWillTake=function(t){this.delegate.willTake&&this.delegate.willTake(t,this)},e.prototype.mapDidTake=function(t){this.delegate.didTake&&this.delegate.didTake(t,this)},e.prototype.mapWillClear=function(){this.delegate.willClear&&this.delegate.willClear(this)},e.prototype.mapDidClear=function(){this.delegate.didClear&&this.delegate.didClear(this)},e.prototype.initialState=function(t){return void 0===t?this._state0||null:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this.delegate,this._keyForm,this._valueForm,t||void 0)},e.prototype.didAliasModel=function(){this.onLinkedResponse(),this._model._state.forEach(function(t,e){this.mapDidUpdate(e,t,void 0)},this),this.onSyncedResponse()},e.prototype.open=function(){var t=this._laneUri;if(t.isEmpty())throw new Error("no lane");var e=this._nodeUri;if(e.isEmpty())throw new Error("no node");var i=this._hostUri;i.isEmpty()&&(i=e.base(),e=Kt.unresolve(i,e));var r=this._context.getDownlink(i,e,t);if(r){if(!(r instanceof Fi))throw new Error("downlink type mismatch");r.addDownlink(this),this._model=r,this.didAliasModel()}else(r=new Fi(this._context,i,e,t,this._prio,this._rate,this._body,this._state0)).addDownlink(this),this._context.openDownlink(r),this._model=r;return this._owner&&this._owner.addDownlink(this),this},e}(Vi),Ii=function(t){function e(e){var i=t.call(this)||this;return i._downlink=e,i}return u(e,t),Object.defineProperty(e.prototype,"downlink",{get:function(){return this._downlink},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){return this._downlink.isEmpty()},e.prototype.isArray=function(){return this._downlink.isEmpty()},e.prototype.isObject=function(){return!0},Object.defineProperty(e.prototype,"length",{get:function(){return this._downlink.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._downlink.size},enumerable:!0,configurable:!0}),e.prototype.has=function(t){return this._downlink.has(t)},e.prototype.get=function(t){return this._downlink.get(t)},e.prototype.getAttr=function(t){return b.Absent},e.prototype.getItem=function(t){t instanceof U&&(t=t.value);var e=this._downlink.size;if(t<0&&(t=e+t),(t=Math.min(Math.max(0,t),e-1))>=0){var i=this._downlink.getEntry(t);return T.of(i[0],i[1])}return w.Absent},e.prototype.set=function(t,e){return this._downlink.set(t,e),this},e.prototype.setAttr=function(t,e){throw new Error("unsupported")},e.prototype.setItem=function(t,e){throw new Error("unsupported")},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];throw new Error("unsupported")},e.prototype.splice=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];throw new Error("unsupported")},e.prototype.delete=function(t){t=b.fromAny(t);var e=this._downlink.get(t);return this._downlink.delete(t)?T.of(t,e):w.Absent},e.prototype.clear=function(){this._downlink.clear()},e.prototype.forEach=function(t,e){var i=0;return this._downlink.forEach(function(r,o){var n=t.call(e,T.of(r,o),i);return i+=1,n})},e}(L),Ui=function(t){function e(e,i,r,o,n,s,a,u){void 0===u&&(u=b.Absent);var h=t.call(this,e,i,r,o,n,s,a)||this;return h._state=u,h}return u(e,t),e.prototype.type=function(){return"value"},e.prototype.get=function(){return this._state},e.prototype.set=function(t){t=this.valueWillSet(t);var e=this._state;this.setState(t),this.valueDidSet(t,e),this.command(t)},e.prototype.setState=function(t){this._state=t},e.prototype.onEventMessage=function(e,i){t.prototype.onEventMessage.call(this,e,i),this.onSetEvent(e.body())},e.prototype.onSetEvent=function(t){t=this.valueWillSet(t);var e=this._state;this.setState(t),this.valueDidSet(t,e)},e.prototype.valueWillSet=function(t){for(var e=0;e<this._views.length;e+=1)t=this._views[e].valueWillSet(t);return t},e.prototype.valueDidSet=function(t,e){for(var i=0;i<this._views.length;i+=1)this._views[i].valueDidSet(t,e)},e}(Si),Wi=function(t){function e(e,i,r,o,n,s,a,u,h,l,p,c,d){void 0===l&&(l=3),void 0===p&&(p={}),void 0===d&&(d=b.Absent);var f=t.call(this,e,i,r,o,n,s,a,u,h,l,p)||this;return r&&(p.willSet=r.willSet||p.willSet,p.didSet=r.didSet||p.didSet,c=r.valueForm?r.valueForm:c),f._valueForm=c||ye.Value,f._state0=d,f}return u(e,t),e.prototype.copy=function(t,i,r,o,n,s,a,u,h,l,p,c){return 10===arguments.length&&(c=this._state0,p=this._valueForm),new e(t,i,void 0,r,o,n,s,a,u,h,l,p,c)},e.prototype.type=function(){return"value"},e.prototype.valueForm=function(t){return void 0===t?this._valueForm:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this.delegate,t,this._state0)},e.prototype.get=function(){return this._model.get()},e.prototype.set=function(t){var e=this._valueForm.mold(t);this._model.set(e)},e.prototype.setState=function(t){this._model.setState(t)},e.prototype.willSet=function(t){return void 0===t?this.delegate.willSet||null:(this.delegate.willSet=t||void 0,this)},e.prototype.didSet=function(t){return void 0===t?this.delegate.didSet||null:(this.delegate.didSet=t||void 0,this)},e.prototype.valueWillSet=function(t){if(this.delegate.willSet){var e=t.coerce(this._valueForm);void 0!==(e=this.delegate.willSet(e,this))&&(t=this._valueForm.mold(e))}return t},e.prototype.valueDidSet=function(t,e){if(this.delegate.didSet){var i=t.coerce(this._valueForm),r=e.coerce(this._valueForm);this.delegate.didSet(i,r,this)}},e.prototype.initialState=function(t){return void 0===t?this._state0:this.copy(this._context,this._owner,this._hostUri,this._nodeUri,this._laneUri,this._prio,this._rate,this._body,this._flags,this.delegate,this._valueForm,t)},e.prototype.didAliasModel=function(){this.onLinkedResponse(),this.valueDidSet(this.get(),b.Absent),this.onSyncedResponse()},e.prototype.open=function(){var t=this._laneUri;if(t.isEmpty())throw new Error("no lane");var e=this._nodeUri;if(e.isEmpty())throw new Error("no node");var i=this._hostUri;i.isEmpty()&&(i=e.base(),e=Kt.unresolve(i,e));var r=this._context.getDownlink(i,e,t);if(r){if(!(r instanceof Ui))throw new Error("downlink type mismatch");r.addDownlink(this),this._model=r,this.didAliasModel()}else(r=new Ui(this._context,i,e,t,this._prio,this._rate,this._body,this._state0)).addDownlink(this),this._context.openDownlink(r),this._model=r;return this._owner&&this._owner.addDownlink(this),this},e}(Vi),Oi=function(t){function e(e){var i=t.call(this)||this;return i._downlink=e,i}return u(e,t),Object.defineProperty(e.prototype,"downlink",{get:function(){return this._downlink},enumerable:!0,configurable:!0}),e.prototype.isEmpty=function(){var t=this._downlink.get();return t instanceof L?t.isEmpty():!t.isDefined()},e.prototype.isArray=function(){var t=this._downlink.get();return t instanceof L?t.isArray():!t.isDefined()||t instanceof b},e.prototype.isObject=function(){var t=this._downlink.get();return t instanceof L?t.isObject():!t.isDefined()||t instanceof M},Object.defineProperty(e.prototype,"length",{get:function(){var t=this._downlink.get();return t instanceof L?t.length:t.isDefined()?1:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var t=this._downlink.get();return t instanceof L?t.size:t.isDefined()?1:0},enumerable:!0,configurable:!0}),e.prototype.has=function(t){var e=this._downlink.get();return e instanceof L&&e.has(t)},e.prototype.get=function(t){var e=this._downlink.get();return e instanceof L?e.get(t):b.Absent},e.prototype.getAttr=function(t){var e=this._downlink.get();return e instanceof L?e.getAttr(t):b.Absent},e.prototype.getItem=function(t){var e=this._downlink.get();return e instanceof L?e.getItem(t):e},e.prototype.set=function(t,e){var i=this._downlink.get();if(!(i instanceof L))throw new Error("unsupported");return i.set(t,e),this},e.prototype.setAttr=function(t,e){var i=this._downlink.get();if(!(i instanceof L))throw new Error("unsupported");return i.setAttr(t,e),this},e.prototype.setItem=function(t,e){var i=this._downlink.get();return i instanceof L?i.setItem(t,e):this._downlink.set(b.fromAny(e)),this},e.prototype.push=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var i=this._downlink.get();if(i instanceof L)return i.push.apply(i,arguments);throw new Error("unsupported")},e.prototype.splice=function(t,e){for(var i=[],r=2;r<arguments.length;r++)i[r-2]=arguments[r];var o=this._downlink.get();if(o instanceof L)return o.splice.apply(o,arguments);throw new Error("unsupported")},e.prototype.delete=function(t){var e=this._downlink.get();return e instanceof L?e.delete(t):b.Absent},e.prototype.clear=function(){var t=this._downlink.get();if(!(t instanceof L))throw new Error("unsupported");t.clear()},e.prototype.forEach=function(t,e){return this._downlink.get().forEach(t,e)},e}(L),Bi=function(){function t(t){this._context=t,this._remote=void 0,this._downlinks=[],this.delegate={}}return t.prototype.isConnected=function(){return!!this._remote&&this._remote.isConnected()},t.prototype.isAuthenticated=function(){return!!this._remote&&this._remote.isAuthenticated()},Object.defineProperty(t.prototype,"session",{get:function(){return this._remote?this._remote.session:b.Absent},enumerable:!0,configurable:!0}),t.prototype.authenticate=function(t){this._context.authenticate(this.hostUri(),t)},t.prototype.addDownlink=function(t){0===this._downlinks.length&&this.open(),this._downlinks.push(t)},t.prototype.removeDownlink=function(t){var e=this._downlinks.indexOf(t);e>=0&&(this._downlinks.splice(e,1),0===this._downlinks.length&&this.close())},t.prototype.open=function(){this._context.openRef(this)},t.prototype.close=function(){this._context.closeRef(this)},t.prototype.closeUp=function(){var t=this._downlinks;this._downlinks=[];for(var e=0,i=t.length;e<i;e+=1)t[e].close()},t.prototype.didConnect=function(t){return void 0===t?this.delegate.didConnect||null:(this.delegate.didConnect=t||void 0,this)},t.prototype.didAuthenticate=function(t){return void 0===t?this.delegate.didAuthenticate||null:(this.delegate.didAuthenticate=t||void 0,this)},t.prototype.didDeauthenticate=function(t){return void 0===t?this.delegate.didDeauthenticate||null:(this.delegate.didDeauthenticate=t||void 0,this)},t.prototype.didDisconnect=function(t){return void 0===t?this.delegate.didDisconnect||null:(this.delegate.didDisconnect=t||void 0,this)},t.prototype.didFail=function(t){return void 0===t?this.delegate.didFail||null:(this.delegate.didFail=t||void 0,this)},t.prototype.hostDidConnect=function(t){this._remote=t,this.delegate.didConnect&&this.delegate.didConnect(t,this)},t.prototype.hostDidAuthenticate=function(t,e){this.delegate.didAuthenticate&&this.delegate.didAuthenticate(t,e,this)},t.prototype.hostDidDeauthenticate=function(t,e){this.delegate.didDeauthenticate&&this.delegate.didDeauthenticate(t,e,this)},t.prototype.hostDidDisconnect=function(t){this._remote=void 0,this.delegate.didDisconnect&&this.delegate.didDisconnect(t,this)},t.prototype.hostDidFail=function(t,e){this.delegate.didFail&&this.delegate.didFail(t,e,this)},t}(),qi=function(t){function e(e,i){var r=t.call(this,e)||this;return r._hostUri=i,r}return u(e,t),e.prototype.hostUri=function(){return this._hostUri},e.prototype.nodeRef=function(t){return t=Kt.fromAny(t),new Gi(this._context,this._hostUri,t)},e.prototype.laneRef=function(t,e){return t=Kt.fromAny(t),e=Kt.fromAny(e),new Hi(this._context,this._hostUri,t,e)},e.prototype.downlink=function(t){return new Ri(this._context,this,t,this._hostUri)},e.prototype.downlinkList=function(t){return new Pi(this._context,this,t,this._hostUri)},e.prototype.downlinkMap=function(t){return new zi(this._context,this,t,this._hostUri)},e.prototype.downlinkValue=function(t){return new Wi(this._context,this,t,this._hostUri)},e.prototype.command=function(t,e,i){this._context.command(this._hostUri,t,e,i)},e}(Bi),Gi=function(t){function e(e,i,r){var o=t.call(this,e)||this;return o._hostUri=i,o._nodeUri=r,o}return u(e,t),e.prototype.hostUri=function(){return this._hostUri},e.prototype.nodeUri=function(){return this._nodeUri},e.prototype.laneRef=function(t){return t=Kt.fromAny(t),new Hi(this._context,this._hostUri,this._nodeUri,t)},e.prototype.downlink=function(t){return new Ri(this._context,this,t,this._hostUri,this._nodeUri)},e.prototype.downlinkList=function(t){return new Pi(this._context,this,t,this._hostUri,this._nodeUri)},e.prototype.downlinkMap=function(t){return new zi(this._context,this,t,this._hostUri,this._nodeUri)},e.prototype.downlinkValue=function(t){return new Wi(this._context,this,t,this._hostUri,this._nodeUri)},e.prototype.command=function(t,e){this._context.command(this._hostUri,this._nodeUri,t,e)},e}(Bi),Hi=function(t){function e(e,i,r,o){var n=t.call(this,e)||this;return n._hostUri=i,n._nodeUri=r,n._laneUri=o,n}return u(e,t),e.prototype.hostUri=function(){return this._hostUri},e.prototype.nodeUri=function(){return this._nodeUri},e.prototype.laneUri=function(){return this._laneUri},e.prototype.downlink=function(t){return new Ri(this._context,this,t,this._hostUri,this._nodeUri,this._laneUri)},e.prototype.downlinkList=function(t){return new Pi(this._context,this,t,this._hostUri,this._nodeUri,this._laneUri)},e.prototype.downlinkMap=function(t){return new zi(this._context,this,t,this._hostUri,this._nodeUri,this._laneUri)},e.prototype.downlinkValue=function(t){return new Wi(this._context,this,t,this._hostUri,this._nodeUri,this._laneUri)},e.prototype.command=function(t){this._context.command(this._hostUri,this._nodeUri,this._laneUri,t)},e}(Bi),Ni=function(t){function e(e){var i=t.call(this,e)||this;return i._downlinks=[],i}return u(e,t),e.prototype.addDownlink=function(t){this._downlinks.push(t)},e.prototype.removeDownlink=function(t){var e=this._downlinks.indexOf(t);e>=0&&this._downlinks.splice(e,1)},e.prototype.initDownlink=function(t,e){return t},e.prototype.downlink=function(t,e){return void 0===e&&(e=this.stack()),new Ri(this.downlinkContext,this,this.initDownlink(t,e))},e.prototype.downlinkList=function(t,e){return void 0===e&&(e=this.stack()),new Pi(this.downlinkContext,this,this.initDownlink(t,e))},e.prototype.downlinkMap=function(t,e){return void 0===e&&(e=this.stack()),new zi(this.downlinkContext,this,this.initDownlink(t,e))},e.prototype.downlinkValue=function(t,e){return void 0===e&&(e=this.stack()),new Wi(this.downlinkContext,this,this.initDownlink(t,e))},e.prototype.importDownlink=function(t,e){var i,r;if(ji(t)){var o=t,n=o.downlink;if(i=t.declaration,!(r=this.initDownlink(Vi.InitForm.cast(i.evaluate(e).toValue()),e)))return n.close(),o.declaration;if(n.hostUri().equals(r.hostUri)&&n.nodeUri().equals(r.nodeUri)&&n.laneUri().equals(r.laneUri))return o;n.close()}else i=t,r=Vi.InitForm.cast(i.evaluate(e).toValue());if(r)try{if("list"===r.type)return new Yi(this,this.downlinkList(r).open(),i);if("map"===r.type)return new Xi(this,this.downlinkMap(r).open(),i);if("value"===r.type)return new Ki(this,this.downlinkValue(r).open(),i)}catch(t){}return t},e.prototype.materializeValue=function(t,e){if("link"===t.tag){var i=this.importDownlink(t,e);if(ji(i))return i}return t},e.prototype.materializeItem=function(t,e){if(t instanceof M){if((i=t.value)!==(r=this.materializeValue(i,e)))return t.withValue(r)}else if(t instanceof b){var i,r;if((i=t)!==(r=this.materializeValue(i,e)))return r}return t},e.prototype.materializeScope=function(t){void 0===t&&(t=this.stack());for(var e=this._record,i=e.length,r=0;r<i;){var o=e.getItem(r),n=this.materializeItem(o,t);n.isDefined()?(o!==n&&e.setItem(r,n),r+=1):e.splice(r,1)}},e.prototype.close=function(){var t=this._downlinks;this._downlinks=[];for(var e=0,i=t.length;e<i;e+=1)t[e].close()},e}(Qe);function ji(t){return!!(t instanceof L&&t.declaration)}var Yi=function(t){function e(e,i,r){var o=t.call(this,i)||this;return o._scope=e,o._declaration=r.commit(),o.downlink.delegate=o,o}return u(e,t),Object.defineProperty(e.prototype,"declaration",{get:function(){return this._declaration},enumerable:!0,configurable:!0}),e.prototype.didInsert=function(t,e){this._scope.didChange(e,b.Absent,t)},e.prototype.didUpdate=function(t,e,i){this._scope.didChange(e,i,t)},e.prototype.didMove=function(t,e,i){this._scope.didChange(i,i,e)},e.prototype.didRemove=function(t,e){this._scope.didChange(b.Absent,e,t)},e.prototype.didDrop=function(t){this._scope.didChange()},e.prototype.didTake=function(t){this._scope.didChange()},e.prototype.didClear=function(){this._scope.didChange()},e}(Li),Xi=function(t){function e(e,i,r){var o=t.call(this,i)||this;return o._scope=e,o._declaration=r.commit(),o.downlink.delegate=o,o}return u(e,t),Object.defineProperty(e.prototype,"declaration",{get:function(){return this._declaration},enumerable:!0,configurable:!0}),e.prototype.didUpdate=function(t,e,i){this._scope.didChange(T.of(t,e),T.of(t,i))},e.prototype.didRemove=function(t,e){this._scope.didChange(w.Absent,T.of(t,e))},e.prototype.didDrop=function(t){this._scope.didChange()},e.prototype.didTake=function(t){this._scope.didChange()},e.prototype.didClear=function(){this._scope.didChange()},e}(Ii),Ki=function(t){function e(e,i,r){var o=t.call(this,i)||this;return o._scope=e,o._declaration=r.commit(),o.downlink.delegate=o,o}return u(e,t),Object.defineProperty(e.prototype,"declaration",{get:function(){return this._declaration},enumerable:!0,configurable:!0}),e.prototype.didSet=function(t,e){this._scope.didChange(t,e)},e}(Oi),Qi=function(t){function e(e,i,r){void 0===r&&(r={});var o=t.call(this,e,i,r)||this;return o.onWebSocketOpen=o.onWebSocketOpen.bind(o),o.onWebSocketMessage=o.onWebSocketMessage.bind(o),o.onWebSocketClose=o.onWebSocketClose.bind(o),o.onWebSocketError=o.onWebSocketError.bind(o),o}return u(e,t),Object.defineProperty(e.prototype,"WebSocket",{get:function(){return this._options.WebSocket||"undefined"!=typeof WebSocket&&WebSocket||"function"==typeof require&&require("ws")||void 0},enumerable:!0,configurable:!0}),e.prototype.isConnected=function(){return!!this._socket&&this._socket.readyState===this._socket.OPEN},e.prototype.open=function(){if(this.clearReconnect(),!this._socket){var t=this.WebSocket;if(!t)throw new Error("undefined WebSocket");var e=this._hostUri;"swim"===e.scheme().name?e=e.scheme("ws"):"swims"===e.scheme().name&&(e=e.scheme("wss")),this._options.protocols?this._socket=new t(e.toUri(),this._options.protocols):this._socket=new t(e.toUri()),this._socket.onopen=this.onWebSocketOpen,this._socket.onmessage=this.onWebSocketMessage,this._socket.onclose=this.onWebSocketClose,this._socket.onerror=this.onWebSocketError}},e.prototype.close=function(){this.clearReconnect(),this.clearIdle(),this._socket?(this._socket.close(),this._context.isOnline()||this.onWebSocketClose()):t.prototype.close.call(this)},e.prototype.push=function(t){if(this.isConnected()){this.clearIdle();var e=t.toRecon();this._socket.send(e),this.watchIdle()}else if(t instanceof yi){if(!(this._sendBuffer.length<this.sendBufferSize))throw new Error("send buffer overflow");this._sendBuffer.push(t),this.open()}},e.prototype.onWebSocketOpen=function(){if(this.isConnected()){var t=this.credentials;if(t.isDefined()){var e=new xi(t);this.push(e)}this.onConnect();for(var i=void 0;(i=this._sendBuffer.shift())&&this.isConnected();)this.push(i);this.watchIdle()}else this.close()},e.prototype.onWebSocketMessage=function(t){var e=t.data;if("string"==typeof e){var i=li.parseRecon(e);i?this.onEnvelope(i):this.onUnknownEnvelope(e)}},e.prototype.onWebSocketClose=function(){this._socket&&(this._socket.onopen=void 0,this._socket.onmessage=void 0,this._socket.onclose=void 0,this._socket.onerror=void 0,this._socket=void 0),this.onDisconnect(),this.clearIdle(),this.isIdle()?this.close():this._context.isOnline()&&this.reconnect()},e.prototype.onWebSocketError=function(){this.onError(),this._socket&&this._socket.close()},e}(Ci),Zi=function(){function t(t){void 0===t&&(t={}),this._options=t,this._hosts=new Ze,this._downlinks=new Ze,this._downlinkCount=0,this._refs=[],this._online=!0,this.delegate={},this.onOnline=this.onOnline.bind(this),this.onOffline=this.onOffline.bind(this),this.watchOnline(!!t.keepOnline)}return t.prototype.isOnline=function(t){return void 0===t?this._online:(this._online!==t&&(this._online=t,this._hosts.forEach(function(e,i){t?i.open():i.close()},this)),this)},t.prototype.keepOnline=function(t){return void 0===t?!!this._options.keepOnline:(this._options.keepOnline!==t&&(this._options.keepOnline=t,this.watchOnline(t)),this)},t.prototype.watchOnline=function(t){"object"==typeof window&&(t?(window.addEventListener("online",this.onOnline),window.addEventListener("offline",this.onOffline)):(window.removeEventListener("online",this.onOnline),window.removeEventListener("offline",this.onOffline)))},t.prototype.onOnline=function(t){this.isOnline(!0)},t.prototype.onOffline=function(t){this.isOnline(!1)},t.prototype.getHost=function(t){return t=Kt.fromAny(t),this._hosts.get(t)},t.prototype.openHost=function(t){t=Kt.fromAny(t);var e=this._hosts.get(t);return e||(e=new Qi(this,t,this._options),this._hosts.set(t,e)),e},t.prototype.closeHost=function(t){this._hosts.get(t._hostUri)&&(this._hosts.delete(t._hostUri),t.closeUp())},t.prototype.getDownlink=function(t,e,i){var r=this._downlinks.get(t);if(r){var o=r.get(e);if(o)return o.get(i)}},t.prototype.openDownlink=function(t){var e=t.hostUri(),i=t.nodeUri(),r=t.laneUri(),o=this._downlinks.get(e);o||(o=new Ze,this._downlinks.set(e,o));var n=o.get(i);if(n||(n=new Ze,o.set(i,n)),n.has(r))throw new Error("duplicate downlink");n.set(r,t),this._downlinkCount+=1,this.openHost(e).openDownlink(t)},t.prototype.unlinkDownlink=function(t){var e=t.hostUri(),i=this.getHost(e);i&&i.unlinkDownlink(t)},t.prototype.closeDownlink=function(t){var e=t.hostUri(),i=t.nodeUri(),r=t.laneUri(),o=this._downlinks.get(e);if(o){var n=o.get(i);if(n&&n.get(r)){this._downlinkCount-=1,n.delete(r),n.isEmpty()&&(o.delete(i),o.isEmpty()&&this._downlinks.delete(e));var s=this.getHost(e);s&&s.closeDownlink(t)}}},t.prototype.downlink=function(t){return new Ri(this,void 0,t)},t.prototype.downlinkList=function(t){return new Pi(this,void 0,t)},t.prototype.downlinkMap=function(t){return new zi(this,void 0,t)},t.prototype.downlinkValue=function(t){return new Wi(this,void 0,t)},t.prototype.openRef=function(t){this._refs.push(t)},t.prototype.closeRef=function(t){var e=this._refs.indexOf(t);e>=0&&(this._refs.splice(e,1),t.closeUp())},t.prototype.hostRef=function(t){return t=Kt.fromAny(t),new qi(this,t)},t.prototype.nodeRef=function(t,e){return t=Kt.fromAny(t),e=void 0===e?(t=(e=t).base()).unresolve(e):Kt.fromAny(e),new Gi(this,t,e)},t.prototype.laneRef=function(t,e,i){return t=Kt.fromAny(t),e=Kt.fromAny(e),void 0===i?(i=e,e=(t=(e=t).base()).unresolve(e)):i=Kt.fromAny(i),new Hi(this,t,e,i)},t.prototype.authenticate=function(t,e){t=Kt.fromAny(t),e=b.fromAny(e),this.openHost(t).authenticate(e)},t.prototype.command=function(t,e,i,r){t=Kt.fromAny(t),e=Kt.fromAny(e),3===arguments.length?(r=i,i=e,e=(t=(e=t).base()).unresolve(e)):i=Kt.fromAny(i),r=b.fromAny(r),this.openHost(t).command(e,i,r)},t.prototype.close=function(){var t=this._refs;this._refs=[];for(var e=0;e<t.length;e+=1)t[e].closeUp();var i=this._downlinks.clone();this._downlinks.clear(),this._downlinkCount=0,i.forEach(function(t,e){e.forEach(function(e,i){i.forEach(function(e,i){i.closeUp();var r=this.getHost(t);r&&r.closeDownlink(i)},this)},this)},this);var r=this._hosts.clone();this._hosts.clear(),r.forEach(function(t,e){e.closeUp()},this)},t.prototype.didConnect=function(t){return void 0===t?this.delegate.didConnect||null:(this.delegate.didConnect=t||void 0,this)},t.prototype.didAuthenticate=function(t){return void 0===t?this.delegate.didAuthenticate||null:(this.delegate.didAuthenticate=t||void 0,this)},t.prototype.didDeauthenticate=function(t){return void 0===t?this.delegate.didDeauthenticate||null:(this.delegate.didDeauthenticate=t||void 0,this)},t.prototype.didDisconnect=function(t){return void 0===t?this.delegate.didDisconnect||null:(this.delegate.didDisconnect=t||void 0,this)},t.prototype.didFail=function(t){return void 0===t?this.delegate.didFail||null:(this.delegate.didFail=t||void 0,this)},t.prototype.hostDidConnect=function(t){this.delegate.didConnect&&this.delegate.didConnect(t,this);for(var e=0;e<this._refs.length;e+=1){var i=this._refs[e];i.hostUri().equals(t._hostUri)&&i.hostDidConnect(t)}},t.prototype.hostDidAuthenticate=function(t,e){this.delegate.didAuthenticate&&this.delegate.didAuthenticate(t,e,this);for(var i=0;i<this._refs.length;i+=1){var r=this._refs[i];r.hostUri().equals(e._hostUri)&&r.hostDidAuthenticate(t,e)}},t.prototype.hostDidDeauthenticate=function(t,e){this.delegate.didDeauthenticate&&this.delegate.didDeauthenticate(t,e,this);for(var i=0;i<this._refs.length;i+=1){var r=this._refs[i];r.hostUri().equals(e._hostUri)&&r.hostDidDeauthenticate(t,e)}},t.prototype.hostDidDisconnect=function(t){this.delegate.didDisconnect&&this.delegate.didDisconnect(t,this);for(var e=0;e<this._refs.length;e+=1){var i=this._refs[e];i.hostUri().equals(t._hostUri)&&i.hostDidDisconnect(t)}},t.prototype.hostDidFail=function(t,e){this.delegate.didFail&&this.delegate.didFail(t,e,this);for(var i=0;i<this._refs.length;i+=1){var r=this._refs[i];r.hostUri().equals(e._hostUri)&&r.hostDidFail(t,e)}},t}(),Ji=new Zi,$i=Ji.isOnline.bind(Ji),tr=Ji.keepOnline.bind(Ji),er=Ji.downlink.bind(Ji),ir=Ji.downlinkList.bind(Ji),rr=Ji.downlinkMap.bind(Ji),or=Ji.downlinkValue.bind(Ji),nr=Ji.hostRef.bind(Ji),sr=Ji.nodeRef.bind(Ji),ar=Ji.laneRef.bind(Ji),ur=Ji.authenticate.bind(Ji),hr=Ji.command.bind(Ji),lr=function(t,e){void 0===e&&(e={});var i=document.createEvent("CustomEvent");return i.initCustomEvent(t,e.bubbles||!1,e.cancelable||!1,e.detail),i.__proto__=this.__proto__,i};"undefined"!=typeof Event&&(lr.prototype=Event.prototype);var pr=function(){function t(t){this.callback=t,this.observationTargets=[],this.activeTargets=[],this.skippedTargets=[],vr.addObserver(this)}return t.prototype.observe=function(t){for(var e=0;e<this.observationTargets.length;e+=1)if(t===this.observationTargets[e].target)return;var i=new fr(t);this.observationTargets.push(i),vr.redetect()},t.prototype.unobserve=function(t){for(var e=0;e<this.observationTargets.length;e+=1)t===this.observationTargets[e].target&&this.observationTargets.splice(e,1);this.observationTargets.length||vr.removeObserver(this)},t.prototype.gatherActive=function(t){this.clearActive(),this.clearSkipped();for(var e=0;e<this.observationTargets.length;e+=1){var i=this.observationTargets[e];if(i.isActive())gr(i.target)>t?this.activeTargets.push(i):this.skippedTargets.push(i)}},t.prototype.broadcastActive=function(t){if(this.hasActive()){for(var e=[],i=0;i<this.activeTargets.length;i+=1){var r=this.observationTargets[i],o=new dr(r.target);e.push(o),r.broadcastWidth=o.contentRect.width,r.broadcastHeight=o.contentRect.height;var n=gr(r.target);n<t&&(t=n)}this.callback(e,this),this.clearActive()}return t},t.prototype.hasActive=function(){return this.activeTargets.length>0},t.prototype.hasSkipped=function(){return this.skippedTargets.length>0},t.prototype.clearActive=function(){this.activeTargets.length=0},t.prototype.clearSkipped=function(){this.skippedTargets.length=0},t.prototype.disconnect=function(){this.clearActive(),this.observationTargets.length=0,vr.removeObserver(this)},t}(),cr="undefined"!=typeof window&&void 0!==window.ResizeObserver?window.ResizeObserver:pr,dr=function(){return function(t,e){this.target=t,this.contentRect=e||wr(t)}}(),fr=function(){function t(t){this.target=t,this.broadcastWidth=0,this.broadcastHeight=0}return t.prototype.isActive=function(){var t=wr(this.target);return!!t&&(Math.round(t.width)!==Math.round(this.broadcastWidth)||Math.round(t.height)!==Math.round(this.broadcastHeight))},t}(),yr=function(){function t(){this.resizeObservers=[],this.mutationObserver=void 0,this.detectAnimationFrame=0,this.connected=!1,this.onResize=this.onResize.bind(this),this.onTransitionEnd=this.onTransitionEnd.bind(this),this.onMutation=this.onMutation.bind(this),this.onSubtreeModified=void 0,this.onDetectAnimationFrame=this.onDetectAnimationFrame.bind(this)}return t.prototype.addObserver=function(t){this.resizeObservers.indexOf(t)<0&&this.resizeObservers.push(t),this.connect()},t.prototype.removeObserver=function(t){var e=this.resizeObservers.indexOf(t);e>=0&&this.resizeObservers.splice(e,1),this.resizeObservers.length||this.disconnect()},t.prototype.gatherActive=function(t){for(var e=0;e<this.resizeObservers.length;e+=1)this.resizeObservers[e].gatherActive(t)},t.prototype.hasActive=function(){for(var t=0;t<this.resizeObservers.length;t+=1)if(this.resizeObservers[t].hasActive())return!0;return!1},t.prototype.hasSkipped=function(){for(var t=0;t<this.resizeObservers.length;t+=1)if(this.resizeObservers[t].hasSkipped())return!0;return!1},t.prototype.broadcastActive=function(){for(var t=Number.POSITIVE_INFINITY,e=0;e<this.resizeObservers.length;e+=1)t=this.resizeObservers[e].broadcastActive(t);return t},t.prototype.detect=function(){var t=0;this.gatherActive(t);do{t=this.broadcastActive(),this.gatherActive(t)}while(this.hasActive());this.hasSkipped()&&window.dispatchEvent(new ErrorEvent("ResizeObserver loop completed with undelivered notifications."))},t.prototype.redetect=function(){this.detectAnimationFrame||(this.detectAnimationFrame=requestAnimationFrame(this.onDetectAnimationFrame))},t.prototype.onDetectAnimationFrame=function(t){this.detectAnimationFrame=0,this.detect()},t.prototype.onResize=function(t){this.redetect()},t.prototype.onTransitionEnd=function(t){for(var e=!1,i=0;i<mr.length;i+=1)if(t.propertyName.indexOf(mr[i])>=0){e=!0;break}e&&this.redetect()},t.prototype.onMutation=function(t){for(var e=0;e<t.length;e+=1){var i=t[e];if("childList"===i.type&&i.addedNodes&&i.addedNodes.length>0)for(var r=0;r<i.addedNodes.length;r+=1)this.addShadows(i.addedNodes[r])}this.redetect()},t.prototype.addShadows=function(t){if(t instanceof Element){for(var e=0;e<t.childNodes.length;e+=1)this.addShadows(t.childNodes[e]);t.shadowRoot&&(this.observe(t.shadowRoot),this.addShadows(t.shadowRoot))}},t.prototype.observe=function(t){this.mutationObserver.observe(t,{attributes:!0,childList:!0,characterData:!0,subtree:!0})},t.prototype.connect=function(){if(!this.connected){window.addEventListener("resize",this.onResize),document.addEventListener("transitionend",this.onTransitionEnd);var t="undefined"!=typeof navigator&&/Trident\/.*rv:11/.test(navigator.userAgent);"undefined"==typeof MutationObserver||t?(this.onSubtreeModified=this.onResize,document.addEventListener("DOMSubtreeModified",this.onSubtreeModified)):(this.mutationObserver=new MutationObserver(this.onMutation),this.observe(document),this.addShadows(document)),this.connected=!0}},t.prototype.disconnect=function(){this.connected&&(window.removeEventListener("resize",this.onResize),document.removeEventListener("transitionend",this.onTransitionEnd),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=void 0),this.onSubtreeModified&&(document.removeEventListener("DOMSubtreeModified",this.onSubtreeModified),this.onSubtreeModified=void 0),this.detectAnimationFrame&&(cancelAnimationFrame(this.detectAnimationFrame),this.detectAnimationFrame=0),this.connected=!1)},t}(),mr=["top","right","bottom","left","width","height","size","weight"],vr=new yr;function gr(t){for(var e=0;t.parentNode;)t=t.parentNode,e+=1;return e}function wr(t){return t instanceof HTMLElement?function(t){if(!t.clientWidth&&!t.clientHeight)return _r(0,0,0,0);var e=getComputedStyle(t),i=br(e.getPropertyValue("padding-left")),r=br(e.getPropertyValue("padding-top")),o=i+br(e.getPropertyValue("padding-right")),n=r+br(e.getPropertyValue("padding-bottom")),s=br(e.getPropertyValue("width")),a=br(e.getPropertyValue("height"));"border-box"===e.getPropertyValue("box-sizing")&&(Math.round(s+o)!==t.clientWidth&&(s-=o+br(e.getPropertyValue("border-left-width"))+br(e.getPropertyValue("border-right-width"))),Math.round(a+n)!==t.clientHeight&&(a-=n+br(e.getPropertyValue("border-top-width"))+br(e.getPropertyValue("border-bottom-width"))));if(t!==document.documentElement){var u=Math.round(s+o)-t.clientWidth,h=Math.round(a+n)-t.clientHeight;1!==Math.abs(u)&&(s-=u),1!==Math.abs(h)&&(a-=h)}return _r(i,r,s,a)}(t):(i=t,("undefined"!=typeof SVGGraphicsElement?i instanceof SVGGraphicsElement:i instanceof SVGElement&&"function"==typeof i.getBBox)?_r(0,0,(e=t.getBBox()).width,e.height):_r(0,0,0,0));var e,i}function br(t){return parseFloat(t)||0}function _r(t,e,i,r){return{x:t,y:e,width:i,height:r,top:e,right:t+i,bottom:e+r,left:t}}var xr=function(){function t(t){this._offset=t}return Object.defineProperty(t.prototype,"name",{get:function(){if(0===this._offset)return"UTC"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"offset",{get:function(){return this._offset},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){return this===e||e instanceof t&&this._offset===e._offset},t.prototype.hashCode=function(){return this._offset},t.forName=function(e){if("UTC"===e)return t.UTC;throw new Error("unknown time zone: "+e)},t.forOffset=function(e){return 0===e?t.UTC:new t(e)},t.fromAny=function(e){if(e instanceof t)return e;if("string"==typeof e)return t.forName(e);if("number"==typeof e)return t.forOffset(e);throw new TypeError(""+e)},t.UTC=new t(0),t.Form=void 0,t.Local=t.forOffset(-(new Date).getTimezoneOffset()),t}(),Ar=function(t){function e(e){void 0===e&&(e=xr.UTC);var i=t.call(this)||this;return i.unit=e,i}return u(e,t),e.prototype.mold=function(t){return t=xr.fromAny(t),U.valueOf(t._offset)},e.prototype.cast=function(t){var e=t.numberValue();if(void 0!==e)return xr.forOffset(e);var i=t.stringValue();return void 0!==i?xr.forName(i):void 0},e}(ye);xr.Form=new Ar;var kr=function(){function t(e,i,r,o,n){void 0===e&&(e=t.Periods),void 0===i&&(i=t.Weekdays),void 0===r&&(r=t.ShortWeekdays),void 0===o&&(o=t.Months),void 0===n&&(n=t.ShortMonths),this.periods=e,this.weekdays=i,this.shortWeekdays=r,this.months=o,this.shortMonths=n}return t.Periods=["AM","PM"],t.Weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t.ShortWeekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t.Months=["January","February","March","April","May","June","July","August","September","October","November","December"],t.ShortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t.Default=new t,t}(),Er=function(){function t(){}return t.prototype.format=function(t){t=oo.fromAny(t);var e=new g;return this.writeDate(t,e),e.bind()},t.prototype.parse=function(t){for("string"==typeof t&&(t=new v(t));!t.isEmpty()&&_.isSpace(t.head());)t.step();var e=this.parseDate(t);if(e.isDone()){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(e=_.unexpected(t))}return e.bind()},t.prototype.parseDate=function(t,e){var i=this.parseDateTime(t,e);return i.isDone()?_.done(oo.fromAny(i.bind())):i.isError()?i.asError():new ro(i)},t.formats=function(e){var i;return void 0===e&&(e=kr.Default),e===kr.Default&&(i=t.Formats),i||(i={Y:t.YearFormat,m:t.MonthNumberFormat,B:new Pr(e),b:new Fr(e),d:t.DayOfMonthFormat,A:new Wr(e),a:new Br(e),H:t.Hour24Format,I:t.Hour12Format,p:new Yr(e),M:t.MinuteFormat,S:t.SecondFormat,L:t.MillisecondFormat}),i},t.pattern=function(e,i){return(!i||i instanceof kr)&&(i=t.formats(i)),new eo(e,i)},t.iso8601=function(e){return(!e||e instanceof kr)&&(e=t.formats(e)),e===t.Formats&&t.Iso8601?t.Iso8601:new eo("%Y-%m-%dT%H:%M:%S.%LZ",e)},t.YearFormat=void 0,t.MonthNumberFormat=void 0,t.DayOfMonthFormat=void 0,t.Hour24Format=void 0,t.Hour12Format=void 0,t.MinuteFormat=void 0,t.SecondFormat=void 0,t.MillisecondFormat=void 0,t.Formats=void 0,t.Iso8601=void 0,t}();function Cr(t,e){var i=48+t%10,r=48+(t/=10)%10;e.push(r,i)}function Sr(t,e,i,r,o,n,s,a){void 0===s&&(s=0),void 0===a&&(a=0);for(var u=0;a<r;){if(!o.isEmpty()){if(u=o.head(),_.isDigit(u)){o.step(),s=10*s+_.decodeDigit(u),a+=1;continue}return _.expected(e,o)}if(o.isDone())return _.unexpected(o);break}return(!o.isEmpty()||o.isDone())&&a>=i?t.bind(s,n):t.cont(n,s,a)}function Vr(t,e,i,r,o){void 0===o&&(o=new g);for(var n=0;;){if(i.isEmpty()||(n=i.head(),!Xe.isIdentStartChar(n))){if(!i.isEmpty()||i.isDone())return t.bind(e,o.bind(),r);break}i.step(),o.push(n)}return t.cont(e,r,o)}var Dr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.writeDate=function(t,e){var i,r,o,n,s;i=t.year(),r=48+i%10,o=48+(i/=10)%10,n=48+(i/=10)%10,s=48+(i/=10)%10,e.push(s,n,o,r)},e.prototype.parseDateTime=function(t,e){return Mr.parse(t,e)},e}(Er);Er.YearFormat=new Dr;var Mr=function(t){function e(e,i,r){var o=t.call(this)||this;return o.date=e,o.year=i,o.step=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.year,this.step)},e.parse=function(t,i,r,o){return Sr(e,"full year",4,4,t,i,r,o)},e.bind=function(t,e){return void 0===e&&(e={}),e.year=t,_.done(e)},e.cont=function(t,i,r){return new e(t,i,r)},e}(_),Rr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.writeDate=function(t,e){Cr(t.month()+1,e)},e.prototype.parseDateTime=function(t,e){return Tr.parse(t,e)},e}(Er);Er.MonthNumberFormat=new Rr;var Tr=function(t){function e(e,i,r){var o=t.call(this)||this;return o.date=e,o.month=i,o.step=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.month,this.step)},e.parse=function(t,i,r,o){return Sr(e,"month number",2,2,t,i,r,o)},e.bind=function(t,e){return void 0===e&&(e={}),e.month=t-1,_.done(e)},e.cont=function(t,i,r){return new e(t,i,r)},e}(_),Pr=function(t){function e(e){var i=t.call(this)||this;return i.locale=e,i}return u(e,t),e.prototype.writeDate=function(t,e){e.push(this.locale.months[t.month()])},e.prototype.parseDateTime=function(t,e){return Lr.parse(t,this.locale,e)},e}(Er),Lr=function(t){function e(e,i,r){var o=t.call(this)||this;return o.locale=e,o.date=i,o.output=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,i,r,o){return Vr(e,i,t,r,o)},e.bind=function(t,e,i){void 0===i&&(i={});var r=t.months.indexOf(e);return r>=0?(i.month=r,_.done(i)):_.error("expected month, but found "+e)},e.cont=function(t,i,r){return new e(t,i,r)},e}(_),Fr=function(t){function e(e){var i=t.call(this)||this;return i.locale=e,i}return u(e,t),e.prototype.writeDate=function(t,e){e.push(this.locale.shortMonths[t.month()])},e.prototype.parseDateTime=function(t,e){return zr.parse(t,this.locale,e)},e}(Er),zr=function(t){function e(e,i,r){var o=t.call(this)||this;return o.locale=e,o.date=i,o.output=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,i,r,o){return Vr(e,i,t,r,o)},e.bind=function(t,e,i){void 0===i&&(i={});var r=t.shortMonths.indexOf(e);return r>=0?(i.month=r,_.done(i)):_.error("expected short month, but found "+e)},e.cont=function(t,i,r){return new e(t,i,r)},e}(_),Ir=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.writeDate=function(t,e){Cr(t.day(),e)},e.prototype.parseDateTime=function(t,e){return Ur.parse(t,e)},e}(Er);Er.DayOfMonthFormat=new Ir;var Ur=function(t){function e(e,i,r){var o=t.call(this)||this;return o.date=e,o.day=i,o.step=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.day,this.step)},e.parse=function(t,i,r,o){return Sr(e,"day of month",2,2,t,i,r,o)},e.bind=function(t,e){return void 0===e&&(e={}),e.day=t,_.done(e)},e.cont=function(t,i,r){return new e(t,i,r)},e}(_),Wr=function(t){function e(e){var i=t.call(this)||this;return i.locale=e,i}return u(e,t),e.prototype.writeDate=function(t,e){e.push(this.locale.weekdays[t.weekday()])},e.prototype.parseDateTime=function(t,e){return Or.parse(t,this.locale,e)},e}(Er),Or=function(t){function e(e,i,r){var o=t.call(this)||this;return o.locale=e,o.date=i,o.output=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,i,r,o){return Vr(e,i,t,r,o)},e.bind=function(t,e,i){return void 0===i&&(i={}),t.weekdays.indexOf(e)>=0?_.done(i):_.error("expected weekday, but found "+e)},e.cont=function(t,i,r){return new e(t,i,r)},e}(_),Br=function(t){function e(e){var i=t.call(this)||this;return i.locale=e,i}return u(e,t),e.prototype.writeDate=function(t,e){e.push(this.locale.shortWeekdays[t.weekday()])},e.prototype.parseDateTime=function(t,e){return qr.parse(t,this.locale,e)},e}(Er),qr=function(t){function e(e,i,r){var o=t.call(this)||this;return o.locale=e,o.date=i,o.output=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,i,r,o){return Vr(e,i,t,r,o)},e.bind=function(t,e,i){return void 0===i&&(i={}),t.shortWeekdays.indexOf(e)>=0?_.done(i):_.error("expected short weekday, but found "+e)},e.cont=function(t,i,r){return new e(t,i,r)},e}(_),Gr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.writeDate=function(t,e){Cr(t.hour(),e)},e.prototype.parseDateTime=function(t,e){return Hr.parse(t,e)},e}(Er);Er.Hour24Format=new Gr;var Hr=function(t){function e(e,i,r){var o=t.call(this)||this;return o.date=e,o.hour=i,o.step=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.hour,this.step)},e.parse=function(t,i,r,o){return Sr(e,"hour (24)",2,2,t,i,r,o)},e.bind=function(t,e){return void 0===e&&(e={}),e.hour=t,_.done(e)},e.cont=function(t,i,r){return new e(t,i,r)},e}(_),Nr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.writeDate=function(t,e){Cr(t.hour()%12||12,e)},e.prototype.parseDateTime=function(t,e){return jr.parse(t,e)},e}(Er);Er.Hour12Format=new Nr;var jr=function(t){function e(e,i,r){var o=t.call(this)||this;return o.date=e,o.hour=i,o.step=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.hour,this.step)},e.parse=function(t,i,r,o){return Sr(e,"hour (12)",2,2,t,i,r,o)},e.bind=function(t,e){return void 0===e&&(e={}),e.hour=(e.hour||0)+t,_.done(e)},e.cont=function(t,i,r){return new e(t,i,r)},e}(_),Yr=function(t){function e(e){var i=t.call(this)||this;return i.locale=e,i}return u(e,t),e.prototype.writeDate=function(t,e){e.push(this.locale.periods[+(t.hour()>=12)])},e.prototype.parseDateTime=function(t,e){return Xr.parse(t,this.locale,e)},e}(Er),Xr=function(t){function e(e,i,r){var o=t.call(this)||this;return o.locale=e,o.date=i,o.output=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.locale,this.date,this.output)},e.parse=function(t,i,r,o){return Vr(e,i,t,r,o)},e.bind=function(t,e,i){void 0===i&&(i={});var r=t.months.indexOf(e);return r>=0?(i.hour=(i.hour||0)+12*r,_.done(i)):_.error("expected hour period, but found "+e)},e.cont=function(t,i,r){return new e(t,i,r)},e}(_),Kr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.writeDate=function(t,e){Cr(t.minute(),e)},e.prototype.parseDateTime=function(t,e){return Qr.parse(t,e)},e}(Er);Er.MinuteFormat=new Kr;var Qr=function(t){function e(e,i,r){var o=t.call(this)||this;return o.date=e,o.minute=i,o.step=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.minute,this.step)},e.parse=function(t,i,r,o){return Sr(e,"minute",2,2,t,i,r,o)},e.bind=function(t,e){return void 0===e&&(e={}),e.minute=t,_.done(e)},e.cont=function(t,i,r){return new e(t,i,r)},e}(_),Zr=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.writeDate=function(t,e){Cr(t.second(),e)},e.prototype.parseDateTime=function(t,e){return Jr.parse(t,e)},e}(Er);Er.SecondFormat=new Zr;var Jr=function(t){function e(e,i,r){var o=t.call(this)||this;return o.date=e,o.second=i,o.step=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.second,this.step)},e.parse=function(t,i,r,o){return Sr(e,"second",2,2,t,i,r,o)},e.bind=function(t,e){return void 0===e&&(e={}),e.second=t,_.done(e)},e.cont=function(t,i,r){return new e(t,i,r)},e}(_),$r=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.writeDate=function(t,e){var i,r,o,n;i=t.millisecond(),r=48+i%10,o=48+(i/=10)%10,n=48+(i/=10)%10,e.push(n,o,r)},e.prototype.parseDateTime=function(t,e){return to.parse(t,e)},e}(Er);Er.MillisecondFormat=new $r;var to=function(t){function e(e,i,r){var o=t.call(this)||this;return o.date=e,o.millisecond=i,o.step=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.date,this.millisecond,this.step)},e.parse=function(t,i,r,o){return Sr(e,"millisecond",1,3,t,i,r,o)},e.bind=function(t,e){return void 0===e&&(e={}),e.millisecond=t,_.done(e)},e.cont=function(t,i,r){return new e(t,i,r)},e}(_),eo=function(t){function e(e,i){var r=t.call(this)||this;return r.pattern=e,r.formats=i,r}return u(e,t),e.prototype.writeDate=function(t,e){for(var i=this.pattern,r=this.formats,o=0,n=0,s=i.length;n<s;)if(37===i.charCodeAt(n)){o!==n&&e.push(i.slice(o,n));var a=r[i.charAt(n+1)];a&&a.writeDate(t,e),o=n+=2}else n+=1;o!==n&&e.push(i.slice(o,n))},e.prototype.parseDateTime=function(t,e){return io.parse(t,this.pattern,this.formats,e)},e}(Er),io=function(t){function e(e,i,r,o,n){var s=t.call(this)||this;return s.pattern=e,s.formats=i,s.date=r,s.dateParser=o,s.step=n,s}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.pattern,this.formats,this.date,this.dateParser,this.step)},e.parse=function(t,i,r,o,n,s){void 0===s&&(s=0);for(var a=i.length;s<a;){var u=i.charCodeAt(s);if(37===u){if(!n){var h=i.charAt(s+1),l=r[h];if(!l)return _.error("unknown format specifier: "+h);n=l.parseDateTime(t,o)}for(;n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone()){o=n.bind(),n=void 0,s+=2;continue}if(n.isError())return n.asError()}else{if(!t.isEmpty()){if(t.head()===u){t.step(),s+=1;continue}return _.expected(u,t)}if(t.isDone())return _.unexpected(t)}break}return s===a?(o=o||{},_.done(o)):new e(i,r,o,n,s)},e}(_),ro=function(t){function e(e){var i=t.call(this)||this;return i.dateParser=e,i}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.dateParser)},e.parse=function(t,i){for(;i.isCont()&&(!t.isEmpty()||t.isDone());)i=i.feed(t);return i.isDone()?_.done(oo.fromAny(i.bind())):i.isError()?i.asError():new e(i)},e}(_);Er.Formats=Er.formats(),Er.Iso8601=Er.iso8601();var oo=function(){function t(t,e){void 0===e&&(e=xr.UTC),this._time=t,this._zone=e}return t.prototype.time=function(e){return void 0===e?this._time:new t(e,this._zone)},t.prototype.zone=function(e){return void 0===e?this._zone:new t(this._time,e)},t.prototype.year=function(e,i,r,o,n,s,a){var u=this.toUTCLocalDate();return void 0===e?u.getUTCFullYear():(u.setUTCFullYear(e),void 0!==i&&u.setUTCMonth(i),void 0!==r&&u.setUTCDate(r),void 0!==o&&u.setUTCHours(o),void 0!==n&&u.setUTCMinutes(n),void 0!==s&&u.setUTCSeconds(s),void 0!==a&&u.setUTCMilliseconds(a),t.fromUTCLocalDate(u,this._zone))},t.prototype.month=function(e,i,r,o,n,s){var a=this.toUTCLocalDate();return void 0===e?a.getUTCMonth():(a.setUTCMonth(e),void 0!==i&&a.setUTCDate(i),void 0!==r&&a.setUTCHours(r),void 0!==o&&a.setUTCMinutes(o),void 0!==n&&a.setUTCSeconds(n),void 0!==s&&a.setUTCMilliseconds(s),t.fromUTCLocalDate(a,this._zone))},t.prototype.day=function(e,i,r,o,n){var s=this.toUTCLocalDate();return void 0===e?s.getUTCDate():(s.setUTCDate(e),void 0!==i&&s.setUTCHours(i),void 0!==r&&s.setUTCMinutes(r),void 0!==o&&s.setUTCSeconds(o),void 0!==n&&s.setUTCMilliseconds(n),t.fromUTCLocalDate(s,this._zone))},t.prototype.hour=function(e,i,r,o){var n=this.toUTCLocalDate();return void 0===e?n.getUTCHours():(n.setUTCHours(e),void 0!==i&&n.setUTCMinutes(i),void 0!==r&&n.setUTCSeconds(r),void 0!==o&&n.setUTCMilliseconds(o),t.fromUTCLocalDate(n,this._zone))},t.prototype.minute=function(e,i,r){var o=this.toUTCLocalDate();return void 0===e?o.getUTCMinutes():(o.setUTCMinutes(e),void 0!==i&&o.setUTCSeconds(i),void 0!==r&&o.setUTCMilliseconds(r),t.fromUTCLocalDate(o,this._zone))},t.prototype.second=function(e,i){var r=this.toUTCLocalDate();return void 0===e?r.getUTCSeconds():(r.setUTCSeconds(e),void 0!==i&&r.setUTCMilliseconds(i),t.fromUTCLocalDate(r,this._zone))},t.prototype.millisecond=function(e){var i=this.toUTCLocalDate();return void 0===e?i.getUTCMilliseconds():(i.setUTCMilliseconds(e),t.fromUTCLocalDate(i,this._zone))},t.prototype.weekday=function(){return this.toUTCLocalDate().getDay()},t.prototype.toUTCLocalDate=function(){return new Date(this._time+6e4*this._zone._offset)},t.prototype.toDate=function(){return new Date(this._time)},t.prototype.valueOf=function(){return this._time},t.prototype.equals=function(e){return this===e||e instanceof t&&(this._time===e._time&&this._zone.equals(e._zone))},t.prototype.compare=function(t){var e=this._time,i=+t;return e<i?-1:e>i?1:e===i?0:NaN},t.prototype.hashCode=function(){return n.mash(n.mix(n.mix(2544170115,this._time),this._zone.hashCode()))},t.prototype.toString=function(){return Er.Iso8601.format(this)},t.fromUTCLocalDate=function(e,i){return new t(e.getTime()-6e4*i._offset,i)},t.current=function(e){return e=void 0!==e?xr.fromAny(e):xr.Local,new t(Date.now(),e)},t.time=function(e){if(e instanceof t)return e._time;if(e instanceof Date)return e.getTime();if("number"==typeof e)return e;if("string"==typeof e)return t.parse(e).time();throw e&&"object"==typeof e&&t.fromObject(e).time(),new TypeError(""+e)},t.fromAny=function(e,i){if(e instanceof t)return e;if(e instanceof Date)return i=void 0!==i?xr.fromAny(i):xr.UTC,new t(e.getTime(),i);if("number"==typeof e)return new t(e,i=void 0!==i?xr.fromAny(i):xr.UTC);if("string"==typeof e)return t.parse(e,i);if(e&&"object"==typeof e)return t.fromObject(e,i);throw new TypeError(""+e)},t.fromObject=function(e,i){var r=Date.UTC(e.year||1970,e.month||0,e.day,e.hour,e.minute,e.second,e.millisecond);return void 0!==e.zone&&(i=xr.fromAny(e.zone)),void 0!==i?r+=6e4*(i=xr.fromAny(i))._offset:i=xr.UTC,new t(r,i)},t.fromValue=function(e){var i,r=e.header("date");r.isDefined()?(e=r,i=!0):i=!1;var o={};if(e.forEach(function(t,e){var r=t.key.stringValue();void 0!==r?"year"===r?o.year=t.toValue().numberValue(o.year):"month"===r?o.month=t.toValue().numberValue(o.month):"day"===r?o.day=t.toValue().numberValue(o.day):"hour"===r?o.hour=t.toValue().numberValue(o.hour):"minute"===r?o.minute=t.toValue().numberValue(o.minute):"second"===r?o.second=t.toValue().numberValue(o.second):"millisecond"===r?o.millisecond=t.toValue().numberValue(o.millisecond):"zone"===r&&(o.zone=t.toValue().cast(xr.Form,o.zone)):t instanceof b&&i&&(0===e?o.year=t.numberValue(o.year):1===e?o.month=t.numberValue(o.month):2===e?o.day=t.numberValue(o.day):3===e?o.hour=t.numberValue(o.hour):4===e?o.minute=t.numberValue(o.minute):5===e?o.second=t.numberValue(o.second):6===e?o.millisecond=t.numberValue(o.millisecond):7===e&&(o.zone=t.cast(xr.Form,o.zone)))}),t.isInit(o))return t.fromObject(o)},t.parse=function(t,e){return Er.Iso8601.parse(t)},t.isInit=function(t){if(t&&"object"==typeof t){var e=t;return void 0!==e.year||void 0!==e.month||void 0!==e.day||void 0!==e.hour||void 0!==e.minute||void 0!==e.second||void 0!==e.millisecond}return!1},t.Form=void 0,t}(),no=function(t){function e(e){void 0===e&&(e=new oo(0));var i=t.call(this)||this;return i.unit=e,i}return u(e,t),e.prototype.mold=function(t){return t=oo.fromAny(t),I.valueOf(Er.Iso8601.format(t))},e.prototype.cast=function(t){var e;try{if(!(e=oo.fromValue(t))){var i=t.numberValue();if(void 0!==i)e=new oo(i);else{var r=t.stringValue();void 0!==r&&(e=oo.parse(r))}}}catch(t){}return e},e}(ye);oo.Form=new no;var so=1e3,ao=6e4,uo=36e5,ho=function(){function t(){}return t.prototype.next=function(t,e){return this.floor(this.offset(t,e))},t.prototype.ceil=function(t){return t=t instanceof oo?t.time(t.time()-1):oo.time(t)-1,this.next(this.floor(t),1)},t.prototype.round=function(t){t=oo.fromAny(t);var e=this.floor(t),i=this.ceil(t);return t.time()-e.time()<i.time()-t.time()?e:i},t.prototype.range=function(t,e,i){t=this.ceil(t),e=oo.time(e);var r=[];if((i="number"==typeof i?Math.floor(i):1)>0)for(;t.time()<e;)r.push(t),t=this.next(t,i);return r},t.prototype.filter=function(t){return new lo(this,t)},t.years=function(e,i,r){return void 0===e?t.Years:void 0===i?t.Years.every(e):t.Years.range(e,i,r)},t.months=function(e,i,r){return void 0===e?t.Months:void 0===i?t.Months.every(e):t.Months.range(e,i,r)},t.weeks=function(e,i,r){return void 0===e?t.Weeks:t.Weeks.range(e,i,r)},t.days=function(e,i,r){return void 0===e?t.Days:void 0===i?t.Days.every(e):t.Days.range(e,i,r)},t.hours=function(e,i,r){return void 0===e?t.Hours:void 0===i?t.Hours.every(e):t.Hours.range(e,i,r)},t.minutes=function(e,i,r){return void 0===e?t.Minutes:void 0===i?t.Minutes.every(e):t.Minutes.range(e,i,r)},t.seconds=function(e,i,r){return void 0===e?t.Seconds:void 0===i?t.Seconds.every(e):t.Seconds.range(e,i,r)},t.milliseconds=function(e,i,r){return void 0===e?t.Milliseconds:void 0===i?t.Milliseconds.every(e):t.Milliseconds.range(e,i,r)},t.Years=void 0,t.Months=void 0,t.Weeks=void 0,t.Days=void 0,t.Hours=void 0,t.Minutes=void 0,t.Seconds=void 0,t.Milliseconds=void 0,t}(),lo=function(t){function e(e,i){var r=t.call(this)||this;return r.unit=e,r.predicate=i,r}return u(e,t),e.prototype.offset=function(t,e){for(t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1);e<0;){do{t=this.unit.offset(t,-1)}while(!this.predicate(t));e+=1}for(;e>0;){do{t=this.unit.offset(t,1)}while(!this.predicate(t));e-=1}return t},e.prototype.floor=function(t){for(t=oo.fromAny(t);t=this.unit.floor(t),!this.predicate(t);)t=t.time(t.time()-1);return t},e}(ho),po=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(ho),co=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.offset=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t=t.year(t.year()+e)},e.prototype.next=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.year(t.year()+e).month(0,1).hour(0,0,0,0)},e.prototype.floor=function(t){return(t=oo.fromAny(t)).month(0,1).hour(0,0,0,0)},e.prototype.ceil=function(t){return(t=(t=(t=(t=oo.fromAny(t)).time(t.time()-1)).month(0,1).hour(0,0,0,0)).year(t.year()+1)).month(0,1).hour(0,0,0,0)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new fo(t);throw new Error(""+t)},e}(po);ho.Years=new co;var fo=function(t){function e(e){var i=t.call(this)||this;return i.stride=e||1,i}return u(e,t),e.prototype.offset=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.year(t.year()+e*this.stride)},e.prototype.next=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),(t=t.year(Math.floor((t.year()+e*this.stride)/this.stride)*this.stride)).month(0,1).hour(0,0,0,0)},e.prototype.floor=function(t){return(t=(t=oo.fromAny(t)).year(Math.floor(t.year()/this.stride)*this.stride)).month(0,1).hour(0,0,0,0)},e.prototype.ceil=function(t){return(t=(t=(t=(t=(t=oo.fromAny(t)).time(t.time()-1)).year(Math.floor(t.year()/this.stride)*this.stride)).month(0,1).hour(0,0,0,0)).year(Math.floor((t.year()+this.stride)/this.stride)*this.stride)).month(0,1).hour(0,0,0,0)},e}(ho),yo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.offset=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.month(t.month()+e)},e.prototype.next=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),(t=t.month(t.month()+e)).day(1).hour(0,0,0,0)},e.prototype.floor=function(t){return(t=oo.fromAny(t)).day(1).hour(0,0,0,0)},e.prototype.ceil=function(t){return(t=(t=(t=(t=oo.fromAny(t)).time(t.time()-1)).day(1).hour(0,0,0,0)).month(t.month()+1)).day(1).hour(0,0,0,0)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new lo(this,e.modulo.bind(null,t));throw new Error(""+t)},e.modulo=function(t,e){return e.month()%t==0},e}(po);ho.Months=new yo;var mo=function(t){function e(e){void 0===e&&(e=0);var i=t.call(this)||this;return i.day=e,i}return u(e,t),e.prototype.offset=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.day(t.day()+7*e)},e.prototype.next=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),(t=(t=t.day(t.day()+7*e)).day(t.day()-(t.weekday()+7-this.day)%7)).hour(0,0,0,0)},e.prototype.floor=function(t){return(t=(t=oo.fromAny(t)).day(t.day()-(t.weekday()+7-this.day)%7)).hour(0,0,0,0)},e.prototype.ceil=function(t){return(t=(t=(t=(t=(t=(t=oo.fromAny(t)).time(t.time()-1)).day(t.day()-(t.weekday()+7-this.day)%7)).hour(0,0,0,0)).day(t.day()+7)).day(t.day()-(t.weekday()+7-this.day)%7)).hour(0,0,0,0)},e}(ho);ho.Weeks=new mo;var vo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.offset=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.day(t.day()+e)},e.prototype.next=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),(t=t.day(t.day()+e)).hour(0,0,0,0)},e.prototype.floor=function(t){return(t=oo.fromAny(t)).hour(0,0,0,0)},e.prototype.ceil=function(t){return(t=(t=(t=(t=oo.fromAny(t)).time(t.time()-1)).hour(0,0,0,0)).day(t.day()+1)).hour(0,0,0,0)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new lo(this,e.modulo.bind(null,t));throw new Error(""+t)},e.modulo=function(t,e){return e.day()%t==0},e}(po);ho.Days=new vo;var go=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.offset=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.time(t.time()+e*uo)},e.prototype.next=function(t,e){t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1);var i=(t=t.time(t.time()+e*uo)).zone().offset*ao%uo;return i<0&&(i+=uo),t.time(Math.floor((t.time()-i)/uo)*uo+i)},e.prototype.floor=function(t){var e=(t=oo.fromAny(t)).zone().offset*ao%uo;return e<0&&(e+=uo),t.time(Math.floor((t.time()-e)/uo)*uo+e)},e.prototype.ceil=function(t){var e=(t=(t=oo.fromAny(t)).time(t.time()-1)).zone().offset*ao%uo;return e<0&&(e+=uo),(e=(t=t.time(Math.floor((t.time()-e)/uo)*uo+e+uo)).zone().offset*ao%uo)<0&&(e+=uo),t.time(Math.floor((t.time()-e)/uo)*uo+e)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new lo(this,e.modulo.bind(null,t));throw new Error(""+t)},e.modulo=function(t,e){return e.hour()%t==0},e}(po);ho.Hours=new go;var wo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.offset=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.time(t.time()+e*ao)},e.prototype.next=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.time(Math.floor((t.time()+e*ao)/ao)*ao)},e.prototype.floor=function(t){return(t=oo.fromAny(t)).time(Math.floor(t.time()/ao)*ao)},e.prototype.ceil=function(t){return(t=oo.fromAny(t)).time(Math.floor((Math.floor((t.time()-1)/ao)*ao+ao)/ao)*ao)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new lo(this,e.modulo.bind(null,t));throw new Error(""+t)},e.modulo=function(t,e){return e.minute()%t==0},e}(po);ho.Minutes=new wo;var bo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.offset=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.time(t.time()+e*so)},e.prototype.next=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.time(Math.floor((t.time()+e*so)/so)*so)},e.prototype.floor=function(t){return(t=oo.fromAny(t)).time(Math.floor(t.time()/so)*so)},e.prototype.ceil=function(t){return(t=oo.fromAny(t)).time(Math.floor((Math.floor((t.time()-1)/so)*so+so)/so)*so)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new lo(this,e.modulo.bind(null,t));throw new Error(""+t)},e.modulo=function(t,e){return e.second()%t==0},e}(po);ho.Seconds=new bo;var _o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.offset=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.time(t.time()+e)},e.prototype.next=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.time(t.time()+e)},e.prototype.floor=function(t){return oo.fromAny(t)},e.prototype.ceil=function(t){return oo.fromAny(t)},e.prototype.every=function(t){if(1===t)return this;if(isFinite(t)&&t>=1)return new xo(t);throw new Error(""+t)},e}(po);ho.Milliseconds=new _o;var xo=function(t){function e(e){var i=t.call(this)||this;return i.stride=e||1,i}return u(e,t),e.prototype.offset=function(t,e){return t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1),t.time(t.time()+e*this.stride)},e.prototype.next=function(t,e){t=oo.fromAny(t),e=Math.max(1,"number"==typeof e?Math.floor(e):1);var i=this.stride;return t.time(Math.floor((t.time()+e*i)/i)*i)},e.prototype.floor=function(t){t=oo.fromAny(t);var e=this.stride;return t.time(Math.floor(t.time()/e)*e)},e.prototype.ceil=function(t){t=oo.fromAny(t);var e=this.stride;return t.time(Math.floor((Math.floor((t.time()-1)/e)*e+e)/e)*e)},e}(ho),Ao=function(){return function(){}}(),ko=864e5,Eo=7*ko,Co=function(t){function e(e){void 0===e&&(e="");var i=t.call(this)||this;return i.units=e,i}return u(e,t),e.prototype.format=function(t){if(isFinite(t)){var e=void 0;t>Eo&&(e=Math.floor(t/Eo),t%=Eo);var i=void 0;t>ko&&(i=Math.floor(t/ko),t%=ko);var r=void 0;t>36e5&&(r=Math.floor(t/36e5),t%=36e5);var o=void 0;t>6e4&&(o=Math.floor(t/6e4),t%=6e4);var n=void 0;t>1e3&&(n=Math.floor(t/1e3),t%=1e3);var s="";return e&&(s+=e+"w"),i&&(s+=i+"d"),r&&(s+=r+"h"),o&&(s+=o+"m"),!n&&s||(s+=(n||0)+"s"),s+=this.units}return""+t},e}(Ao),So=function(){return function(){}}(),Vo=["p","n","u","m","","k","M","G","T"],Do=function(t){function e(e,i,r){void 0===e&&(e=2),void 0===i&&(i=""),void 0===r&&(r="");var o=t.call(this)||this;return o.digits=e,o.units=i,o.symbol=r,o}return u(e,t),e.prototype.format=function(t){if(isFinite(t)){var e=t.toExponential(this.digits).split(/e/),i=+e[0],r=+e[1]<0?0:+e[1],o=Math.floor(r/3);return this.symbol+(i*Math.pow(10,r-3*o)).toFixed(r)+Vo[o+4]+this.units}return""+t},e}(So),Mo=Math.PI,Ro=2*Mo,To=function(){function t(){}return t.prototype.isDefined=function(){return 0!==this.value},t.prototype.plus=function(e,i){return void 0===i&&(i=this.units),t.fromAny(this.toValue(i)+t.fromAny(e).toValue(i),i)},t.prototype.opposite=function(e){return void 0===e&&(e=this.units),t.fromAny(-this.toValue(e),e)},t.prototype.minus=function(e,i){return void 0===i&&(i=this.units),t.fromAny(this.toValue(i)-t.fromAny(e).toValue(i),i)},t.prototype.times=function(e,i){return void 0===i&&(i=this.units),t.fromAny(this.toValue(i)*e,i)},t.prototype.divide=function(e,i){return void 0===i&&(i=this.units),t.fromAny(this.toValue(i)/e,i)},t.prototype.norm=function(e,i){return void 0===i&&(i=this.units),t.fromAny(this.toValue(i)/t.fromAny(e).toValue(i),i)},t.prototype.deg=function(){return new Po(this.degValue())},t.prototype.grad=function(){return new Lo(this.gradValue())},t.prototype.rad=function(){return new Fo(this.radValue())},t.prototype.turn=function(){return new zo(this.turnValue())},t.prototype.toValue=function(t){switch(t){case"deg":return this.degValue();case"grad":return this.gradValue();case"rad":return this.radValue();case"turn":return this.turnValue();default:throw new TypeError(t)}},t.prototype.to=function(t){switch(t){case"deg":return this.deg();case"grad":return this.grad();case"rad":return this.rad();case"turn":return this.turn();default:throw new TypeError(t)}},t.prototype.equals=function(e){return e instanceof t&&(this.value===e.value&&this.units===e.units)},t.prototype.toString=function(){return this.value+this.units},t.form=function(e){return void 0!==e?new Uo(e):t.Form},t.zero=function(t){switch(t=t||"rad"){case"deg":return new Po(0);case"grad":return new Lo(0);case"rad":return new Fo(0);case"turn":return new zo(0);default:throw new TypeError(t)}},t.deg=function(t){return new Po(t)},t.grad=function(t){return new Lo(t)},t.rad=function(t){return new Fo(t)},t.turn=function(t){return new zo(t)},t.fromAny=function(e,i){if(e instanceof t)return e;if("number"!=typeof e){if("string"==typeof e)return t.parse(e);throw new Error}if("string"!=typeof i)return new Fo(e);switch(i){case"deg":return new Po(e);case"grad":return new Lo(e);case"":case"rad":return new Fo(e);case"turn":return new zo(e);default:throw new Error(i)}},t.fromValue=function(t){if(2===t.length){var e=t.getItem(0).numberValue(),i=t.getItem(1);if(void 0!==e&&isFinite(e)&&i instanceof R&&i.value===b.Extant)switch(i.key.value){case"deg":return new Po(e);case"grad":return new Lo(e);case"rad":return new Fo(e);case"turn":return new zo(e)}}},t.parse=function(t,e){for(var i=new v(t);!i.isEmpty()&&_.isSpace(i.head());)i.step();var r=Io.parse(i,e);if(r.isDone()){for(;!i.isEmpty()&&_.isSpace(i.head());)i.step();i.isEmpty()||(r=_.unexpected(i))}return r.bind()},t.Form=void 0,t}(),Po=function(t){function e(e){var i=t.call(this)||this;return i.value=e,i}return u(e,t),Object.defineProperty(e.prototype,"units",{get:function(){return"deg"},enumerable:!0,configurable:!0}),e.prototype.degValue=function(){return this.value},e.prototype.gradValue=function(){return 10*this.value/9},e.prototype.radValue=function(){return this.value*Mo/180},e.prototype.turnValue=function(){return this.value/360},e.prototype.deg=function(){return this},e}(To),Lo=function(t){function e(e){var i=t.call(this)||this;return i.value=e,i}return u(e,t),Object.defineProperty(e.prototype,"units",{get:function(){return"grad"},enumerable:!0,configurable:!0}),e.prototype.degValue=function(){return.9*this.value},e.prototype.gradValue=function(){return this.value},e.prototype.radValue=function(){return this.value*Mo/200},e.prototype.turnValue=function(){return this.value/400},e.prototype.grad=function(){return this},e}(To),Fo=function(t){function e(e){var i=t.call(this)||this;return i.value=e,i}return u(e,t),Object.defineProperty(e.prototype,"units",{get:function(){return"rad"},enumerable:!0,configurable:!0}),e.prototype.degValue=function(){return 180*this.value/Mo},e.prototype.gradValue=function(){return 200*this.value/Mo},e.prototype.radValue=function(){return this.value},e.prototype.turnValue=function(){return this.value/Ro},e.prototype.rad=function(){return this},e}(To),zo=function(t){function e(e){var i=t.call(this)||this;return i.value=e,i}return u(e,t),Object.defineProperty(e.prototype,"units",{get:function(){return"turn"},enumerable:!0,configurable:!0}),e.prototype.degValue=function(){return 360*this.value},e.prototype.gradValue=function(){return 400*this.value},e.prototype.radValue=function(){return this.value*Ro},e.prototype.turnValue=function(){return this.value},e.prototype.turn=function(){return this},e}(To),Io=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.defaultUnits=e,n.valueParser=i,n.unitsOutput=r,n.step=o,n}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.defaultUnits,this.valueParser,this.unitsOutput,this.step)},e.parse=function(t,i,r,o,n){void 0===i&&(i=""),void 0===n&&(n=1);var s=0;if(1===n){for(r||(r=Xe.Factory.parseDecimal(t));r.isCont()&&(!t.isEmpty()||t.isDone());)r=r.feed(t);if(r.isDone())n=2;else if(r.isError())return r.asError()}if(2===n){for(o=o||new g;!t.isEmpty()&&(s=t.head(),_.isAlpha(s));)t.step(),o.push(s);if(!t.isEmpty()||t.isDone()){var a=r.bind().numberValue(),u=o.bind()||i;switch(u){case"deg":return _.done(new Po(a));case"grad":return _.done(new Lo(a));case"":case"rad":return _.done(new Fo(a));case"turn":return _.done(new zo(a));default:return _.error(u)}}}return new e(i,r,o,n)},e}(_),Uo=function(t){function e(e){var i=t.call(this)||this;return i.units=e,i}return u(e,t),Object.defineProperty(e.prototype,"unit",{get:function(){return To.zero(this.units)},enumerable:!0,configurable:!0}),e.prototype.mold=function(t){return t=To.fromAny(t),I.valueOf(t.toString())},e.prototype.cast=function(t){var e;try{if(!(e=To.fromValue(t))){var i=t.stringValue();void 0!==i&&(e=To.parse(i))}}catch(t){}return e},e}(ye);function Wo(t){for(;t;){if(t instanceof HTMLElement&&t.offsetParent instanceof HTMLElement)return t.offsetParent.offsetWidth;t=t.parentNode||void 0}return 0}function Oo(t){for(;t;){if(t instanceof Element){var e=getComputedStyle(t).fontSize;if(null!==e)return parseFloat(e)}t=t.parentNode||void 0}return 0}function Bo(){var t=getComputedStyle(document.documentElement).fontSize;return null!==t?parseFloat(t):0}To.Form=new Uo;var qo=function(){function t(){}return t.prototype.isDefined=function(){return 0!==this.value},Object.defineProperty(t.prototype,"unitValue",{get:function(){return 0},enumerable:!0,configurable:!0}),t.prototype.emValue=function(){return this.pxValue()/Oo(this.node)},t.prototype.remValue=function(){return this.pxValue()/Bo()},t.prototype.pctValue=function(){return this.px().value/this.unitValue},t.prototype.px=function(){return new Go(this.pxValue(),this.node)},t.prototype.em=function(){return new Ho(this.emValue(),this.node)},t.prototype.rem=function(){return new No(this.remValue(),this.node)},t.prototype.pct=function(){return new jo(this.pctValue(),this.node)},t.prototype.toValue=function(t){switch(t){case"px":return this.pxValue();case"em":return this.emValue();case"rem":return this.remValue();case"%":return this.pctValue();default:throw new TypeError(t)}},t.prototype.to=function(t){switch(t){case"px":return this.px();case"em":return this.em();case"rem":return this.rem();case"%":return this.pct();default:throw new TypeError(t)}},t.prototype.equals=function(e){return e instanceof t&&(this.value===e.value&&this.units===e.units&&this.node===e.node)},t.prototype.toString=function(){return this.value+this.units},t.form=function(e){return e?new Ko(e):t.Form},t.zero=function(t){return new Go(0,t)},t.px=function(t,e){return new Go(t,e)},t.em=function(t,e){return new Ho(t,e)},t.rem=function(t,e){return new No(t,e)},t.pct=function(t,e){return new jo(t,e)},t.unitless=function(t,e){return new Yo(t,e)},t.fromAny=function(e,i,r){if(e instanceof t)return e;if("number"!=typeof e){if("string"==typeof e&&"string"!=typeof i)return t.parse(e,i);throw new Error}if("string"!=typeof i)return void 0!==i&&(r=i),new Go(e,r);switch(i){case"px":return new Go(e,r);case"em":return new Ho(e,r);case"rem":return new No(e,r);case"%":return new jo(e,r);case"":return new Yo(e,r);default:throw new Error(i)}},t.fromValue=function(t,e){if(2===t.length){var i=t.getItem(0).numberValue(),r=t.getItem(1);if(void 0!==i&&isFinite(i)&&r instanceof R&&r.value===b.Extant)switch(r.key.value){case"px":return new Go(i,e);case"em":return new Ho(i,e);case"rem":return new No(i,e);case"pct":return new jo(i,e)}}},t.parse=function(t,e){for(var i=new v(t);!i.isEmpty()&&_.isSpace(i.head());)i.step();var r=Xo.parse(i,e);if(r.isDone()){for(;!i.isEmpty()&&_.isSpace(i.head());)i.step();i.isEmpty()||(r=_.unexpected(i))}return r.bind()},t.widthUnit=function(){return Wo(this.node)},t.emUnit=function(){return Oo(this.node)},t.Form=void 0,t}(),Go=function(t){function e(e,i){var r=t.call(this)||this;return r.value=e,r.node=i,r}return u(e,t),Object.defineProperty(e.prototype,"units",{get:function(){return"px"},enumerable:!0,configurable:!0}),e.prototype.pxValue=function(){return this.value},e.prototype.px=function(){return this},e}(qo),Ho=function(t){function e(e,i){var r=t.call(this)||this;return r.value=e,r.node=i,r}return u(e,t),Object.defineProperty(e.prototype,"units",{get:function(){return"em"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unitValue",{get:function(){return Oo(this.node)},enumerable:!0,configurable:!0}),e.prototype.pxValue=function(){return this.unitValue*this.value},e.prototype.em=function(){return this},e}(qo),No=function(t){function e(e,i){var r=t.call(this)||this;return r.value=e,r.node=i,r}return u(e,t),Object.defineProperty(e.prototype,"units",{get:function(){return"rem"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unitValue",{get:function(){return Bo()},enumerable:!0,configurable:!0}),e.prototype.pxValue=function(){return this.unitValue*this.value},e.prototype.rem=function(){return this},e}(qo),jo=function(t){function e(e,i){var r=t.call(this)||this;return r.value=e,r.node=i,r}return u(e,t),Object.defineProperty(e.prototype,"units",{get:function(){return"%"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"unitValue",{get:function(){return Wo(this.node)},enumerable:!0,configurable:!0}),e.prototype.pxValue=function(t){return void 0===t&&(t=this.unitValue),t*this.value/100},e.prototype.pct=function(){return this},e}(qo),Yo=function(t){function e(e,i){var r=t.call(this)||this;return r.value=e,r.node=i,r}return u(e,t),Object.defineProperty(e.prototype,"units",{get:function(){return""},enumerable:!0,configurable:!0}),e.prototype.pxValue=function(){return this.value},e}(qo),Xo=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.node=e,n.valueParser=i,n.unitsOutput=r,n.step=o,n}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.node,this.valueParser,this.unitsOutput,this.step)},e.parse=function(t,i,r,o,n){void 0===n&&(n=1);var s=0;if(1===n){for(r||(r=Xe.Factory.parseDecimal(t));(!t.isEmpty()||t.isDone())&&r.isCont();)r=r.feed(t);if(r.isDone())n=2;else if(r.isError())return r.asError()}if(2===n){for(o=o||new g;!t.isEmpty()&&(s=t.head(),_.isAlpha(s)||37===s);)t.step(),o.push(s);if(!t.isEmpty()||t.isDone()){var a=r.bind().numberValue(),u=o.bind();switch(u){case"px":return _.done(new Go(a,i));case"em":return _.done(new Ho(a,i));case"rem":return _.done(new No(a,i));case"%":return _.done(new jo(a,i));case"":return _.done(new Yo(a,i));default:return _.error(u)}}}return new e(i,r,o,n)},e}(_),Ko=function(t){function e(e){var i=t.call(this)||this;return i.node=e,i}return u(e,t),Object.defineProperty(e.prototype,"unit",{get:function(){return qo.zero(this.node)},enumerable:!0,configurable:!0}),e.prototype.mold=function(t){return t=qo.fromAny(t),I.valueOf(t.toString())},e.prototype.cast=function(t){var e;try{if(!(e=qo.fromValue(t))){var i=t.stringValue();void 0!==i&&(e=qo.parse(i))}}catch(t){}return e},e}(ye);qo.Form=new Ko;var Qo=function(){function t(){}return t.prototype.contrast=function(t){return this.lightness()<.67?this.brighter(t):this.darker(t)},t.form=function(e){return void 0!==e?new an(t.fromAny(e)):t.Form},t.transparent=function(t){return Zo.transparent(t)},t.black=function(){return Zo.black()},t.white=function(){return Zo.white()},t.rgb=function(e,i,r,o){return 1===arguments.length?t.fromAny(e).rgb():new Zo(e,i,r,o)},t.hsl=function(e,i,r,o){return 1===arguments.length?t.fromAny(e).hsl():(e="number"==typeof e?e:To.fromAny(e).degValue(),new Jo(e,i,r,o))},t.fromAny=function(e){if(e instanceof t)return e;if("string"==typeof e)return t.parse(e);if(e&&"object"==typeof e){var i=e;if(void 0!==i.r&&void 0!==i.g&&void 0!==i.b)return new Zo(i.r,i.g,i.b,i.a);var r=e;if(void 0!==r.h&&void 0!==r.s&&void 0!==r.l){var o="number"==typeof r.h?r.h:To.fromAny(r.h).degValue();return new Jo(o,r.s,r.l,r.a)}}throw new TypeError(""+e)},t.fromValue=function(t){var e;return(e=Zo.fromValue(t))||(e=Jo.fromValue(t)),e},t.parse=function(t){for(var e=new v(t);!e.isEmpty()&&_.isSpace(e.head());)e.step();var i=sn.parse(e);if(i.isDone()){for(;!e.isEmpty()&&_.isSpace(e.head());)e.step();e.isEmpty()||(i=_.unexpected(e))}return i.bind()},t.isInit=function(t){return Zo.isInit(t)||Jo.isInit(t)},t.Form=void 0,t}(),Zo=function(t){function e(e,i,r,o){void 0===o&&(o=1);var n=t.call(this)||this;return n.r=e,n.g=i,n.b=r,n.a=o,n}return u(e,t),e.prototype.isDefined=function(){return 0!==this.r||0!==this.g||0!==this.b||1!==this.a},e.prototype.alpha=function(t){return void 0===t?this.a:new e(this.r,this.g,this.b,t)},e.prototype.lightness=function(){var t=this.r/255,e=this.g/255,i=this.b/255,r=Math.min(t,e,i);return(Math.max(t,e,i)+r)/2},e.prototype.brighter=function(t){return t=void 0===t?1/.7:Math.pow(1/.7,t),new e(this.r*t,this.g*t,this.b*t,this.a)},e.prototype.darker=function(t){return t=void 0===t?.7:Math.pow(.7,t),new e(this.r*t,this.g*t,this.b*t,this.a)},e.prototype.rgb=function(){return this},e.prototype.hsl=function(){var t=this.r/255,e=this.g/255,i=this.b/255,r=Math.min(t,e,i),o=Math.max(t,e,i),n=NaN,s=o-r,a=(o+r)/2;return s?(n=t===o?(e-i)/s+6*+(e<i):e===o?(i-t)/s+2:(t-e)/s+4,s/=a<.5?o+r:2-(o+r),n*=60):s=a>0&&a<1?0:n,new Jo(n,s,a,this.a)},e.prototype.equals=function(t){return t instanceof e&&(this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a)},e.prototype.toHexString=function(){var t=Math.min(Math.max(0,Math.round(this.r||0)),255),i=Math.min(Math.max(0,Math.round(this.g||0)),255),r=Math.min(Math.max(0,Math.round(this.b||0)),255),o="#";return o+=e.Base16Alphabet.charAt(t>>>4&15),o+=e.Base16Alphabet.charAt(15&t),o+=e.Base16Alphabet.charAt(i>>>4&15),o+=e.Base16Alphabet.charAt(15&i),o+=e.Base16Alphabet.charAt(r>>>4&15),o+=e.Base16Alphabet.charAt(15&r)},e.prototype.toString=function(){var t=this.a;if(1===(t=isNaN(t)?1:Math.max(0,Math.min(this.a,1))))return this.toHexString();var e="rgba";return e+="(",e+=Math.max(0,Math.min(Math.round(this.r)||0,255)),e+=",",e+=Math.max(0,Math.min(Math.round(this.g)||0,255)),e+=",",e+=Math.max(0,Math.min(Math.round(this.b)||0,255)),1!==t&&(e+=",",e+=t),e+=")"},e.transparent=function(t){return void 0===t&&(t=0),new e(0,0,0,t)},e.black=function(){return new e(0,0,0,1)},e.white=function(){return new e(255,255,255,1)},e.fromValue=function(t){var e,i,r,o,n,s=t.tag;if("rgb"===s||"rgba"===s?(t=t.header(s),e=!0):e=!1,t.forEach(function(t,s){var a=t.key.stringValue();void 0!==a?"r"===a?i=t.toValue().numberValue(i):"g"===a?r=t.toValue().numberValue(r):"b"===a?o=t.toValue().numberValue(o):"a"===a&&(n=t.toValue().numberValue(n)):t instanceof b&&e&&(0===s?i=t.numberValue(i):1===s?r=t.numberValue(r):2===s?o=t.numberValue(o):3===s&&(n=t.numberValue(n)))}),void 0!==i&&void 0!==r&&void 0!==o)return Qo.rgb(i,r,o,n)},e.parse=function(t){return Qo.parse(t).rgb()},e.isInit=function(t){if(t&&"object"==typeof t){var e=t;return void 0!==e.r&&void 0!==e.g&&void 0!==e.b}return!1},e.Base16Alphabet="0123456789abcdef",e}(Qo),Jo=function(t){function e(e,i,r,o){void 0===o&&(o=1);var n=t.call(this)||this;return n.h=e,n.s=i,n.l=r,n.a=o,n}return u(e,t),e.prototype.isDefined=function(){return 0!==this.h||0!==this.s||0!==this.l||1!==this.a},e.prototype.alpha=function(t){return void 0===t?this.a:new e(this.h,this.s,this.l,t)},e.prototype.lightness=function(){return this.l},e.prototype.brighter=function(t){return t=void 0===t?1/.7:Math.pow(1/.7,t),new e(this.h,this.s,this.l*t,this.a)},e.prototype.darker=function(t){return t=void 0===t?.7:Math.pow(.7,t),new e(this.h,this.s,this.l*t,this.a)},e.toRgb=function(t,e,i){return 255*(t<60?e+(i-e)*t/60:t<180?i:t<240?e+(i-e)*(240-t)/60:e)},e.prototype.rgb=function(){var t=this.h%360+360*+(this.h<0),i=isNaN(t)||isNaN(this.s)?0:this.s,r=this.l,o=r+(r<.5?r:1-r)*i,n=2*r-o;return new Zo(e.toRgb(t>=240?t-240:t+120,n,o),e.toRgb(t,n,o),e.toRgb(t<120?t+240:t-120,n,o),this.a)},e.prototype.hsl=function(){return this},e.prototype.equals=function(t){return t instanceof e&&(this.h===t.h&&this.s===t.s&&this.l===t.l&&this.a===t.a)},e.prototype.toHexString=function(){return this.rgb().toHexString()},e.prototype.toString=function(){var t=this.a,e=1===(t=isNaN(t)?1:Math.max(0,Math.min(this.a,1)))?"hsl":"hsla";return e+="(",e+=Math.max(0,Math.min(Math.round(this.h)||0,360)),e+=",",e+=Math.max(0,Math.min(100*Math.round(this.s)||0,100))+"%",e+=",",e+=Math.max(0,Math.min(100*Math.round(this.l)||0,100))+"%",1!==t&&(e+=",",e+=t),e+=")"},e.transparent=function(t){return void 0===t&&(t=0),new e(0,0,0,t)},e.black=function(){return new e(0,0,0,1)},e.white=function(){return new e(0,1,1,1)},e.fromValue=function(t){var e,i,r,o,n,s=t.tag;if("hsl"===s||"hsla"===s?(t=t.header(s),e=!0):e=!1,t.forEach(function(t,s){var a=t.key.stringValue();void 0!==a?"h"===a?i=t.toValue().cast(To.Form,i):"s"===a?r=t.toValue().numberValue(r):"l"===a?o=t.toValue().numberValue(o):"a"===a&&(n=t.toValue().numberValue(n)):t instanceof b&&e&&(0===s?i=t.cast(To.Form,i):1===s?r=t.numberValue(r):2===s?o=t.numberValue(o):3===s&&(n=t.numberValue(n)))}),void 0!==i&&void 0!==r&&void 0!==o)return Qo.hsl(i,r,o,n)},e.parse=function(t){return Qo.parse(t).hsl()},e.isInit=function(t){if(t&&"object"==typeof t){var e=t;return void 0!==e.h&&void 0!==e.s&&void 0!==e.l}return!1},e}(Qo),$o=function(){function t(t,e){void 0===e&&(e=""),this.value=t,this.units=e}return t.prototype.scale=function(t){return"%"===this.units?this.value*t/100:this.value},t}(),tn=function(t){function e(e,i){var r=t.call(this)||this;return r.valueParser=e,r.step=i,r}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.valueParser,this.step)},e.parse=function(t,i,r){if(void 0===r&&(r=1),1===r){for(i||(i=Xe.Factory.parseNumber(t));i.isCont()&&(!t.isEmpty()||t.isDone());)i=i.feed(t);if(i.isDone())r=2;else if(i.isError())return i.asError()}if(2===r){if(!t.isEmpty()&&37===t.head())return t.step(),_.done(new $o(i.bind().numberValue(),"%"));if(!t.isEmpty()||t.isDone())return _.done(new $o(i.bind().numberValue()))}return new e(i,r)},e}(_);function en(t,e,i,r,o,n,s){void 0===s&&(s=1);var a=0;if(1===s){for(e||(e=Xe.Factory.parseIdent(t));e.isCont()&&(!t.isEmpty()||t.isDone());)e=e.feed(t);if(e.isDone())s=2;else if(e.isError())return e.asError()}if(2===s)if(t.isEmpty()||40!==t.head()){if(!t.isEmpty()||t.isDone())return _.expected("(",t)}else t.step(),s=3;if(3===s){if(!i){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(i=this.parseX(t))}if(i){for(;i.isCont()&&(!t.isEmpty()||t.isDone());)i=i.feed(t);if(i.isDone())s=4;else if(i.isError())return i.asError()}else if(t.isDone())return _.unexpected(t)}if(4===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else 44===a&&t.step(),s=5}if(5===s){if(!r){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(r=this.parseY(t))}if(r){for(;r.isCont()&&(!t.isEmpty()||t.isDone());)r=r.feed(t);if(r.isDone())s=6;else if(r.isError())return r.asError()}else if(t.isDone())return _.unexpected(t)}if(6===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else 44===a&&t.step(),s=7}if(7===s){if(!o){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(o=this.parseZ(t))}if(o){for(;o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())s=8;else if(o.isError())return o.asError()}else if(t.isDone())return _.unexpected(t)}if(8===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(41===a){t.step();try{return _.done(this.decode(e.bind().stringValue(),i.bind(),r.bind(),o.bind()))}catch(t){return _.error(t)}}else 44===a&&t.step();s=9}}if(9===s){if(!n){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(n=this.parseA(t))}if(n){for(;n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())s=10;else if(n.isError())return n.asError()}else if(t.isDone())return _.unexpected(t)}if(10===s){for(;!t.isEmpty()&&(a=t.head(),_.isSpace(a));)t.step();if(t.isEmpty()||41!==a){if(!t.isEmpty()||t.isDone())return _.expected(")",t)}else{t.step();try{return _.done(this.decode(e.bind().stringValue(),i.bind(),r.bind(),o.bind(),n.bind()))}catch(t){return _.error(t)}}}return this.cont(e,i,r,o,n,s)}var rn=function(t){function e(e,i){var r=t.call(this)||this;return r.value=e,r.step=i,r}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.value,this.step)},e.parse=function(t,i,r){void 0===i&&(i=0),void 0===r&&(r=1);var o=0;if(1===r)if(t.isEmpty()||35!==t.head()){if(!t.isEmpty()||t.isDone())return _.expected("#",t)}else t.step(),r=2;if(r>=2){for(;r<=9&&!t.isEmpty()&&(o=t.head(),_.isHexChar(o));)t.step(),i=i<<4|_.decodeHexChar(o),r+=1;if(!t.isEmpty()||t.isDone())return 5===r?_.done(new Zo(i>>8&15|i>>4&240,i>>4&15|240&i,i<<4&240|15&i)):6===r?_.done(new Zo(i>>12&15|i>>8&240,i>>8&15|i>>4&240,i>>4&15|240&i,(i<<4&240|15&i)/255)):8===r?_.done(new Zo(i>>16&255,i>>8&255,255&i)):10===r?_.done(new Zo(i>>24&255,i>>16&255,i>>8&255,(255&i)/255)):_.unexpected(t)}return new e(i,r)},e}(_),on=function(t){function e(e,i,r,o,n,s){var a=t.call(this)||this;return a.identParser=e,a.rParser=i,a.gParser=r,a.bParser=o,a.aParser=n,a.step=s,a}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.identParser,this.rParser,this.gParser,this.bParser,this.aParser,this.step)},e.parse=function(t,i,r,o,n,s,a){return en.call(e,t,i,r,o,n,s,a)},e.parseRest=function(t,i){return e.parse(t,i,void 0,void 0,void 0,void 0,2)},e.decode=function(t,e,i,r,o){if("rgb"===t||"rgba"===t)return new Zo(e.scale(255),i.scale(255),r.scale(255),o&&o.scale(1));throw new Error(t)},e.parseX=function(t){return tn.parse(t)},e.parseY=function(t){return tn.parse(t)},e.parseZ=function(t){return tn.parse(t)},e.parseA=function(t){return tn.parse(t)},e.cont=function(t,i,r,o,n,s){return new e(t,i,r,o,n,s)},e}(_),nn=function(t){function e(e,i,r,o,n,s){var a=t.call(this)||this;return a.identParser=e,a.hParser=i,a.sParser=r,a.lParser=o,a.aParser=n,a.step=s,a}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.identParser,this.hParser,this.sParser,this.lParser,this.aParser,this.step)},e.parse=function(t,i,r,o,n,s,a){return en.call(e,t,i,r,o,n,s,a)},e.parseRest=function(t,i){return e.parse(t,i,void 0,void 0,void 0,void 0,2)},e.decode=function(t,e,i,r,o){if("hsl"===t||"hsla"===t)return new Jo(e.deg().value,i.scale(1),r.scale(1),o&&o.scale(1));throw new Error(t)},e.parseX=function(t){return Io.parse(t,"deg")},e.parseY=function(t){return tn.parse(t)},e.parseZ=function(t){return tn.parse(t)},e.parseA=function(t){return tn.parse(t)},e.cont=function(t,i,r,o,n,s){return new e(t,i,r,o,n,s)},e}(_),sn=function(t){function e(e,i){var r=t.call(this)||this;return r.identParser=e,r.step=i,r}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.identParser,this.step)},e.parse=function(t,i,r){if(void 0===r&&(r=1),1===r)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(35===t.head())return rn.parse(t);r=2}if(2===r){for(i||(i=Xe.Factory.parseIdent(t));i.isCont()&&(!t.isEmpty()||t.isDone());)i=i.feed(t);if(i.isDone()){var o=i.bind().stringValue();switch(o){case"rgb":case"rgba":return on.parseRest(t,i);case"hsl":case"hsla":return nn.parseRest(t,i);case"transparent":return _.done(Qo.transparent());case"black":return _.done(Qo.black());case"white":return _.done(Qo.white());default:return _.error(o)}}else if(i.isError())return i.asError()}return new e(i,r)},e}(_),an=function(t){function e(e){void 0===e&&(e=Qo.transparent());var i=t.call(this)||this;return i.unit=e,i}return u(e,t),e.prototype.mold=function(t){return t=Qo.fromAny(t),I.valueOf(t.toString())},e.prototype.cast=function(t){var e;try{if(!(e=Qo.fromValue(t))){var i=t.stringValue();void 0!==i&&(e=Qo.parse(i))}}catch(t){}return e},e}(ye);Qo.Form=new an;var un=function(){function t(t,e,i,r,o,n,s){this.inset=t,this.offsetX=e,this.offsetY=i,this.blurRadius=r,this.spreadRadius=o,this.color=n,this.next=s}return t.prototype.isDefined=function(){return this.inset||this.offsetX.isDefined()||this.offsetY.isDefined()||this.blurRadius.isDefined()||this.spreadRadius.isDefined()||this.color.isDefined()||!!this.next&&this.next.isDefined()},t.prototype.and=function(e,i,r,o,n,s){var a=this.next?this.next.and.apply(this.next,arguments):t.of.apply(void 0,arguments);return new t(this.inset,this.offsetX,this.offsetY,this.blurRadius,this.spreadRadius,this.color,a)},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.inset===e.inset&&this.offsetX.equals(e.offsetX)&&this.offsetY.equals(e.offsetY)&&this.blurRadius.equals(e.blurRadius)&&this.spreadRadius.equals(e.spreadRadius)&&this.color.equals(e.color)&&(null===this.next?null===e.next:this.next.equals(e.next)))},t.prototype.toString=function(){if(this.isDefined()){for(var t="",e=this;;){if(e.inset&&(t+="inset",t+=" "),t+=e.offsetX.toString(),t+=" ",t+=e.offsetY.toString(),t+=" ",t+=e.blurRadius.toString(),t+=" ",t+=e.spreadRadius.toString(),t+=" ",t+=e.color.toString(),!e.next)break;t+=", ",e=e.next}return t}return"none"},t.form=function(e){return void 0!==e?new ln(t.fromAny(e)):t.Form},t.of=function(e,i,r,o,n,s){if(1===arguments.length)return t.fromAny(arguments[0]);if("boolean"!=typeof e){if(3===arguments.length)s=Qo.fromAny(arguments[2]),n=qo.zero(),o=qo.zero(),r=qo.fromAny(arguments[1]),i=qo.fromAny(arguments[0]);else if(4===arguments.length)s=Qo.fromAny(arguments[3]),n=qo.zero(),o=qo.fromAny(arguments[2]),r=qo.fromAny(arguments[1]),i=qo.fromAny(arguments[0]);else{if(5!==arguments.length)throw new TypeError(""+arguments);s=Qo.fromAny(arguments[4]),n=qo.fromAny(arguments[3]),o=qo.fromAny(arguments[2]),r=qo.fromAny(arguments[1]),i=qo.fromAny(arguments[0])}e=!1}else if(4===arguments.length)s=Qo.fromAny(arguments[3]),n=qo.zero(),o=qo.zero(),i=qo.fromAny(arguments[1]),r=qo.fromAny(arguments[2]);else if(5===arguments.length)s=Qo.fromAny(arguments[4]),n=qo.zero(),o=qo.fromAny(arguments[3]),i=qo.fromAny(arguments[1]),r=qo.fromAny(arguments[2]);else{if(6!==arguments.length)throw new TypeError(""+arguments);s=Qo.fromAny(arguments[5]),n=qo.fromAny(arguments[4]),o=qo.fromAny(arguments[3]),r=qo.fromAny(arguments[2]),i=qo.fromAny(arguments[1])}return new t(e,i,r,o,n,s,null)},t.fromAny=function(){for(var e,i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];if((e=0===arguments.length?t.None:1===arguments.length?arguments[0]:arguments)instanceof t)return e;if("string"==typeof e)return t.parse(e);if(e&&"object"==typeof e&&void 0===e.length)return new t((e=e).inset||!1,void 0!==e.offsetX?qo.fromAny(e.offsetX):qo.zero(),void 0!==e.offsetY?qo.fromAny(e.offsetY):qo.zero(),void 0!==e.blurRadius?qo.fromAny(e.blurRadius):qo.zero(),void 0!==e.spreadRadius?qo.fromAny(e.spreadRadius):qo.zero(),void 0!==e.color?Qo.fromAny(e.color):Qo.black(),null);if(e&&"object"==typeof e&&e.length>0){e=e;for(var o=t.fromAny(e[0]),n=1;n<e.length;n+=1)o=o.and(e[n]);return o}throw new TypeError(""+e)},t.fromValue=function(e){var i;return e.forEach(function(e,r){var o=e.header("boxShadow");if(o){var n,s,a,u,h,l;o.forEach(function(t,e){var i=t.key.stringValue();void 0!==i?"inset"===i?n=t.toValue().booleanValue(n):"offsetX"===i?s=t.toValue().cast(qo.Form,s):"offsetY"===i?a=t.toValue().cast(qo.Form,a):"blurRadius"===i?u=t.toValue().cast(qo.Form,u):"spreadRadius"===i?h=t.toValue().cast(qo.Form,h):"color"===i&&(l=t.toValue().cast(Qo.Form,l)):t instanceof b&&(0===e&&t instanceof I&&"inset"===t.value?n=!0:0===e||1===e&&void 0!==n?s=t.cast(qo.Form,s):1===e||2===e&&void 0!==n?a=t.cast(qo.Form,a):2===e||3===e&&void 0!==n?void 0===(u=t.cast(qo.Form,u))&&(l=t.cast(Qo.Form,l)):(3===e||4===e&&void 0===n)&&void 0===l?void 0===(h=t.cast(qo.Form,h))&&(l=t.cast(Qo.Form,l)):(4===e||5===e&&void 0===n)&&void 0===l&&(l=t.cast(Qo.Form,l)))}),n=void 0!==n&&n,s=void 0!==s?s:qo.zero(),a=void 0!==a?a:qo.zero(),u=void 0!==u?u:qo.zero(),h=void 0!==h?h:qo.zero(),l=void 0!==l?l:Qo.black();var p=new t(n||!1,s,a,u,h,l,null);i=i?i.and(p):p}}),i},t.parse=function(t){for(var e=new v(t);!e.isEmpty()&&_.isSpace(e.head());)e.step();var i=hn.parse(e);if(i.isDone()){for(;!e.isEmpty()&&_.isSpace(e.head());)e.step();e.isEmpty()||(i=_.unexpected(e))}return i.bind()},t.isInit=function(t){if(t&&"object"==typeof t){var e=t;return void 0!==e.offsetX&&void 0!==e.offsetY&&void 0!==e.color}return!1},t.None=new t(!1,qo.zero(),qo.zero(),qo.zero(),qo.zero(),Qo.black(),null),t.Form=void 0,t}(),hn=function(t){function e(e,i,r,o,n,s,a,u){var h=t.call(this)||this;return h.boxShadow=e,h.identParser=i,h.offsetXParser=r,h.offsetYParser=o,h.blurRadiusParser=n,h.spreadRadiusParser=s,h.colorParser=a,h.step=u,h}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.boxShadow,this.identParser,this.offsetXParser,this.offsetYParser,this.blurRadiusParser,this.spreadRadiusParser,this.colorParser,this.step)},e.parse=function(t,i,r,o,n,s,a,u,h){void 0===h&&(h=1);for(var l=0;;){if(1===h){for(;!t.isEmpty()&&(l=t.head(),_.isSpace(l));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else h=Xe.isIdentStartChar(l)?2:4}if(2===h){for(r||(r=Xe.Factory.parseIdent(t));r.isCont()&&(!t.isEmpty()||t.isDone());)r=r.feed(t);if(r.isDone()){var p=r.bind().stringValue();if("inset"!==p)return"none"!==p||i?_.error("unexpected "+p):_.done(un.None);h=3}else if(r.isError())return r.asError()}if(3===h)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(!_.isSpace(t.head()))return _.expected("space",t);t.step(),h=4}if(4===h){if(!o){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(o=Xo.parse(t))}if(o){for(;o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())h=5;else if(o.isError())return o.asError()}else if(t.isDone())return _.unexpected(t)}if(5===h)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(!_.isSpace(t.head()))return _.expected("space",t);t.step(),h=6}if(6===h){if(!n){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(n=Xo.parse(t))}if(n){for(;n.isCont()&&(!t.isEmpty()||t.isDone());)n=n.feed(t);if(n.isDone())h=7;else if(n.isError())return n.asError()}else if(t.isDone())return _.unexpected(t)}if(7===h)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(!_.isSpace(t.head()))return _.expected("space",t);t.step(),h=8}if(8===h){if(!s){for(;!t.isEmpty()&&(l=t.head(),_.isSpace(l));)t.step();t.isEmpty()||(45===l||l>=48&&l<=57?s=Xo.parse(t):h=12)}if(s){for(;s.isCont()&&(!t.isEmpty()||t.isDone());)s=s.feed(t);if(s.isDone())h=9;else if(s.isError())return s.asError()}else if(t.isDone())return _.unexpected(t)}if(9===h)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(!_.isSpace(t.head()))return _.expected("space",t);t.step(),h=10}if(10===h){if(!a){for(;!t.isEmpty()&&(l=t.head(),_.isSpace(l));)t.step();t.isEmpty()||(45===l||l>=48&&l<=57?a=Xo.parse(t):h=12)}if(a){for(;a.isCont()&&(!t.isEmpty()||t.isDone());)a=a.feed(t);if(a.isDone())h=11;else if(a.isError())return a.asError()}else if(t.isDone())return _.unexpected(t)}if(11===h)if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(!_.isSpace(t.head()))return _.expected("space",t);t.step(),h=12}if(12===h){if(!u){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(u=sn.parse(t))}if(u){for(;u.isCont()&&(!t.isEmpty()||t.isDone());)u=u.feed(t);if(u.isDone()){var c=!!r&&"inset"===r.bind().stringValue(),d=o.bind(),f=n.bind(),y=s?s.bind():qo.zero(),m=a?a.bind():qo.zero(),v=u.bind(),g=new un(c,d,f,y,m,v,null);i=i?i.and(g):g,r=void 0,o=void 0,n=void 0,s=void 0,a=void 0,u=void 0,h=13}else if(u.isError())return u.asError()}else if(t.isDone())return _.unexpected(t)}if(13===h){for(;!t.isEmpty()&&(l=t.head(),_.isSpace(l));)t.step();if(!t.isEmpty()&&44===l){t.step(),h=1;continue}if(!t.isEmpty()||t.isDone())return _.done(i)}break}return new e(i,r,o,n,s,a,u,h)},e}(_),ln=function(t){function e(e){void 0===e&&(e=un.None);var i=t.call(this)||this;return i.unit=e,i}return u(e,t),e.prototype.mold=function(t){for(var e=un.fromAny(t),i=L.empty();;){var r=L.empty(5);if(e.inset&&r.push("inset"),r.push(qo.Form.mold(e.offsetX)),r.push(qo.Form.mold(e.offsetY)),r.push(qo.Form.mold(e.blurRadius)),r.push(qo.Form.mold(e.spreadRadius)),r.push(Qo.Form.mold(e.color)),i.attr("boxShadow",r),!e.next)break;e=e.next}return i},e.prototype.cast=function(t){var e;try{if(!(e=un.fromValue(t))){var i=t.stringValue();void 0!==i&&(e=un.parse(i))}}catch(t){}return e},e}(ye);un.Form=new ln;var pn={linear:function(t){return t},quadIn:function(t){return t*t},quadOut:function(t){return t*(2-t)},quadInOut:function(t){return(t*=2)<=1?t*=t:(t-=1,t*=2-t,t+=1),t/=2},cubicIn:function(t){return t*t*t},cubicOut:function(t){return t-=1,t*=t*t,t+=1},cubicInOut:function(t){return(t*=2)<=1?t*=t*t:(t-=2,t*=t*t,t+=2),t/=2},quartIn:function(t){return t*t*t*t},quartOut:function(t){return 1-(t-=1)*t*t*t},quartInOut:function(t){var e=t-1;return t<.5?8*t*t*t*t:1-8*e*e*e*e},expoIn:function(t){return 0===t?0:Math.pow(2,10*(t-1))},expoOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},expoInOut:function(t){return 1===t||0===t?t:(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*(t-1)))},circIn:function(t){return-1*(Math.sqrt(1-t/1*t)-1)},circOut:function(t){return t-=1,Math.sqrt(1-t*t)},circInOut:function(t){if((t*=2)<1)return-.5*(Math.sqrt(1-t*t)-1);var e=t-2;return.5*(Math.sqrt(1-e*e)+1)},backIn:function(t){return t*t*(2.70158*t-1.70158)},backOut:function(t){var e=t/1-1;return e*e*6.2985344964+1},backInOut:function(t){var e=2.5949095;if((t*=2)<1)return.5*t*t*((e+1)*t-e);var i=t-2;return.5*(i*i*((e+1)*i+e)+2)},elasticIn:function(t){if(0===t||1===t)return t;var e=t/1-1,i=(1-.7)/2*Math.PI*Math.asin(1);return-Math.pow(2,10*e)*Math.sin(2*(e-i)*Math.PI/(1-.7))},elasticOut:function(t){if(0===t||1===t)return t;var e=(1-.7)/(2*Math.PI)*Math.asin(1);return t*=2,Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/(1-.7))+1},elasticInOut:function(t){if(0===t||1===t)return t;var e=.35/(2*Math.PI)*Math.asin(1),i=2*t,r=i-1;return i<1?Math.pow(2,10*r)*Math.sin(2*(r-e)*Math.PI/.35)*-.5:Math.pow(2,-10*r)*Math.sin(2*(r-e)*Math.PI/.35)*.5+1},bounceIn:function(t){var e=7.5625;return(t=1-t)<1/2.75?1-e*t*t:t<2/2.75?1-(e*(t-=1.5/2.75)*t+.75):t<2.5/2.75?1-(e*(t-=2.25/2.75)*t+.9375):1-(e*(t-=2.625/2.75)*t+.984375)},bounceOut:function(t){var e=7.5625;return t<1/2.75?e*t*t:t<2/2.75?e*(t-=1.5/2.75)*t+.75:t<2.5/2.75?e*(t-=2.25/2.75)*t+.9375:e*(t-=2.625/2.75)*t+.984375},bounceInOut:function(t){var e=t<.5,i=7.5625;return(t=e?1-2*t:2*t-1)<1/2.75?t*=i*t:t=t<2/2.75?i*(t-=1.5/2.75)*t+.75:t<2.5/2.75?i*(t-=2.25/2.75)*t+.9375:i*(t-=2.625/2.75)*t+.984375,e?.5*(1-t):.5*t+.5},Form:void 0,form:function(t){return void 0!==t?new cn(pn.fromAny(t)):pn.Form},fromAny:function(t){if("function"==typeof t)return t;if("string"==typeof t)switch(t){case"linear":return pn.linear;case"quad-in":return pn.quadIn;case"quad-out":return pn.quadOut;case"quad-in-out":return pn.quadInOut;case"cubic-in":return pn.cubicIn;case"cubic-out":return pn.cubicOut;case"cubic-in-out":return pn.cubicInOut;case"quart-in":return pn.quartIn;case"quart-out":return pn.quartOut;case"quart-in-out":return pn.quartInOut;case"expo-in":return pn.expoIn;case"expo-out":return pn.expoOut;case"expo-in-out":return pn.expoInOut;case"circ-in":return pn.circIn;case"circ-out":return pn.circOut;case"circ-in-out":return pn.circInOut;case"back-in":return pn.backIn;case"back-out":return pn.backOut;case"back-in-out":return pn.backInOut;case"elastic-in":return pn.elasticIn;case"elastic-out":return pn.elasticOut;case"elastic-in-out":return pn.elasticInOut;case"bounce-in":return pn.bounceIn;case"bounce-out":return pn.bounceOut;case"bounce-in-out":return pn.bounceInOut}throw new Error(t)}};pn.linear.type="linear",pn.quadIn.type="quad-in",pn.quadOut.type="quad-out",pn.quadInOut.type="quad-in-out",pn.cubicIn.type="cubic-in",pn.cubicOut.type="cubic-out",pn.cubicInOut.type="cubic-in-out",pn.quartIn.type="quart-in",pn.quartOut.type="quart-out",pn.quartInOut.type="quart-in-out",pn.expoIn.type="expo-in",pn.expoOut.type="expo-out",pn.expoInOut.type="expo-in-out",pn.circIn.type="circ-in",pn.circOut.type="circ-out",pn.circInOut.type="circ-in-out",pn.backIn.type="back-in",pn.backOut.type="back-out",pn.backInOut.type="back-in-out",pn.elasticIn.type="elastic-in",pn.elasticOut.type="elastic-out",pn.elasticInOut.type="elastic-in-out",pn.bounceIn.type="bounce-in",pn.bounceOut.type="bounce-out",pn.bounceInOut.type="bounce-in-out";var cn=function(t){function e(e){void 0===e&&(e=pn.linear);var i=t.call(this)||this;return i.unit=e,i}return u(e,t),e.prototype.mold=function(t){return t=pn.fromAny(t),I.valueOf(t.type)},e.prototype.cast=function(t){var e=t.stringValue();if(void 0!==e)try{return pn.fromAny(e)}catch(t){}},e}(ye);pn.Form=new cn;var dn=function(){function t(){}return t.prototype.transform=function(t){return t instanceof fn?this:new bn([this,t])},t.prototype.translate=function(e,i){return this.transform(t.translate(e,i))},t.prototype.translateX=function(e){return this.transform(t.translateX(e))},t.prototype.translateY=function(e){return this.transform(t.translateY(e))},t.prototype.scale=function(e,i){return this.transform(t.scale(e,i))},t.prototype.scaleX=function(e){return this.transform(t.scaleX(e))},t.prototype.scaleY=function(e){return this.transform(t.scaleY(e))},t.prototype.rotate=function(e){return this.transform(t.rotate(e))},t.prototype.skew=function(e,i){return this.transform(t.skew(e,i))},t.prototype.skewX=function(e){return this.transform(t.skewX(e))},t.prototype.skewY=function(e){return this.transform(t.skewY(e))},t.prototype.toAttributeString=function(){return this.toString()},t.from=function(e){return void 0!==e?new Vn(t.fromAny(e)):t.Form},t.translate=function(t,e){return new yn(t,e)},t.translateX=function(t){return new yn(t,0)},t.translateY=function(t){return new yn(0,t)},t.scale=function(t,e){return new mn(t,e)},t.scaleX=function(t){return new mn(t,1)},t.scaleY=function(t){return new mn(1,t)},t.rotate=function(t){return new vn(t)},t.skew=function(t,e){return new gn(t,e)},t.skewX=function(t){return new gn(t,1)},t.skewY=function(t){return new gn(1,t)},t.matrix=function(t,e,i,r,o,n){return new wn(t,e,i,r,o,n)},t.fromAny=function(e){if(e instanceof t)return e;if("string"==typeof e)return t.parse(e);throw new Error(e)},t.fromValue=function(t){var e=t.tag;return"identity"===e?fn.fromValue(t):"translate"===e?yn.fromValue(t):"scale"===e?mn.fromValue(t):"rotate"===e?vn.fromValue(t):"skew"===e?gn.fromValue(t):"matrix"===e?wn.fromValue(t):bn.fromValue(t)},t.parse=function(t){for(var e=new v(t);!e.isEmpty()&&_.isSpace(e.head());)e.step();var i=Sn.parse(e);if(i.isDone()){for(;!e.isEmpty()&&_.isSpace(e.head());)e.step();e.isEmpty()||(i=_.unexpected(e))}return i.bind()},t.Identity=void 0,t.Form=void 0,t}(),fn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.transform=function(t){return t},e.prototype.toMatrix=function(){return new wn(1,0,0,1,0,0)},e.prototype.toValue=function(){return L.of(R.of("identity"))},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equals=function(t){return t instanceof e},e.prototype.toString=function(){return"none"},e.fromValue=function(t){if("identity"===t.tag)return dn.Identity},e}(dn);dn.Identity=new fn;var yn=function(t){function e(e,i){var r=t.call(this)||this;return r.x=qo.fromAny(e),r.y=qo.fromAny(i),r}return u(e,t),e.prototype.toMatrix=function(){return new wn(1,0,0,1,this.x.px().value,this.y.px().value)},e.prototype.toValue=function(){return L.of(R.of("translate",L.of(T.of("x",this.x.toString()),T.of("y",this.y.toString()))))},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equals=function(t){return t instanceof e&&(this.x.equals(t.x)&&this.y.equals(t.y))},e.prototype.toString=function(){return this.x.value&&!this.y.value?"translate("+this.x+",0)":!this.x.value&&this.y.value?"translate(0,"+this.y+")":"translate("+this.x+","+this.y+")"},e.prototype.toAttributeString=function(){return this.x.value&&!this.y.value?"translate("+this.x.px().value+",0)":!this.x.value&&this.y.value?"translate(0,"+this.y.px().value+")":"translate("+this.x.px().value+","+this.y.px().value+")"},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new Error(t)},e.fromValue=function(t){var i=t.header("translate");if(i.isDefined()){var r=qo.zero(),o=qo.zero();return i.forEach(function(t,e){var i=t.key.stringValue();void 0!==i?"x"===i?r=t.toValue().cast(qo.Form,r):"y"===i&&(o=t.toValue().cast(qo.Form,o)):t instanceof b&&(0===e?r=t.cast(qo.Form,r):1===e&&(o=t.cast(qo.Form,o)))},this),new e(r,o)}},e.parse=function(t){for(var e=new v(t);!e.isEmpty()&&_.isSpace(e.head());)e.step();var i=_n.parse(e);if(i.isDone()){for(;!e.isEmpty()&&_.isSpace(e.head());)e.step();e.isEmpty()||(i=_.unexpected(e))}return i.bind()},e}(dn),mn=function(t){function e(e,i){var r=t.call(this)||this;return r.x=+e,r.y=+i,r}return u(e,t),e.prototype.toMatrix=function(){return new wn(this.x,0,0,this.y,0,0)},e.prototype.toValue=function(){return L.of(R.of("scale",L.of(T.of("x",this.x),T.of("y",this.y))))},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equals=function(t){return t instanceof e&&(this.x===t.x&&this.y===t.y)},e.prototype.toString=function(){return this.x&&!this.y?"scaleX("+this.x+")":!this.x&&this.y?"scaleY("+this.y+")":"scale("+this.x+","+this.y+")"},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new Error(t)},e.fromValue=function(t){var i=t.header("scale");if(i.isDefined()){var r=0,o=0;return i.forEach(function(t,e){var i=t.key.stringValue();void 0!==i?"x"===i?r=t.toValue().numberValue(r):"y"===i&&(o=t.toValue().numberValue(o)):t instanceof b&&(0===e?r=t.numberValue(r):1===e&&(o=t.numberValue(o)))},this),new e(r,o)}},e.parse=function(t){for(var e=new v(t);!e.isEmpty()&&_.isSpace(e.head());)e.step();var i=xn.parse(e);if(i.isDone()){for(;!e.isEmpty()&&_.isSpace(e.head());)e.step();e.isEmpty()||(i=_.unexpected(e))}return i.bind()},e}(dn),vn=function(t){function e(e){var i=t.call(this)||this;return i.a=To.fromAny(e),i}return u(e,t),e.prototype.toMatrix=function(){var t=this.a.rad().value;return new wn(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0)},e.prototype.toValue=function(){return L.of(R.of("rotate",this.a.toString()))},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equals=function(t){return t instanceof e&&this.a.equals(t.a)},e.prototype.toString=function(){return"rotate("+this.a+")"},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new Error(t)},e.fromValue=function(t){var i=t.header("rotate");if(i.isDefined()){var r=To.zero();return i.forEach(function(t,e){"a"===t.key.stringValue()?r=t.toValue().cast(To.Form,r):t instanceof b&&0===e&&(r=t.cast(To.Form,r))},this),new e(r)}},e.parse=function(t){for(var e=new v(t);!e.isEmpty()&&_.isSpace(e.head());)e.step();var i=An.parse(e);if(i.isDone()){for(;!e.isEmpty()&&_.isSpace(e.head());)e.step();e.isEmpty()||(i=_.unexpected(e))}return i.bind()},e}(dn),gn=function(t){function e(e,i){var r=t.call(this)||this;return r.x=To.fromAny(e),r.y=To.fromAny(i),r}return u(e,t),e.prototype.toMatrix=function(){var t=this.x.rad().value,e=this.y.rad().value;return new wn(1,Math.tan(e),Math.tan(t),1,0,0)},e.prototype.toValue=function(){return L.of(R.of("skew",L.of(T.of("x",this.x.toString()),T.of("y",this.y.toString()))))},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equals=function(t){return t instanceof e&&(this.x.equals(t.x)&&this.y.equals(t.y))},e.prototype.toString=function(){return this.x.value&&!this.y.value?"skewX("+this.x+")":!this.x.value&&this.y.value?"skewY("+this.y+")":"skew("+this.x+","+this.y+")"},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new Error(t)},e.fromValue=function(t){var i=t.header("skew");if(i.isDefined()){var r=To.zero(),o=To.zero();return i.forEach(function(t,e){var i=t.key.stringValue();void 0!==i?"x"===i?r=t.toValue().cast(To.Form,r):"y"===i&&(o=t.toValue().cast(To.Form,o)):t instanceof b&&(0===e?r=t.cast(To.Form,r):1===e&&(o=t.cast(To.Form,o)))},this),new e(r,o)}},e.parse=function(t){for(var e=new v(t);!e.isEmpty()&&_.isSpace(e.head());)e.step();var i=kn.parse(e);if(i.isDone()){for(;!e.isEmpty()&&_.isSpace(e.head());)e.step();e.isEmpty()||(i=_.unexpected(e))}return i.bind()},e}(dn),wn=function(t){function e(e,i,r,o,n,s){void 0===e&&(e=1),void 0===i&&(i=0),void 0===r&&(r=0),void 0===o&&(o=1),void 0===n&&(n=0),void 0===s&&(s=0);var a=t.call(this)||this;return a.x0=+e,a.y0=+i,a.x1=+r,a.y1=+o,a.tx=+n,a.ty=+s,a}return u(e,t),e.prototype.multiply=function(t){return new e(this.x0*t.x0+this.x1*t.y0,this.y0*t.x0+this.y1*t.y0,this.x0*t.x1+this.x1*t.y1,this.y0*t.x1+this.y1*t.y1,this.x0*t.tx+this.x1*t.ty,this.y0*t.tx+this.y1*t.ty)},e.prototype.transform=function(t){return this.multiply(t.toMatrix())},e.prototype.toMatrix=function(){return this},e.prototype.toValue=function(){return L.of(R.of("matrix",L.of(this.x0,this.y0,this.x1,this.y1,this.tx,this.ty)))},e.prototype.conformsTo=function(t){return t instanceof e},e.prototype.equals=function(t){return t instanceof e&&(this.x0===t.x0&&this.y0===t.y0&&this.x1===t.x1&&this.y1===t.y1&&this.tx===t.tx&&this.ty===t.ty)},e.prototype.toString=function(){return"matrix("+this.x0+","+this.y0+","+this.x1+","+this.y1+","+this.tx+","+this.ty+")"},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new Error(t)},e.fromValue=function(t){var i=t.header("matrix");if(i.isDefined()){var r=0,o=0,n=0,s=0,a=0,u=0;return i.forEach(function(t,e){var i=t.key.stringValue();if(void 0!==i)"x0"===i?r=t.toValue().numberValue(r):"y0"===i?o=t.toValue().numberValue(o):"x1"===i?n=t.toValue().numberValue(n):"y1"===i?s=t.toValue().numberValue(s):"tx"===i?a=t.toValue().numberValue(a):"ty"===i&&(u=t.toValue().numberValue(u));else if(t instanceof b)switch(e){case 0:r=t.numberValue(r);break;case 1:o=t.numberValue(o);break;case 2:n=t.numberValue(n);break;case 3:s=t.numberValue(s);break;case 4:a=t.numberValue(a);break;case 5:u=t.numberValue(u)}},this),new e(r,o,n,s,a,u)}},e.parse=function(t){for(var e=new v(t);!e.isEmpty()&&_.isSpace(e.head());)e.step();var i=En.parse(e);if(i.isDone()){for(;!e.isEmpty()&&_.isSpace(e.head());)e.step();e.isEmpty()||(i=_.unexpected(e))}return i.bind()},e.Identity=new e,e}(dn),bn=function(t){function e(i){var r,o=t.call(this)||this;o.transforms=[];for(var n=0;n<i.length;n+=1){var s=i[n];s instanceof e?(r=o.transforms).push.apply(r,s.transforms):!s||s instanceof fn||o.transforms.push(s)}return o}return u(e,t),e.prototype.toMatrix=function(){for(var t=wn.Identity,e=0;e<this.transforms.length;e+=1)t=t.multiply(this.transforms[e].toMatrix());return t},e.prototype.toValue=function(){for(var t=this.transforms.length,e=L.empty(t),i=0;i<t;i+=1)e.push(this.transforms[i].toValue());return e},e.prototype.conformsTo=function(t){if(t instanceof e){var i=this.transforms.length;if(i===t.transforms.length){for(var r=0;r<i;r+=1)if(!this.transforms[r].conformsTo(t.transforms[r]))return!1;return!0}}return!1},e.prototype.equals=function(t){if(t instanceof e){var i=this.transforms.length;if(i===t.transforms.length){for(var r=0;r<i;r+=1)if(!this.transforms[r].equals(t.transforms[r]))return!1;return!0}}return!1},e.prototype.toString=function(){for(var t="",e=0;e<this.transforms.length;e+=1)e>0&&(t+=" "),t+=this.transforms[e].toString();return t},e.prototype.toAttributeString=function(){for(var t="",e=0;e<this.transforms.length;e+=1)e>0&&(t+=" "),t+=this.transforms[e].toAttributeString();return t},e.fromAny=function(t){if(t instanceof e)return t;if("string"==typeof t)return e.parse(t);throw new Error(t)},e.fromValue=function(t){var i=[];if(t.forEach(function(t){var e=dn.fromValue(t.toValue());e&&i.push(e)},this),i.length)return new e(i)},e.parse=function(t){var i=dn.parse(t);return i instanceof e?i:new e([i])},e}(dn),_n=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.identParser=e,n.xParser=i,n.yParser=r,n.step=o,n}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.identParser,this.xParser,this.yParser,this.step)},e.parse=function(t,i,r,o,n){void 0===n&&(n=1);var s=0;if(1===n){for(i||(i=Xe.Factory.parseIdent(t));i.isCont()&&(!t.isEmpty()||t.isDone());)i=i.feed(t);if(i.isDone())n=2;else if(i.isError())return i.asError()}if(2===n)if(t.isEmpty()||40!==t.head()){if(!t.isEmpty()||t.isDone())return _.expected("(",t)}else t.step(),n=3;if(3===n){if(!r){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(r=Xo.parse(t))}for(;r.isCont()&&(!t.isEmpty()||t.isDone());)r=r.feed(t);if(r.isDone())n=4;else if(r.isError())return r.asError()}if(4===n){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(41===(s=t.head()))return t.step(),"translateX"===(a=i.bind().stringValue())?_.done(dn.translateX(r.bind())):"translateY"===a?_.done(dn.translateY(r.bind())):_.error(a);if(44!==s)return _.expected(",",t);t.step(),n=5}}if(5===n){if(!o){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(o=Xo.parse(t))}for(;o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())n=6;else if(o.isError())return o.asError()}if(6===n){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();var a;if(!t.isEmpty()&&41===t.head())return t.step(),"translate"===(a=i.bind().stringValue())?_.done(dn.translate(r.bind(),o.bind())):_.error(a);if(!t.isEmpty()||t.isDone())return _.expected(")",t)}return new e(i,r,o,n)},e.parseRest=function(t,i){return e.parse(t,i,void 0,void 0,2)},e}(_),xn=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.identParser=e,n.xParser=i,n.yParser=r,n.step=o,n}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.identParser,this.xParser,this.yParser,this.step)},e.parse=function(t,i,r,o,n){void 0===n&&(n=1);var s=0;if(1===n){for(i||(i=Xe.Factory.parseIdent(t));i.isCont()&&(!t.isEmpty()||t.isDone());)i=i.feed(t);if(i.isDone())n=2;else if(i.isError())return i.asError()}if(2===n)if(t.isEmpty()||40!==t.head()){if(!t.isEmpty()||t.isDone())return _.expected("(",t)}else t.step(),n=3;if(3===n){if(!r){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(r=Xe.Factory.parseNumber(t))}for(;r.isCont()&&(!t.isEmpty()||t.isDone());)r=r.feed(t);if(r.isDone())n=4;else if(r.isError())return r.asError()}if(4===n){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(41===(s=t.head()))return t.step(),"scaleX"===(a=i.bind().stringValue())?_.done(dn.scaleX(r.bind().numberValue())):"scaleY"===a?_.done(dn.scaleY(r.bind().numberValue())):_.error(a);if(44!==s)return _.expected(",",t);t.step(),n=5}}if(5===n){if(!o){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(o=Xe.Factory.parseNumber(t))}for(;o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())n=6;else if(o.isError())return o.asError()}if(6===n){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();if(!t.isEmpty()&&41===t.head()){var a;if(t.step(),"scale"===(a=i.bind().stringValue())){var u=r.bind().numberValue(),h=o.bind().numberValue();return _.done(dn.scale(u,h))}return _.error(a)}if(!t.isEmpty()||t.isDone())return _.expected(")",t)}return new e(i,r,o,n)},e.parseRest=function(t,i){return e.parse(t,i,void 0,void 0,2)},e}(_),An=function(t){function e(e,i,r){var o=t.call(this)||this;return o.identParser=e,o.aParser=i,o.step=r,o}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.identParser,this.aParser,this.step)},e.parse=function(t,i,r,o){if(void 0===o&&(o=1),1===o){for(i||(i=Xe.Factory.parseIdent(t));i.isCont()&&(!t.isEmpty()||t.isDone());)i=i.feed(t);if(i.isDone())o=2;else if(i.isError())return i.asError()}if(2===o)if(t.isEmpty()||40!==t.head()){if(!t.isEmpty()||t.isDone())return _.expected("(",t)}else t.step(),o=3;if(3===o){if(!r){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(r=Io.parse(t))}for(;r.isCont()&&(!t.isEmpty()||t.isDone());)r=r.feed(t);if(r.isDone())o=4;else if(r.isError())return r.asError()}if(4===o){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();if(!t.isEmpty()&&41===t.head()){t.step();var n=i.bind().stringValue();return"rotate"===n?_.done(dn.rotate(r.bind())):_.error(n)}if(!t.isEmpty()||t.isDone())return _.expected(")",t)}return new e(i,r,o)},e.parseRest=function(t,i){return e.parse(t,i,void 0,2)},e}(_),kn=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.identParser=e,n.xParser=i,n.yParser=r,n.step=o,n}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.identParser,this.xParser,this.yParser,this.step)},e.parse=function(t,i,r,o,n){void 0===n&&(n=1);var s=0;if(1===n){for(i||(i=Xe.Factory.parseIdent(t));i.isCont()&&(!t.isEmpty()||t.isDone());)i=i.feed(t);if(i.isDone())n=2;else if(i.isError())return i.asError()}if(2===n)if(t.isEmpty()||40!==t.head()){if(!t.isEmpty()||t.isDone())return _.expected("(",t)}else t.step(),n=3;if(3===n){if(!r){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(r=Io.parse(t))}for(;r.isCont()&&(!t.isEmpty()||t.isDone());)r=r.feed(t);if(r.isDone())n=4;else if(r.isError())return r.asError()}if(4===n){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(41===(s=t.head()))return t.step(),"skewX"===(a=i.bind().stringValue())?_.done(dn.skewX(r.bind())):"skewY"===a?_.done(dn.skewY(r.bind())):_.error(a);if(44!==s)return _.expected(",",t);t.step(),n=5}}if(5===n){if(!o){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(o=Io.parse(t))}for(;o.isCont()&&(!t.isEmpty()||t.isDone());)o=o.feed(t);if(o.isDone())n=6;else if(o.isError())return o.asError()}if(6===n){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();var a;if(!t.isEmpty()&&41===t.head())return t.step(),"skew"===(a=i.bind().stringValue())?_.done(dn.skew(r.bind(),o.bind())):_.error(a);if(!t.isEmpty()||t.isDone())return _.expected(")",t)}return new e(i,r,o,n)},e.parseRest=function(t,i){return e.parse(t,i,void 0,void 0,2)},e}(_),En=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.identParser=e,n.entryParser=i,n.entries=r,n.step=o,n}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.identParser,this.entryParser,this.entries,this.step)},e.parse=function(t,i,r,o,n){void 0===o&&(o=[]),void 0===n&&(n=1);var s=0;if(1===n){for(i||(i=Xe.Factory.parseIdent(t));i.isCont()&&(!t.isEmpty()||t.isDone());)i=i.feed(t);if(i.isDone())n=2;else if(i.isError())return i.asError()}if(2===n)if(t.isEmpty()||40!==t.head()){if(!t.isEmpty()||t.isDone())return _.expected("(",t)}else t.step(),n=3;for(;;){if(3===n){if(!r){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(r=Xe.Factory.parseNumber(t))}for(;r.isCont()&&(!t.isEmpty()||t.isDone());)r=r.feed(t);if(r.isDone())o.push(r.bind().numberValue()),r=void 0,n=4;else if(r.isError())return r.asError()}if(4===n){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();if(!t.isEmpty()){if(41===(s=t.head())){t.step();var a=i.bind().stringValue();return"matrix"===a?_.done(dn.matrix.apply(dn,o)):_.error(a)}if(o.length>=6)return _.expected(")",t);if(44===s){t.step(),n=3;continue}return _.expected(",",t)}if(t.isDone())return _.unexpected(t)}break}return new e(i,r,o,n)},e.parseRest=function(t,i){return e.parse(t,i,void 0,void 0,2)},e}(_),Cn=function(t){function e(e){var i=t.call(this)||this;return i.identParser=e,i}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.identParser)},e.parse=function(t,i){for(i||(i=Xe.Factory.parseIdent(t));i.isCont()&&(!t.isEmpty()||t.isDone());)i=i.feed(t);if(i.isDone()){var r=i.bind().stringValue();switch(r){case"translateX":case"translateY":case"translate":return _n.parseRest(t,i);case"scaleX":case"scaleY":case"scale":return xn.parseRest(t,i);case"rotate":return An.parseRest(t,i);case"skewX":case"skewY":case"skew":return kn.parseRest(t,i);case"matrix":return En.parseRest(t,i);case"none":return _.done(dn.Identity);default:return _.error(r)}}else if(i.isError())return i.asError();return new e(i)},e}(_),Sn=function(t){function e(e,i){var r=t.call(this)||this;return r.transformParser=e,r.transform=i,r}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.transformParser,this.transform)},e.parse=function(t,i,r){for(void 0===r&&(r=dn.Identity);;){if(!i){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(i=Cn.parse(t))}for(;i.isCont()&&(!t.isEmpty()||t.isDone());)i=i.feed(t);if(!i.isDone()){if(i.isError())return i.asError();break}r=r.transform(i.bind())}return new e(i)},e}(_),Vn=function(t){function e(e){void 0===e&&(e=dn.Identity);var i=t.call(this)||this;return i.unit=e,i}return u(e,t),e.prototype.mold=function(t){return(t=dn.fromAny(t)).toValue()},e.prototype.cast=function(t){try{if(t instanceof L)return dn.fromValue(t);var e=t.stringValue();if(void 0!==e)return dn.parse(e)}catch(t){}},e}(ye),Dn=function(){function t(){}return t.of=function(t,e,i,r){if("time"===t){r=i,i=e;var o=oo.current();e=o,t=o.time(o.time()-864e5)}else"linear"===t&&(r=i,i=e,e=1,t=0);if(t instanceof oo||t instanceof Date||e instanceof oo||e instanceof Date)return new Tn(t,e,i instanceof Ln?i:Ln.interpolate(i,r));if("number"==typeof t&&"number"==typeof e)return new Rn(t,e,i instanceof Ln?i:Ln.interpolate(i,r));throw new TypeError(""+arguments)},t.linear=function(t,e,i,r){return Array.isArray(t)?e instanceof Ln?new Rn(t[0],t[1],e):(e=e,new Rn(t[0],t[1],Ln.interpolate(e[0],e[1]))):(t=t,e=e,i instanceof Ln?new Rn(t,e,i):(i=i,r=r,new Rn(t,e,Ln.interpolate(i,r))))},t.time=function(t,e,i,r){return Array.isArray(t)?e instanceof Ln?new Tn(t[0],t[1],e):(e=e,new Tn(t[0],t[1],Ln.interpolate(e[0],e[1]))):(t=t,e=e,i instanceof Ln?new Tn(t,e,i):(i=i,r=r,new Tn(t,e,Ln.interpolate(i,r))))},t.Form=void 0,t}(),Mn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Form=void 0,e}(Dn),Rn=function(t){function e(e,i,r){var o=t.call(this)||this;return o.x0=e,o.dx=i-o.x0,o.fx=r,o}return u(e,t),e.prototype.norm=function(t){return this.dx?(t-this.x0)/this.dx:this.dx},e.prototype.scale=function(t){var e=this.norm(t);return this.fx.map(e)},e.prototype.unscale=function(t){return this.x0+this.dx*this.fx.unmap(t)},e.prototype.clampScale=function(t){var e=Math.min(Math.max(0,this.norm(t)),1);return this.fx.map(e)},e.prototype.domain=function(t,i){return void 0===t?[this.x0,this.x0+this.dx]:void 0===i?new e((t=t)[0],t[1],this.fx):new e(t,i,this.fx)},e.prototype.range=function(t,i){return void 0===t?this.fx.range():new e(this.x0,this.x0+this.dx,void 0===i?this.fx.range(t):this.fx.range(t,i))},e.prototype.interpolate=function(t){return void 0===t?this.fx:(t=Ln.fromAny(t),new e(this.x0,this.x0+this.dx,t))},e.prototype.clampDomain=function(t,i,r,o){var n=this.x0,s=this.x0+this.dx;void 0!==t&&(n<s&&n<t?n=t:s<n&&s<t&&(s=t)),void 0!==i&&(n<s&&s>i?s=i:s<n&&n>i&&(s=i));var a=+this.scale(n),u=+this.scale(s)-a,h=Math.abs(u/(s-n));if(void 0!==r&&h<1/r)n=((p=n+s)-(l=u*r))/2,s=(p+l)/2;else if(void 0!==o&&h>1/o){var l,p;n=((p=n+s)-(l=u*o))/2,s=(p+l)/2}return n!==this.x0||s-n!==this.dx?new e(n,s,this.fx):this},e.prototype.solveDomain=function(t,i,r,o){var n,s=this.fx.range(),a=+s[0],u=+s[1],h=+i-(n=void 0===r||void 0===o||t===r||i===o?(u-a)/this.dx:(+o-+i)/(r-t))*t;return new e((a-h)/n,(u-h)/n,this.fx)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx===t.dx&&this.fx.equals(t.fx))},e}(Mn),Tn=function(t){function e(e,i,r,o){var n=t.call(this)||this;return e=oo.fromAny(e),i=oo.fromAny(i),n.t0=e.time(),n.dt=i.time()-n.t0,n.zone=o||e.zone(),n.ft=r,n}return u(e,t),e.prototype.norm=function(t){return t=oo.time(t),this.dt?(t-this.t0)/this.dt:this.dt},e.prototype.scale=function(t){var e=this.norm(t);return this.ft.map(e)},e.prototype.unscale=function(t){return new oo(this.t0+this.dt*this.ft.unmap(t))},e.prototype.clampScale=function(t){var e=Math.min(Math.max(0,this.norm(t)),1);return this.ft.map(e)},e.prototype.domain=function(t,i){return void 0===t?[new oo(this.t0,this.zone),new oo(this.t0+this.dt,this.zone)]:void 0===i?new e((t=t)[0],t[1],this.ft,this.zone):new e(t,i,this.ft,this.zone)},e.prototype.range=function(t,i){return void 0===t?this.ft.range():new e(this.t0,this.t0+this.dt,void 0===i?this.ft.range(t):this.ft.range(t,i),this.zone)},e.prototype.interpolate=function(t){return void 0===t?this.ft:(t=Ln.fromAny(t),new e(this.t0,this.t0+this.dt,t,this.zone))},e.prototype.clampDomain=function(t,i,r,o){var n=this.t0,s=this.t0+this.dt;void 0!==t&&(n<s&&n<+t?n=+t:s<n&&s<+t&&(s=+t)),void 0!==i&&(n<s&&s>+i?s=+i:s<n&&n>+i&&(s=+i));var a=+this.scale(n),u=+this.scale(s)-a,h=Math.abs(u/(s-n));if(void 0!==r&&h<1/r)n=((p=n+s)-(l=u*r))/2,s=(p+l)/2;else if(void 0!==o&&h>1/o){var l,p;n=((p=n+s)-(l=u*o))/2,s=(p+l)/2}return n!==this.t0||s-n!==this.dt?new e(n,s,this.ft,this.zone):this},e.prototype.solveDomain=function(t,i,r,o){var n,s=this.ft.range(),a=+s[0],u=+s[1],h=+i-(n=void 0===r||void 0===o||t===r||i===o?(u-a)/this.dt:(+o-+i)/(+r-+t))*+t;return new e((a-h)/n,(u-h)/n,this.ft,this.zone)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.t0===t.t0&&this.dt===t.dt&&this.ft.equals(t.ft))},e}(Mn),Pn=function(t){function e(e,i,r){var o=t.call(this)||this;return o.domainForm=e,o.interpolatorForm=i,o.unit=r,o}return u(e,t),e.prototype.mold=function(t){if(t instanceof Mn){var e=t.domain(),i=this.domainForm.mold(e[0]),r=this.domainForm.mold(e[1]),o=L.of(i,r),n=L.of(R.of("scale",o)),s=this.interpolatorForm.mold(t.interpolate());return s.isDefined()&&(n=n.concat(s)),n}return b.Absent},e.prototype.cast=function(t){var e=t.header("scale");if(e.length>=2){var i,r;e.forEach(function(t,e){t instanceof b&&(0===e?i=t.cast(this.domainForm,i):1===e&&(r=t.cast(this.domainForm,r)))},this);var o=this.interpolatorForm.cast(t.body());if(void 0!==i&&void 0!==r&&o)return Dn.of(i,r,o)}},e}(ye),Ln=function(){function t(){}return t.form=function(t,e){return new is(t,e)},t.step=function(t,e){return new Fn(t,e)},t.number=function(t,e){return new zn(t,e)},t.date=function(t,e){return new In(t,e)},t.angle=function(t,e){return new Un(t,e)},t.len=function(t,e){return new Wn(t,e)},t.color=function(t,e){return void 0===t&&void 0===e?new On:(void 0!==t&&(t=Qo.fromAny(t)),void 0!==e&&(e=Qo.fromAny(e)),t||e?e?t||(t=e):e=t:e=t=Qo.transparent(),t instanceof Jo&&e instanceof Jo?new qn(t,e):new Bn(t.rgb(),e.rgb()))},t.rgb=function(t,e){return new Bn(t,e)},t.hsl=function(t,e){return new qn(t,e)},t.transform=function(t,e){return void 0===t&&void 0===e?new Gn:(void 0!==t&&(t=dn.fromAny(t)),void 0!==e&&(e=dn.fromAny(e)),t||e?e?t||(t=e):e=t:e=t=dn.Identity,t instanceof yn&&e instanceof yn?new Hn(t,e):t instanceof mn&&e instanceof mn?new Nn(t,e):t instanceof vn&&e instanceof vn?new jn(t,e):t instanceof gn&&e instanceof gn?new Yn(t,e):t instanceof bn&&e instanceof bn&&t.conformsTo(e)?new Kn(t,e):new Xn(t.toMatrix(),e.toMatrix()))},t.scale=function(t,e){if(void 0===t&&void 0===e)return new Zn;if(e?t||(t=e):e=t,t instanceof Rn&&e instanceof Rn)return new Jn(t,e);if(t instanceof Tn&&e instanceof Tn)return new $n(t,e);throw new TypeError(t+", "+e)},t.array=function(t,e){return new ts(t,e)},t.interpolate=function(e,i){return e instanceof t&&i instanceof t?new es(e,i):e instanceof oo||e instanceof Date||i instanceof oo||i instanceof Date?new In(e,i):e instanceof To||i instanceof To?new Un(e,i):e instanceof qo||i instanceof qo?new Wn(e,i):e instanceof Qo||i instanceof Qo?t.color(e,i):e instanceof dn||i instanceof dn?t.transform(e,i):e instanceof Mn||i instanceof Mn?t.scale(e,i):e instanceof w||i instanceof w?t.recon(e,i):"number"==typeof e||"number"==typeof i?new zn(e,i):Array.isArray(e)||Array.isArray(i)?new ts(e,i):new Fn(e,i)},t.fromAny=function(e){if(e instanceof t)return e;if("string"==typeof e)switch(e){case"step":return t.step();case"number":return t.number();case"angle":return t.angle();case"length":return t.len();case"color":return t.color();case"rgb":return t.rgb();case"hsl":return t.hsl();case"transform":case"translate":case"scale":case"rotate":case"skew":case"matrix":case"transform-list":return t.transform();case"scale":return t.scale();case"array":return t.array()}throw new Error(e)},t.Form=void 0,t.recon=void 0,t}(),Fn=function(t){function e(e,i){var r=t.call(this)||this;return void 0===i?i=e:void 0===e&&(e=i),r.y0=e,r.y1=i,r}return u(e,t),e.prototype.map=function(t){var e=t<1?this.y0:this.y1;if(void 0===e)throw new TypeError;return e},e.prototype.unmap=function(t){return t===this.y1?1:0},e.prototype.range=function(t,i){if(void 0===t){if(void 0===this.y0||void 0===this.y1)throw new TypeError;return[this.y0,this.y1]}return void 0===i?new e((t=t)[0],t[1]):new e(t,i)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.y0===t.y0&&this.y1===t.y1)},e}(Ln),zn=function(t){function e(e,i){var r=t.call(this)||this;return void 0===e&&void 0===i?i=e=0:void 0===i?i=e:void 0===e&&(e=i),r.y0=+e,r.dy=+i-r.y0,r}return u(e,t),e.prototype.map=function(t){return this.y0+this.dy*t},e.prototype.unmap=function(t){return this.dy?(t-this.y0)/this.dy:this.dy},e.prototype.range=function(t,i){return void 0===t?[this.y0,this.y0+this.dy]:void 0===i?new e((t=t)[0],t[1]):new e(t,i)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.y0===t.y0&&this.dy===t.dy)},e}(Ln),In=function(t){function e(e,i,r){var o=t.call(this)||this;return void 0===e&&void 0===i?i=e=0:void 0===i?i=e:void 0===e&&(e=i),e=oo.fromAny(e),i=oo.fromAny(i),o.t0=e.time(),o.dt=i.time()-o.t0,o.zone=r||e.zone(),o}return u(e,t),e.prototype.map=function(t){return new oo(this.t0+this.dt*t,this.zone)},e.prototype.unmap=function(t){return t=oo.time(t),this.dt?(t-this.t0)/this.dt:this.dt},e.prototype.range=function(t,i){return void 0===t?[new oo(this.t0,this.zone),new oo(this.t0+this.dt,this.zone)]:void 0===i?new e((t=t)[0],t[1],this.zone):new e(t,i,this.zone)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.t0===t.t0&&this.dt===t.dt)},e}(Ln),Un=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=To.fromAny(e)),void 0!==i&&(i=To.fromAny(i)),e||i?i?e=e?e.to(i.units):i:i=e:i=e=To.zero(),r.v0=e.value,r.dv=i.value-r.v0,r.units=i.units,r}return u(e,t),e.prototype.map=function(t){return To.fromAny(this.v0+this.dv*t,this.units)},e.prototype.unmap=function(t){var e=To.fromAny(t).to(this.units).value;return this.dv?(e-this.v0)/this.dv:this.dv},e.prototype.range=function(t,i){return void 0===t?[To.fromAny(this.v0,this.units),To.fromAny(this.v0+this.dv,this.units)]:void 0===i?new e((t=t)[0],t[1]):new e(t,i)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.v0===t.v0&&this.dv===t.dv&&this.units===t.units)},e}(Ln),Wn=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=qo.fromAny(e)),void 0!==i&&(i=qo.fromAny(i)),i||i?i?e=e?e.to(i.units):i:i=e:i=e=qo.zero(),r.v0=e.value,r.dv=i.value-r.v0,r.units=i.units,r}return u(e,t),e.prototype.map=function(t){return qo.fromAny(this.v0+this.dv*t,this.units)},e.prototype.unmap=function(t){var e=qo.fromAny(t).to(this.units).value;return this.dv?(e-this.v0)/this.dv:this.dv},e.prototype.range=function(t,i){return void 0===t?[qo.fromAny(this.v0,this.units),qo.fromAny(this.v0+this.dv,this.units)]:void 0===i?new e((t=t)[0],t[1]):new e(t,i)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.v0===t.v0&&this.dv===t.dv&&this.units===t.units)},e}(Ln),On=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.map=function(t){return Qo.transparent()},e.prototype.unmap=function(t){return 0},e.prototype.range=function(t,e){return void 0===t?[this.map(0),this.map(1)]:void 0===e?(t=t,Ln.color(t[0],t[1])):Ln.color(t,e)},e.prototype.equals=function(t){return this===t},e}(Ln),Bn=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=Qo.rgb(e)),void 0!==i&&(i=Qo.rgb(i)),e||i?i?e||(e=i):i=e:i=e=Zo.transparent(),r.r0=e.r,r.dr=i.r-r.r0,r.g0=e.g,r.dg=i.g-r.g0,r.b0=e.b,r.db=i.b-r.b0,r.a0=e.a,r.da=i.a-r.a0,r}return u(e,t),e.prototype.map=function(t){var e=this.r0+this.dr*t,i=this.g0+this.dg*t,r=this.b0+this.db*t,o=this.a0+this.da*t;return new Zo(e,i,r,o)},e.prototype.unmap=function(t){var e=(t=Qo.rgb(t)).r-this.r0,i=t.g-this.g0,r=t.b-this.b0,o=t.a-this.a0,n=e*this.dr+i*this.dg+r*this.db+o*this.da,s=Math.sqrt(e*e+i*i+r*r+o*o);return s?n/s:s},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.r0===t.r0&&this.dr===t.dr&&this.g0===t.g0&&this.dg===t.dg&&this.b0===t.b0&&this.db===t.db&&this.a0===t.a0&&this.da===t.da)},e}(On),qn=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=Qo.hsl(e)),void 0!==i&&(i=Qo.hsl(i)),e||i?i?e||(e=i):i=e:i=e=Jo.transparent(),r.h0=e.h,r.dh=i.h-r.h0,r.s0=e.s,r.ds=i.s-r.s0,r.l0=e.l,r.dl=i.l-r.l0,r.a0=e.a,r.da=i.a-r.a0,r}return u(e,t),e.prototype.map=function(t){var e=this.h0+this.dh*t,i=this.s0+this.ds*t,r=this.l0+this.dl*t,o=this.a0+this.da*t;return new Jo(e,i,r,o)},e.prototype.unmap=function(t){var e=(t=Qo.hsl(t)).h-this.h0,i=t.s-this.s0,r=t.l-this.l0,o=t.a-this.a0,n=e*this.dh+i*this.ds+r*this.dl+o*this.da,s=Math.sqrt(e*e+i*i+r*r+o*o);return s?n/s:s},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.h0===t.h0&&this.dh===t.dh&&this.s0===t.s0&&this.ds===t.ds&&this.l0===t.l0&&this.dl===t.dl&&this.a0===t.a0&&this.da===t.da)},e}(On),Gn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.map=function(t){return dn.Identity},e.prototype.unmap=function(t){return 0},e.prototype.range=function(t,e){return void 0===t?[this.map(0),this.map(1)]:void 0===e?(t=t,Ln.transform(t[0],t[1])):Ln.transform(t,e)},e.prototype.equals=function(t){return this===t},e}(Ln),Hn=function(t){function e(e,i){var r,o,n,s,a=t.call(this)||this;return void 0!==e?(r=(e=yn.fromAny(e)).x,o=e.y):(r=void 0,o=void 0),void 0!==i?(n=(i=yn.fromAny(i)).x,s=i.y):(n=void 0,s=void 0),r||n?n?r=r?r.to(n.units):n:n=r:n=r=qo.zero(),o||s?s?o=o?o.to(s.units):s:s=o:s=o=qo.zero(),a.x0=r.value,a.dx=n.value-a.x0,a.xUnits=n.units,a.y0=o.value,a.dy=s.value-a.y0,a.yUnits=s.units,a}return u(e,t),e.prototype.map=function(t){var e=qo.fromAny(this.x0+this.dx*t,this.xUnits),i=qo.fromAny(this.y0+this.dy*t,this.yUnits);return new yn(e,i)},e.prototype.unmap=function(t){var e=(t=yn.fromAny(t)).x.units,i=qo.fromAny(this.x0,this.xUnits).to(e).value,r=qo.fromAny(this.y0,this.yUnits).to(e).value,o=qo.fromAny(this.dx,this.xUnits).to(e).value,n=qo.fromAny(this.dy,this.yUnits).to(e).value,s=t.x.to(e).value-i,a=t.y.to(e).value-r,u=s*o+a*n,h=Math.sqrt(s*s+a*a);return h?u/h:h},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx===t.dx&&this.xUnits===t.xUnits&&this.y0===t.y0&&this.dy===t.dy&&this.yUnits===t.yUnits)},e}(Gn),Nn=function(t){function e(e,i){var r,o,n,s,a=t.call(this)||this;return void 0!==e?(r=(e=mn.fromAny(e)).x,o=e.y):(r=void 0,o=void 0),void 0!==i?(n=(i=mn.fromAny(i)).x,s=i.y):(n=void 0,s=void 0),void 0!==r||n?void 0===n?n=r:void 0===r&&(r=n):n=r=1,void 0===o&&void 0===s?s=o=1:void 0===s?s=o:void 0===o&&(o=s),a.x0=r,a.dx=n-a.x0,a.y0=o,a.dy=s-a.y0,a}return u(e,t),e.prototype.map=function(t){var e=this.x0+this.dx*t,i=this.y0+this.dy*t;return new mn(e,i)},e.prototype.unmap=function(t){var e=(t=mn.fromAny(t)).x-this.x0,i=t.y-this.y0,r=e*this.dx+i*this.dy,o=Math.sqrt(e*e+i*i);return o?r/o:o},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx===t.dx&&this.y0===t.y0&&this.dy===t.dy)},e}(Gn),jn=function(t){function e(e,i){var r,o,n=t.call(this)||this;return r=void 0!==e?(e=vn.fromAny(e)).a:void 0,o=void 0!==i?(i=vn.fromAny(i)).a:void 0,r||o?o?r=r?r.to(o.units):o:o=r:o=r=To.zero(),n.v0=r.value,n.dv=o.value-n.v0,n.units=o.units,n}return u(e,t),e.prototype.map=function(t){var e=To.fromAny(this.v0+this.dv*t,this.units);return new vn(e)},e.prototype.unmap=function(t){var e=vn.fromAny(t).a.to(this.units).value;return this.dv?(e-this.v0)/this.dv:this.dv},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.v0===t.v0&&this.dv===t.dv&&this.units===t.units)},e}(Gn),Yn=function(t){function e(e,i){var r,o,n,s,a=t.call(this)||this;return void 0!==e?(r=(e=gn.fromAny(e)).x,o=e.y):(r=void 0,o=void 0),void 0!==i?(n=(i=gn.fromAny(i)).x,s=i.y):(n=void 0,s=void 0),r||n?n?r=r?r.to(n.units):n:n=r:n=r=To.zero(),o||s?s?o=o?o.to(s.units):s:s=o:s=o=To.zero(),a.x0=r.value,a.dx=n.value-a.x0,a.xUnits=n.units,a.y0=o.value,a.dy=s.value-a.y0,a.yUnits=s.units,a}return u(e,t),e.prototype.map=function(t){var e=To.fromAny(this.x0+this.dx*t,this.xUnits),i=To.fromAny(this.y0+this.dy*t,this.yUnits);return new gn(e,i)},e.prototype.unmap=function(t){var e=(t=gn.fromAny(t)).x.units,i=To.fromAny(this.x0,this.xUnits).to(e).value,r=To.fromAny(this.y0,this.yUnits).to(e).value,o=To.fromAny(this.dx,this.xUnits).to(e).value,n=To.fromAny(this.dy,this.yUnits).to(e).value,s=t.x.to(e).value-i,a=t.y.to(e).value-r,u=s*o+a*n,h=Math.sqrt(s*s+a*a);return h?u/h:h},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0===t.x0&&this.dx===t.dx&&this.xUnits===t.xUnits&&this.y0===t.y0&&this.dy===t.dy&&this.yUnits===t.yUnits)},e}(Gn),Xn=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=wn.fromAny(e)),void 0!==i&&(i=wn.fromAny(i)),e||i?i?e||(e=i):i=e:i=e=new wn,r.f0=e,r.f1=i,r}return u(e,t),e.prototype.map=function(t){return this.f1},e.prototype.unmap=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.f0.equals(t.f0)&&this.f1.equals(t.f1))},e}(Gn),Kn=function(t){function e(e,i){var r=t.call(this)||this;void 0!==e&&(e=bn.fromAny(e)),void 0!==i&&(i=bn.fromAny(i)),e||i?i?e||(e=i):i=e:i=e=new bn([]),r.interpolators=[];for(var o=Math.min(e.transforms.length,i.transforms.length),n=0;n<o;n+=1)r.interpolators.push(Ln.transform(e.transforms[n],i.transforms[n]));return r}return u(e,t),e.prototype.map=function(t){for(var e=[],i=0;i<this.interpolators.length;i+=1)e.push(this.interpolators[i].map(t));return new bn(e)},e.prototype.unmap=function(t){return 0},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){var i=this.interpolators.length;if(i===t.interpolators.length){for(var r=0;r<i;r+=1)if(!this.interpolators[r].equals(t.interpolators[r]))return!1;return!0}}return!1},e}(Gn),Qn=function(t){function e(e){var i=t.call(this)||this;if(e instanceof SVGPathElement)i.path=e;else{var r=document.createElementNS("http://www.w3.org/2000/svg","path");r.setAttribute("d",""+e),i.path=r}return i}return u(e,t),e.prototype.map=function(t){var e=this.path.getPointAtLength(t*this.path.getTotalLength());return dn.translate(e.x,e.y)},e.prototype.unmap=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&this.path===t.path},e}(Gn),Zn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.map=function(t){throw new Error},e.prototype.unmap=function(t){return 0},e.prototype.range=function(t,e){return void 0===t?[this.map(0),this.map(1)]:void 0===e?(t=t,Ln.scale(t[0],t[1])):Ln.scale(t,e)},e.prototype.equals=function(t){return this===t},e}(Ln),Jn=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new Error;return i?e||(e=i):i=e,r.x0=new zn(e.x0,i.x0),r.dx=new zn(e.dx,i.dx),r.fx=new es(e.fx,i.fx),r}return u(e,t),e.prototype.map=function(t){var e=this.x0.map(t),i=this.dx.map(t),r=this.fx.map(t);return new Rn(e,e+i,r)},e.prototype.unmap=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.x0.equals(t.x0)&&this.dx.equals(t.dx)&&this.fx.equals(t.fx))},e}(Zn),$n=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new Error;return i?e||(e=i):i=e,r.t0=new zn(e.t0,i.t0),r.dt=new zn(e.dt,i.dt),r.ft=new es(e.ft,i.ft),r}return u(e,t),e.prototype.map=function(t){var e=this.t0.map(t),i=this.dt.map(t),r=this.ft.map(t);return new Tn(e,e+i,r)},e.prototype.unmap=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.t0.equals(t.t0)&&this.dt.equals(t.dt)&&this.ft.equals(t.ft))},e}(Zn),ts=function(t){function e(e,i){var r=t.call(this)||this;e||i?i?e||(e=i):i=e:i=e=[],r.interpolators=[];for(var o=Math.min(e.length,i.length),n=0;n<o;n+=1)r.interpolators.push(Ln.interpolate(e[n],i[n]));return r}return u(e,t),e.prototype.map=function(t){for(var e=this.interpolators.length,i=new Array(e),r=0;r<this.interpolators.length;r+=1)i[r]=this.interpolators[r].map(t);return i},e.prototype.unmap=function(t){return 0},e.prototype.range=function(t,i){return void 0===t?[this.map(0),this.map(1)]:void 0===i?new e((t=t)[0],t[1]):new e(t,i)},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){var i=this.interpolators.length;if(i===t.interpolators.length){for(var r=0;r<i;r+=1)if(!this.interpolators[r].equals(t.interpolators[r]))return!1;return!0}}return!1},e}(Ln),es=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new Error;return i?e||(e=i):i=e,r.i0=e,r.i1=i,r.i00=r.i1.range(r.i0.map(0),r.i1.map(0)),r.i11=r.i1.range(r.i0.map(1),r.i1.map(1)),r}return u(e,t),e.prototype.map=function(t){return 0===t?this.i0:1===t?this.i1:this.i1.range(this.i00.map(t),this.i11.map(t))},e.prototype.unmap=function(t){return 0},e.prototype.range=function(t,i){return void 0===t?[this.i0,this.i1]:void 0===i?new e((t=t)[0],t[1]):new e(t,i)},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.i0.equals(t.i0)&&this.i1.equals(t.i1))},e}(Ln),is=function(t){function e(e,i){var r=t.call(this)||this;return r.form=e,r.unit=i,r}return u(e,t),e.prototype.mold=function(t){if(void 0!==t){t=Ln.fromAny(t);var e=this.form.mold(t.map(0)),i=this.form.mold(t.map(1));if(e.isDefined()&&i.isDefined())return L.of(R.of("interpolate",L.of(e,i)))}return b.Absent},e.prototype.cast=function(t){var e=t.header("interpolate");if(e.length>=2){var i=this.form.cast(e.getItem(0).toValue()),r=this.form.cast(e.getItem(1).toValue());if(void 0!==i&&void 0!==r)return Ln.interpolate(i,r)}},e}(ye),rs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.map=function(t){return w.Absent},e.prototype.unmap=function(t){return 0},e.prototype.range=function(t,e){return void 0===t?[this.map(0),this.map(1)]:void 0===e?(t=t,Ln.recon(t[0],t[1])):Ln.recon(t,e)},e.prototype.equals=function(t){return this===t},e}(Ln),os=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new TypeError;if(i?e||(e=i):i=e,!(e.key instanceof I))throw new TypeError(""+e.key);if(!(i.key instanceof I))throw new TypeError(""+i.key);return e.commit(),i.commit(),r.keyInterpolator=Ln.recon(e.key,i.key),r.valueInterpolator=Ln.recon(e.value,i.value),r}return u(e,t),e.prototype.map=function(t){var e=this.keyInterpolator.map(t),i=this.valueInterpolator.map(t);return R.of(e,i)},e.prototype.unmap=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.keyInterpolator.equals(t.keyInterpolator)&&this.valueInterpolator.equals(t.valueInterpolator))},e}(rs),ns=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new TypeError;return i?e||(e=i):i=e,e.commit(),i.commit(),r.keyInterpolator=Ln.recon(e.key,i.key),r.valueInterpolator=Ln.recon(e.value,i.value),r}return u(e,t),e.prototype.map=function(t){var e=this.keyInterpolator.map(t),i=this.valueInterpolator.map(t);return T.of(e,i)},e.prototype.unmap=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.keyInterpolator.equals(t.keyInterpolator)&&this.valueInterpolator.equals(t.valueInterpolator))},e}(rs),ss=function(t){function e(e,i){var r=t.call(this)||this;return void 0!==e&&(e=b.fromAny(e)),void 0!==i&&(i=b.fromAny(i)),e||i?i?e||(e=i):i=e:i=e=b.Absent,r.v0=e.commit(),r.v1=i.commit(),r}return u(e,t),e.prototype.map=function(t){return t<1?this.v0:this.v1},e.prototype.unmap=function(t){return t.equals(this.v1)?1:0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.v0.equals(t.v0)&&this.v1.equals(t.v1))},e}(rs),as=function(t){function e(e,i){var r=t.call(this)||this;void 0!==e&&(e=L.fromAny(e)),void 0!==i&&(i=L.fromAny(i)),e||i?i?e||(e=i):i=e:i=e=L.Empty,e.commit(),i.commit(),r.interpolators=[];for(var o=Math.min(e.length,i.length),n=0;n<o;n+=1)r.interpolators.push(Ln.recon(e.getItem(n),i.getItem(n)));return r}return u(e,t),e.prototype.map=function(t){for(var e=this.interpolators.length,i=L.empty(e),r=0;r<e;r+=1)i.push(this.interpolators[r].map(t));return i},e.prototype.unmap=function(t){return 0},e.prototype.equals=function(t){if(this===t)return!0;if(t instanceof e){var i=this.interpolators.length;if(i===t.interpolators.length){for(var r=0;r<i;r+=1)if(!this.interpolators[r].equals(t.interpolators[r]))return!1;return!0}}return!1},e}(rs),us=function(t){function e(e,i){var r=t.call(this)||this;return void 0===e&&void 0===i?i=e=0:void 0===i?i=e:void 0===e&&(e=i),r.y0=+e,r.dy=+i-r.y0,r}return u(e,t),e.prototype.map=function(t){return U.valueOf(this.y0+this.dy*t)},e.prototype.unmap=function(t){return this.dy?(t.value-this.y0)/this.dy:this.dy},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.y0===t.y0&&this.dy===t.dy)},e}(rs),hs=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new TypeError;if(i?e||(e=i):i=e,r.operator=e.operator,r.operator!==i.operator)throw new Error(i.operator);return e.commit(),i.commit(),r.lhsInterpolator=Ln.recon(e.lhs,i.lhs),r.rhsInterpolator=Ln.recon(e.rhs,i.rhs),r}return u(e,t),e.prototype.map=function(t){var e=this.lhsInterpolator.map(t),i=this.rhsInterpolator.map(t);switch(this.operator){case"||":return e.or(i);case"&&":return e.and(i);case"<":return e.lt(i);case"<=":return e.le(i);case"==":return e.eq(i);case"!=":return e.ne(i);case">=":return e.ge(i);case">":return e.gt(i);case"+":return e.plus(i);case"-":return e.minus(i);case"*":return e.times(i);case"/":return e.divide(i);case"%":return e.modulo(i);default:throw new Error(this.operator)}},e.prototype.unmap=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.lhsInterpolator.equals(t.lhsInterpolator)&&this.rhsInterpolator.equals(t.rhsInterpolator))},e}(rs),ls=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new TypeError;if(i?e||(e=i):i=e,r.operator=e.operator,r.operator!==i.operator)throw new Error(i.operator);return e.commit(),i.commit(),r.rhsInterpolator=Ln.recon(e.rhs,i.rhs),r}return u(e,t),e.prototype.map=function(t){var e=this.rhsInterpolator.map(t);switch(this.operator){case"!":return e.not();case"-":return e.opposite();default:throw new Error(this.operator)}},e.prototype.unmap=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&this.rhsInterpolator.equals(t.rhsInterpolator)},e}(rs),ps=function(t){function e(e,i){var r=t.call(this)||this;if(!e&&!i)throw new TypeError;return i?e||(e=i):i=e,e.commit(),i.commit(),r.funcInterpolator=Ln.recon(e.func,i.func),r.argsInterpolator=Ln.recon(e.args,i.args),r}return u(e,t),e.prototype.map=function(t){var e=this.funcInterpolator.map(t),i=this.argsInterpolator.map(t);return B.literal(e).invoke(i)},e.prototype.unmap=function(t){return 0},e.prototype.equals=function(t){return this===t||t instanceof e&&(this.funcInterpolator.equals(t.funcInterpolator)&&this.argsInterpolator.equals(t.argsInterpolator))},e}(rs);Ln.recon=function(t,e){if(void 0===t&&void 0===e)return new rs;if(void 0!==t&&(t=w.fromAny(t)),void 0!==e&&(e=w.fromAny(e)),t||e?e?t||(t=e):e=t:e=t=w.Absent,t instanceof M&&e instanceof M)return t instanceof R&&e instanceof R||t instanceof R&&e.key instanceof I||e instanceof R&&t.key instanceof I?new os(t,e):new ns(t,e);var i=t.toValue(),r=e.toValue();return i instanceof L&&r instanceof L?new as(i,r):i instanceof U&&r instanceof U?new us(i,r):i instanceof yt&&r instanceof yt?new hs(i,r):i instanceof mt&&r instanceof mt?new ls(i,r):i instanceof Pt&&r instanceof Pt?new ps(i,r):new ss(i,r)};var cs,ds,fs=function(){function t(t,e,i,r,o,n){this.dt=t,this.ft=e?pn.fromAny(e):void 0,this.f=i?Ln.fromAny(i):void 0,this.f0=r,this.f1=o,this.fi=n}return t.prototype.duration=function(e){return arguments.length?new t(e,this.ft,this.f,this.f0,this.f1,this.fi):this.dt},t.prototype.ease=function(e){return arguments.length?new t(this.dt,e,this.f,this.f0,this.f1,this.fi):this.ft},t.prototype.interpolate=function(e){return arguments.length?new t(this.dt,this.ft,e,this.f0,this.f1,this.fi):this.f},t.prototype.range=function(e,i){if(void 0===e)return this.f&&this.f.range();var r=void 0;return r=this.f?this.f.range(e,i):Ln.interpolate(e,i),new t(this.dt,this.ft,r,this.f0,this.f1,this.fi)},t.prototype.onStart=function(e){return arguments.length?new t(this.dt,this.ft,this.f,e,this.f1,this.fi):this.f0},t.prototype.onEnd=function(e){return arguments.length?new t(this.dt,this.ft,this.f,this.f0,e,this.fi):this.f1},t.prototype.onInterrupt=function(e){return arguments.length?new t(this.dt,this.ft,this.f,this.f0,this.f1,e):this.fi},t.prototype.equals=function(e){return this===e||e instanceof t&&(this.dt===e.dt&&this.ft===e.ft&&(void 0===this.f?void 0===e.f:this.f.equals(e.f)))},t.form=function(t,e){return new ys(t,e)},t.duration=function(e,i,r){return new t(e,i,r)},t.ease=function(e,i){return new t(void 0,e,i)},t.interpolate=function(e){return new t(void 0,void 0,e)},t.range=function(e,i){var r;return void 0===i?(e=e,r=Ln.interpolate(e[0],e[1])):r=Ln.interpolate(e,i),new t(void 0,void 0,r)},t.fromAny=function(e,i,r,o){return e instanceof t?e:"object"==typeof e?new t(e.duration,e.ease,e.interpolate,e.onStart,e.onEnd,e.onInterrupt):!0===e?new t(r,o,Ln.interpolate(i)):void 0},t.isInit=function(t){if(t&&"object"==typeof t){var e=t;return void 0!==e.duration||void 0!==e.ease||void 0!==e.interpolate}return!1},t.Form=void 0,t}(),ys=function(t){function e(e,i){var r=t.call(this)||this;return r.interpolatorForm=e,r.unit=i,r}return u(e,t),e.prototype.mold=function(t){if(void 0!==t){t=fs.fromAny(t);var e=L.empty();void 0!==t.dt&&e.slot("dt",t.dt),void 0!==t.ft&&e.slot("ease",pn.Form.mold(t.ft));var i=L.of(R.of("transition",e)),r=this.interpolatorForm.mold(t.f);return r.isDefined()&&(i=i.concat(r)),i}return b.Absent},e.prototype.cast=function(t){var e=t.header("transition");if(e.length>=2){var i,r;e.forEach(function(t,e){var o=t.key.stringValue();void 0!==o?"dt"===o?i=t.toValue().numberValue(i):"ease"===o&&(r=t.toValue().cast(pn.Form,r)):t instanceof b&&(0===e?i=t.numberValue(i):1===e&&(r=t.cast(pn.Form,r)))},this);var o=this.interpolatorForm.cast(t.body());return new fs(i,r,o)}},e}(ye);function ms(t){return t&&"object"==typeof t&&"function"==typeof t.toAttributeString?t.toAttributeString():""+t}function vs(t){return t&&"object"==typeof t&&"function"==typeof t.toStyleString?t.toStyleString():""+t}(ds=cs||(cs={}))[ds.Quiesced=0]="Quiesced",ds[ds.Diverged=1]="Diverged",ds[ds.Tracking=2]="Tracking",ds[ds.Converged=3]="Converged",ds[ds.Interrupt=4]="Interrupt";var gs=function(){function t(){}return t.DISABLED=1,t.REQUIRES_RESIZE=16,t}(),ws=function(t){function e(){var e=t.call(this)||this;return e.flags=0,e.animationFrame=0,e.onAnimationFrame=e.onAnimationFrame.bind(e),e}return u(e,t),e.prototype.enabled=function(t){return void 0===t?0==(this.flags&gs.DISABLED):(t&&0!=(this.flags&gs.DISABLED)?(this.flags&=~gs.DISABLED,this.animate()):t||0!=(this.flags&gs.DISABLED)||(this.flags|=gs.DISABLED),this)},e.prototype.animate=function(){this.animationFrame||0!=(this.flags&gs.DISABLED)||(this.animationFrame=requestAnimationFrame(this.onAnimationFrame))},e.prototype.cancel=function(){this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=0)},e.prototype.onAnimationFrame=function(t){this.animationFrame=0,this.onFrame(t)},e}(gs),bs=function(t){function e(e){var i=t.call(this)||this;return i.parent=e,i}return u(e,t),e.prototype.animate=function(){this.parent.animate()},e}(gs),_s=function(t){function e(e,i,r){void 0===r&&(r=0);var o=t.call(this)||this;if(!i.f)throw new Error("no interpolator");return o.dt=void 0!==i.dt?i.dt:0,o.ft=i.ft||pn.linear,o.f=i.f,o.f0=i.f0,o.f1=i.f1,o.fi=i.fi,o.fl=void 0,o.v=e,o.v1=e,o.t0=0,o.flags=r,o.tweenState=0,o}return u(e,t),e.prototype.enabled=function(t){return void 0===t?0==(this.flags&gs.DISABLED):(t&&0!=(this.flags&gs.DISABLED)?(this.flags&=~gs.DISABLED,this.animate()):t||0!=(this.flags&gs.DISABLED)||(this.flags|=gs.DISABLED),this)},e.prototype.transition=function(t){return t?(void 0!==t.dt&&(this.dt=t.dt),t.ft&&(this.ft=t.ft),t.f&&(this.f=t.f),void 0!==t.f0&&(this.f0=t.f0),void 0!==t.f1&&(this.f1=t.f1),void 0!==t.fi&&(this.fi=t.fi),this):new fs(this.dt,this.ft,this.f)},e.prototype.duration=function(t){return void 0===t?this.dt:(this.dt=Math.max(0,t),this)},e.prototype.ease=function(t){return t?(this.ft=pn.fromAny(t),this):this.ft},e.prototype.get=function(){return this.v},e.prototype.set=function(t,e){var i=this.fi;this.fi=void 0,e&&this.transition(e),this.f=this.f.range(this.v,t),this.fl=i,this.v1=t,this.t0=0,2===this.tweenState?this.tweenState=4:this.tweenState=1,e?this.animate():this.onFrame(0)},e.prototype.onFrame=function(t){if(0!==this.tweenState&&0==(this.flags&gs.DISABLED)){if(4===this.tweenState&&(this.onInterrupt(this.v),this.fl&&(this.fl(this.v),this.fl=void 0),this.tweenState=1),1===this.tweenState&&(S(this.v,this.v1)?this.tween(1):(this.t0=t,this.onStart(this.v),this.f0&&(this.f0(this.v),this.f0=void 0),this.tweenState=2)),2===this.tweenState){var e=this.dt?Math.min(Math.max(0,(t-this.t0)/this.dt),1):1;this.tween(e)}3===this.tweenState?(this.onEnd(this.v),this.f1&&(this.f1(this.v),this.f1=void 0),this.fi=void 0,this.t0=0,this.tweenState=0):this.animate()}},e.prototype.map=function(t){return this.f.map(t)},e.prototype.tween=function(t){t=this.ft(t),this.v=this.map(t),this.update(this.v),1===t&&(this.tweenState=3)},e.prototype.updateTarget=function(t){var e=t.view;e&&0!=(this.flags&gs.REQUIRES_RESIZE)&&e.requireResize()},e.prototype.onStart=function(t){},e.prototype.onEnd=function(t){},e.prototype.onInterrupt=function(t){},e}(gs),xs=function(t){function e(e,i,r,o){var n=t.call(this,i,r,o)||this;return n.parent=e,n}return u(e,t),e.prototype.animate=function(){0==(this.flags&gs.DISABLED)&&this.parent.animate()},e}(_s),As=function(t){function e(e,i,r){var o=t.call(this,e,i,r)||this;return o.animationFrame=0,o.onAnimationFrame=o.onAnimationFrame.bind(o),o}return u(e,t),e.prototype.animate=function(){this.animationFrame||0!=(this.flags&gs.DISABLED)||(this.animationFrame=requestAnimationFrame(this.onAnimationFrame))},e.prototype.cancel=function(){this.animationFrame&&(cancelAnimationFrame(this.animationFrame),this.animationFrame=0)},e.prototype.onAnimationFrame=function(t){this.animationFrame=0,this.onFrame(t)},e}(_s),ks=function(t){function e(e,i,r,o,n){var s=t.call(this,r,o,n)||this;return s.target=e,s.name=i,s}return u(e,t),e.prototype.update=function(t){var e=this.target.getAttribute(this.name),i=ms(t);e!==i&&(this.target.setAttribute(this.name,i),this.updateTarget(this.target))},e.prototype.animate=function(){t.prototype.animate.call(this)},e}(As),Es=function(t){function e(e,i,r,o,n,s){var a=t.call(this,r,o,s)||this;return a.target=e,a.name=i,a.priority=n,a}return u(e,t),e.prototype.update=function(t){var e=this.target.style.getPropertyValue(this.name),i=vs(t);e!==i&&(this.target.style.setProperty(this.name,i,this.priority),this.updateTarget(this.target))},e.prototype.animate=function(){t.prototype.animate.call(this)},e}(As),Cs=function(t){function e(e,i,r,o,n){var s=t.call(this,i,r,n)||this;return s.target=e,s.format=o,s}return u(e,t),e.prototype.update=function(t){var e,i=this.format;if("object"==typeof i&&(i=i.format),"function"==typeof i)e=i(t);else if(t instanceof w){var r=void 0;r=this.target.view?this.target.view.stack():D.of(w.GlobalScope),e=t.evaluate(r).stringValue("")}else e=""+t;this.target instanceof Text?this.target.nodeValue=e:this.target instanceof HTMLElement?this.target.innerText=e:this.target.textContent=e},e.prototype.animate=function(){t.prototype.animate.call(this)},e}(As),Ss=Math.cos(Math.PI/4),Vs=Math.sin(Math.PI/4),Ds=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r.points=i.points,r}return u(e,t),e}(lr),Ms=function(){function t(t,e){this.kinematic=t,this.identifier=e,this.path=[],this.t=NaN,this.cx=NaN,this.cy=NaN,this.vx=NaN,this.vy=NaN,this.ax=NaN,this.ay=NaN,this.dx=NaN,this.dy=NaN}return Object.defineProperty(t.prototype,"ghost",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.moveTo=function(t,e,i){for(this.path.push({t:t,cx:e,cy:i});this.path.length>1&&t-this.path[0].t>this.kinematic.h;)this.path.splice(0,1);this.update()},t.prototype.update=function(){var t=this.path[0],e=this.path[this.path.length-1];if(e&&e!==t){var i=e.t-t.t,r=void 0,o=void 0;if(i){var n=(r=(e.cx-t.cx)/i)*r+(o=(e.cy-t.cy)/i)*o,s=this.kinematic.vMax;if(s*s<n){var a=Math.sqrt(n);r=r*s/a,o=o*s/a}}else r=0,o=0;this.t=e.t,this.dx=e.cx-this.cx,this.dy=e.cy-this.cy,this.cx=e.cx,this.cy=e.cy,this.vx=r,this.vy=o}else t&&(this.t=t.t,this.dx=t.cx-this.cx,this.dy=t.cy-this.cy,this.cx=t.cx,this.cy=t.cy,this.vx=0,this.vy=0)},t}(),Rs=function(){function t(t,e,i,r,o,n,s,a,u){this.kinematic=t,this.identifier=e,this.t=i,this.cx=r,this.cy=o,this.vx=n,this.vy=s,this.ax=a,this.ay=u,this.dx=0,this.dy=0}return Object.defineProperty(t.prototype,"ghost",{get:function(){return!0},enumerable:!0,configurable:!0}),t.prototype.translate=function(t,e){this.cx+=t,this.cy+=e},t.prototype.update=function(t){var e=t-this.t;if(e){var i=this.vx+this.ax*e,r=void 0;i<0==this.vx<0?r=this.cx+this.vx*e+this.ax*e*e*.5:(r=this.cx-this.vx*this.vx/(2*this.ax),i=0,this.ax=0);var o=this.vy+this.ay*e,n=void 0;o<0==this.vy<0?n=this.cy+this.vy*e+this.ay*e*e*.5:(n=this.cy-this.vy*this.vy/(2*this.ay),o=0,this.ay=0),this.dx=r-this.cx,this.dy=n-this.cy,this.cx=r,this.cy=n,this.vx=i,this.vy=o,this.t=t}},t}(),Ts=function(){function t(){this.node=null,this.tracks={},this.trackCount=0,this.ghosts={},this.ghostCount=0,this.ghostFrame=0,this.h=67,this.a=.00175,this.vMax=1.75,this.dMin=10,this.onGhostFrame=this.onGhostFrame.bind(this)}return t.prototype.surface=function(t){return void 0===t?this.node:(this.node&&this.detach(this.node),this.node=t,this.node&&this.attach(this.node),this)},t.prototype.hysteresis=function(t){return void 0===t?this.h:(this.h=t,this)},t.prototype.acceleration=function(t){return void 0===t?this.a:(this.a=t,this)},t.prototype.velocityMax=function(t){return void 0===t?this.vMax:(this.vMax=t,this)},t.prototype.distanceMin=function(t){return void 0===t?this.dMin:(this.dMin=t,this)},t.prototype.wheel=function(t){return void 0!==t&&this},t.prototype.points=function(){var t=[];for(var e in this.tracks)t.push(this.tracks[e]);for(var e in this.ghosts)t.push(this.ghosts[e]);return t},t.prototype.interrupt=function(){this.ghostFrame&&(cancelAnimationFrame(this.ghostFrame),this.ghostFrame=0),this.ghostCount&&(this.ghosts={},this.ghostCount=0,this.trackCount?this.kinematicUpdate():this.kinematicEnd())},t.prototype.zoom=function(t,e,i){if(i){var r=Date.now(),o=this.a,n=o*Ss,s=o*Vs,a=this.vMax,u=.5*a*Ss,h=.5*a*Vs,l=4*u*u/n,p=4*h*h/s,c=this.ghosts.zoom0,d=this.ghosts.zoom1;if(c&&d){var f=Math.abs(d.cx-c.cx)/2,y=Math.abs(d.cy-c.cy)/2,m=r-c.t,v=(i=Math.min(Math.max(-a*m,i),a*m))*f*Ss/l,g=i*y*Vs/p;n=n*f/l,s=s*y/p,m>0&&(c.t=r,c.cx+=v,c.cy+=g,c.vx=v/m,c.vy=g/m,c.ax=c.vx<0?n:c.vx>0?-n:0,c.ay=c.vy<0?s:c.vy>0?-s:0,c.dx=v,c.dy=g,d.t=r,d.cx-=v,d.cy-=g,d.vx=-v/m,d.vy=-g/m,d.ax=d.vx<0?n:d.vx>0?-n:0,d.ay=d.vy<0?s:d.vy>0?-s:0,d.dx=-v,d.dy=-g)}else this.interrupt(),this.kinematicStart(),i<0?(c=new Rs(this,"zoom0",r,t-l,e-p,-u,-h,n,s),d=new Rs(this,"zoom1",r,t+l,e+p,u,h,-n,-s)):(c=new Rs(this,"zoom0",r,t-l,e-p,u,h,-n,-s),d=new Rs(this,"zoom1",r,t+l,e+p,-u,-h,n,s)),this.ghosts.zoom0=c,this.ghostCount+=1,this.ghosts.zoom1=d,this.ghostCount+=1;this.kinematicUpdate(),this.ghostFrame&&cancelAnimationFrame(this.ghostFrame),this.ghostFrame=requestAnimationFrame(this.onGhostFrame)}},t.prototype.updateVelocity=function(t,e){var i=e[0],r=e[1],o=0;if(i&&r){o=2;var n=Math.abs(r.cx-i.cx),s=Math.abs(r.cy-i.cy);i instanceof Rs&&i.update(t),r instanceof Rs&&r.update(t);var a=Math.abs(r.cx-i.cx)/n,u=Math.abs(r.cy-i.cy)/s;i.vx*=a,i.vy*=u,i.ax*=a,i.ay*=u,r.vx*=a,r.vy*=u,r.ax*=a,r.ay*=u}for(;o<e.length;){var h=e[o];h instanceof Rs&&h.update(t),o+=1}},t.prototype.spreadVelocity=function(t){for(var e in this.ghosts){var i=this.ghosts[e];t.vx<0==i.vx<0?(t.vx=(t.vx+i.vx)/2,i.vx=(t.vx+i.vx)/2):(t.vx=(t.vx-i.vx)/2,i.vx=(i.vx-t.vx)/2),t.vy<0==i.vy<0?(t.vy=(t.vy+i.vy)/2,i.vy=(t.vy+i.vy)/2):(t.vy=(t.vy-i.vy)/2,i.vy=(i.vy-t.vy)/2)}},t.prototype.coast=function(t){if(t.vx||t.vy){this.spreadVelocity(t);var e=Math.atan2(Math.abs(t.vy),Math.abs(t.vx)),i=this.a,r=(t.vx<0?i:t.vx>0?-i:0)*Math.cos(e),o=(t.vy<0?i:t.vy>0?-i:0)*Math.sin(e);if(r||o){var n=new Rs(this,t.identifier,t.t,t.cx,t.cy,t.vx,t.vy,r,o);this.ghosts[n.identifier]=n,this.ghostCount+=1,this.ghostFrame||(this.ghostFrame=requestAnimationFrame(this.onGhostFrame))}}},t.prototype.translate=function(t,e){for(var i in t=t||0,e=e||0,this.ghosts)this.ghosts[i].translate(t,e)},t.prototype.interpolate=function(t){for(var e in this.tracks)this.tracks[e].update();for(var e in this.updateVelocity(t,this.points()),this.kinematicUpdate(),this.ghosts){var i=this.ghosts[e];i.ax||i.ay||(delete this.ghosts[e],this.ghostCount-=1)}this.trackCount||this.ghostCount?this.ghostCount&&!this.ghostFrame&&(this.ghostFrame=requestAnimationFrame(this.onGhostFrame)):this.kinematicEnd()},t.prototype.onGhostFrame=function(t){this.ghostFrame=0,this.interpolate(Date.now())},t.prototype.kinematicStart=function(){var t=new Ds("kinematicstart",{bubbles:!0,cancelable:!0,composed:!0,points:this.points()});this.node.dispatchEvent(t)},t.prototype.kinematicUpdate=function(){var t=new Ds("kinematicupdate",{bubbles:!0,cancelable:!0,composed:!0,points:this.points()});this.node.dispatchEvent(t)},t.prototype.kinematicEnd=function(){var t=new Ds("kinematicend",{bubbles:!0,cancelable:!0,composed:!0,points:this.points()});this.node.dispatchEvent(t)},t.prototype.trackStart=function(t,e,i,r){this.interrupt();var o=new Ms(this,t);this.tracks[t]=o,o.moveTo(Date.now(),e,i),this.trackCount+=1,1===this.trackCount&&this.startTracking(this.node),this.trackDidStart(o,this.node,r)},t.prototype.trackMove=function(t,e,i,r){var o=this.tracks[t];o&&(o.moveTo(Date.now(),e,i),this.trackDidMove(o,this.node,r))},t.prototype.trackCancel=function(t,e,i,r){var o=this.tracks[t];o&&(delete this.tracks[t],this.trackCount-=1,o.update(),this.trackDidCancel(o,this.node,r),0===this.trackCount&&this.endTracking(this.node))},t.prototype.trackEnd=function(t,e,i,r){var o=this.tracks[t];o&&(delete this.tracks[t],this.trackCount-=1,o.update(),this.trackDidEnd(o,this.node,r),0===this.trackCount&&this.endTracking(this.node))},t.prototype.trackDidStart=function(t,e,i){1===this.trackCount&&this.kinematicStart()},t.prototype.trackDidMove=function(t,e,i){this.translate(t.dx,t.dy),this.interpolate(Date.now())},t.prototype.trackDidCancel=function(t,e,i){this.trackCount||this.ghostCount||this.kinematicEnd()},t.prototype.trackDidEnd=function(t,e,i){this.coast(t),this.trackCount||this.ghostCount||this.kinematicEnd()},t.create=function(){return"undefined"!=typeof PointerEvent?new Ps:"undefined"!=typeof TouchEvent?new Ls:new Fs},t}(),Ps=function(t){function e(){var e=t.call(this)||this;return e._wheel=!0,e.onPointerDown=e.onPointerDown.bind(e),e.onPointerMove=e.onPointerMove.bind(e),e.onPointerUp=e.onPointerUp.bind(e),e.onWheel=e.onWheel.bind(e),e}return u(e,t),e.prototype.wheel=function(t){return void 0===t?this._wheel:(this._wheel!==t&&(this._wheel=t,this.node&&(t?this.node.addEventListener("wheel",this.onWheel):this.node.removeEventListener("wheel",this.onWheel))),this)},e.prototype.attach=function(t){t.addEventListener("pointerdown",this.onPointerDown),this._wheel&&t.addEventListener("wheel",this.onWheel)},e.prototype.detach=function(t){t.removeEventListener("pointerdown",this.onPointerDown),t.removeEventListener("wheel",this.onWheel)},e.prototype.startTracking=function(t){t.addEventListener("pointermove",this.onPointerMove),t.addEventListener("pointerup",this.onPointerUp)},e.prototype.endTracking=function(t){t.removeEventListener("pointermove",this.onPointerMove),t.removeEventListener("pointerup",this.onPointerUp)},e.prototype.trackDidStart=function(e,i,r){t.prototype.trackDidStart.call(this,e,i,r),i.setPointerCapture&&i.setPointerCapture(+e.identifier)},e.prototype.trackDidEnd=function(e,i,r){t.prototype.trackDidEnd.call(this,e,i,r),i.releasePointerCapture&&i.releasePointerCapture(+e.identifier)},e.prototype.onPointerDown=function(t){this.trackStart(""+t.pointerId,t.clientX,t.clientY,t)},e.prototype.onPointerMove=function(t){this.trackMove(""+t.pointerId,t.clientX,t.clientY,t)},e.prototype.onPointerUp=function(t){this.trackEnd(""+t.pointerId,t.clientX,t.clientY,t)},e.prototype.onWheel=function(t){t.preventDefault(),this.zoom(t.clientX,t.clientY,t.wheelDeltaY||t.deltaY)},e}(Ts),Ls=function(t){function e(){var e=t.call(this)||this;return e.onTouchStart=e.onTouchStart.bind(e),e.onTouchMove=e.onTouchMove.bind(e),e.onTouchCancel=e.onTouchCancel.bind(e),e.onTouchEnd=e.onTouchEnd.bind(e),e}return u(e,t),e.prototype.attach=function(t){t.addEventListener("touchstart",this.onTouchStart)},e.prototype.detach=function(t){t.removeEventListener("touchstart",this.onTouchStart)},e.prototype.startTracking=function(t){t.addEventListener("touchmove",this.onTouchMove),t.addEventListener("touchcancel",this.onTouchCancel),t.addEventListener("touchend",this.onTouchEnd)},e.prototype.endTracking=function(t){t.removeEventListener("touchmove",this.onTouchMove),t.removeEventListener("touchcancel",this.onTouchCancel),t.removeEventListener("touchend",this.onTouchEnd)},e.prototype.onTouchStart=function(t){for(var e=0;e<t.changedTouches.length;e+=1){var i=t.changedTouches[e];this.trackStart(""+i.identifier,i.clientX,i.clientY,t)}(t.changedTouches.length>1||this.trackCount>1)&&t.preventDefault()},e.prototype.onTouchMove=function(t){for(var e=0;e<t.changedTouches.length;e+=1){var i=t.changedTouches[e];this.trackMove(""+i.identifier,i.clientX,i.clientY,t)}},e.prototype.onTouchCancel=function(t){for(var e=0;e<t.changedTouches.length;e+=1){var i=t.changedTouches[e];this.trackCancel(""+i.identifier,i.clientX,i.clientY,t)}},e.prototype.onTouchEnd=function(t){for(var e=0;e<t.changedTouches.length;e+=1){var i=t.changedTouches[e];this.trackEnd(""+i.identifier,i.clientX,i.clientY,t)}},e}(Ts),Fs=function(t){function e(){var e=t.call(this)||this;return e._wheel=!0,e.onMouseDown=e.onMouseDown.bind(e),e.onMouseMove=e.onMouseMove.bind(e),e.onMouseUp=e.onMouseUp.bind(e),e.onWheel=e.onWheel.bind(e),e}return u(e,t),e.prototype.wheel=function(t){return void 0===t?this._wheel:(this._wheel!==t&&(this._wheel=t,this.node&&(t?this.node.addEventListener("wheel",this.onWheel):this.node.removeEventListener("wheel",this.onWheel))),this)},e.prototype.attach=function(t){t.addEventListener("mousedown",this.onMouseDown),this._wheel&&t.addEventListener("wheel",this.onWheel)},e.prototype.detach=function(t){t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("wheel",this.onWheel)},e.prototype.startTracking=function(t){document.body.addEventListener("mousemove",this.onMouseMove),document.body.addEventListener("mouseup",this.onMouseUp)},e.prototype.endTracking=function(t){document.body.removeEventListener("mousemove",this.onMouseMove),document.body.removeEventListener("mouseup",this.onMouseUp)},e.prototype.onMouseDown=function(t){this.trackStart("mouse",t.clientX,t.clientY,t)},e.prototype.onMouseMove=function(t){this.trackMove("mouse",t.clientX,t.clientY,t)},e.prototype.onMouseUp=function(t){this.trackEnd("mouse",t.clientX,t.clientY,t)},e.prototype.onWheel=function(t){t.preventDefault(),this.zoom(t.clientX,t.clientY,t.wheelDeltaY||t.deltaY)},e}(Ts),zs=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r.kinematicScale=i.kinematicScale,r.kinematic=i.kinematic,r.ruler=i.ruler,r.scale=i.scale,r}return u(e,t),e}(lr),Is=function(){function t(){this._kinematic=null,this._ruler=null,this._scale=null,this._xMin=null,this._xMax=null,this._zMin=null,this._zMax=null,this._points=[],this.onKinematicStart=this.onKinematicStart.bind(this),this.onKinematicUpdate=this.onKinematicUpdate.bind(this),this.onKinematicEnd=this.onKinematicEnd.bind(this)}return t.prototype.kinematic=function(t){return void 0===t?this._kinematic:(this._kinematic&&this.detach(this._kinematic),this._kinematic=t,this._kinematic&&this.attach(this._kinematic),this)},t.prototype.hysteresis=function(t){return void 0===t?this._kinematic.hysteresis():(this._kinematic.hysteresis(t),this)},t.prototype.acceleration=function(t){return void 0===t?this._kinematic.acceleration():(this._kinematic.acceleration(t),this)},t.prototype.velocityMax=function(t){return void 0===t?this._kinematic.velocityMax():(this._kinematic.velocityMax(t),this)},t.prototype.distanceMin=function(t){return void 0===t?this._kinematic.distanceMin():(this._kinematic.distanceMin(t),this)},t.prototype.wheel=function(t){return void 0===t?this._kinematic.wheel():(this._kinematic.wheel(t),this)},t.prototype.ruler=function(t){return void 0===t?this._ruler:(this._ruler=t,this)},t.prototype.scale=function(t){if(void 0===t)return this._scale;var e=this._scale;return this._scale=t,null===e&&this.zoomBounds(!0),this},t.prototype.domainMin=function(t){return void 0===t?this._xMin:(this._xMin=t,this)},t.prototype.domainMax=function(t){return void 0===t?this._xMax:(this._xMax=t,this)},t.prototype.domainBounds=function(t,e){return void 0===t?[this._xMin,this._xMax]:void 0===e?(t=t,this._xMin=t[0],this._xMax=t[1],this):(this._xMin=t,this._xMax=e,this)},t.prototype.zoomMin=function(t){return void 0===t?this._zMin:(this._zMin=t,this)},t.prototype.zoomMax=function(t){return void 0===t?this._zMax:(this._zMax=t,this)},t.prototype.zoomBounds=function(t,e){return void 0===t?[this._zMin,this._zMax]:void 0===e?("boolean"==typeof t?this._scale instanceof Rn?(this._zMin=1e6,this._zMax=.001):this._scale instanceof Tn&&(this._zMin=864e5,this._zMax=1):(t=t,this._zMin=t[0],this._zMax=t[1]),this):(this._zMin=t,this._zMax=e,this)},t.prototype.attach=function(t){var e=this._kinematic&&this._kinematic.surface();e&&(e.addEventListener("kinematicstart",this.onKinematicStart),e.addEventListener("kinematicupdate",this.onKinematicUpdate),e.addEventListener("kinematicend",this.onKinematicEnd))},t.prototype.detach=function(t){var e=this._kinematic&&this._kinematic.surface();e&&(e.removeEventListener("kinematicstart",this.onKinematicStart),e.removeEventListener("kinematicupdate",this.onKinematicUpdate),e.removeEventListener("kinematicend",this.onKinematicEnd))},t.prototype.createPoint=function(t){var e=this.coords(t.cx,t.cy);return{identifier:t.identifier,domainCoord:e.domainCoord,rangeCoord:e.rangeCoord}},t.prototype.updatePoint=function(t,e){e.rangeCoord=this.rangeCoord(t.cx,t.cy)},t.prototype.updatePoints=function(t){var e=this._points;t:for(var i=0;i<t.length;i+=1){for(var r=t[i],o=0;o<e.length;o+=1){var n=e[o];if(r.identifier==n.identifier){this.updatePoint(r,n);continue t}}var s=this.createPoint(r);e.push(s)}var a=0;t:for(;a<e.length;){for(s=e[a],i=0;i<t.length;i+=1){r=t[i];if(s.identifier==r.identifier){a+=1;continue t}}e.splice(a,1)}},t.prototype.clampScale=function(){var t=null!==this._xMin?this._xMin:void 0,e=null!==this._xMax?this._xMax:void 0,i=null!==this._zMin?this._zMin:void 0,r=null!==this._zMax?this._zMax:void 0,o=this._scale;if(this._scale=o.clampDomain(t,e,i,r),this._scale!==o)for(var n=0;n<this._points.length;n+=1){var s=this._points[n];s.domainCoord=this._scale.unscale(s.rangeCoord)}},t.prototype.rescale=function(){var t=this._points[0],e=this._points[1];if(t&&e){var i=t.domainCoord,r=t.rangeCoord,o=e.domainCoord,n=e.rangeCoord;this._scale=this._scale.solveDomain(i,r,o,n),this.clampScale()}else if(t){i=t.domainCoord,r=t.rangeCoord;this._scale=this._scale.solveDomain(i,r),this.clampScale()}},t.prototype.onKinematicStart=function(t){this.scaleStart()},t.prototype.onKinematicUpdate=function(t){this.updatePoints(t.points),this.rescale(),this.scaleUpdate()},t.prototype.onKinematicEnd=function(t){this.scaleEnd()},t.prototype.scaleStart=function(){var t=new zs("kinematicscalestart",{bubbles:!0,cancelable:!0,composed:!0,kinematicScale:this,kinematic:this._kinematic,ruler:this._ruler,scale:this._scale});this._ruler.dispatchEvent(t)},t.prototype.scaleUpdate=function(){var t=new zs("kinematicscaleupdate",{bubbles:!0,cancelable:!0,composed:!0,kinematicScale:this,kinematic:this._kinematic,ruler:this._ruler,scale:this._scale});this._ruler.dispatchEvent(t)},t.prototype.scaleEnd=function(){var t=new zs("kinematicscaleend",{bubbles:!0,cancelable:!0,composed:!0,kinematicScale:this,kinematic:this._kinematic,ruler:this._ruler,scale:this._scale});this._ruler.dispatchEvent(t),this._points.length=0},t.horizontal=function(){return new Us},t.vertical=function(){return new Ws},t}(),Us=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.coords=function(t,e){var i=this._ruler.getBoundingClientRect();return{domainCoord:this._scale.unscale(t-i.left),rangeCoord:t-i.left}},e.prototype.rangeCoord=function(t,e){return t-this._ruler.getBoundingClientRect().left},e.prototype.isParallel=function(t,e,i,r){return Math.abs(i-t)>=Math.abs(r-e)},e}(Is),Ws=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.coords=function(t,e){var i=this._ruler.getBoundingClientRect();return{domainCoord:this._scale.unscale(e-i.top),rangeCoord:e-i.top}},e.prototype.rangeCoord=function(t,e){return e-this._ruler.getBoundingClientRect().top},e.prototype.isParallel=function(t,e,i,r){return Math.abs(r-e)>=Math.abs(i-t)},e}(Is),Os=Math.PI,Bs=2*Os,qs=1e-6,Gs=function(){function t(){this.x0=null,this.y0=null,this.x1=null,this.y1=null,this.d=""}return t.prototype.moveTo=function(t,e){this.d+="M"+(this.x0=this.x1=t)+","+(this.y0=this.y1=e)},t.prototype.closePath=function(){void 0!==this.x1&&(this.x1=this.x0,this.y1=this.y0,this.d+="Z")},t.prototype.lineTo=function(t,e){this.d+="L"+(this.x1=t)+","+(this.y1=e)},t.prototype.quadraticCurveTo=function(t,e,i,r){this.d+="Q"+t+","+e+","+(this.x1=i)+","+(this.y1=r)},t.prototype.bezierCurveTo=function(t,e,i,r,o,n){this.d+="C"+t+","+e+","+i+","+r+","+(this.x1=o)+","+(this.y1=n)},t.prototype.arcTo=function(t,e,i,r,o){var n=+this.x1,s=+this.y1,a=i-t,u=r-e,h=n-t,l=s-e,p=h*h+l*l;if(o<0)throw new Error("negative radius: "+o);if(null===this.x1)this.d+="M"+(this.x1=t)+","+(this.y1=e);else if(p>qs)if(Math.abs(l*a-u*h)>qs&&o){var c=i-n,d=r-s,f=a*a+u*u,y=c*c+d*d,m=Math.sqrt(f),v=Math.sqrt(p),g=o*Math.tan((Os-Math.acos((f+p-y)/(2*m*v)))/2),w=g/v,b=g/m;Math.abs(w-1)>qs&&(this.d+="L"+(t+w*h)+","+(e+w*l)),this.d+="A"+o+","+o+",0,0,"+ +(l*c>h*d)+","+(this.x1=t+b*a)+","+(this.y1=e+b*u)}else this.d+="L"+(this.x1=t)+","+(this.y1=e);else;},t.prototype.arc=function(t,e,i,r,o,n){void 0===n&&(n=!1);var s=i*Math.cos(r),a=i*Math.sin(r),u=t+s,h=e+a,l=1^+n,p=n?r-o:o-r;if(i<0)throw new Error("negative radius: "+i);null===this.x1?this.d+="M"+u+","+h:(Math.abs(+this.x1-u)>qs||Math.abs(+this.y1-h)>qs)&&(this.d+="L"+u+","+h),i&&(p<0&&(p=p%Bs+Bs),p>Bs-qs?this.d+="A"+i+","+i+",0,1,"+l+","+(t-s)+","+(e-a)+"A"+i+","+i+",0,1,"+l+","+(this.x1=u)+","+(this.y1=h):p>qs&&(this.d+="A"+i+","+i+",0,"+ +(p>=Os)+","+l+","+(this.x1=t+i*Math.cos(o))+","+(this.y1=e+i*Math.sin(o))))},t.prototype.rect=function(t,e,i,r){this.d+="M"+(this.x0=this.x1=t)+","+(this.y0=this.y1=e)+"h"+i+"v"+r+"h"+-i+"Z"},t.prototype.toString=function(){return this.d},t}(),Hs=Math.PI,Ns=Hs/2,js=2*Hs,Ys=1e-12,Xs=function(){function t(t,e,i,r,o,n,s){void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=To.zero()),void 0===r&&(r=To.zero()),void 0===o&&(o=To.zero()),void 0===n&&(n=null),void 0===s&&(s=0),this._innerRadius=t,this._outerRadius=e,this._startAngle=To.fromAny(i),this._deltaAngle=To.fromAny(r),this._padAngle=To.fromAny(o),this._padRadius=n,this._cornerRadius=s,this.dirty=!0}return t.prototype.innerRadius=function(t){return void 0===t?this._innerRadius:(this._innerRadius!==t&&(this._innerRadius=t,this.dirty=!0),this)},t.prototype.outerRadius=function(t){return void 0===t?this._outerRadius:(this._outerRadius!==t&&(this._outerRadius=t,this.dirty=!0),this)},t.prototype.startAngle=function(t){return void 0===t?this._startAngle:(t=To.fromAny(t),this._startAngle.equals(t)||(this._startAngle=t,this.dirty=!0),this)},t.prototype.deltaAngle=function(t){return void 0===t?this._deltaAngle:(t=To.fromAny(t),this._deltaAngle.equals(t)||(this._deltaAngle=t,this.dirty=!0),this)},t.prototype.padAngle=function(t){return void 0===t?this._padAngle:(t=To.fromAny(t),this._padAngle.equals(t)||(this._padAngle=t,this.dirty=!0),this)},t.prototype.padRadius=function(t){return void 0===t?this._padRadius:(this._padRadius!==t&&(this._padRadius=t,this.dirty=!0),this)},t.prototype.cornerRadius=function(t){return void 0===t?this._cornerRadius:(this._cornerRadius!==t&&(this._cornerRadius=t,this.dirty=!0),this)},t.prototype.draw=function(t){this.dirty=!1,t=t||new Gs;var e,i,r,o,n,s,a,u,h,l=this._innerRadius,p=this._outerRadius,c=this._startAngle.radValue()-Ns,d=this._deltaAngle.radValue(),f=c+d,y=d>=0;if(p<l){var m=p;p=l,l=m}if(p>Ys)if(d>js-Ys)t.moveTo(p*Math.cos(c),p*Math.sin(c)),t.arc(0,0,p,c,f,!y),l>Ys&&(t.moveTo(l*Math.cos(f),l*Math.sin(f)),t.arc(0,0,l,f,c,y));else{var v=c,g=f,w=c,b=f,_=d,x=d,A=this._padAngle.radValue()/2,k=+(A>Ys)&&(null!==this._padRadius?this._padRadius:Math.sqrt(l*l+p*p)),E=Math.min(Math.abs(p-l)/2,this._cornerRadius),C=E,S=E;if(k>Ys){var V=Math.asin(k/l*Math.sin(A)),D=Math.asin(k/p*Math.sin(A));(_-=2*V)>Ys?(w+=V*=y?1:-1,b-=V):(_=0,w=b=(c+f)/2),(x-=2*D)>Ys?(v+=D*=y?1:-1,g-=D):(x=0,v=g=(c+f)/2)}var M=void 0,R=void 0,T=p*Math.cos(v),P=p*Math.sin(v),L=l*Math.cos(b),F=l*Math.sin(b),z=void 0,I=void 0;if(E>Ys&&(z=p*Math.cos(g),I=p*Math.sin(g),M=l*Math.cos(w),R=l*Math.sin(w),d<Hs)){var U=_>Ys?[(e=T)+(h=((a=L-(r=z))*((i=P)-(o=I))-(u=F-o)*(e-r))/(u*(n=M-e)-a*(s=R-i)))*n,i+h*s]:[L,F],W=T-U[0],O=P-U[1],B=z-U[0],q=I-U[1],G=1/Math.sin(.5*Math.acos((W*B+O*q)/(Math.sqrt(W*W+O*O)*Math.sqrt(B*B+q*q)))),H=Math.sqrt(U[0]*U[0]+U[1]*U[1]);C=Math.min(E,(l-H)/(G-1)),S=Math.min(E,(p-H)/(G+1))}if(x>Ys)if(S>Ys){var N=Ks(M,R,T,P,p,S,y),j=Ks(z,I,L,F,p,S,y);t.moveTo(N.cx+N.x01,N.cy+N.y01),S<E?t.arc(N.cx,N.cy,S,Math.atan2(N.y01,N.x01),Math.atan2(j.y01,j.x01),!y):(t.arc(N.cx,N.cy,S,Math.atan2(N.y01,N.x01),Math.atan2(N.y11,N.x11),!y),t.arc(0,0,p,Math.atan2(N.cy+N.y11,N.cx+N.x11),Math.atan2(j.cy+j.y11,j.cx+j.x11),!y),t.arc(j.cx,j.cy,S,Math.atan2(j.y11,j.x11),Math.atan2(j.y01,j.x01),!y))}else t.moveTo(T,P),t.arc(0,0,p,v,g,!y);else t.moveTo(T,P);if(l>Ys&&_>Ys)if(C>Ys){N=Ks(L,F,z,I,l,-C,y),j=Ks(T,P,M,R,l,-C,y);t.lineTo(N.cx+N.x01,N.cy+N.y01),C<E?t.arc(N.cx,N.cy,C,Math.atan2(N.y01,N.x01),Math.atan2(j.y01,j.x01),!y):(t.arc(N.cx,N.cy,C,Math.atan2(N.y01,N.x01),Math.atan2(N.y11,N.x11),!y),t.arc(0,0,l,Math.atan2(N.cy+N.y11,N.cx+N.x11),Math.atan2(j.cy+j.y11,j.cx+j.x11),y),t.arc(j.cx,j.cy,C,Math.atan2(j.y11,j.x11),Math.atan2(j.y01,j.x01),!y))}else t.arc(0,0,l,b,w,y);else t.lineTo(L,F)}else t.moveTo(0,0);if(t.closePath(),!arguments.length)return t.toString()},t}();function Ks(t,e,i,r,o,n,s){var a=t-i,u=e-r,h=(s?n:-n)/Math.sqrt(a*a+u*u),l=h*u,p=-h*a,c=t+l,d=e+p,f=i+l,y=r+p,m=(c+f)/2,v=(d+y)/2,g=f-c,w=y-d,b=g*g+w*w,_=o-n,x=c*y-f*d,A=(w<0?-1:1)*Math.sqrt(Math.max(0,_*_*b-x*x)),k=(x*w-g*A)/b,E=(-x*g-w*A)/b,C=(x*w+g*A)/b,S=(-x*g+w*A)/b,V=k-m,D=E-v,M=C-m,R=S-v;return V*V+D*D>M*M+R*R&&(k=C,E=S),{cx:k,cy:E,x01:-l,y01:-p,x11:k*(o/_-1),y11:E*(o/_-1)}}var Qs=function(){function t(t){this.node=t,this._backgroundColor=Qo.white(),this._borderRadius=qo.zero(),this._arrowWidth=qo.fromAny(10),this._arrowHeight=qo.fromAny(8),this._placement=[],this._viewportTop=qo.fromAny(-1/0),this._viewportRight=qo.fromAny(-1/0),this._viewportBottom=qo.fromAny(-1/0),this._viewportLeft=qo.fromAny(-1/0),this._sourceLeft=qo.fromAny(NaN),this._sourceTop=qo.fromAny(NaN),this._sourceWidth=qo.zero(),this._sourceHeight=qo.zero(),this.dirty=!0,this.observers=[],this.arrow=document.createElement("div"),this.arrow.setAttribute("class","popover-arrow"),this.arrow.style.setProperty("display","none"),this.arrow.style.setProperty("position","absolute"),this.arrow.style.setProperty("width","0"),this.arrow.style.setProperty("height","0")}return t.prototype.backgroundColor=function(t){return void 0===t?this._backgroundColor:(t=Qo.fromAny(t),this._backgroundColor.equals(t)||(this._backgroundColor=t,this.dirty=!0),this)},t.prototype.borderRadius=function(t){return void 0===t?this._borderRadius:(t=qo.fromAny(t),this._borderRadius.equals(t)||(this._borderRadius=t,this.dirty=!0),this)},t.prototype.arrowWidth=function(t){return void 0===t?this._arrowWidth:(t=qo.fromAny(t),this._arrowWidth.equals(t)||(this._arrowWidth=t,this.dirty=!0),this)},t.prototype.arrowHeight=function(t){return void 0===t?this._arrowHeight:(t=qo.fromAny(t),this._arrowHeight.equals(t)||(this._arrowHeight=t,this.dirty=!0),this)},t.prototype.placement=function(t){return void 0===t?this._placement.slice(0):(this._placement=t.slice(0),this.dirty=!0,this)},t.prototype.viewportLeft=function(t){return void 0===t?this._viewportLeft:(t=qo.fromAny(t),this._viewportLeft.equals(t)||(this._viewportLeft=t,this.dirty=!0),this)},t.prototype.viewportRight=function(t){return void 0===t?this._viewportRight:(t=qo.fromAny(t),this._viewportRight.equals(t)||(this._viewportRight=t,this.dirty=!0),this)},t.prototype.viewportTop=function(t){return void 0===t?this._viewportTop:(t=qo.fromAny(t),this._viewportTop.equals(t)||(this._viewportTop=t,this.dirty=!0),this)},t.prototype.viewportBottom=function(t){return void 0===t?this._viewportBottom:(t=qo.fromAny(t),this._viewportBottom.equals(t)||(this._viewportBottom=t,this.dirty=!0),this)},t.prototype.sourceLeft=function(t){return void 0===t?this._sourceLeft:(t=qo.fromAny(t),this._sourceLeft.equals(t)||(this._sourceLeft=t,this.dirty=!0),this)},t.prototype.sourceTop=function(t){return void 0===t?this._sourceTop:(t=qo.fromAny(t),this._sourceTop.equals(t)||(this._sourceTop=t,this.dirty=!0),this)},t.prototype.sourceWidth=function(t){return void 0===t?this._sourceWidth:(t=qo.fromAny(t),this._sourceWidth.equals(t)||(this._sourceWidth=t,this.dirty=!0),this)},t.prototype.sourceHeight=function(t){return void 0===t?this._sourceHeight:(t=qo.fromAny(t),this._sourceHeight.equals(t)||(this._sourceHeight=t,this.dirty=!0),this)},t.prototype.place=function(){if(this._placement.length){this.node.style.setProperty("position","absolute");for(var t,e=this._sourceWidth.pxValue(),i=this._sourceHeight.pxValue(),r=this._sourceLeft.pxValue(),o=r+e,n=this._sourceTop.pxValue(),s=n+i,a=r+e/2,u=n+i/2,h=this._arrowHeight.pxValue(),l=this.node.offsetWidth,p=this.node.offsetHeight,c=this.node.getBoundingClientRect(),d=Math.max(0,this._viewportLeft.pxValue()),f=document.body.clientWidth-Math.max(0,this._viewportRight.pxValue()),y=Math.max(0,this._viewportTop.pxValue()),m=document.body.clientHeight-Math.max(0,this._viewportBottom.pxValue()),v=d+(this.node.offsetLeft-c.left),g=f+(this.node.offsetLeft-c.left),w=y+(this.node.offsetTop-c.top),b=m+(this.node.offsetTop-c.top),_=d+r,x=document.body.clientWidth-(_+e),A=y+n,k=document.body.clientHeight-(A+i),E=0;E<this._placement.length;E+=1){if("top"===(C=this._placement[E])&&p+h<=A){t="top";break}if("bottom"===C&&p+h<=k){t="bottom";break}if("left"===C&&l+h<=_){t="left";break}if("right"===C&&l+h<=x){t="right";break}}if(!t)for(E=0;E<this._placement.length;E+=1){var C;if("over"===(C=this._placement[E])){t="over";break}if("top"===C&&A>=k){t="top";break}if("bottom"===C&&k>=A){t="bottom";break}if("left"===C&&_>=x){t="left";break}if("right"===C&&x>=_){t="right";break}}var S=qo.fromAny(this.node.style.getPropertyValue("max-width")||0).pxValue(),V=qo.fromAny(this.node.style.getPropertyValue("max-height")||0).pxValue(),D=S,M=V,R=this.node.offsetLeft,T=this.node.offsetTop;if("over"===t?(R=v,T=w,D=Math.max(0,f-d),M=Math.max(0,m-y)):"top"===t?(R=a-l/2<=v?v:a+l/2>=g?g-l:a-l/2,T=Math.max(w,n-(p+h)),D=Math.max(0,f-d),M=Math.max(0,s-w)):"bottom"===t?(R=a-l/2<=v?v:a+l/2>=g?g-l:a-l/2,T=Math.max(w,s+h),D=Math.max(0,f-d),M=Math.max(0,b-n)):"left"===t?(R=Math.max(v,r-(l+h)),T=u-p/2<=w?w:u+p/2>=b?b-p:u-p/2,D=Math.max(0,o-v),M=Math.max(0,m-y)):"right"===t&&(R=Math.max(v,o+h),T=u-p/2<=w?w:u+p/2>=b?b-p:u-p/2,D=Math.max(0,g-r),M=Math.max(0,m-y)),R!==this.node.offsetLeft||T!==this.node.offsetTop||D!==S||M!==V){for(E=0;E<this.observers.length;E+=1){(P=this.observers[E]).popoverWillPlace&&P.popoverWillPlace(t,this)}this.node.style.setProperty("left",R+"px"),this.node.style.setProperty("top",T+"px"),this.node.style.setProperty("max-width",D+"px"),this.node.style.setProperty("max-height",M+"px"),this.dirty=!0;for(E=0;E<this.observers.length;E+=1){var P;(P=this.observers[E]).popoverDidPlace&&P.popoverDidPlace(t,this)}}}},t.prototype.render=function(){this.dirty&&(this.dirty=!1,this.renderPopover())},t.prototype.renderPopover=function(){this.arrow.parentNode||this.node.insertBefore(this.arrow,this.node.firstChild);var t=this._sourceWidth.pxValue(),e=this._sourceHeight.pxValue(),i=this._sourceLeft.pxValue(),r=i+t,o=this._sourceTop.pxValue(),n=o+e,s=i+t/2,a=o+e/2,u=this.node.offsetLeft,h=u+this.node.offsetWidth,l=this.node.offsetTop,p=l+this.node.offsetHeight,c=this._borderRadius.pxValue(),d=this._arrowWidth.pxValue(),f=this._arrowHeight.pxValue(),y=u+c+d/2,m=h-c-d/2,v=l+c+d/2,g=p-c-d/2;this.node.style.setProperty("position","absolute"),this.node.style.setProperty("background-color",this._backgroundColor.toString()),this.node.style.setProperty("border-radius",this._borderRadius.toString()),this.arrow.style.removeProperty("top"),this.arrow.style.removeProperty("right"),this.arrow.style.removeProperty("bottom"),this.arrow.style.removeProperty("left"),this.arrow.style.removeProperty("border-left-width"),this.arrow.style.removeProperty("border-left-style"),this.arrow.style.removeProperty("border-left-color"),this.arrow.style.removeProperty("border-right-width"),this.arrow.style.removeProperty("border-right-style"),this.arrow.style.removeProperty("border-right-color"),this.arrow.style.removeProperty("border-top-width"),this.arrow.style.removeProperty("border-top-style"),this.arrow.style.removeProperty("border-top-color"),this.arrow.style.removeProperty("border-bottom-width"),this.arrow.style.removeProperty("border-bottom-style"),this.arrow.style.removeProperty("border-bottom-color"),l-f>=a&&y<=i&&m>=r?(this.arrow.style.setProperty("display","block"),this.arrow.style.setProperty("top",-f+"px"),this.arrow.style.setProperty("left",s-u-d/2+"px"),this.arrow.style.setProperty("border-left-width",d/2+"px"),this.arrow.style.setProperty("border-left-style","solid"),this.arrow.style.setProperty("border-left-color","transparent"),this.arrow.style.setProperty("border-right-width",d/2+"px"),this.arrow.style.setProperty("border-right-style","solid"),this.arrow.style.setProperty("border-right-color","transparent"),this.arrow.style.setProperty("border-bottom-width",f+"px"),this.arrow.style.setProperty("border-bottom-style","solid"),this.arrow.style.setProperty("border-bottom-color",this._backgroundColor.toString())):p+f<=a&&y<=i&&m>=r?(this.arrow.style.setProperty("display","block"),this.arrow.style.setProperty("bottom",-f+"px"),this.arrow.style.setProperty("left",s-u-d/2+"px"),this.arrow.style.setProperty("border-left-width",d/2+"px"),this.arrow.style.setProperty("border-left-style","solid"),this.arrow.style.setProperty("border-left-color","transparent"),this.arrow.style.setProperty("border-right-width",d/2+"px"),this.arrow.style.setProperty("border-right-style","solid"),this.arrow.style.setProperty("border-right-color","transparent"),this.arrow.style.setProperty("border-top-width",f+"px"),this.arrow.style.setProperty("border-top-style","solid"),this.arrow.style.setProperty("border-top-color",this._backgroundColor.toString())):u-f>=s&&v<=o&&g>=n?(this.arrow.style.setProperty("display","block"),this.arrow.style.setProperty("left",-f+"px"),this.arrow.style.setProperty("top",a-l-d/2+"px"),this.arrow.style.setProperty("border-top-width",d/2+"px"),this.arrow.style.setProperty("border-top-style","solid"),this.arrow.style.setProperty("border-top-color","transparent"),this.arrow.style.setProperty("border-bottom-width",d/2+"px"),this.arrow.style.setProperty("border-bottom-style","solid"),this.arrow.style.setProperty("border-bottom-color","transparent"),this.arrow.style.setProperty("border-right-width",f+"px"),this.arrow.style.setProperty("border-right-style","solid"),this.arrow.style.setProperty("border-right-color",this._backgroundColor.toString())):h+f<=s&&v<=o&&g>=n?(this.arrow.style.setProperty("display","block"),this.arrow.style.setProperty("right",-f+"px"),this.arrow.style.setProperty("top",a-l-d/2+"px"),this.arrow.style.setProperty("border-top-width",d/2+"px"),this.arrow.style.setProperty("border-top-style","solid"),this.arrow.style.setProperty("border-top-color","transparent"),this.arrow.style.setProperty("border-bottom-width",d/2+"px"),this.arrow.style.setProperty("border-bottom-style","solid"),this.arrow.style.setProperty("border-bottom-color","transparent"),this.arrow.style.setProperty("border-left-width",f+"px"),this.arrow.style.setProperty("border-left-style","solid"),this.arrow.style.setProperty("border-left-color",this._backgroundColor.toString())):this.arrow.style.setProperty("display","none")},t.prototype.addObserver=function(t){this.observers.indexOf(t)<0&&this.observers.push(t)},t.prototype.removeObserver=function(t){var e=this.observers.indexOf(t);e>=0&&this.observers.splice(e,1)},t.prototype.willShow=function(){for(var t=0;t<this.observers.length;t+=1){var e=this.observers[t];e.popoverWillShow&&e.popoverWillShow(this)}},t.prototype.didShow=function(){for(var t=0;t<this.observers.length;t+=1){var e=this.observers[t];e.popoverDidShow&&e.popoverDidShow(this)}},t.prototype.willHide=function(){for(var t=0;t<this.observers.length;t+=1){var e=this.observers[t];e.popoverWillHide&&e.popoverWillHide(this)}},t.prototype.didHide=function(){for(var t=0;t<this.observers.length;t+=1){var e=this.observers[t];e.popoverDidHide&&e.popoverDidHide(this)}},t.prototype.sourceWillChange=function(t,e){for(var i=0;i<this.observers.length;i+=1){var r=this.observers[i];r.popoverSourceWillChange&&r.popoverSourceWillChange(t,e,this)}},t.prototype.sourceDidChange=function(t,e){for(var i=0;i<this.observers.length;i+=1){var r=this.observers[i];r.popoverSourceDidChange&&r.popoverSourceDidChange(t,e,this)}},t.create=function(e){return void 0===e&&(e="div"),new t(document.createElement(e))},t}(),Zs={Form:void 0,form:function(t){return void 0!==t?new ta(t):Zs.Form},fromAny:function(t){if(t instanceof oo||t instanceof To||t instanceof qo||t instanceof Qo||t instanceof un||t instanceof dn||t instanceof Ln||t instanceof Dn||t instanceof fs||"number"==typeof t||"boolean"==typeof t)return t;if(t instanceof Date||oo.isInit(t))return oo.fromAny(t);if(Qo.isInit(t))return Qo.fromAny(t);if(un.isInit(t))return un.fromAny(t);if(fs.isInit(t))return fs.fromAny(t);if("string"==typeof t)return Zs.parse(t);throw new TypeError(""+t)},parse:function(t){for("string"==typeof t&&(t=new v(t));!t.isEmpty()&&_.isSpace(t.head());)t.step();var e=$s.parse(t);if(e.isDone()){for(;!t.isEmpty()&&_.isSpace(t.head());)t.step();t.isEmpty()||(e=_.unexpected(t))}return e.bind()}},Js=Er.pattern("%m-%dT%H:%M:%S.%LZ"),$s=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.identParser=e,n.valueParser=i,n.unitsOutput=r,n.step=o,n}return u(e,t),e.prototype.feed=function(t){return e.parse(t,this.identParser,this.valueParser,this.unitsOutput,this.step)},e.parse=function(t,i,r,o,n){void 0===n&&(n=1);var s=0;if(1===n){for(;!t.isEmpty()&&(s=t.head(),_.isSpace(s));)t.step();if(t.isEmpty()){if(t.isDone())return _.unexpected(t)}else{if(35===s)return rn.parse(t);n=Xe.isIdentStartChar(s)?2:3}}if(2===n){for(i||(i=Xe.Factory.parseIdent(t));i.isCont()&&(!t.isEmpty()||t.isDone());)i=i.feed(t);if(i.isDone()){var a=i.bind().stringValue();switch(a){case"rgb":case"rgba":return on.parseRest(t,i);case"hsl":case"hsla":return nn.parseRest(t,i);case"translateX":case"translateY":case"translate":return _n.parseRest(t,i);case"scaleX":case"scaleY":case"scale":return xn.parseRest(t,i);case"rotate":return An.parseRest(t,i);case"skewX":case"skewY":case"skew":return kn.parseRest(t,i);case"matrix":return En.parseRest(t,i);case"true":return _.done(!0);case"false":return _.done(!1);default:return _.error(a)}}else if(i.isError())return i.asError()}if(3===n){for(r||(r=Xe.Factory.parseDecimal(t));r.isCont()&&(!t.isEmpty()||t.isDone());)r=r.feed(t);if(r.isDone())n=4;else if(r.isError())return r.asError()}if(4===n){if(!t.isEmpty()&&45===(s=t.head())){t.step();var u={};return u.year=r.bind().numberValue(),Js.parseDate(t,u)}t.isEmpty()&&!t.isDone()||(n=5)}if(5===n){for(o=o||new g;!t.isEmpty()&&(s=t.head(),_.isAlpha(s)||37===s);)t.step(),o.push(s);if(!t.isEmpty()||t.isDone()){var h=r.bind().numberValue(),l=o.bind();switch(l){case"deg":return _.done(To.deg(h));case"grad":return _.done(To.grad(h));case"rad":return _.done(To.rad(h));case"turn":return _.done(To.turn(h));case"px":return _.done(qo.px(h));case"em":return _.done(qo.em(h));case"rem":return _.done(qo.rem(h));case"%":return _.done(qo.pct(h));case"":return _.done(h);default:return _.error(l)}}}return new e(i,r,o,n)},e}(_),ta=function(t){function e(e){var i=t.call(this)||this;return i.unit=e,i}return u(e,t),e.prototype.mold=function(t){if(void 0!==t){if((t=Zs.fromAny(t))instanceof oo)return oo.Form.mold(t);if(t instanceof To)return To.Form.mold(t);if(t instanceof qo)return qo.Form.mold(t);if(t instanceof Qo)return Qo.Form.mold(t);if(t instanceof un)return un.Form.mold(t);if(t instanceof dn)return dn.Form.mold(t);if(t instanceof Ln)return Ln.Form.mold(t);if(t instanceof Dn)return Dn.Form.mold(t);if(t instanceof fs)return fs.Form.mold(t);if("number"==typeof t)return U.valueOf(t)}return b.Absent},e.prototype.cast=function(t){if(t instanceof U)return t.numberValue();if(t instanceof W)return t.booleanValue();var e=t.stringValue();if(void 0!==e)try{return Zs.parse(e)}catch(t){}if(t instanceof L){var i=oo.fromValue(t);if(i)return i;var r=To.fromValue(t);if(r)return r;var o=qo.fromValue(t);if(o)return o;var n=Qo.fromValue(t);if(n)return n;var s=un.fromValue(t);if(s)return s;var a=dn.fromValue(t);if(a)return a;var u=Ln.Form.cast(t);if(u)return u;var h=Dn.Form.cast(t);if(h)return h;var l=fs.Form.cast(t);if(l)return l}},e}(ye);Zs.Form=new ta,Ln.Form=new is(Zs.Form),Dn.Form=new Pn(Zs.Form,Ln.Form),Mn.Form=Dn.Form,fs.Form=new ys(Ln.Form);var ea=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"date"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){var i;return(i=t instanceof Lt?oo.current():t.evaluate(e).cast(oo.Form))?oo.Form.mold(i):w.Absent},e}(Z),ia=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"now"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t){return U.valueOf(Date.now())},e}(Z),ra=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"brighter"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){var i,r;return t.length>=2?(i=t.getItem(0).evaluate(e).cast(Qo.Form),r=t.getItem(1).evaluate(e).numberValue()):i=t.evaluate(e).cast(Qo.Form),i?(i=i.brighter(r),Qo.Form.mold(i)):w.Absent},e}(Z),oa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"darker"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){var i,r;return t.length>=2?(i=t.getItem(0).evaluate(e).cast(Qo.Form),r=t.getItem(1).evaluate(e).numberValue()):i=t.evaluate(e).cast(Qo.Form),i?(i=i.darker(r),Qo.Form.mold(i)):w.Absent},e}(Z),na=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"contrast"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){var i,r;return t.length>=2?(i=t.getItem(0).evaluate(e).cast(Qo.Form),r=t.getItem(1).evaluate(e).numberValue()):i=t.evaluate(e).cast(Qo.Form),i?(i=i.contrast(r),Qo.Form.mold(i)):w.Absent},e}(Z),sa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"opacity"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){var i,r;return t.length>=2&&(i=t.getItem(0).evaluate(e).cast(Qo.Form),r=t.getItem(1).evaluate(e).numberValue(),i&&void 0!==r)?(i=i.alpha(r),Qo.Form.mold(i)):w.Absent},e}(Z),aa=function(t){function e(e){var i=t.call(this)||this;return i.interpolator=e,i}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"interpolator"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){var i=t.evaluate(e).numberValue();if(void 0!==i){i=Math.min(Math.max(0,i||0),1);var r=this.interpolator.map(i);return Zs.Form.mold(r)}return w.Absent},e}(Z),ua=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return"inerpolate"},enumerable:!0,configurable:!0}),e.prototype.invoke=function(t,e){var i,r;if(t.length>=2?(i=t.getItem(0).evaluate(e).cast(Zs.Form),r=t.getItem(1).evaluate(e).cast(Zs.Form)):i=t.evaluate(e).cast(Zs.Form),void 0!==i||void 0!==r){var o=Ln.interpolate(i,r);return new aa(o)}return w.Absent},e}(Z),ha={Date:new ea,Now:new ia,Brighter:new ra,Darker:new oa,Contrast:new na,Opacity:new sa,Interpolate:new ua,GlobalScope:void 0};ha.GlobalScope=w.GlobalScope.branch().slot("date",ha.Date).slot("now",ha.Now).slot("brighter",ha.Brighter).slot("darker",ha.Darker).slot("contrast",ha.Contrast).slot("opacity",ha.Opacity).slot("interpolate",ha.Interpolate).commit();var la=function(){function t(){}return Object.defineProperty(t.prototype,"tag",{get:function(){return this.constructor.tag},enumerable:!0,configurable:!0}),t.prototype.toRecon=function(){return this.toValue().toRecon()},Object.defineProperty(t,"tag",{get:function(){return""},enumerable:!0,configurable:!0}),t.fromValue=function(t){switch(t.tag){case"append":return da.fromValue(t);case"prepend":return fa.fromValue(t);case"insert":return ya.fromValue(t);case"remove":return ma.fromValue(t);case"state":return va.fromValue(t);case"model":return ga.fromValue(t);default:return}},t.parseRecon=function(e){return t.fromValue(b.parseRecon(e))},t}(),pa=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n._parent=e,n._child=i,n._target=r,n._body=o,n}return u(e,t),e.prototype.parent=function(t){return void 0===t?this._parent:this.copy(t,this._child,this._target,this._body)},e.prototype.child=function(t){return void 0===t?this._child:this.copy(this._parent,t,this._target,this._body)},e.prototype.target=function(t){return void 0===t?this._target:this.copy(this._parent,this._child,t,this._body)},e.prototype.body=function(t){return void 0===t?this._body:(t=b.fromAny(t),this.copy(this._parent,this._child,this._target,t))},e.prototype.toValue=function(){var t=L.empty(this._target?3:2).slot("parent",this._parent).slot("child",this._child);return this._target&&t.slot("target",this._target),R.of(this.tag,t).concat(this._body)},e.fromValue=function(t,e){var i,r,o="";if(t.header(e.tag).forEach(function(t,e){if(t.key instanceof I){var n=t.key.value;"parent"===n?i=t.toValue().stringValue(i):"child"===n?r=t.toValue().stringValue(r):"target"===n&&(o=t.toValue().stringValue(o))}else t instanceof b&&(0===e?i=t.stringValue(i):1===e?r=t.stringValue(r):2===e&&(o=t.stringValue(o)))},this),void 0!==i&&void 0!==r){var n=t.body();return new e(i,r,o,n)}},e}(la),ca=function(t){function e(e,i){var r=t.call(this)||this;return r._child=e,r._body=i,r}return u(e,t),e.prototype.parent=function(t){return void 0===t?"":this},e.prototype.child=function(t){return void 0===t?this._child:this.copy(t,this._body)},e.prototype.target=function(t){return void 0===t?"":this},e.prototype.body=function(t){return void 0===t?this._body:(t=b.fromAny(t),this.copy(this._child,t))},e.prototype.toValue=function(){var t=L.empty(1).slot("child",this._child);return R.of(this.tag,t).concat(this._body)},e.fromValue=function(t,e){var i;if(t.header(e.tag).forEach(function(t,e){t.key instanceof I?"child"===t.key.value&&(i=t.toValue().stringValue(i)):t instanceof b&&0===e&&(i=t.stringValue(i))},this),void 0!==i){var r=t.body();return new e(i,r)}},e}(la),da=function(t){function e(e,i,r,o){return t.call(this,e,i,r,o)||this}return u(e,t),e.prototype.copy=function(t,i,r,o){return new e(t,i,r,o)},e.fromValue=function(t){return pa.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"append"},enumerable:!0,configurable:!0}),e.of=function(t,i,r,o){return void 0===o&&(o=b.Absent),new e(t,i,r,o=b.fromAny(o))},e}(pa),fa=function(t){function e(e,i,r,o){return t.call(this,e,i,r,o)||this}return u(e,t),e.prototype.copy=function(t,i,r,o){return new e(t,i,r,o)},e.fromValue=function(t){return pa.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"prepend"},enumerable:!0,configurable:!0}),e.of=function(t,i,r,o){return void 0===o&&(o=b.Absent),new e(t,i,r,o=b.fromAny(o))},e}(pa),ya=function(t){function e(e,i,r,o){return t.call(this,e,i,r,o)||this}return u(e,t),e.prototype.copy=function(t,i,r,o){return new e(t,i,r,o)},e.fromValue=function(t){return pa.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"insert"},enumerable:!0,configurable:!0}),e.of=function(t,i,r,o){return void 0===o&&(o=b.Absent),new e(t,i,r,o=b.fromAny(o))},e}(pa),ma=function(t){function e(e,i,r,o){return void 0===o&&(o=b.Absent),t.call(this,e,i,r,o)||this}return u(e,t),e.prototype.copy=function(t,i,r,o){return new e(t,i,r,o)},e.fromValue=function(t){return pa.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"remove"},enumerable:!0,configurable:!0}),e.of=function(t,i,r,o){return void 0===o&&(o=b.Absent),new e(t,i,r,o=b.fromAny(o))},e}(pa),va=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),e.prototype.copy=function(t,i){return new e(t,i)},e.fromValue=function(t){return ca.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"state"},enumerable:!0,configurable:!0}),e.of=function(t,i){return void 0===i&&(i=b.Absent),new e(t,i=b.fromAny(i))},e}(ca),ga=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),e.prototype.copy=function(t,i){return new e(t,i)},e.fromValue=function(t){return ca.fromValue(t,e)},Object.defineProperty(e,"tag",{get:function(){return"model"},enumerable:!0,configurable:!0}),e.of=function(t,i){return void 0===i&&(i=b.Absent),new e(t,i=b.fromAny(i))},e}(ca),wa=function(){function t(t){void 0===t&&(t=C.generateId()),this._id=t,this._parentView=null,this._childViews=[],this._appView=null,this._model=b.Absent,this._state=b.Absent,this._flags=0}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentView",{get:function(){return this._parentView},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childViews",{get:function(){return this._childViews},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appView",{get:function(){var e=this._appView;if(null===e)for(var i=this;i;){if(i instanceof t.AppView){this._appView=e=i;break}i=i.parentView}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),t.prototype.setModel=function(t){if(t=b.fromAny(t),!this._model.equals(t)){this._model=t.commit(),this.didSetModel(t);var e=this.appView;e&&e.setModel(t,this)}},t.prototype.didSetModel=function(t){this._controller&&this._controller.didSetModel(t,this)},Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),t.prototype.setState=function(t){t=b.fromAny(t);var e=this._state;e.equals(t)||(this._state=t.commit(),this.didSetState(t,e))},t.prototype.didSetState=function(t,e){this._controller&&this._controller.didSetState(t,e,this),t.forEach(function(t){t instanceof T&&t.key instanceof I&&this.didSetStateParam(t.key.value,t.value)},this)},t.prototype.didSetStateParam=function(t,e){},t.prototype.setParentView=function(t){var e=this._parentView;if(t){if(e)throw new Error;this._parentView=t,(i=this.appView)&&i.addDescendantViews(this,t),this.requireResize(),this.didSetParentView(t)}else if(e){var i;e.requireResize(),(i=e.appView)&&i.removeDescendantViews(this,e),this._flags=0,this._appView=null,this._parentView=null,this.didSetParentView(t)}},t.prototype.didSetParentView=function(t){this._controller&&this._controller.didSetParentView(t,this)},t.prototype.setAppView=function(t){this._appView=t,this.didSetAppView(t)},t.prototype.didSetAppView=function(t){},t.prototype.appendChildView=function(t){if(!t)throw new TypeError(""+t);if(this._childViews.indexOf(t)>=0)throw new Error("duplicate child");if(t._parentView)throw new Error("duplicate parent");this._childViews.push(t),t.setParentView(this),this.didInsertChildView(t)},t.prototype.prependChildView=function(t){if(!t)throw new TypeError(""+t);if(this._childViews.indexOf(t)>=0)throw new Error("duplicate child");if(t._parentView)throw new Error("duplicate parent");this._childViews.unshift(t),t.setParentView(this),this.didInsertChildView(t)},t.prototype.insertChildView=function(t,e){if(!t)throw new TypeError(""+t);if(this._childViews.indexOf(t)>=0)throw new Error("duplicate child");if(t._parentView)throw new Error("duplicate parent");var i=e?this._childViews.indexOf(e):-1;i<0&&(i=this._childViews.length),this._childViews.splice(i,0,t),t.setParentView(this),this.didInsertChildView(t)},t.prototype.removeChildView=function(t){if(!t)throw new TypeError(""+t);var e=this._childViews.indexOf(t);e>=0&&(t.setParentView(null),this._childViews.splice(e,1),this.didRemoveChildView(t))},t.prototype.removeAllChildViews=function(){for(;this._childViews.length;){var t=this._childViews[0];t.setParentView(null),this._childViews.splice(0,1),this.didRemoveChildView(t)}},t.prototype.didInsertChildView=function(e){0!=(e._flags&t.REQUEST_RESIZE)&&this.requestResize(),this._controller&&this._controller.didInsertChildView(e,this)},t.prototype.didRemoveChildView=function(t){this._controller&&this._controller.didRemoveChildView(t,this)},t.prototype.controller=function(t){return void 0===t?this._controller||null:(this._controller!==t&&(this._controller&&(this._controller.view=null),this._controller=t||void 0,this._controller&&(this._controller.view=this)),this)},t.prototype.isViewable=function(){return!0},t.prototype.willResize=function(){this._controller&&this._controller.willResize(this)},t.prototype.didResize=function(){this._controller&&this._controller.didResize(this)},t.prototype.willReview=function(t){this._controller&&this._controller.willReview(t,this)},t.prototype.didReview=function(t){this._controller&&this._controller.didReview(t,this)},t.prototype.willRedraw=function(){this._controller&&this._controller.willRedraw(this)},t.prototype.didRedraw=function(){this._controller&&this._controller.didRedraw(this)},t.prototype.requestResize=function(){0==(this._flags&t.REQUEST_RESIZE)&&(this._flags|=t.REQUEST_RESIZE,this._parentView&&this._parentView.requestResize())},t.prototype.requireResize=function(){if(0==(this._flags&t.REQUIRE_RESIZE)){this._flags|=t.REQUIRE_RESIZE,this.requestResize();for(var e=this._childViews,i=0,r=e.length;i<r;i+=1)e[i].requireResize()}},t.prototype.cascadeWillResize=function(){if(0!=(this._flags&t.REQUEST_RESIZE)){0!=(this._flags&t.REQUIRE_RESIZE)&&this.willResize();for(var e=this._childViews,i=0,r=e.length;i<r;i+=1)e[i].cascadeWillResize()}},t.prototype.cascadeDidResize=function(){if(0!=(this._flags&t.REQUEST_RESIZE)){this._flags&=~t.REQUEST_RESIZE;for(var e=this._childViews,i=0,r=e.length;i<r;i+=1)e[i].cascadeDidResize();0!=(this._flags&t.REQUIRE_RESIZE)&&(this._flags&=~t.REQUIRE_RESIZE,this.didResize())}},t.prototype.requestReview=function(){0==(this._flags&t.REQUEST_REVIEW)&&(this._flags|=t.REQUEST_REVIEW,this._parentView&&this._parentView.requestReview())},t.prototype.requireReview=function(){if(0==(this._flags&t.REQUIRE_REVIEW)){this._flags|=t.REQUIRE_REVIEW,this.requestReview();for(var e=this._childViews,i=0,r=e.length;i<r;i+=1)e[i].requireReview()}},t.prototype.cascadeWillReview=function(){if(0!=(this._flags&t.REQUEST_REVIEW)){0!=(this._flags&t.REQUIRE_REVIEW)&&(0==(this._flags&t.VIEWABLE)?this.isViewable()&&this.willReview(!0):0!=(this._flags&t.VIEWABLE)&&(this.isViewable()||this.willReview(!1)));for(var e=this._childViews,i=0,r=e.length;i<r;i+=1)e[i].cascadeWillReview()}},t.prototype.cascadeDidReview=function(){if(0!=(this._flags&t.REQUEST_REVIEW)){this._flags&=~t.REQUEST_REVIEW;for(var e=this._childViews,i=0,r=e.length;i<r;i+=1)e[i].cascadeDidReview();0!=(this._flags&t.REQUIRE_REVIEW)&&(this._flags&=~t.REQUIRE_REVIEW,0==(this._flags&t.VIEWABLE)?this.isViewable()&&(this._flags|=t.VIEWABLE,this.didReview(!0)):0!=(this._flags&t.VIEWABLE)&&(this.isViewable()||(this._flags&=~t.VIEWABLE,this.didReview(!1))))}},t.prototype.requestRedraw=function(){0==(this._flags&t.REQUEST_REDRAW)&&(this._flags|=t.REQUEST_REDRAW,this._parentView&&this._parentView.requestRedraw())},t.prototype.requireRedraw=function(){if(0==(this._flags&t.REQUIRE_REDRAW)){this._flags|=t.REQUIRE_REDRAW,this.requestRedraw();for(var e=this._childViews,i=0,r=e.length;i<r;i+=1)e[i].requireRedraw()}},t.prototype.cascadeWillRedraw=function(){if(0!=(this._flags&t.REQUEST_REDRAW)){0!=(this._flags&t.REQUIRE_REDRAW)&&this.willRedraw();for(var e=this._childViews,i=0,r=e.length;i<r;i+=1)e[i].cascadeWillRedraw()}},t.prototype.cascadeDidRedraw=function(){if(0!=(this._flags&t.REQUEST_REDRAW)){this._flags&=~t.REQUEST_REDRAW;for(var e=this._childViews,i=0,r=e.length;i<r;i+=1)e[i].cascadeDidRedraw();0!=(this._flags&t.REQUIRE_REDRAW)&&(this._flags&=~t.REQUIRE_REDRAW,this.didRedraw())}},t.prototype.stack=function(){return D.of(t.GlobalScope,this._model,this._state)},t.initTheme=function(){var t=L.empty();t.slot("textColor","#555c78"),t.slot("subtextColor","#555c78"),t.slot("primaryColor","#9b9eb1");var e=B.get("primaryColor"),i=B.get("darker").invoke(L.of(e,.2)),r=B.get("brighter").invoke(L.of(e,.2)),o=B.get("interpolate").invoke(L.of(i,r));return t.slot("primaryHue",o),t},t.GlobalScope=ha.GlobalScope,t.Theme=t.initTheme(),t.REQUEST_RESIZE=1,t.REQUIRE_RESIZE=2,t.REQUEST_REVIEW=4,t.REQUIRE_REVIEW=8,t.REQUEST_REDRAW=16,t.REQUIRE_REDRAW=32,t.VIEWABLE=64,t.NodeView=void 0,t.ElemView=void 0,t.TextView=void 0,t.HtmlView=void 0,t.SvgView=void 0,t.AppView=void 0,t}(),ba=function(t){function e(e,i){var r=t.call(this,i)||this;return r.node=e,r.node.view=r,r}return u(e,t),e.prototype.text=function(t){return void 0===t?this.node.textContent||"":(this.node.textContent=t,this)},e.prototype.attachApp=function(){for(var t,i=this.node;t=i.parentNode;){if(t.view instanceof wa.AppView){t.view.appendChildView(i.view);break}if(t instanceof HTMLBodyElement){wa.AppView.create(t).appendChildView(i.view);break}if(t instanceof HTMLHeadElement||t instanceof HTMLHtmlElement)break;e.create(t).appendChildView(i.view),i=t}},e.create=function(t){return t instanceof e?t:"string"==typeof t?new wa.ElemView(document.createElement(t)):t.view?t.view:t instanceof HTMLElement?new wa.HtmlView(t):t instanceof SVGElement?new wa.SvgView(t):t instanceof Element?new wa.ElemView(t):t instanceof Text?new wa.TextView(t):new e(t)},e}(wa);wa.NodeView=ba;var _a=function(){function t(){}return t.addGlobal=function(e){t.Global=t.Global.withDirectiveForm(e)},t.removeGlobal=function(e){t.Global=t.Global.withoutDirectiveForm(e)},t.Global=void 0,t}(),xa=function(t){function e(e){var i=t.call(this)||this;return i._directiveForms=e,i}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.directiveForms=function(){return this._directiveForms.slice(0)},e.prototype.withDirectiveForm=function(t){if(this._directiveForms.indexOf(t)<0){var i=this._directiveForms.slice(0);return i.push(t),new e(i)}return this},e.prototype.withDirectiveForms=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var r=this._directiveForms.slice(0),o=0;o<t.length;o+=1){var n=t[o];r.indexOf(n)<0&&r.push(n)}return this._directiveForms.length!==r.length?new e(r):this},e.prototype.withoutDirectiveForm=function(t){var i=this._directiveForms.indexOf(t);if(i>=0){var r=this._directiveForms.slice(0);return r.splice(i,1),new e(r)}return this},e.prototype.cast=function(t){"string"==typeof t&&(t=b.parseRecon(t));for(var e=0;e<this._directiveForms.length;e+=1){var i=this._directiveForms[e].cast(t);if(void 0!==i)return i}},e}(_a);_a.Global=new xa([]);var Aa=function(){function t(){}return t.prototype.materializeView=function(t,e,i,r){var o=L.empty();return e.forEach(function(e){(e=this.materializeViewParam(t,e,i,r))instanceof w&&e.isDefined()&&o.push(e)},this),o},t.prototype.materializeViewParam=function(t,e,i,r){return e},t.prototype.materializeModel=function(t,e,i,r){var o=L.empty();return e.forEach(function(e){(e=this.materializeModelParam(t,e,i,r))instanceof w&&e.isDefined()&&o.push(e)},this),o},t.prototype.materializeModelParam=function(t,e,i,r){if(e instanceof M&&e.key instanceof I&&"sealed"===e.key.value){var o=e.toValue().booleanValue();if(void 0!==o)return t.isSealed(o),e}var n=_a.Global.cast(e);return n?(t.addDirective(n),w.Absent):e},t.addGlobal=function(e){t.Global=t.Global.withUiForm(e)},t.removeGlobal=function(e){t.Global=t.Global.withoutUiForm(e)},t.Global=void 0,t}(),ka=function(t){function e(e){var i=t.call(this)||this;return i._uiForms=e,i}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.uiForms=function(){return this._uiForms.slice(0)},e.prototype.withUiForm=function(t){if(this._uiForms.indexOf(t)<0){var i=this._uiForms.slice(0);return i.push(t),new e(i)}return this},e.prototype.withUiForms=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];for(var r=this._uiForms.slice(0),o=0;o<t.length;o+=1){var n=t[o];r.indexOf(n)<0&&r.push(n)}return this._uiForms.length!==r.length?new e(r):this},e.prototype.withoutUiForm=function(t){var i=this._uiForms.indexOf(t);if(i>=0){var r=this._uiForms.slice(0);return r.splice(i,1),new e(r)}return this},e.prototype.castModel=function(t,e,i){void 0===i&&(i=this),"string"==typeof t&&(t=b.parseRecon(t));for(var r=0;r<this._uiForms.length;r+=1){var o=this._uiForms[r].castModel(t,e,i);if(void 0!==o)return o}},e.prototype.castView=function(t,e,i){void 0===i&&(i=this),"string"==typeof t&&(t=b.parseRecon(t));for(var r=0;r<this._uiForms.length;r+=1){var o=this._uiForms[r].castView(t,e,i);if(void 0!==o)return o}},e.prototype.materializeScripts=function(t){if(t||(t=D.of(w.GlobalScope,wa.GlobalScope)),"undefined"!=typeof document)for(var e=document.querySelectorAll('script[type="text/recon"]'),i=0;i<e.length;i+=1){var r=e[i];r instanceof HTMLElement&&this.materializeScript(r,t)}},e.prototype.materializeScript=function(t,e){var i=t.innerText,r=this.castView(i,e);r instanceof ba&&t.parentNode&&(t.parentNode.replaceChild(r.node,t),r.attachApp())},e}(Aa);Aa.Global=new ka([]);var Ea=function(){function t(){this._view=null}return Object.defineProperty(t.prototype,"view",{get:function(){return this._view},set:function(t){this._view!==t&&(this._view=t,this._view&&this.didSetView(this._view))},enumerable:!0,configurable:!0}),t.prototype.didSetView=function(t){},t.prototype.didSetParentView=function(t,e){},t.prototype.didInsertChildView=function(t,e){},t.prototype.didRemoveChildView=function(t,e){},t.prototype.viewScope=function(){return L.empty()},t.prototype.stack=function(){var t=new D;return t.push(wa.GlobalScope),t.push(this.viewScope()),t},t.prototype.didSetModel=function(t,e){},t.prototype.didSetStyle=function(t,e,i){},t.prototype.didSetState=function(t,e,i){},t.prototype.willResize=function(t){},t.prototype.didResize=function(t){},t.prototype.willReview=function(t,e){},t.prototype.didReview=function(t,e){},t.prototype.willRedraw=function(t){},t.prototype.didRedraw=function(t){},t}(),Ca=function(){function t(t,e){this._name=t,this._selector=e}return t.prototype.evaluate=function(t,e){var i=this._selector.evaluate(e).toValue();i.isDefined()&&t.slot(this._name,i)},t}(),Sa=function(){function t(t){void 0===t&&(t=C.generateId()),this._id=t,this._parentModel=null,this._childModels=[],this._directives=[],this._appModel=null,this._modelScope=new Va(this),this._state=b.Absent,this._flags=0}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentModel",{get:function(){return this._parentModel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"childModels",{get:function(){return this._childModels},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"appModel",{get:function(){var e=this._appModel;if(null===e)for(var i=this;i;){if(i instanceof t.AppModel){this._appModel=e=i;break}i=i._parentModel}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"directives",{get:function(){return this._directives},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"modelScope",{get:function(){return this._modelScope},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"routeScope",{get:function(){var t=this.appModel;return t?t._routeScope:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parentScope",{get:function(){var t=this._parentModel;return t?t._modelScope:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"downlinkContext",{get:function(){for(var t=this;t;){if(t._downlinkContext)return t._downlinkContext;t=t._parentModel}return Ji},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"params",{get:function(){return this.constructor.Params},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),t.prototype.setState=function(t){t=b.fromAny(t);var e=this._state;if(t=this.willSetState(t,e),!e.equals(t)){this._state=t.commit(),this.didSetState(t,e);var i=this.appModel;i&&i.setState(t,this)}},t.prototype.willSetState=function(t,e){return t},t.prototype.didSetState=function(t,e){},t.prototype.setParentModel=function(t){var e=this._parentModel;if(t){if(e)throw new Error;this._parentModel=t,(i=this.appModel)&&i.addDescendantModels(this,t),this.requireRestate(),this.didSetParentModel(t)}else if(e){var i;(i=e.appModel)&&i.removeDescendantModels(this,e),this._flags=0,this._appModel=null,this._parentModel=null,this.didSetParentModel(null)}},t.prototype.didSetParentModel=function(t){},t.prototype.setAppModel=function(t){this._appModel=t,null===t&&this._modelScope.close(),this.didSetAppModel(t)},t.prototype.didSetAppModel=function(t){},t.prototype.appendChildModel=function(t){if(!t)throw new TypeError(""+t);if(this._childModels.indexOf(t)>=0)throw new Error("duplicate child");if(t._parentModel)throw new Error("duplicate parent");this._childModels.push(t),t.setParentModel(this),this.didInsertChildModel(t)},t.prototype.prependChildModel=function(t){if(!t)throw new TypeError(""+t);if(this._childModels.indexOf(t)>=0)throw new Error("duplicate child");if(t._parentModel)throw new Error("duplicate parent");this._childModels.unshift(t),t.setParentModel(this),this.didInsertChildModel(t)},t.prototype.insertChildModel=function(t,e){if(!t)throw new TypeError(""+t);if(this._childModels.indexOf(t)>=0)throw new Error("duplicate child");if(t._parentModel)throw new Error("duplicate parent");var i=e?this._childModels.indexOf(e):-1;i<0&&(i=this._childModels.length),this._childModels.splice(i,0,t),t.setParentModel(this),this.didInsertChildModel(t)},t.prototype.removeChildModel=function(t){if(!t)throw new TypeError(""+t);var e=this._childModels.indexOf(t);e>=0&&(t.setParentModel(null),this._childModels.splice(e,1),this.didRemoveChildModel(t))},t.prototype.didInsertChildModel=function(e){for(var i=0,r=this._directives.length;i<r;i+=1)this._directives[i].didInsertChildModel(e);0!=(e._flags&t.REQUEST_RESTATE)&&this.requestRestate()},t.prototype.didRemoveChildModel=function(t){for(var e=0,i=this._directives.length;e<i;e+=1)this._directives[e].didRemoveChildModel(t)},t.prototype.addDirective=function(t){if(!t)throw new TypeError(""+t);if(this._directives.indexOf(t)>=0)throw new Error("duplicate directive");if(t._model)throw new Error("duplicate model");this._directives.push(t),t.setModel(this),this.didAddDirective(t)},t.prototype.removeDirective=function(t){if(!t)throw new TypeError(""+t);var e=this._directives.indexOf(t);e>=0&&(t.setModel(null),this._directives.splice(e,1),this.didRemoveDirective(t))},t.prototype.didAddDirective=function(t){},t.prototype.didRemoveDirective=function(t){},t.prototype.appendChildView=function(t,e){var i=this._appModel;i&&i.appendChildView(this._id,t,e)},t.prototype.prependChildView=function(t,e){var i=this._appModel;i&&i.prependChildView(this._id,t,e)},t.prototype.insertChildView=function(t,e,i){var r=this._appModel;r&&r.insertChildView(this._id,t,e,i)},t.prototype.removeChildView=function(t){var e=this._appModel;e&&e.removeChildView(this._id,t)},t.prototype.isSealed=function(e){return void 0===e?0!=(this._flags&t.SEALED):(e?this._flags|=t.SEALED:this._flags&=~t.SEALED,this)},t.prototype.willRemodel=function(t,e){for(var i=0,r=this._directives.length;i<r;i+=1)this._directives[i].willRemodel(t,e)},t.prototype.didRemodel=function(t,e){for(var i=0,r=this._directives.length;i<r;i+=1)this._directives[i].didRemodel(t,e)},t.prototype.remodel=function(t){void 0===t&&(t=this.stack());for(var e=this.params,i=L.empty(e.length),r=0;r<e.length;r+=1)e[r].evaluate(i,t);this.willRemodel(i,t),this.setState(i),this.didRemodel(i,t)},t.prototype.willRestate=function(){for(var t=0,e=this._directives.length;t<e;t+=1)this._directives[t].willRestate()},t.prototype.didRestate=function(){this._modelScope.materializeScope();for(var t=0,e=this._directives.length;t<e;t+=1)this._directives[t].didRestate();this.remodel()},t.prototype.requestRestate=function(){0==(this._flags&t.REQUEST_RESTATE)&&(this._flags|=t.REQUEST_RESTATE,this._parentModel&&this._parentModel.requestRestate())},t.prototype.requireRestate=function(e){if(void 0===e&&(e=this),0==(this._flags&t.REQUIRE_RESTATE)&&(this._flags|=t.REQUIRE_RESTATE,this.requestRestate(),e===this||0==(this._flags&t.SEALED)))for(var i=this._childModels,r=0,o=i.length;r<o;r+=1)i[r].requireRestate(e)},t.prototype.cascadeWillRestate=function(){if(0!=(this._flags&t.REQUEST_RESTATE)){0!=(this._flags&t.REQUIRE_RESTATE)&&this.willRestate();for(var e=this._childModels,i=0,r=e.length;i<r;i+=1)e[i].cascadeWillRestate()}},t.prototype.cascadeDidRestate=function(){if(0!=(this._flags&t.REQUEST_RESTATE)){this._flags&=~t.REQUEST_RESTATE;for(var e=this._childModels,i=0,r=e.length;i<r;i+=1)e[i].cascadeDidRestate();0!=(this._flags&t.REQUIRE_RESTATE)&&(this._flags&=~t.REQUIRE_RESTATE,this.didRestate())}},t.prototype.setData=function(t){"string"==typeof t?t=L.parseRecon(t):t instanceof L||(t=L.of(t));for(var e=0,i=this._directives.length;e<i;e+=1)this._directives[e].setData(t);this._modelScope._record=t,this.requireRestate()},t.prototype.initDownlink=function(t,e){return void 0===e&&(e=this.stack()),t&&void 0!==t.hostUri||((t=t||{}).hostUri=Ra.evaluate(e).cast(ye.Uri)),t&&void 0!==t.nodeUri||((t=t||{}).nodeUri=Ta.evaluate(e).cast(ye.Uri)),t&&void 0!==t.laneUri||((t=t||{}).laneUri=Pa.evaluate(e).cast(ye.Uri)),t&&void 0!==t.prio||((t=t||{}).prio=La.evaluate(e).numberValue()),t&&void 0!==t.rate||((t=t||{}).rate=Fa.evaluate(e).numberValue()),t},t.prototype.stack=function(){return D.of(t.GlobalScope,this._modelScope)},t.Params=[],t.GlobalScope=ha.GlobalScope,t.REQUEST_RESTATE=1,t.REQUIRE_RESTATE=2,t.SEALED=256,t.AppModel=void 0,t}(),Va=function(t){function e(e){var i=t.call(this)||this;return i._model=e,i}return u(e,t),Object.defineProperty(e.prototype,"parentScope",{get:function(){return this._model.parentScope},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"downlinkContext",{get:function(){return this._model.downlinkContext},enumerable:!0,configurable:!0}),e.prototype.initDownlink=function(t,e){return this._model.initDownlink(t,e)},e.prototype.materializeMutableScope=function(t,e){var i=new Ma(this._model);return t.header("mutable").forEach(function(t){t instanceof B&&i._dependents.push(t)},this),i._record=t.tail(),i},e.prototype.materializeValue=function(e,i){if("mutable"===e.tag){var r=this.materializeMutableScope(e,i);if(r instanceof Ma)return r}return t.prototype.materializeValue.call(this,e,i)},e.prototype.didChange=function(t,e,i){this._model.requireRestate()},e.prototype.stack=function(){return D.of(Sa.GlobalScope,this)},e}(Ni),Da=function(t){function e(e){var i=t.call(this)||this;return i._model=e,i}return u(e,t),Object.defineProperty(e.prototype,"parentScope",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.didChange=function(t,e,i){this._model.requireRestate()},e.prototype.stack=function(){return D.of(Sa.GlobalScope,this)},e}(Qe),Ma=function(t){function e(e){var i=t.call(this)||this;return i._model=e,i._dependents=L.empty(),i}return u(e,t),Object.defineProperty(e.prototype,"parentScope",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.didChange=function(t,e,i){this._model.requireRestate()},e.prototype.stack=function(){return D.of(Sa.GlobalScope,this)},e}(Qe),Ra=B.get("host"),Ta=B.get("node"),Pa=B.get("lane"),La=B.get("prio"),Fa=B.get("rate"),za=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"view"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=new wa,o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new Sa,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(Aa);Aa.addGlobal(za.Form);var Ia=function(){function t(){this._model=null}return Object.defineProperty(t.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),t.prototype.setModel=function(t){var e=this._model;if(t){if(e)throw new Error;this._model=t,this.didSetModel(t)}else e&&(this._model=null,this.didSetModel(null))},t.prototype.didSetModel=function(t){},t.prototype.didInsertChildModel=function(t){},t.prototype.didRemoveChildModel=function(t){},t.prototype.willRestate=function(){},t.prototype.didRestate=function(){},t.prototype.willRemodel=function(t,e){},t.prototype.didRemodel=function(t,e){},t.prototype.setData=function(t){},t.prototype.setStyle=function(t){},t.prototype.stack=function(){return this._model?this._model.stack():D.of(Sa.GlobalScope)},t.prototype.injectStack=function(t){},t}(),Ua=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(Sa),Wa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.materializeViewParam=function(e,i,r,o){return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return t.prototype.materializeModelParam.call(this,e,i,r,o)},e}(Aa),Oa=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),e.prototype.text=function(t,e){var i=this.textAnimator;if(void 0===t)return i?i.get():this.node.nodeValue||"";if(null===t)return i&&(i.cancel(),this.textAnimator=void 0),this.node.nodeValue=null,this;if(e=fs.fromAny(e,t),i||void 0===e||(e.f||(e=e.range(t)),i=new Cs(this.node,t,e),this.textAnimator=i),i)i.set(t,e);else if(t instanceof w){var r=this.stack();this.node.nodeValue=t.evaluate(r).stringValue("")}else this.node.nodeValue=""+t;return this},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("text");if(r instanceof w.Text)this.text(r.value);else if(r.isDefined()){var o=e.get("transition").cast(fs.Form);this.text(r,o)}},e.create=function(t){if(void 0===t&&(t=""),t instanceof e)return t;if(t instanceof ba)throw new TypeError(""+t);if("string"==typeof t)return new wa.TextView(document.createTextNode(t));if(t.view instanceof e)return t.view;if(t.view)throw new TypeError(""+t.view);if(t instanceof Text)return new e(t);throw new TypeError(""+t)},e}(ba);wa.TextView=Oa;var Ba=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.remodel=function(t){void 0===t&&(t=this.stack());var e=L.empty(),i=qa.evaluate(t).toValue();i.isDefined()&&e.slot("transition",i);var r=Ga.substitute(t).toValue();r.isDefined()&&e.slot("text",r),this.setState(e)},e}(Ua),qa=B.get("transition"),Ga=B.get("text"),Ha=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"text"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.header(this.tag).isDefined()){var r=Oa.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.header(this.tag).isDefined()){var r=new Ba,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.Form=new e,e}(Wa);Aa.addGlobal(Ha.Form);var Na=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r.attributeAnimators={},r.styleAnimators={},r}return u(e,t),e.prototype.isViewable=function(){var t=this.node.getBoundingClientRect(),e=document.documentElement.clientWidth,i=document.documentElement.clientHeight;return(t.top<=0&&t.bottom>0||t.top>=0&&t.top<i)&&(t.left<=0&&t.right>0||t.left>=0&&t.left<e)},e.prototype.attribute=function(t,e,i,r){var o=this.attributeAnimators[t];if(void 0===e)return o?o.get():this.node.getAttribute(t);if(null===e)return o&&(o.cancel(),this.attributeAnimators[t]=void 0),this.node.removeAttribute(t),this;if(i=fs.fromAny(i,e),o||void 0===i||(i.f||(i=i.range(e)),o=new ks(this.node,t,e,i,r),this.attributeAnimators[t]=o),o)o.set(e,i);else{var n=this.node.getAttribute(t),s=ms(e);n!==s&&(this.node.setAttribute(t,s),void 0!==r&&0!=(r&gs.REQUIRES_RESIZE)&&this.requireResize())}return this},e.prototype.style=function(t,e,i,r){var o=this.styleAnimators[t];if(void 0===e)return o?o.get():this.node.style.getPropertyValue(t);if(null===e)return o&&(o.cancel(),this.styleAnimators[t]=void 0),this.node.style.removeProperty(t),this;if(i=fs.fromAny(i,e),o||void 0===i||(i.f||(i=i.range(e)),o=new Es(this.node,t,e,i,void 0,r),this.styleAnimators[t]=o),o)o.set(e,i);else{var n=this.node.style.getPropertyValue(t),s=vs(e);n!==s&&(this.node.style.setProperty(t,s),void 0!==r&&0!=(r&gs.REQUIRES_RESIZE)&&this.requireResize())}return this},e.prototype.property=function(t,e,i){var r=t.animator(this);return void 0===e?r?r.get():t.get(this):null===e?(t.set(this,null),this):(i=fs.fromAny(i,e),r||void 0===i||(i.f||(i=i.range(e)),r=t.animator(this,e,i)),r?r.set(e,i):t.set(this,e),this)},e.prototype.attributeEnum=function(t,e,i,r){return this.attribute(t,e,i,r)},e.prototype.attributeNumber=function(t,e,i,r){null!=e&&(e=+e);var o=this.attribute(t,e,i,r);return"string"==typeof o&&(o=+o),o},e.prototype.attributeLength=function(t,e,i,r){null!=e&&(e=qo.fromAny(e,this.node));var o=this.attribute(t,e,i,r);return"string"==typeof o&&(o=qo.fromAny(o,this.node)),o},e.prototype.attributeLengthEnum=function(t,e,i,r){if(null!=e)try{e=qo.fromAny(e,this.node)}catch(t){}var o=this.attribute(t,e,i,r);if("string"==typeof o)try{o=qo.fromAny(o,this.node)}catch(t){}return o},e.prototype.attributeColor=function(t,e,i,r){null!=e&&(e=Qo.fromAny(e));var o=this.attribute(t,e,i,r);return"string"==typeof o&&(o=Qo.fromAny(o)),o},e.prototype.attributeTransform=function(t,e,i,r){null!=e&&(e=dn.fromAny(e));var o=this.attribute(t,e,i,r);return"string"==typeof o&&(o=dn.fromAny(o)),o},e.prototype.attributeBoolean=function(t,e,i,r){null!=e&&(e=!!e||null);var o=this.attribute(t,e,i,r);return"string"==typeof o&&(o=!!o),o},e.prototype.attributeValue=function(t,e,i,r){var o;null!=e&&void 0===(o=Zs.Form.cast(e))&&(o=e.stringValue());var n=this.attribute(t,o,i,r);return"string"==typeof n&&(n=Zs.parse(n)),n!==this&&(n=Zs.Form.mold(n)),n},e.prototype.styleEnum=function(t,e,i,r){return this.style(t,e,i,r)},e.prototype.styleNumber=function(t,e,i,r){null!=e&&(e=+e);var o=this.style(t,e,i,r);return"string"==typeof o&&(o=+o),o},e.prototype.styleNumberEnum=function(t,e,i,r){var o=this.style(t,e,i,r);return"string"==typeof o&&isFinite(+o)&&(o=+o),o},e.prototype.styleLength=function(t,e,i,r){null!=e&&(e=qo.fromAny(e,this.node));var o=this.style(t,e,i,r);return"string"==typeof o&&(o=qo.fromAny(o,this.node)),o},e.prototype.styleLengthEnum=function(t,e,i,r){if(null!=e)try{e=qo.fromAny(e,this.node)}catch(t){}var o=this.style(t,e,i,r);if("string"==typeof o)try{o=qo.fromAny(o,this.node)}catch(t){}return o},e.prototype.styleColor=function(t,e,i,r){null!=e&&(e=Qo.fromAny(e));var o=this.style(t,e,i,r);return"string"==typeof o&&(o=Qo.fromAny(o)),o},e.prototype.styleColorEnum=function(t,e,i,r){if(null!=e)try{e=Qo.fromAny(e)}catch(t){}var o=this.style(t,e,i,r);if("string"==typeof o)try{o=Qo.fromAny(o)}catch(t){}return o},e.prototype.styleTransform=function(t,e,i,r){null!=e&&(e=dn.fromAny(e));var o=this.style(t,e,i,r);return"string"==typeof o&&(o=dn.fromAny(o)),o},e.prototype.styleValue=function(t,e,i,r){var o;null!=e&&void 0===(o=Zs.Form.cast(e))&&(o=e.stringValue());var n=this.style(t,o,i,r);return"string"==typeof n&&(n=Zs.parse(n)),n!==this&&(n=Zs.Form.mold(n)),n},e.prototype.propertyEnum=function(t,e,i){return this.property(t,e,i)},e.prototype.propertyNumber=function(t,e,i){null!=e&&(e=+e);var r=this.property(t,e,i);return"string"==typeof r&&(r=+r),r},e.prototype.propertyNumberEnum=function(t,e,i){var r=this.property(t,e,i);return"string"==typeof r&&isFinite(+r)&&(r=+r),r},e.prototype.propertyAngle=function(t,e,i){null!=e&&(e=To.fromAny(e));var r=this.property(t,e,i);return"string"==typeof r&&(r=To.fromAny(r)),r},e.prototype.propertyLength=function(t,e,i){null!=e&&(e=qo.fromAny(e,this.node));var r=this.property(t,e,i);return"string"==typeof r&&(r=qo.fromAny(r,this.node)),r},e.prototype.propertyLengthEnum=function(t,e,i){if(null!=e)try{e=qo.fromAny(e,this.node)}catch(t){}var r=this.property(t,e,i);if("string"==typeof r)try{r=qo.fromAny(r,this.node)}catch(t){}return r},e.prototype.propertyColor=function(t,e,i){null!=e&&(e=Qo.fromAny(e));var r=this.property(t,e,i);return"string"==typeof r&&(r=Qo.fromAny(r)),r},e.prototype.propertyColorEnum=function(t,e,i){if(null!=e)try{e=Qo.fromAny(e)}catch(t){}var r=this.property(t,e,i);if("string"==typeof r)try{r=Qo.fromAny(r)}catch(t){}return r},e.prototype.propertyBoolean=function(t,e,i){return this.property(t,e,i)},e.prototype.elemId=function(t,e){return this.attribute("id",t,e)},e.prototype.name=function(t,e){return this.attribute("name",t,e)},e.prototype.className=function(t,e){return this.attribute("class",t,e)},e.prototype.on=function(t,e,i){return this.node.addEventListener(t,e,i),this},e.prototype.off=function(t,e,i){return this.node.removeEventListener(t,e,i),this},e.prototype.createChildView=function(t){return e.create(t)},e.prototype.append=function(t){var e=this.createChildView(t);return this.appendChildView(e),this.node.appendChild(e.node),e},e.prototype.prepend=function(t){var e=this.createChildView(t);return this.prependChildView(e),this.node.insertBefore(e.node,this.node.firstChild),e},e.prototype.insertBefore=function(t,e){var i;e instanceof ba?(i=e,e=e.node):i=e&&e.view||null;var r=this.createChildView(t);return this.insertChildView(r,i),this.node.insertBefore(r.node,e),r},e.prototype.remove=function(t){if(void 0===t)this._parentView&&this._parentView.removeChildView(this),this.node.parentNode&&this.node.parentNode.removeChild(this.node);else{var e=void 0,i=void 0;t instanceof ba?i=(e=t).node:e=(i=t).view,this.node.removeChild(i),e&&this.removeChildView(e)}return this},e.prototype.removeAll=function(){for(var t;t=this.node.firstChild;)this.node.removeChild(t),t.view&&this.removeChildView(t.view);return this.removeAllChildViews(),this},e.prototype.didInsertChildView=function(e){t.prototype.didInsertChildView.call(this,e),e instanceof ba&&!e.node.parentNode&&this.node.appendChild(e.node)},e.prototype.didRemoveChildView=function(e){e instanceof ba&&e.node.parentNode===this.node&&e.node.removeChild(e.node),t.prototype.didRemoveChildView.call(this,e)},e.prototype.didSetStateParam=function(e,i){"attrs"===e?this.didSetAttrs(i):"style"===e?this.didSetStyle(i):t.prototype.didSetStateParam.call(this,e,i)},e.prototype.didSetAttrs=function(t){var e=t.get("transition").cast(fs.Form);t.forEach(function(t){t instanceof T&&t.key instanceof I&&("transition"!==t.key.value&&this.didSetAttrsParam(t.key.value,t.value,e))},this)},e.prototype.didSetAttrsParam=function(t,e,i){this.attributeValue(t,e,i)},e.prototype.didSetStyle=function(t){var e=t.get("transition").cast(fs.Form);t.forEach(function(t){t instanceof T&&t.key instanceof I&&("transition"!==t.key.value&&this.didSetStyleParam(t.key.value,t.value,e))},this)},e.prototype.didSetStyleParam=function(t,e,i){this.styleValue(t,e,i)},e}(ba);wa.ElemView=Na;var ja=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(Ua),Ya=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.materializeViewParam=function(e,i,r,o){if(i.key instanceof I&&"id"===i.key.value){var n=i.toValue().stringValue();if(void 0!==n)return e.elemId(n),i}return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return t.prototype.materializeModelParam.call(this,e,i,r,o)},e}(Wa),Xa=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),e.prototype.viewBox=function(t,e){return this.attribute("viewBox",t,e)},e.prototype.preserveAspectRatio=function(t,e){return this.attributeBoolean("preserveAspectRatio",t,e)},e.prototype.transform=function(t,e){return this.attributeTransform("transform",t,e),this.styleTransform("transform",t,e)},e.prototype.x=function(t,e){return this.attributeNumber("x",t,e)},e.prototype.y=function(t,e){return this.attributeNumber("y",t,e)},e.prototype.x1=function(t,e){return this.attributeNumber("x1",t,e)},e.prototype.y1=function(t,e){return this.attributeNumber("y1",t,e)},e.prototype.x2=function(t,e){return this.attributeNumber("x2",t,e)},e.prototype.y2=function(t,e){return this.attributeNumber("y2",t,e)},e.prototype.cx=function(t,e){return this.attributeNumber("cx",t,e)},e.prototype.cy=function(t,e){return this.attributeNumber("cy",t,e)},e.prototype.dx=function(t,e){return this.attributeNumber("dx",t,e)},e.prototype.dy=function(t,e){return this.attributeNumber("dy",t,e)},e.prototype.r=function(t,e){return this.attributeNumber("r",t,e)},e.prototype.d=function(t,e){return this.attribute("d",t,e)},e.prototype.points=function(t,e){return this.attribute("points",t,e)},e.prototype.clipPath=function(t,e){return this.attribute("clip-path",t,e)},e.prototype.in=function(t,e){return this.attribute("in",t,e)},e.prototype.in2=function(t,e){return this.attribute("in2",t,e)},e.prototype.mode=function(t,e){return this.attribute("mode",t,e)},e.prototype.edgeMode=function(t,e){return this.attribute("edgeMode",t,e)},e.prototype.stdDeviation=function(t,e){return this.attribute("stdDeviation",t,e)},e.prototype.type=function(t,e){return this.attribute("type",t,e)},e.prototype.values=function(t,e){return this.attribute("values",t,e)},e.prototype.result=function(t,e){return this.attribute("result",t,e)},e.prototype.width=function(t,e){return this.attributeLength("width",t,e)},e.prototype.height=function(t,e){return this.attributeLength("height",t,e)},e.prototype.alignmentBaseline=function(t,e){return this.attributeEnum("alignment-baseline",t,e)},e.prototype.textAnchor=function(t,e){return this.attributeEnum("text-anchor",t,e)},e.prototype.fill=function(t,e){return this.styleColorEnum("fill",t,e)},e.prototype.fillRule=function(t,e){return this.style("fill-rule",t,e)},e.prototype.stroke=function(t,e){return this.styleColorEnum("stroke",t,e)},e.prototype.strokeWidth=function(t,e){return this.styleNumber("stroke-width",t,e)},e.prototype.strokeDashArray=function(t,e){return this.styleNumber("stroke-dasharray",t,e)},e.prototype.cursor=function(t,e){return this.styleEnum("cursor",t,e)},e.prototype.createChildView=function(t){return e.create(t)},e.prototype.append=function(e){return t.prototype.append.call(this,e)},e.prototype.prepend=function(e){return t.prototype.prepend.call(this,e)},e.prototype.insertBefore=function(e,i){return t.prototype.insertBefore.call(this,e,i)},e.create=function(t){return t instanceof ba?t:"string"==typeof t?new wa.SvgView(document.createElementNS(e.NS,t)):t.view?t.view:t instanceof HTMLElement?new wa.HtmlView(t):t instanceof SVGElement?new wa.SvgView(t):t instanceof Element?new wa.ElemView(t):t instanceof Text?new wa.TextView(t):new ba(t)},e.NS="http://www.w3.org/2000/svg",e}(Na);wa.SvgView=Xa;var Ka=function(){function t(){}return t.newGuid=function(){return"xxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})},t.openSwimValueLink=function(t){return new Qa("value",t).downlink},t.openSwimMapLink=function(t){return new Qa("map",t).downlink},t.copyConfig=function(t){var e={};for(var i in t)e[i]=t[i];return e},t.parseHost=function(t){var e={},i=null;return-1!==t.indexOf("://")?(i=t.split("://"),e.isSecure="wss"===i[0]):e.isSecure=!1,i=i?i[1].split(":"):t.split(":"),e.hostUrl=i[0],e.hostPort=i[1]?i[1]:"",e},t}(),Qa=function(){function t(t,e,i){void 0===i&&(i=!1),this.type=t,this.config=e,this.shortUrl=null,this._debug=i,this._downlink=null,this.connect()}return t.prototype.connect=function(){switch(this.type){case"value":this._swimService=or;break;default:this._swimService=rr}var t=this.config.hostPort?":"+this.config.hostPort:"";this.shortUrl=(this.config.isSecure?"wss":"ws")+"://"+this.config.hostUrl+t,this.fullUrlWithPath=""+this.shortUrl+this.config.node+"/"+this.config.lane+"/",void 0!==this.config.keepSynced&&null!==this.config.keepSynced||(this.config.keepSynced=!1),this._downlink=this._swimService().host(this.shortUrl).node(this.config.node).lane(this.config.lane).keepSynced(this.config.keepSynced).didConnect(this.didConnect.bind(this)).didFail(this.didFail.bind(this)).didSync(this.didSync.bind(this)).didLink(this.didLink.bind(this)).didUnlink(this.didUnlink.bind(this)),this.valueType(),this.mapType(),this.open()},Object.defineProperty(t.prototype,"downlink",{get:function(){return null===this._downlink&&this.connect(),this._downlink},enumerable:!0,configurable:!0}),t.prototype.valueType=function(){"value"===this.type&&this._downlink.didSet(this.didSet.bind(this))},t.prototype.didSet=function(t){this._debug&&console.log("[util] "+this.fullUrlWithPath+" didSet",t),this.config.didSet&&this.config.didSet(t)},t.prototype.mapType=function(){"value"!==this.type&&(this._downlink.didSync(this.didSync.bind(this)),this._downlink.didUpdate(this.didUpdate.bind(this)))},t.prototype.didSync=function(){this._debug&&console.log("[util] "+this.fullUrlWithPath+" didSync"),this.config.didSync&&this.config.didSync()},t.prototype.didLink=function(){this._debug&&console.log("[util] "+this.fullUrlWithPath+" didLink"),this.config.didLink&&this.config.didLink()},t.prototype.didUnlink=function(){this._debug&&console.log("[util] "+this.fullUrlWithPath+" didunlink"),this.config.didUnlink&&this.config.didUnlink()},t.prototype.didUpdate=function(t,e){this._debug&&console.log("[util] "+this.fullUrlWithPath+" didUpdate - key: "+t+", Value: ",e),this.config.didUpdate&&this.config.didUpdate(t,e)},t.prototype.update=function(t,e,i){void 0===i&&(i=!1),this.close(),this.type=t,this.config=e,this._debug=i,this.connect()},t.prototype.didConnect=function(t){this._debug&&console.log("[util] "+this.fullUrlWithPath+" opened.")},t.prototype.didFail=function(t){this._debug&&(console.error(this.fullUrlWithPath+" error: "+t),this.config.didFail&&this.config.didFail(t))},t.prototype.open=function(){this._downlink.open()},t.prototype.close=function(){this._downlink.close(),this._downlink.didSync(null),this._downlink.didUpdate(null)},t.create=function(e,i,r){return new t(e,i,r)},t}(),Za=function(){function t(t){this.swimDataConfig={isSecure:!1,hostUrl:"",hostPort:"",node:"",lane:"",keepSynced:!1},this.parentElem=t,this.layoutDataIsDirty=!1,this.renderedElementCache={},this.swimDataLink=null}return t.prototype.setLayoutDefinition=function(t){return this.layoutDefinition=t,!!this.layoutDefinition&&(this.layoutDefinition.width&&this.setLayoutWidth(this.layoutDefinition.width),this.layoutDefinition.height&&this.setLayoutHeight(this.layoutDefinition.height),this.layoutDefinition.title&&this.setLayoutTitle(this.layoutDefinition.title),this.setLayoutElements(this.layoutDefinition.layoutElements),this.layoutDefinition.hostUrl&&(this.swimDataConfig.hostUrl=this.layoutDefinition.hostUrl),this.layoutDefinition.hostPort&&(this.swimDataConfig.hostPort=this.layoutDefinition.hostPort),this.layoutDefinition.node&&(this.swimDataConfig.node=this.layoutDefinition.node),this.layoutDefinition.lane&&(this.swimDataConfig.lane=this.layoutDefinition.lane),this.layoutDefinition.keepSynced&&(this.swimDataConfig.keepSynced=this.layoutDefinition.keepSynced),this.layoutDefinition.renderType&&this.setLayoutRenderType(this.layoutDefinition.renderType||"json"),!0)},t.prototype.openSwimDataLink=function(){this.swimDataConfig.didUpdate=this.handleSwimDataUpdate.bind(this),console.error("dataconfig",this.swimDataConfig),this.swimDataLink=Ka.openSwimMapLink(this.swimDataConfig)},t.prototype.handleSwimDataUpdate=function(){console.error("render sync",this.swimDataLink),this.swimDataLink&&(console.error(this.swimDataLink.get()),this.setSwimData(this.swimDataLink.get()))},t.prototype.getLayoutDefinition=function(){return this.layoutDefinition},t.prototype.setLayoutTitle=function(t){this.layoutDefinition.title=t,this.layoutTitle=this.layoutDefinition.title},t.prototype.getLayoutTitle=function(){return this.layoutTitle||"No Title"},t.prototype.setLayoutWidth=function(t){t!==this.layoutDefinition.width&&(this.layoutDefinition.width=t),this.container&&this.container.width(this.layoutDefinition.width)},t.prototype.setLayoutHeight=function(t){t!==this.layoutDefinition.height&&(this.layoutDefinition.height=t),this.container&&this.container.height(this.layoutDefinition.height)},t.prototype.setLayoutBackground=function(t){t!==this.layoutDefinition.backgroundColor&&(this.layoutDefinition.backgroundColor=t),this.container&&this.container.backgroundColor(this.layoutDefinition.backgroundColor)},t.prototype.setLayoutDisplayType=function(t){t!==this.layoutDefinition.display&&(this.layoutDefinition.display=t),this.container&&this.container.display(this.layoutDefinition.display)},t.prototype.setLayoutFlexType=function(t){t!==this.layoutDefinition.flexDirection&&(this.layoutDefinition.flexDirection=t)},t.prototype.setLayoutElements=function(t){this.layoutElements=t},t.prototype.setLayoutRenderType=function(t){t!==this.layoutDefinition.renderType&&(this.layoutDefinition.renderType=t,console.info("RE_RENDER THE LAYOUT HERE!!!!"),"recon"===t?this.buildReconLayout():this.buildJsonLayout())},t.prototype.setSwimData=function(t){},t.prototype.setSwimDataModel=function(t){},t.prototype.buildJsonLayout=function(){if(console.info("build json layout"),this.layoutDefinition&&(console.info("build json layout"),this.container=tu.create("div").width(this.layoutDefinition.width||"100%").height(this.layoutDefinition.height||"100%").backgroundColor(this.layoutDefinition.backgroundColor||"transparent").display(this.layoutDefinition.display).flexDirection(this.layoutDefinition.flexDirection).position("relative"),this.container.node.innerHTML="",this.parentElem.appendChild(this.container.node),this.layoutElements&&this.layoutElements.length>0))for(var t=0,e=this.layoutElements;t<e.length;t++){var i=e[t];this.renderLayoutElement(i)}},t.prototype.buildReconLayout=function(){console.info("build recon layout"),this.layoutDefinition&&(this.container=tu.create("script").type("script/recon"),this.container.node.innerHTML="",this.parentElem.appendChild(this.container.node))},t.prototype.destroyLayout=function(){if(this.container){for(var t in this.renderedElementCache)this.renderedElementCache[t].remove(),delete this.renderedElementCache[t];this.renderedElementCache=[],this.container.remove(),this.container.removeAll()}},t.prototype.renderLayoutElement=function(t){var e=this.createHtmlElement(t);this.container&&this.container.node.appendChild(e.node)},t.prototype.cacheNewElement=function(t,e){this.renderedElementCache[t]=e},t.prototype.getCachedElement=function(t){return this.renderedElementCache[t]},t.prototype.getLayoutElements=function(){return this.layoutElements},t.prototype.createHtmlElement=function(t){var e=tu.create(t.type);if("svg"===t.type&&(e=Xa.create("svg").width(t.width).height(t.height).viewBox("0 0 "+t.width+" "+t.height)),t.id||(t.id=Ka.newGuid()),e.elemId(t.id),t.width&&"svg"!==t.type&&e.width(t.width),t.height&&"svg"!==t.type&&e.height(t.height),t.content&&e.text(t.content),t.swimAttributes)for(var i=0,r=Object.keys(t.swimAttributes);i<r.length;i++){"function"==typeof e[s=r[i]]?e[s](t.swimAttributes[s]):e.node.setAttribute(s,t.swimAttributes[s])}if(t.htmlAttributes)for(var o=0,n=Object.keys(t.htmlAttributes);o<n.length;o++){var s=n[o];"function"==typeof t.htmlAttributes[s]?e.node[s]=t.htmlAttributes[s]:"path"===s?e.append("path").d(t.htmlAttributes[s]):"polygon"===s?e.append("polygon").points(t.htmlAttributes[s]):e.node.setAttribute(s,t.htmlAttributes[s])}if(t.styleAttributes){for(var a="",u=0,h=Object.keys(t.styleAttributes);u<h.length;u++){a+=(s=h[u])+": "+t.styleAttributes[s]+"; "}e.node.setAttribute("style",a)}if(t.children&&t.children.length>0)for(var l=0,p=t.children;l<p.length;l++){var c=p[l],d=this.createHtmlElement(c);e.append(d)}return this.cacheNewElement(t.id,e),e},t}(),Ja=function(){function t(){}return t.getCachedLayout=function(t,e){var i=t.get(e);return i||(t.set(e,this.getLayout(e)),i=t.get(e)),i},t.getLayout=function(t){return this.layoutList[t]},t.getLayoutList=function(){return Object.keys(this.layoutList)},t.layoutList={addAttributeForm:{title:"New Add Attr Form",style:null,width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"column",layoutElements:[{type:"div",swimAttributes:{width:"100%"},id:"a199175b",styleAttributes:{display:"flex","flex-direction":"column",margin:"15px"},children:[{type:"h2",swimAttributes:{width:"100%"},id:"fc14565c",content:"Add Attribute to Element",styleAttributes:{color:"black",margin:"10px 0 0 0"}},{type:"h3",swimAttributes:{},id:"353ec5b7",content:"error message",htmlAttributes:{},styleAttributes:{color:"red"}},{type:"div",swimAttributes:{},id:"ddb022da",content:"",htmlAttributes:{},styleAttributes:{display:"flex","flex-direction":"row",width:"95%","padding-bottom":"10px",margin:"0px auto"},children:[{type:"h3",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"right",width:"25%","padding-right":"5px",color:"black"},id:"2c102917",content:"Attribute Name"},{type:"input",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,width:"75%","font-size":"27px","background-color":"rgba(155,155,155,0.4)",border:"solid 1px rgba(45,45,45,0.4)","padding-left":"5px"},id:"e299d99c",htmlAttributes:{type:"text"}}]},{type:"div",swimAttributes:{},id:"ddb022db",content:"",htmlAttributes:{},styleAttributes:{display:"flex","flex-direction":"row",width:"95%",margin:"0px auto"},children:[{type:"h3",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"right",width:"25%","padding-right":"5px",color:"black"},id:"88cc7f14",content:"Attribute Value"},{type:"input",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,width:"75%","font-size":"27px","background-color":"rgba(155,155,155,0.4)",border:"solid 1px rgba(45,45,45,0.4)","padding-left":"5px"},id:"01fa2cb7",htmlAttributes:{type:"text"}}]},{type:"div",swimAttributes:{width:"100%",height:"100px"},id:"b6fb0f93",children:[{type:"input",swimAttributes:{},id:"917495b7",content:"Add",styleAttributes:{"flex-grow":"1","font-size":"27px",margin:"20px",padding:"20px 0","background-color":"rgb(43,43,53)",border:"0",color:"white","border-radius":"5px"},htmlAttributes:{type:"button",value:"Add"}},{type:"input",swimAttributes:{},id:"0e315fca",content:"Cancel",styleAttributes:{"font-size":"27px","flex-grow":"1",margin:"20px",padding:"20px 0","background-color":"rgb(43,43,53)",color:"white",border:"0px","border-radius":"5px"},htmlAttributes:{type:"button",value:"Cancel"}}],styleAttributes:{display:"flex","flex-direction":"row"}}]}],id:"6693a2c9"},loadJsonDialog:{title:"Load Layout",style:null,width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"column",layoutElements:[{type:"div",swimAttributes:{width:"100%"},id:"a199175b",styleAttributes:{display:"flex","flex-direction":"column",margin:"15px"},children:[{type:"h2",swimAttributes:{width:"100%"},id:"fc14565c",content:"Load Card Layout",styleAttributes:{color:"black",margin:"10px 0 0 0"}},{type:"h3",swimAttributes:{},id:"353ec5b7",content:"error message",htmlAttributes:{},styleAttributes:{color:"red"}},{type:"textarea",swimAttributes:{},id:"ddb022da",content:"Enter Layout JSON",htmlAttributes:{cols:"60",rows:"15"},styleAttributes:{border:"solid 3px rgba(100,100,100, 0.3)","border-radius":"10px"}},{type:"div",swimAttributes:{width:"100%",height:"100px"},id:"b6fb0f93",children:[{type:"button",swimAttributes:{},id:"3fcd7fab",content:"Load",styleAttributes:{"flex-grow":"1","font-size":"27px",margin:"20px",padding:"20px 0","background-color":"rgb(43,43,53)",border:"0",color:"white","border-radius":"5px"}},{type:"button",swimAttributes:{},id:"0e315fca",content:"Cancel",styleAttributes:{"font-size":"27px","flex-grow":"1",margin:"20px",padding:"20px 0","background-color":"rgb(43,43,53)",color:"white",border:"0px","border-radius":"5px"}}],styleAttributes:{display:"flex","flex-direction":"row"}}]}]},loadListDialog:{title:"Load Layout",style:null,width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"column",layoutElements:[{type:"div",swimAttributes:{width:"100%"},id:"a199175b",styleAttributes:{display:"flex","flex-direction":"column",margin:"15px"},children:[{type:"h2",swimAttributes:{width:"100%"},id:"fc14565c",content:"Load Card Layout",styleAttributes:{color:"black",margin:"10px 0 0 0"}},{type:"h3",swimAttributes:{},id:"353ec5b7",content:"error message",htmlAttributes:{},styleAttributes:{color:"red"}},{type:"div",swimAttributes:{},id:"ddb022da",content:"<list goes here>",htmlAttributes:{},styleAttributes:{border:"solid 3px rgba(100,100,100, 0.3)","border-radius":"10px",height:"270px",overflow:"auto"}},{type:"div",swimAttributes:{width:"100%",height:"100px"},id:"b6fb0f93",children:[{type:"button",swimAttributes:{},id:"0e315fca",content:"Cancel",styleAttributes:{"font-size":"27px","flex-grow":"1",margin:"20px",padding:"20px 0","background-color":"rgb(43,43,53)",color:"white",border:"0px","border-radius":"5px"}}],styleAttributes:{display:"flex","flex-direction":"row"}}]}]},mainLayoutForm:{title:"Layout Form",width:"260px",height:"608px",backgroundColor:"rgb(53,53,53)",display:"flex",flexDirection:"column",layoutElements:[{type:"h3",id:"ee19a133",content:"Layout Info",styleAttributes:{margin:"0 0 18px 0",padding:"12px 0px 4px 8px","background-color":"rgb(42,42,42)","border-top":"solid 1px rgb(42,42,42)","border-bottom":"solid 1px rgba(255,255,255,0.4)","font-size":"22px"},children:[]},{type:"form",swimAttributes:{},id:"1090afd2",content:"",children:[{type:"div",swimAttributes:{},content:"Layout Title",styleAttributes:{"font-size":"18px"},id:"0ac74869"},{type:"input",swimAttributes:{bind:"{{blockTitleValue}}",slot:"value"},htmlAttributes:{type:"text"},styleAttributes:{margin:"3px 0 10px 0","background-color":"rgba(255,255,255,0.1)",background:"rgba(255,255,255,0.1)",border:"solid 1px rgba(255,255,255,0.8)",color:"white","font-size":"20px",padding:"3px","border-radius":"3px","margin-bottom":"10px",width:"95%"},id:"258f66d4"},{type:"div",swimAttributes:{},content:"Layout Width",styleAttributes:{"font-size":"18px"},id:"83fea821"},{type:"input",swimAttributes:{bind:"{{blockWidthValue}}",slot:"value"},htmlAttributes:{type:"text"},styleAttributes:{margin:"3px 0 10px 0","background-color":"rgba(255,255,255,0.1)",background:"rgba(255,255,255,0.1)",border:"solid 1px rgba(255,255,255,0.8)",color:"white","font-size":"20px",padding:"3px","border-radius":"3px","margin-bottom":"10px",width:"95%"},id:"1056f91e"},{type:"div",swimAttributes:{},content:"Layout Height",styleAttributes:{"font-size":"18px"},id:"1707e5cf"},{type:"input",swimAttributes:{bind:"{{blockHeightValue}}",slot:"value"},htmlAttributes:{type:"text"},styleAttributes:{margin:"3px 0 10px 0","background-color":"rgba(255,255,255,0.1)",background:"rgba(255,255,255,0.1)",border:"solid 1px rgba(255,255,255,0.8)",color:"white","font-size":"20px",padding:"3px","border-radius":"3px","margin-bottom":"10px",width:"95%"},id:"e9a054b0"},{type:"div",swimAttributes:{},content:"Background Color",styleAttributes:{"font-size":"18px"},id:"63568108"},{type:"input",swimAttributes:{bind:"{{blockBgColorValue}}",slot:"value"},htmlAttributes:{type:"text"},styleAttributes:{margin:"3px 0 10px 0","background-color":"rgba(255,255,255,0.1)",background:"rgba(255,255,255,0.1)",border:"solid 1px rgba(255,255,255,0.8)",color:"white","font-size":"20px",padding:"3px","border-radius":"3px","margin-bottom":"10px",width:"95%"},id:"bf26f39e"},{type:"div",swimAttributes:{},content:"Layout Display Type",styleAttributes:{"font-size":"18px"},id:"a32edb7c"},{type:"input",swimAttributes:{bind:"{{blockDisplayValue}}",slot:"value"},htmlAttributes:{type:"text"},styleAttributes:{margin:"3px 0 10px 0","background-color":"rgba(255,255,255,0.1)",background:"rgba(255,255,255,0.1)",border:"solid 1px rgba(255,255,255,0.8)",color:"white","font-size":"20px",padding:"3px","border-radius":"3px","margin-bottom":"10px",width:"95%"},id:"ea01c64a"},{type:"div",swimAttributes:{},content:"Layout Flex Type",styleAttributes:{"font-size":"18px"},id:"8bf2625c"},{type:"input",swimAttributes:{bind:"{{blockFlexType}}",slot:"value"},htmlAttributes:{type:"text"},styleAttributes:{margin:"3px 0 10px 0","background-color":"rgba(255,255,255,0.1)",background:"rgba(255,255,255,0.1)",border:"solid 1px rgba(255,255,255,0.8)",color:"white","font-size":"20px",padding:"3px","border-radius":"3px","margin-bottom":"10px",width:"95%"},id:"9e5c85a6"},{type:"div",swimAttributes:{},styleAttributes:{"font-size":"18px"},id:"d23899aa",content:"Render Type (json||recon)"},{type:"input",swimAttributes:{width:"100%"},styleAttributes:{margin:"3px 0 10px 0","background-color":"rgba(255,255,255,0.1)",border:"solid 1px rgba(255,255,255,0.8)",color:"white","font-size":"20px",padding:"3px","border-radius":"3px","margin-bottom":"10px",width:"95%"},id:"933f721d",htmlAttributes:{type:"text"}}],styleAttributes:{padding:"10px"}},{type:"h3",swimAttributes:{},id:"7aada818",content:"Layout Elements",styleAttributes:{margin:"0 0 18px 0",padding:"12px 0 4px 8px","background-color":"rgb(42,42,42)","border-top":"solid 1px rgba(0,0,0,0.8)","border-bottom":"solid 1px rgba(255,255,255,0.4)",position:"relative","font-size":"22px"},children:[{type:"div",swimAttributes:{width:"100%",height:"100px"},id:"27e250a2",content:"+",styleAttributes:{width:"28px",height:"28px",position:"absolute",right:"3px",top:"5px","border-radius":"50%",cursor:"pointer","background-color":"rgba(255,255,255,0.3)","text-align":"center","line-height":"28px",border:"solid 1px rgba(255,255,255,0.8)"},htmlAttributes:{}}]}],keepSynced:!1,renderType:"json"},mainHeaderMenus:{title:"Editor Header Menus",width:"100%",height:"45px",backgroundColor:"rgba(53,53,53,1)",display:"flex",flexDirection:"row",layoutElements:[{type:"div",swimAttributes:{},styleAttributes:{},id:"FileMenuContainer",content:"",children:[{type:"button",swimAttributes:{},styleAttributes:{},id:"e2e1d9a7",content:"File",children:{},htmlAttributes:{class:"dropbtn"}},{type:"div",swimAttributes:{},styleAttributes:{},id:"26bd9978",htmlAttributes:{class:"dropdown-content"},children:[{type:"a",swimAttributes:{},styleAttributes:{},id:"e5bae29c",content:"New  Layout",htmlAttributes:{href:"javascript:pageController.newLayout()"}},{type:"a",swimAttributes:{},styleAttributes:{},id:"933364fc",content:"Load Layout",htmlAttributes:{href:"javascript:pageController.loadLayoutFromService()"}},{type:"a",swimAttributes:{},styleAttributes:{},id:"d451499b",content:"Save Layout",htmlAttributes:{href:"javascript:pageController.saveLayout()"}},{type:"a",swimAttributes:{},styleAttributes:{},id:"adf15cb1",content:"Load Template",htmlAttributes:{href:"javascript:pageController.loadLayoutFromList()"}},{type:"a",swimAttributes:{},styleAttributes:{},id:"e328a3d2",content:"Load from JSON",htmlAttributes:{href:"javascript:pageController.loadLayoutFromJson()"}},{type:"a",swimAttributes:{},styleAttributes:{},id:"ba942fc2",content:"Output JSON",htmlAttributes:{href:"javascript:pageController.debugLayout()"}}]}],htmlAttributes:{class:"dropdown"}},{type:"div",swimAttributes:{},styleAttributes:{},id:"a997a04b",children:[{type:"button",swimAttributes:{},styleAttributes:{},id:"b4b0adbd",content:"Link Config",htmlAttributes:{class:"dropbtn"}},{type:"div",swimAttributes:{},styleAttributes:{},id:"a8ca9f23",htmlAttributes:{class:"dropdown-content"},children:[{type:"a",swimAttributes:{},styleAttributes:{},id:"36a36814",content:"Quilt Link Config",htmlAttributes:{href:"javascript:pageController.showQuiltConfigDialog()"}},{type:"a",swimAttributes:{},styleAttributes:{},id:"c49ea016",content:"Swim Link Config",htmlAttributes:{href:"javascript:pageController.showLinkConfigDialog()"}},{type:"a",swimAttributes:{},styleAttributes:{},id:"faf0659b",content:"Flush Saved Templates",htmlAttributes:{href:"javascript:pageController.flushSavedTemplates()"}}]}],htmlAttributes:{class:"dropdown"}},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,color:"white","line-height":"42px","text-align":"right"},id:"swimHostUrlLabel",content:""},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,color:"white","line-height":"42px"},id:"452d2af0"}],keepSynced:!1},dataLinkConfigForm:{title:"Data Link Config Form",width:"640px",height:"480px",backgroundColor:"transparent",display:"flex",flexDirection:"column",layoutElements:[{type:"div",swimAttributes:{width:"100%"},id:"a199175b",styleAttributes:{display:"flex","flex-direction":"column",margin:"0 15px",height:"75%","flex-grow":"1"},children:[{type:"h2",swimAttributes:{width:"100%"},id:"fc14565c",content:"link config",styleAttributes:{color:"black",margin:"10px 0 0 0"}},{type:"h3",swimAttributes:{},id:"353ec5b7",content:"error message",htmlAttributes:{},styleAttributes:{color:"red"}},{type:"div",swimAttributes:{},id:"ddb022da",content:"",htmlAttributes:{},styleAttributes:{display:"flex","flex-direction":"row",width:"95%","padding-bottom":"10px",margin:"0px auto"},children:[{type:"h3",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"right",width:"25%","padding-right":"5px",color:"black"},content:"Host",id:"140f3854"},{type:"input",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,width:"75%","font-size":"27px","background-color":"rgba(155,155,155,0.4)",border:"solid 1px rgba(45,45,45,0.4)","padding-left":"5px"},htmlAttributes:{type:"text"},id:"96af4f65"}]},{type:"div",swimAttributes:{},id:"ddb022da",content:"",htmlAttributes:{},styleAttributes:{display:"flex","flex-direction":"row",width:"95%","padding-bottom":"10px",margin:"0px auto"},children:[{type:"h3",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"right",width:"25%","padding-right":"5px",color:"black"},id:"2c102917",content:"Node"},{type:"input",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,width:"75%","font-size":"27px","background-color":"rgba(155,155,155,0.4)",border:"solid 1px rgba(45,45,45,0.4)","padding-left":"5px"},id:"e299d99c",htmlAttributes:{type:"text"}}]},{type:"div",swimAttributes:{},id:"ddb022db",content:"",htmlAttributes:{},styleAttributes:{display:"flex","flex-direction":"row",width:"95%",margin:"0px auto","padding-bottom":"10px"},children:[{type:"h3",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"right",width:"25%","padding-right":"5px",color:"black"},id:"88cc7f14",content:"Lane"},{type:"input",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,width:"75%","font-size":"27px","background-color":"rgba(155,155,155,0.4)",border:"solid 1px rgba(45,45,45,0.4)","padding-left":"5px"},id:"01fa2cb7",htmlAttributes:{type:"text"}}]},{type:"div",swimAttributes:{},content:"",htmlAttributes:{},styleAttributes:{display:"flex","flex-direction":"row",width:"95%",margin:"0px auto"},children:[{type:"h3",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"right",width:"25%","padding-right":"5px",color:"black"},content:"Keep Synced",id:"22c76974"},{type:"input",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,width:"75%","font-size":"27px","background-color":"rgba(155,155,155,0.4)",border:"solid 1px rgba(45,45,45,0.4)","padding-left":"5px"},htmlAttributes:{type:"text"},id:"faf17c1c"}],id:"a7000b31"},{type:"div",swimAttributes:{width:"100%",height:"110px"},id:"b6fb0f93",children:[{type:"input",swimAttributes:{},id:"917495b7",content:"",styleAttributes:{"flex-grow":"1","font-size":"27px",margin:"20px",padding:"20px 0","background-color":"rgb(43,43,53)",border:"0",color:"white","border-radius":"5px"},htmlAttributes:{type:"button",value:"Connect"}},{type:"input",swimAttributes:{},id:"0e315fca",content:"Cancel",styleAttributes:{"font-size":"27px","flex-grow":"1",margin:"20px",padding:"20px 0","background-color":"rgb(43,43,53)",color:"white",border:"0px","border-radius":"5px"},htmlAttributes:{type:"button",value:"Done"}}],styleAttributes:{display:"flex","flex-direction":"row"}}]}],hostUrl:null,hostPort:null,node:null,lane:null},quiltConfigForm:{title:"Quilt Config Form",width:"640px",height:"480px",backgroundColor:"transparent",display:"flex",flexDirection:"column",layoutElements:[{type:"div",swimAttributes:{width:"100%"},id:"a199175b",styleAttributes:{display:"flex","flex-direction":"column",margin:"0 15px",height:"75%","flex-grow":"1"},children:[{type:"h2",swimAttributes:{width:"100%"},id:"fc14565c",content:"link config",styleAttributes:{color:"black",margin:"10px 0 0 0"}},{type:"h3",swimAttributes:{},id:"353ec5b7",content:"error message",htmlAttributes:{},styleAttributes:{color:"red"}},{type:"div",swimAttributes:{},id:"ddb022da",content:"",htmlAttributes:{},styleAttributes:{display:"flex","flex-direction":"row",width:"95%","padding-bottom":"10px",margin:"0px auto"},children:[{type:"h3",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"right",width:"25%","padding-right":"5px",color:"black"},content:"Host",id:"140f3854"},{type:"input",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,width:"75%","font-size":"27px","background-color":"rgba(155,155,155,0.4)",border:"solid 1px rgba(45,45,45,0.4)","padding-left":"5px"},htmlAttributes:{type:"text"},id:"96af4f65"}]},{type:"div",swimAttributes:{},id:"ddb022da",content:"",htmlAttributes:{},styleAttributes:{display:"none","flex-direction":"row",width:"95%","padding-bottom":"10px",margin:"0px auto"},children:[{type:"h3",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"right",width:"25%","padding-right":"5px",color:"black"},id:"2c102917",content:"Node"},{type:"input",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,width:"75%","font-size":"27px","background-color":"rgba(155,155,155,0.4)",border:"solid 1px rgba(45,45,45,0.4)","padding-left":"5px"},id:"e299d99c",htmlAttributes:{type:"text"}}]},{type:"div",swimAttributes:{},id:"ddb022db",content:"",htmlAttributes:{},styleAttributes:{display:"flex","flex-direction":"row",width:"95%",margin:"0px auto","padding-bottom":"10px"},children:[{type:"h3",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"right",width:"25%","padding-right":"5px",color:"black"},id:"88cc7f14",content:"Quilt ID"},{type:"input",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,width:"75%","font-size":"27px","background-color":"rgba(155,155,155,0.4)",border:"solid 1px rgba(45,45,45,0.4)","padding-left":"5px"},id:"01fa2cb7",htmlAttributes:{type:"text"}}]},{type:"div",swimAttributes:{width:"100%",height:"110px"},id:"b6fb0f93",children:[{type:"input",swimAttributes:{},id:"917495b7",content:"",styleAttributes:{"flex-grow":"1","font-size":"27px",margin:"20px",padding:"20px 0","background-color":"rgb(43,43,53)",border:"0",color:"white","border-radius":"5px"},htmlAttributes:{type:"button",value:"Update"}},{type:"input",swimAttributes:{},id:"0e315fca",content:"Cancel",styleAttributes:{"font-size":"27px","flex-grow":"1",margin:"20px",padding:"20px 0","background-color":"rgb(43,43,53)",color:"white",border:"0px","border-radius":"5px"},htmlAttributes:{type:"button",value:"Cancel"}}],styleAttributes:{display:"flex","flex-direction":"row"}}]}],hostUrl:null,hostPort:null,node:null,lane:null,keepSynced:!1},flexTestLayout:{title:"flex test layout",style:null,width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"column",layoutElements:[{type:"div",swimAttributes:{},id:"9d2fe39b",styleAttributes:{"background-color":"red",width:"200px",height:"200px",margin:"5px"}},{type:"div",swimAttributes:{width:"100%",height:"100px"},id:"08734296",styleAttributes:{width:"200px",height:"200px","background-color":"blue",margin:"5px"}}]},"@canary":{title:"@Canary Card Layout",width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"row",layoutElements:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1},id:"88181e51",children:[{type:"swim-canary-card",swimAttributes:{width:"100%",header:!1},styleAttributes:{"flex-grow":1,width:"100%",height:"100%"},id:"37a2b719",content:""}]}],hostUrl:null,hostPort:null,node:null,lane:null,keepSynced:!1},"@chart":{title:"@Chart Layout",width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"column",layoutElements:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,display:"flex",height:"90%"},id:"52716243",children:[{type:"swim-time-series",swimAttributes:{width:"100%",height:"100%","gutter-left":"60px","gutter-bottom":"20px",header:!1},styleAttributes:{"flex-grow":1},id:"584d0bee"}]}],hostUrl:null,hostPort:null,node:null,lane:null,keepSynced:!1},"@gauge":{title:"@Gauge Card",width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"column",layoutElements:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":"1",display:"flex",padding:"0px","margin-left":"5%","margin-right":"5%","margin-top":"5%","margin-bottom":"5%"},id:"78bcaa56",content:"",children:[{type:"swim-gauge",swimAttributes:{width:"100%",meter:"{{powerBattery}}",height:"100%","dial-corner":"10",header:!1},styleAttributes:{"flex-grow":1},id:"cd9db6a1",content:""}]}],hostUrl:"",hostPort:"",node:"",lane:"",keepSynced:!1},"@pie":{title:"@Pie chart ",width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"column",layoutElements:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":"1",display:"flex",padding:"0px","margin-left":"0%","margin-right":"0%","margin-top":"0%","margin-bottom":"0%"},id:"78bcaa56",content:"",children:[{type:"swim-pie",swimAttributes:{"inner-radius":"40","outer-radius":"160","tick-radius":"180","tick-length":"240","tick-color":"#667095","label-radius":"135","pad-angle":"0","label-size":"10","label-color":"#ffffff","title-size":"14","title-color":"#7883AA",header:!1},styleAttributes:{"flex-grow":"1"},id:"ab79f9fc",content:""}]}],hostUrl:null,hostPort:null,node:null,lane:null,keepSynced:!1},"@donut":{title:"@Donut pie chart ",width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"column",layoutElements:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":"1",display:"flex",padding:"0px","margin-left":"0%","margin-right":"0%","margin-top":"0%","margin-bottom":"0%"},id:"78bcaa56",content:"",children:[{type:"swim-pie",swimAttributes:{"inner-radius":"40","outer-radius":"160","tick-radius":"180","tick-length":"240","tick-color":"#667095","label-radius":"135","pad-angle":"0","label-size":"10","label-color":"#ffffff","title-size":"14","title-color":"#7883AA",header:!1},styleAttributes:{"flex-grow":"1"},id:"ab79f9fc",content:""}]}],hostUrl:null,hostPort:null,node:null,lane:null,keepSynced:!1},"@treemap":{title:"@Treemap chart",width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"column",layoutElements:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,display:"flex",padding:"0px","margin-left":"2%","margin-right":"2%","margin-top":"2%","margin-bottom":"2%"},id:"fead5c64",content:"",children:[{type:"swim-treemap",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1},id:"31ed4f1c",content:""}]}],hostUrl:"",hostPort:"",node:"",lane:"",keepSynced:!1},loginForm:{title:"Login Form",width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"row",layoutElements:[{type:"div",swimAttributes:{},styleAttributes:{width:"420px",margin:"40px auto",height:"400px","background-color":"rgba(155,155,155,0.2)",display:"flex","flex-direction":"column","border-radius":"5px"},id:"7b8c3d21",children:[{type:"h3",swimAttributes:{width:"100%"},styleAttributes:{padding:"0px 10px"},id:"2cecd57e",content:"UserName"},{type:"input",swimAttributes:{},styleAttributes:{padding:"10px",margin:"0px 10px"},id:"709b0b18",htmlAttributes:{type:"text"}},{type:"h3",swimAttributes:{width:"100%"},styleAttributes:{padding:"0px 10px"},id:"32e98c6a",content:"Password"},{type:"input",swimAttributes:{},styleAttributes:{margin:"0px 10px",padding:"10px"},id:"3586e072",content:"",htmlAttributes:{type:"text"}},{type:"input",swimAttributes:{},styleAttributes:{margin:"20px","font-size":"27px"},id:"f0bdc8ae",htmlAttributes:{type:"button",value:"Login"}}]}],hostUrl:"",hostPort:"",node:"",lane:"",keepSynced:!1},cardMainLayout:{title:"Card Base Layout",width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"row",layoutElements:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,display:"flex",width:"100%",height:"100%","flex-shrink":"0"},id:"85b73a7b",children:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,display:"flex","flex-direction":"column"},id:"b6933185",children:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,display:"flex",height:"5%","flex-direction":"row"},id:"aca40a2a",content:"",children:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,width:"60%",display:"flex"},id:"5cfbae2e",content:"",children:[{type:"swim-text",swimAttributes:{slot:"title"},styleAttributes:{color:"rgb(78,84,108)","padding-top":"0.5%","padding-left":"1.5%"},id:"31fb9ec5",content:"-title-"}],name:"Title"},{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,display:"flex","flex-direction":"row-reverse"},id:"fbb5cd76",content:"",children:[{type:"div",swimAttributes:{},styleAttributes:{color:"rgb(78, 84, 108)",opacity:"0.5","padding-top":"0.5%","padding-right":"2.5%"},id:"c41341e7",content:"ALL SYSTEMS"}],name:"System Name"}],name:"Header Row"},{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,height:"95%",position:"relative"},id:"3baa2621",content:"",children:[{type:"div",swimAttributes:{},styleAttributes:{display:"flex",position:"absolute",top:"0%",bottom:"0%",right:"1.8%",left:"1.8%"},id:"cardChartContainer",name:"chart target"},{type:"div",swimAttributes:{},styleAttributes:{position:"absolute",top:"0px",left:"3.8%",right:"3.8%","border-top":"solid 1px #529fc1",display:"none"},id:"8e021f2b",name:"blue top line"},{type:"swim-text",swimAttributes:{slot:"subtitle"},styleAttributes:{position:"absolute",left:"3.8%",top:"1.6%",opacity:"0"},id:"39be1de1",content:"-subtitle-",name:"subtitle"}],name:"Center Row"},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,height:"1%"},id:"45ab68bf",content:"",name:"footer"}],name:"Padding"}],name:"Main"}],hostUrl:"",hostPort:"",node:"",lane:"",keepSynced:!1},modalMainLayout:{title:"Modal Base Layout",width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"row",layoutElements:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,display:"flex",width:"100%",height:"100%","flex-shrink":"0"},id:"db97694a",children:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,display:"flex","flex-direction":"column"},id:"d37b387d",children:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,display:"flex",height:"10%","flex-direction":"row"},id:"aca40a2a",content:"",children:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,width:"60%",display:"flex","align-items":"center","margin-left":"3.8%"},id:"afd6c1db",content:"",children:[{type:"swim-text",swimAttributes:{slot:"title"},styleAttributes:{"font-size":"24px",color:"rgb(78,84,108)"},id:"a82ff7a1",content:"-title-"}],name:"Title"},{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,display:"flex","flex-direction":"row-reverse","align-items":"center","margin-right":"3.8%"},id:"96480d63",content:"",children:[{type:"swim-text",swimAttributes:{},styleAttributes:{color:"rgb(78, 84, 108)",opacity:"0.5"},id:"7f041834",content:"ALL SYSTEMS"}],name:"System Name"}],name:"Header Row"},{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,height:"80%",position:"relative"},id:"f34fd5cd",content:"",children:[{type:"div",swimAttributes:{},styleAttributes:{display:"flex",position:"absolute",top:"0%",bottom:"0%",right:"3.8%",left:"3.8%"},id:"mainChartContainer",name:"chart target"},{type:"div",swimAttributes:{},styleAttributes:{position:"absolute",top:"0px",left:"3.8%",right:"3.8%","border-top":"solid 1px #529fc1"},id:"34b3d8b3",name:"blue top line"},{type:"swim-text",swimAttributes:{slot:"subtitle"},styleAttributes:{position:"absolute",left:"3.8%",top:"1.6%",opacity:"0"},id:"80f95769",content:"-subtitle-",name:"subtitle"}],name:"Center Row"},{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":"1","flex-direction":"row",display:"flex",position:"relative",height:"15%"},id:"30ab02aa",content:"",children:[{type:"div",swimAttributes:{},styleAttributes:{position:"absolute",top:"0%",bottom:"0%",left:"3.8%",right:"3.8%",display:"flex"},id:"secondChartContainer",content:"",children:[{type:"swim-time-series",swimAttributes:{width:"100%","gutter-left":"0px","gutter-bottom":"0px",header:!1,subheader:!1},styleAttributes:{"flex-grow":1},id:"954dfba4"}],name:"second chart tagget"}],name:"second chart row"},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,height:"5%"},id:"10a281f8",content:"",name:"footer"}],name:"Padding"}],name:"Main"}],hostUrl:"",hostPort:"",node:"",lane:"",keepSynced:!1},moonOverMountainsLayout:{title:"Moon Over Mountains Layout",width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"row",layoutElements:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,display:"flex",width:"100%",height:"100%","flex-shrink":"0"},id:"db97694a",children:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,display:"flex","flex-direction":"column"},id:"d37b387d",children:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,display:"flex",height:"10%","flex-direction":"row"},id:"aca40a2a",content:"",children:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,width:"60%",display:"flex","align-items":"center","margin-left":"3.8%"},id:"afd6c1db",content:"",children:[{type:"swim-text",swimAttributes:{slot:"title"},styleAttributes:{"font-size":"24px",color:"rgb(78,84,108)"},id:"a82ff7a1",content:"-title-"}],name:"Title"},{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,display:"flex","flex-direction":"row-reverse","align-items":"center","margin-right":"3.8%"},id:"96480d63",content:"",children:[{type:"div",swimAttributes:{},styleAttributes:{color:"rgb(78, 84, 108)",opacity:"0.5"},id:"7f041834",content:"ALL SYSTEMS"}],name:"System Name"}],name:"Header Row"},{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,height:"80%",position:"relative"},id:"f34fd5cd",content:"",children:[{type:"div",swimAttributes:{},styleAttributes:{display:"flex",position:"absolute",top:"0%",bottom:"0%",right:"3.8%",left:"3.8%"},id:"mainChartContainer",name:"time series target"},{type:"div",swimAttributes:{},styleAttributes:{position:"absolute",top:"0px",left:"3.8%",right:"3.8%","border-top":"solid 1px #529fc1"},id:"34b3d8b3",name:"blue top line"},{type:"swim-text",swimAttributes:{slot:"subtitle"},styleAttributes:{position:"absolute",left:"3.8%",top:"1.6%",opacity:"0"},id:"80f95769",content:"-subtitle-",name:"subtitle"},{type:"div",swimAttributes:{},styleAttributes:{position:"absolute",width:"40%",height:"40%",top:"0px",right:"0px"},id:"smallChartContainer",name:"small chart target"}],name:"Center Row"},{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":"1","flex-direction":"row",display:"flex",position:"relative",height:"15%"},id:"30ab02aa",content:"",children:[{type:"div",swimAttributes:{},styleAttributes:{position:"absolute",top:"0%",bottom:"0%",left:"3.8%",right:"3.8%",display:"flex"},id:"secondChartContainer",content:"",children:[{type:"swim-time-series",swimAttributes:{width:"100%","gutter-left":"0px","gutter-bottom":"0px",header:!1,subheader:!1},styleAttributes:{"flex-grow":1},id:"954dfba4"}],name:"second chart tagget"}],name:"second chart row"},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,height:"5%"},id:"10a281f8",content:"",name:"footer"}],name:"Padding"}],name:"Main"}],hostUrl:"",hostPort:"",node:"",lane:"",keepSynced:!1},pieChartCard3:{title:"pie chart 1",width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"row",layoutElements:[{type:"swim-pie",swimAttributes:{width:"100%","inner-radius":"0","outer-radius":"60","tick-radius":"80","tick-length":"140","tick-color":"#667095","label-radius":"35","label-size":"10","label-color":"#ffffff","title-size":"14","title-color":"#7883aa"},styleAttributes:{"flex-grow":"1"},id:"13245",content:""}]},boxGraphCard:{title:"block chart",width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"column",layoutElements:[{type:"div",swimAttributes:{},id:"9d2fe39b",styleAttributes:{"flex-grow":"0",height:"6%"},children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,color:"#555c78",margin:"2%"},id:"661d7ca7",content:"Alerts Distribution by Fan Types & Manufacturers - Al"}]},{type:"div",swimAttributes:{},id:"08734296",styleAttributes:{"flex-grow":"1",display:"flex",height:"77%",width:"100%","flex-direction":"row"},children:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":"1",display:"flex","flex-direction":"row",margin:"2%"},id:"440cb5a2",content:"",children:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":"1","background-color":"#d4d7e5",border:"solid 1px #b0b6cf",display:"flex","flex-shrink":"0",width:"33%"},id:"96d6d678",children:[{type:"span",swimAttributes:{},styleAttributes:{"flex-grow":1,"border-right":"solid 1px #b0b6cf",display:"flex",overflow:"hidden","text-align":"center","align-items":"center"},id:"054e1d501",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"center"},id:"24c68b73",content:"Samsung"}],content:""},{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,display:"flex","flex-direction":"column"},id:"9ee59edf",content:"",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":"1.7","border-bottom":"solid 1px #b0b6cf","text-align":"center","align-items":"center",display:"flex"},id:"7bf10628",content:"",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1},id:"75114a32",content:"LG"}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"border-bottom":"solid 1px #b0b6cf",display:"flex","align-items":"center"},id:"d31b2f01",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"center"},id:"41ec8cdf",content:"LTech"}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,display:"flex","align-items":"center"},id:"e2d38b18",content:"",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"center"},id:"c6bcc9cb",content:"TEL"}]}]}]},{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,"background-color":"#e0e2ec",border:"solid 1px #b0b6cf","flex-shrink":"0",display:"flex",width:"33%"},id:"9179933a",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"border-right":"solid 1px #b0b6cf",display:"flex","align-items":"center"},id:"bf5646ce",content:"",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"center"},id:"7d6b584a",content:"Samsung"}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,display:"flex","flex-direction":"column"},id:"5d5ceb7e",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"border-bottom":"solid 1px #b0b6cf",display:"flex","align-items":"center"},id:"ee57a30d",content:"",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"center"},id:"cf495ff3",content:"XPower"}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"border-bottom":"solid 1px #b0b6cf",display:"flex","align-items":"center"},id:"79576306",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"center"},id:"9d8db363",content:"Ltech"}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"border-bottom":"solid 1px #b0b6cf",display:"flex","align-items":"center"},id:"0e3f6374",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"center"},id:"4f77c46e",content:"PG"}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,display:"flex","align-items":"center","border-bottom":"solid 1px #b0b6cf"},id:"f0d5aa9e",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"center"},id:"cbabebc9",content:"TEL"}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,display:"flex","align-items":"center"},id:"a5e75b9c",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"center"},id:"3e0bd773",content:"G5"}]}]}]},{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,"background-color":"#eeeff5",border:"solid 1px #b0b6cf","flex-shrink":"0",display:"flex",width:"33%"},id:"ecc0feee",content:"",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"border-right":"solid 1px #b0b6cf",display:"flex","align-items":"center"},id:"2cba09a0",content:"",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"center"},id:"132e1d3c",content:"LTech"}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,display:"flex","flex-direction":"column"},id:"e6f25067",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"border-bottom":"solid 1px #b0b6cf",display:"flex","align-items":"center"},id:"5e13a780",content:"",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"center"},id:"28a3260a",content:"PG"}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"border-bottom":"solid 1px #b0b6cf",display:"flex","align-items":"center"},id:"1db161ee",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"center"},id:"2213f1e8",content:"TEL"}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,display:"flex","align-items":"center"},id:"dd5fcdb8",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"text-align":"center"},id:"4e02c462",content:"G5"}]}]}]}]}],content:""},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":"0",height:"16%",display:"flex",padding:"0px"},id:"165d28d8",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,margin:"2%",display:"flex"},id:"aad130ae",children:[{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":"1",display:"flex",width:"33%"},id:"6211555d",children:[{type:"div",swimAttributes:{},styleAttributes:{width:"20px"},id:"c47b2767",children:[{type:"div",swimAttributes:{},styleAttributes:{width:"20px",height:"20px","background-color":"#cccfe0",border:"solid 1px #b7bed9"},id:"c8a005dc"}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,padding:"0 0 0 10px",display:"flex","flex-direction":"column"},id:"309e5643",children:[{type:"swim-text",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"font-size":"12px"},id:"3fa0e788",content:"Fan Type 1 (2 blade)"},{type:"swim-text",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"font-size":"12px"},id:"d4e46fc1",content:"51% of types"},{type:"swim-text",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"font-size":"12px"},id:"ca48ae9d",content:"5 Fan dudes"}]}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":"1",display:"flex",width:"33%"},id:"669c77bc",children:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":"0",width:"20px"},id:"b80f830c",children:[{type:"div",swimAttributes:{},styleAttributes:{width:"20px",height:"20px",border:"solid 1px #b7bed9","background-color":"#e0e2ec"},id:"e24df4ae"}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,display:"flex",padding:"0 0 0 10px","flex-direction":"column"},id:"e3502637",children:[{type:"swim-text",swimAttributes:{},styleAttributes:{"flex-grow":1,"font-size":"12px"},id:"ca9b8cf5",content:"Fan Type 2 (3 blade)"},{type:"swim-text",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"font-size":"12px"},id:"108e84d0",content:"26% of Types"},{type:"swim-text",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"font-size":"12px"},id:"6ce8705d",content:"6 Fan Manuf."}]}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":"1",display:"flex",width:"33%"},id:"4090ed1a",children:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":"0",width:"20px"},id:"92414999",children:[{type:"div",swimAttributes:{},styleAttributes:{"flex-grow":1,width:"20px",height:"20px",border:"solid 1px #b7bed9","background-color":"#edeef5"},id:"16a7f5a9"}]},{type:"div",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,display:"flex","flex-direction":"column",padding:"0 0 0 10px"},id:"39d43ef0",children:[{type:"swim-text",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"font-size":"12px"},id:"0e561efe",content:"Fan Type 3 (4 blade)"},{type:"swim-text",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"font-size":"12px"},id:"98a4fda1",content:"23% of Types"},{type:"swim-text",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,"font-size":"12px"},id:"8a370100",content:"5 Fan man"}]}]}]}]},{type:"swim-text",swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1,position:"absolute",top:"3%",right:"2%",color:"rgba(85, 92, 120, 0.4)"},id:"5be728c3",content:"GRPNG"}]}},t}(),$a=function(){function t(t,e){this.unselectedShadow="rgb(0, 0, 0) 0px 0px 0px 0px",this.selectedShadow="rgba(42, 255, 42, 0.5) 0px 0px 0px 5px",this.highlightedShadow="rgba(255, 42, 42, 0.5) 0px 0px 0px 5px",this.titleFieldTagId="258f66d4",this.widthFieldTagId="1056f91e",this.widthTitleTagId="83fea821",this.heightFieldTagId="e9a054b0",this.heightTitleTagId="1707e5cf",this.bgColorFieldTagId="bf26f39e",this.bgColorTitleTagId="63568108",this.addElementButtonTagId="27e250a2",this.displayTypeTitleTagId="a32edb7c",this.displayTypeFieldTagId="ea01c64a",this.flexTypeTitleTagId="8bf2625c",this.flexTypeFieldTagId="9e5c85a6",this.renderTypeTitleTagId="d23899aa",this.renderTypeFieldTagId="933f721d",this.swimHostUrlLabelId="swimHostUrlLabel",this.swimDataKeysLabelId="452d2af0",this.hostInputFieldId="96af4f65",this.nodeInputFieldId="e299d99c",this.laneInputFieldId="01fa2cb7",this.submitButtonId="917495b7",this.cancelButtonId="0e315fca",this.errorMessageId="353ec5b7",this.titleMessageId="fc14565c",this.keepSyncedFieldId="faf17c1c",this.quiltIdInputFieldId="01fa2cb7",this.nameInputFieldId="e299d99c",this.valueInputFieldId="01fa2cb7",this.loadButtonId="3fcd7fab",this.textAreaInputFieldId="ddb022da",this.addAttributeForm=Ja.getLayout("addAttributeForm"),this.loadJsonDialog=Ja.getLayout("loadJsonDialog"),this.loadListDialog=Ja.getLayout("loadListDialog"),this.mainHeaderMenus=Ja.getLayout("mainHeaderMenus"),this.mainLayoutForm=Ja.getLayout("mainLayoutForm"),this.dataLinkConfigForm=Ja.getLayout("dataLinkConfigForm"),this.quiltConfigForm=Ja.getLayout("quiltConfigForm"),this.flexTestLayout=Ja.getLayout("flexTestLayout"),this.swimLayoutLinkConfig={isSecure:!1,hostUrl:"auto2.swim.services",hostPort:"",node:"/quilt/martin_quilt",lane:"layouts",keepSynced:!0},this.swimDataConfig={isSecure:!1,hostUrl:"",hostPort:"",node:"",lane:"",keepSynced:!1},this.loadJsonDialog=Ja.getLayout("loadJsonDialog"),this.parentElem=t,this.editorPanelDefinition=Ja.getLayout("mainLayoutForm"),this.swimDataSet=e,this.buildBaseEditorLayout(),this.buildLayoutEditorForm(),this.newLayout()}return t.prototype.saveLayout=function(){var t=this.activeLayoutRenderTrack.getLayoutDefinition();t.id||(t.id=Ka.newGuid());var e={id:t.id,title:t.title,width:t.width,height:t.height,backgroundColor:t.backgroundColor,display:t.display,flexDirection:t.flexDirection,layoutElements:t.layoutElements||[],hostUrl:this.swimDataConfig.hostUrl,hostPort:this.swimDataConfig.hostPort,node:this.swimDataConfig.node,lane:this.swimDataConfig.lane,keepSynced:this.swimDataConfig.keepSynced,renderType:t.renderType};this.swimLayoutLink.set(t.id,e)},t.prototype.buildEditorHeader=function(){var t=tu.create("div");this.headerMenuElement=t.renderLayout(this.mainHeaderMenus);var e=document.getElementById("headerNavigation");e&&e.appendChild(t.node)},t.prototype.openSwimDataLink=function(){var t=this;if(this.headerMenuElement&&this.swimDataConfig&&""!==this.swimDataConfig.hostUrl){var e=this.headerMenuElement.getCachedElement(this.swimHostUrlLabelId),i=this.headerMenuElement.getCachedElement(this.swimDataKeysLabelId);e&&i&&(e.node.innerText="swim://"+this.swimDataConfig.hostUrl+":"+this.swimDataConfig.hostPort+this.swimDataConfig.node+"/"+this.swimDataConfig.lane,i.node.innerHTML=""),this.swimDataConfig.didUpdate=function(e,r){if(t.swimDataLink&&t.updateLayoutDataset(r),t.headerMenuElement&&i&&t.swimDataLink&&r&&""===i.node.innerHTML)for(var o in i.node.innerHTML="&nbsp;<i>Bindings:</i>&nbsp;",r)i.node.innerHTML+="&nbsp;{{"+o+"}}&nbsp;"},this.swimDataLink&&this.swimDataLink.isConnected()&&this.swimDataLink.close()}},t.prototype.buildBaseEditorLayout=function(){this.buildEditorHeader(),this.leftColumnElementTrack=tu.create("div").elemId("leftColumn"),this.workspaceElementTrack=tu.create("div").elemId("workspace"),this.rightColumnElementTrack=tu.create("div").elemId("rightColumn"),this.parentElem.appendChild(this.leftColumnElementTrack.node),this.parentElem.appendChild(this.workspaceElementTrack.node),this.parentElem.appendChild(this.rightColumnElementTrack.node)},t.prototype.buildLayoutEditorForm=function(){var t=this;this.editorFormRenderTrack=this.leftColumnElementTrack.renderLayout(this.mainLayoutForm);var e=this.editorFormRenderTrack.getCachedElement(this.titleFieldTagId),i=this.editorFormRenderTrack.getCachedElement(this.widthFieldTagId),r=this.editorFormRenderTrack.getCachedElement(this.widthTitleTagId),o=this.editorFormRenderTrack.getCachedElement(this.heightFieldTagId),n=this.editorFormRenderTrack.getCachedElement(this.heightTitleTagId),s=this.editorFormRenderTrack.getCachedElement(this.bgColorFieldTagId),a=this.editorFormRenderTrack.getCachedElement(this.bgColorTitleTagId),u=this.editorFormRenderTrack.getCachedElement(this.displayTypeFieldTagId),h=this.editorFormRenderTrack.getCachedElement(this.flexTypeFieldTagId),l=this.editorFormRenderTrack.getCachedElement(this.addElementButtonTagId),p=this.editorFormRenderTrack.getCachedElement(this.renderTypeTitleTagId),c=this.editorFormRenderTrack.getCachedElement(this.renderTypeFieldTagId),d=function(e,i){if(i){var o=i;if(o&&o.srcElement&&o.srcElement.value){var s=o.srcElement.value;switch(e){case"title":t.updateLayoutTitle(s);break;case"width":try{qo.parse(s)instanceof Object&&(t.updateLayoutWidth(s),r&&r.color(Qo.parse("rgb(214,214,214)")))}catch(t){r&&r.color(Qo.parse("rgb(255,0,0)"))}break;case"height":try{qo.parse(s)instanceof Object&&(t.updateLayoutHeight(s),n&&n.color(Qo.parse("rgb(214,214,214)")))}catch(t){n&&n.color(Qo.parse("rgb(255,0,0)"))}break;case"bgColor":try{Qo.parse(s)&&t.updateLayoutBackgroundColor(s),a&&a.color(Qo.parse("rgb(214,214,214)"))}catch(t){a&&a.color(Qo.parse("rgb(255,0,0)"))}break;case"displayType":t.updateLayoutDisplayType(s);break;case"flexType":t.updateLayoutFlexType(s);break;case"renderType":"json"===s||"recon"===s?(t.updateLayoutRenderType(s),p&&p.color(Qo.parse("rgb(214,214,214)"))):p&&p.color(Qo.parse("rgb(255,0,0)"))}}}};e&&e.on("keyup",function(t){d("title",t)}),i&&i.on("keyup",function(t){d("width",t)}),o&&o.on("keyup",function(t){d("height",t)}),s&&s.on("keyup",function(t){d("bgColor",t)}),u&&u.on("keyup",function(t){d("displayType",t)}),h&&h.on("keyup",function(t){d("flexType",t)}),c&&c.on("keyup",function(t){d("renderType",t)}),l&&l.on("mouseup",function(e){t.addNewLayoutElement("div")})},t.prototype.buildLayoutAttributePanelLists=function(){this.removeLayoutAttributePanel(),this.layoutAttributesPanelTrack=tu.create("div"),this.buildLayoutAttributePanel("Core Attributes"),this.buildLayoutAttributePanel("Swim Attributes","swimAttributes"),this.buildLayoutAttributePanel("HTML Attributes","htmlAttributes"),this.buildLayoutAttributePanel("Style Attributes","styleAttributes"),this.rightColumnElementTrack.append(this.layoutAttributesPanelTrack)},t.prototype.buildLayoutAttributePanel=function(t,e,i){var r=this;void 0===e&&(e="core"),void 0===i&&(i=!1);var o=null;o="core"===e?{id:this.selectedLayoutData.id,name:this.selectedLayoutData.name||"",type:this.selectedLayoutData.type,content:this.selectedLayoutData.content||""}:this.selectedLayoutData[e];var n=tu.create("div").elemId("attributePanel"),s=tu.create("h3").text(t),a=tu.create("div").className("addElementButton").text("+");a.node.onmouseup=function(t){r.showAddAttributeDialog(function(t,i){t&&i&&r.addElementAttribute(e,t,i)})},s.append(a),n.append(s);var u=1,h=tu.create("div");if(i&&(h.append(this.buildAttributeRow(e,"type",this.selectedLayoutData.type)),this.selectedLayoutData.content)){var l=this.buildAttributeRow(e,"content",this.selectedLayoutData.content);l.node.style.backgroundColor="rgba(200, 200, 200, 0.2)",u++,h.append(l)}if(o)for(var p=0,c=Object.keys(o);p<c.length;p++){var d=c[p],f=o[d],y=this.buildAttributeRow(e,d,f);u%2==1&&(y.node.style.backgroundColor="rgba(200, 200, 200, 0.2)"),h.append(y),u++}n.append(h),this.layoutAttributesPanelTrack&&this.layoutAttributesPanelTrack.append(n)},t.prototype.flushSavedTemplates=function(){var t=this;confirm("This will reset all saved templates. Are you sure?")&&this.swimLayoutLink.forEach(function(e){var i=Ja.getLayout(e);i&&t.swimLayoutLink.set(e,i)})},t.prototype.showLinkConfigDialog=function(t){var e=this,i=this.spawnDialog(this.dataLinkConfigForm);if(i){var r=i.getCachedElement(this.hostInputFieldId),o=i.getCachedElement(this.nodeInputFieldId),n=i.getCachedElement(this.laneInputFieldId),s=i.getCachedElement(this.submitButtonId),a=i.getCachedElement(this.cancelButtonId),u=i.getCachedElement(this.errorMessageId),h=i.getCachedElement(this.titleMessageId),l=i.getCachedElement(this.keepSyncedFieldId);r&&o&&s&&n&&a&&u&&h&&l&&(h.text("Configure swim data link"),u.text(""),""!==this.swimDataConfig.hostPort?r.node.value=this.swimDataConfig.hostUrl+":"+this.swimDataConfig.hostPort:r.node.value=""+this.swimDataConfig.hostUrl,o.node.value=this.swimDataConfig.node,n.node.value=this.swimDataConfig.lane,l.node.value=this.swimDataConfig.keepSynced,r.node.focus(),s.on("click",function(t){var i=r.node.value;if(i&&i.indexOf(":")>=0){var s=i.split(":");e.swimDataConfig.hostUrl=s[0],e.swimDataConfig.hostPort=s[1]}else e.swimDataConfig.hostUrl=i,e.swimDataConfig.hostPort="";e.swimDataConfig.node=o.node.value,e.swimDataConfig.lane=n.node.value,e.swimDataConfig.keepSynced=l.node.value,u.node.innerHTML="<span style='color:black'>Connecting Link...</span>",e.swimDataConfig.didUnlink=function(){u.node.innerHTML="Link disconected due to error"},e.swimDataConfig.didFail=function(){u.node.innerHTML="Link failed to connect"},e.swimDataConfig.didLink=function(){u.node.innerHTML="<span style='color:green'>Link Connected</span>"},e.openSwimDataLink()}),a.on("click",function(t){e.swimDataConfig.didUnlink=null,e.swimDataConfig.didLink=null,e.swimDataConfig.didUpdate=function(t){e.swimDataLink&&e.updateLayoutDataset(e.swimDataLink.get(t))}}))}},t.prototype.showQuiltConfigDialog=function(){var t=this,e=this.spawnDialog(this.quiltConfigForm);if(e){var i=e.getCachedElement(this.hostInputFieldId),r=e.getCachedElement(this.nodeInputFieldId),o=e.getCachedElement(this.quiltIdInputFieldId),n=e.getCachedElement(this.submitButtonId),s=e.getCachedElement(this.cancelButtonId),a=e.getCachedElement(this.errorMessageId),u=e.getCachedElement(this.titleMessageId);i&&r&&n&&o&&s&&a&&u&&(u.text("Configure Quilt"),a.text(""),""!==this.swimLayoutLinkConfig.hostPort?i.node.value=this.swimLayoutLinkConfig.hostUrl+":"+this.swimLayoutLinkConfig.hostPort:i.node.value=""+this.swimLayoutLinkConfig.hostUrl,o.node.value=this.swimLayoutLinkConfig.node.replace("/quilt/",""),i.node.focus(),n.on("click",function(e){var r=i.node.value;if(r&&r.indexOf(":")>=0){var n=r.split(":");t.swimLayoutLinkConfig.hostUrl=n[0],t.swimLayoutLinkConfig.hostPort=n[1]}else t.swimLayoutLinkConfig.hostUrl=r,t.swimLayoutLinkConfig.hostPort="";t.swimLayoutLinkConfig.node="/quilt/"+o.node.value,t.swimLayoutLink.close()}),s.on("click",function(t){}))}},t.prototype.showAddAttributeDialog=function(t){if(null!==this.loadJsonDialog){var e=this.spawnDialog(this.addAttributeForm);if(e){var i=e.getCachedElement(this.nameInputFieldId),r=e.getCachedElement(this.valueInputFieldId),o=e.getCachedElement(this.submitButtonId),n=e.getCachedElement(this.cancelButtonId),s=e.getCachedElement(this.errorMessageId);i&&o&&r&&n&&s&&(s.text(""),o.on("click",function(e){var o=i.node.value,n=r.node.value;t(o,n)}),n.on("click",function(t){}))}}},t.prototype.buildAttributeRow=function(t,e,i){var r=this,o=tu.create("div").className("attributeRow").display("flex").flexDirection("row"),n=tu.create("div").text(e).className("rowKey"),s=tu.create("span").className("removeElementButton").text("-");n.append(s),s.node.onmouseup=function(i){confirm("Are you sure you want to delete this element?\r\nThis will also remove any child elements as well and can not be undone")&&r.deleteElementAttribute(t,e)&&o.remove(),i.preventDefault()};var a=tu.create("div").text(i).className("rowValue");return a.node.setAttribute("contenteditable","true"),a.node.onkeyup=function(i){r.updateSelectedLayoutAttribute(t,e,a.node.innerText)},o.append(n),o.append(a),o},t.prototype.updateSelectedLayoutAttribute=function(t,e,i){var r=!1;if("core"===t)switch(e){case"type":if(""===i)break;this.selectedLayoutData.type!==i&&(this.selectedLayoutData.type=i,r=!0);break;case"name":this.selectedLayoutData.name!==i&&(this.selectedLayoutData.name=i,r=!0);break;case"content":this.selectedLayoutData.content!==i&&(this.selectedLayoutData.content=i,r=!0);break;case"id":this.selectedLayoutData.id!==i&&(this.selectedLayoutData.id=i,r=!0)}else{var o=this.selectedLayoutData[t];o[e]!==i&&(o[e]=i,r=!0)}r&&(this.clearWorkspace(!1),this.setLayoutDefinition(this.activeLayoutDefinition),r=!1)},t.prototype.removeLayoutAttributePanel=function(){this.layoutAttributesPanelTrack&&(this.rightColumnElementTrack.remove(this.layoutAttributesPanelTrack),this.layoutAttributesPanelTrack=null)},t.prototype.loadLayoutFromJson=function(){var t=this;if(null!==this.loadJsonDialog){var e=this.spawnDialog(this.loadJsonDialog);if(e){var i=e.getCachedElement(this.loadButtonId),r=e.getCachedElement(this.cancelButtonId),o=e.getCachedElement(this.textAreaInputFieldId),n=e.getCachedElement(this.errorMessageId);i&&r&&o&&n&&(n.text(""),i.on("click",function(e){try{t.clearWorkspace(!0),t.setLayoutDefinition(JSON.parse(o.node.value))}catch(t){return void n.text(t.toString())}}),r.on("click",function(t){}))}}},t.prototype.loadLayoutFromList=function(){var t=this;if(null!==this.loadJsonDialog){var e=this.spawnDialog(this.loadListDialog);if(e){var i=e.getCachedElement(this.cancelButtonId),r=e.getCachedElement(this.textAreaInputFieldId),o=e.getCachedElement(this.errorMessageId);if(i&&r&&o){var n=Ja.getLayoutList();r.node.innerHTML="";for(var s=function(e){var i=tu.create("li").width("100%").padding("10px").text(e).color(Qo.parse("black")).on("mouseover",function(){i.backgroundColor("rgba(0,0,0,0.3)")}).on("mouseout",function(){i.backgroundColor("transparent")}).on("click",function(){t.clearWorkspace(!0),t.setLayoutDefinition(Ja.getLayout(e))});r.append(i)},a=0,u=n;a<u.length;a++){s(u[a])}o.text(""),i.on("click",function(t){})}}}},t.prototype.loadLayoutFromService=function(){var t=this;if(null!==this.loadJsonDialog){var e=this.spawnDialog(this.loadListDialog);if(e){var i=e.getCachedElement(this.cancelButtonId),r=e.getCachedElement(this.textAreaInputFieldId),o=e.getCachedElement(this.errorMessageId);i&&r&&o&&(r.node.innerHTML="",this.swimLayoutLink.forEach(function(e){var i=t.swimLayoutLink.get(e);if(i){i.id=e;var o=tu.create("li").width("100%").padding("10px").text(i.title||"No Title").color(Qo.parse("black")).on("mouseover",function(){o.backgroundColor("rgba(0,0,0,0.3)")}).on("mouseout",function(){o.backgroundColor("transparent")}).on("click",function(){t.clearWorkspace(!0),t.setLayoutDefinition(i)});r.append(o)}}),o.text(""),i.on("click",function(t){}))}}},t.prototype.newLayout=function(){this.clearWorkspace(!0);var t={id:Ka.newGuid(),title:"New layout",width:"100%",height:"100%",backgroundColor:"transparent",display:"flex",flexDirection:"row",layoutElements:null,hostUrl:"",hostPort:"",node:"",lane:"",keepSynced:!1,renderType:"json"};this.setLayoutDefinition(t)},t.prototype.debugLayout=function(){var t=this.activeLayoutRenderTrack.getLayoutDefinition(),e={id:t.id,title:t.title,width:t.width,height:t.height,backgroundColor:t.backgroundColor,display:t.display,flexDirection:t.flexDirection,layoutElements:t.layoutElements||[],hostUrl:this.swimDataConfig.hostUrl,hostPort:this.swimDataConfig.hostPort,node:this.swimDataConfig.node,lane:this.swimDataConfig.lane,keepSynced:this.swimDataConfig.keepSynced,renderType:"json"};console.log(JSON.stringify(e))},t.prototype.clearWorkspace=function(t){void 0===t&&(t=!1),this.activeLayoutRenderTrack&&this.activeLayoutRenderTrack.destroyLayout(),t&&this.selectLayoutElement()},t.prototype.updateLayoutTitle=function(t){t!==this.activeLayoutDefinition.title&&(this.activeLayoutDefinition.title=t,this.activeLayoutRenderTrack.setLayoutTitle(this.activeLayoutDefinition.title))},t.prototype.updateLayoutWidth=function(t){t!==this.activeLayoutDefinition.width&&(this.activeLayoutDefinition.width=t,this.activeLayoutRenderTrack.setLayoutWidth(this.activeLayoutDefinition.width))},t.prototype.updateLayoutHeight=function(t){t!==this.activeLayoutDefinition.height&&(this.activeLayoutDefinition.height=t,this.activeLayoutRenderTrack.setLayoutHeight(this.activeLayoutDefinition.height))},t.prototype.updateLayoutBackgroundColor=function(t){t!==this.activeLayoutDefinition.backgroundColor&&(this.activeLayoutDefinition.backgroundColor=t,this.activeLayoutRenderTrack.setLayoutBackground(this.activeLayoutDefinition.backgroundColor))},t.prototype.updateLayoutDisplayType=function(t){t!==this.activeLayoutDefinition.backgroundColor&&(this.activeLayoutDefinition.display=t,this.activeLayoutRenderTrack.setLayoutDisplayType(this.activeLayoutDefinition.display))},t.prototype.updateLayoutFlexType=function(t){t!==this.activeLayoutDefinition.flexDirection&&(this.activeLayoutDefinition.flexDirection=t,this.activeLayoutRenderTrack.setLayoutFlexType(this.activeLayoutDefinition.flexDirection))},t.prototype.updateLayoutDataset=function(t){this.swimDataSet=t,this.editorFormRenderTrack.setSwimData(this.swimDataSet)},t.prototype.updateLayoutRenderType=function(t){t!==this.activeLayoutDefinition.flexDirection&&(this.activeLayoutDefinition.renderType=t,this.activeLayoutRenderTrack.setLayoutRenderType(this.activeLayoutDefinition.renderType||"json"))},t.prototype.setLayoutDataValue=function(t){for(var e=0,i=t;e<i.length;e++){var r=i[e],o=r[0],n=r[1];this.swimDataSet[o]=n}this.activeLayoutRenderTrack.setSwimData(this.swimDataSet),this.editorFormRenderTrack.setSwimData(this.swimDataSet)},t.prototype.setLayoutDefinition=function(t){if(this.activeLayoutDefinition=t,this.activeLayoutDefinition){this.activeLayoutRenderTrack=new Za(this.workspaceElementTrack.node),this.activeLayoutRenderTrack.setLayoutDefinition(this.activeLayoutDefinition),this.activeLayoutDefinition.renderType&&"recon"===this.activeLayoutDefinition.renderType?this.activeLayoutRenderTrack.buildReconLayout():this.activeLayoutRenderTrack.buildJsonLayout(),this.buildLayoutElementList(this.activeLayoutRenderTrack.getLayoutElements());var e=this.editorFormRenderTrack.getCachedElement(this.titleFieldTagId),i=this.editorFormRenderTrack.getCachedElement(this.widthFieldTagId),r=this.editorFormRenderTrack.getCachedElement(this.heightFieldTagId),o=this.editorFormRenderTrack.getCachedElement(this.bgColorFieldTagId),n=this.editorFormRenderTrack.getCachedElement(this.displayTypeFieldTagId),s=this.editorFormRenderTrack.getCachedElement(this.flexTypeFieldTagId),a=this.editorFormRenderTrack.getCachedElement(this.renderTypeFieldTagId);if(e&&(e.node.value=this.activeLayoutDefinition.title),i&&(i.node.value=this.activeLayoutDefinition.width),r&&(r.node.value=this.activeLayoutDefinition.height),o&&(o.node.value=this.activeLayoutDefinition.backgroundColor),n&&(n.node.value=this.activeLayoutDefinition.display),s&&(s.node.value=this.activeLayoutDefinition.flexDirection),a&&(a.node.value=this.activeLayoutDefinition.renderType||"json"),this.swimDataConfig.hostUrl=this.activeLayoutDefinition.hostUrl,this.swimDataConfig.hostPort=this.activeLayoutDefinition.hostPort,this.swimDataConfig.node=this.activeLayoutDefinition.node,this.swimDataConfig.lane=this.activeLayoutDefinition.lane,this.headerMenuElement){var u=this.headerMenuElement.getCachedElement("swimHostUrlLabel"),h=this.headerMenuElement.getCachedElement("452d2af0");u&&h&&(u.node.innerText="",h.node.innerHTML="")}this.swimDataLink&&this.swimDataLink.close&&this.swimDataLink.close(),this.swimDataConfig.hostUrl&&""!==this.swimDataConfig.hostUrl&&this.openSwimDataLink()}},t.prototype.buildLayoutElementList=function(t){this.layoutElementListTrack&&null!==this.layoutElementListTrack&&this.layoutElementListTrack.remove(),this.layoutElementListTrack=tu.create("div").elemId("layoutElementListContainer").overflow("auto"),this.leftColumnElementTrack.append(this.layoutElementListTrack);var e=[{type:"root",id:"root",children:t}];e&&this.outputLayoutElementsListItems(e,this.layoutElementListTrack)},t.prototype.selectLayoutElement=function(t,e){void 0===t&&(t=null),void 0===e&&(e=null),console.info(t,e),this.selectedLayoutElement&&(this.selectedLayoutElement.node.style.boxShadow=this.unselectedShadow,this.selectedLayoutElement=null),this.selectedLayoutElement&&(this.selectedLayoutElement.node.className="",this.selectedLayoutElement=null),e&&(this.selectedLayoutElement=e,this.selectedLayoutElement.node.className="selected");var i=null;t&&"root"!==t.id&&(i=this.activeLayoutRenderTrack.getCachedElement(t.id)),i?(this.selectedLayoutData=t,this.selectedLayoutElement=i,this.selectedLayoutElement.node.style.boxShadow=this.selectedShadow,this.buildLayoutAttributePanelLists()):(this.selectedLayoutData=null,this.selectedLayoutElement=null,this.removeLayoutAttributePanel())},t.prototype.removeElementHightlight=function(){this.selectedLayoutElement&&this.highlightedLayoutElement&&this.selectedLayoutElement.node.id===this.highlightedLayoutElement.node.id||this.highlightedLayoutElement&&(this.highlightedLayoutElement.node.style.boxShadow=this.unselectedShadow,this.highlightedLayoutElement=null)},t.prototype.highlightLayoutElement=function(t){t&&this.selectedLayoutElement&&this.selectedLayoutElement.node.id===t.node.id||(this.highlightedLayoutElement&&this.removeElementHightlight(),this.highlightedLayoutElement=t,this.highlightedLayoutElement&&(this.highlightedLayoutElement.node.style.boxShadow=this.highlightedShadow))},t.prototype.addNewLayoutElement=function(t){void 0===t&&(t="div");var e={type:t,swimAttributes:{width:"100%"},styleAttributes:{"flex-grow":1}};if(this.selectedLayoutElement){var i=this.findLayoutElementById(this.selectedLayoutElement.node.id,this.activeLayoutDefinition.layoutElements);i.children&&i.children.length||(i.children=[]),i.children.push(e)}else null===this.activeLayoutDefinition.layoutElements?(this.activeLayoutDefinition.layoutElements=[],this.activeLayoutDefinition.layoutElements.push(e)):this.activeLayoutDefinition.layoutElements.push(e);this.clearWorkspace(!1),this.activeLayoutRenderTrack.setLayoutDefinition(this.activeLayoutDefinition),this.activeLayoutDefinition.renderType&&"recon"===this.activeLayoutDefinition.renderType?this.activeLayoutRenderTrack.buildReconLayout():this.activeLayoutRenderTrack.buildJsonLayout(),this.buildLayoutElementList(this.activeLayoutRenderTrack.getLayoutElements())},t.prototype.addElementAttribute=function(t,e,i){if(void 0===e&&(e="newAttr"),void 0===i&&(i=""),"style"!==e&&"id"!==e)if(""!==e){if(this.selectedLayoutElement){var r=this.findLayoutElementById(this.selectedLayoutElement.node.id,this.activeLayoutDefinition.layoutElements);if("content"===e)r.hasOwnProperty("content")?alert("content already exists"):r.content="new content";else if(r[t]||(r[t]={}),r[t].hasOwnProperty(e))alert("Attribute '"+e+"' already exists");else r[t][e]=i;this.buildLayoutAttributePanelLists(),this.clearWorkspace(!1),this.activeLayoutDefinition.renderType&&"recon"===this.activeLayoutDefinition.renderType?this.activeLayoutRenderTrack.buildReconLayout():this.activeLayoutRenderTrack.buildJsonLayout(),this.buildLayoutElementList(this.activeLayoutRenderTrack.getLayoutElements())}}else alert("Enter an attribute name.");else alert("You can not set the "+e+" manually")},t.prototype.findLayoutElementById=function(t,e){for(var i=null,r=0,o=e;r<o.length;r++){var n=o[r];if(null!==i)break;n.id===t&&(i=n),n.children&&null===i&&(i=this.findLayoutElementById(t,n.children))}return i},t.prototype.findParentElementById=function(t,e,i){void 0===e&&(e=this.activeLayoutDefinition.layoutElements),void 0===i&&(i=null);for(var r=null,o=0,n=e;o<n.length;o++){var s=n[o];if(null!==r)break;s.id===t&&(r=i),s.children&&null===r&&(r=this.findParentElementById(t,s.children,s))}return r},t.prototype.deleteChildElement=function(t,e){if(this.selectLayoutElement(),t){o=[];for(var i=0,r=t.children;i<r.length;i++){(a=r[i]).id!==e.id&&o.push(a)}t.children=o}else{for(var o=[],n=0,s=this.activeLayoutDefinition.layoutElements;n<s.length;n++){var a;(a=s[n]).id!==e.id&&o.push(a)}this.activeLayoutDefinition.layoutElements=o,this.activeLayoutRenderTrack.setLayoutDefinition(this.activeLayoutDefinition)}this.buildLayoutElementList(this.activeLayoutRenderTrack.getLayoutElements()),this.clearWorkspace(!0),this.activeLayoutDefinition.renderType&&"recon"===this.activeLayoutDefinition.renderType?this.activeLayoutRenderTrack.buildReconLayout():this.activeLayoutRenderTrack.buildJsonLayout()},t.prototype.deleteElementAttribute=function(t,e){if("core"===t)return alert("You can not delete core attributes."),!1;var i={},r=this.selectedLayoutData[t];for(var o in r)o!==e&&(i[o]=r[o]);return this.selectedLayoutData[t]=i,this.clearWorkspace(!1),this.activeLayoutDefinition.renderType&&"recon"===this.activeLayoutDefinition.renderType?this.activeLayoutRenderTrack.buildReconLayout():this.activeLayoutRenderTrack.buildJsonLayout(),!0},t.prototype.spawnDialog=function(t){return null},t.prototype.outputLayoutElementsListItems=function(t,e,i){var r=this;void 0===i&&(i=0);for(var o=0,n=function(e){var n="",a="";if(0!==i&&(n=++o!==t.length||e.children?"├":"└"),i>=2)for(var u=1;u<i;u++)a+="─";var h=e.name?""+e.name:"<"+e.type+">",l=tu.create("div").text(""+n+a+" "+h);l.node&&(l.node.id=e.id);var p=tu.create("span").className("removeElementButton").text("-");if(s.selectedLayoutElement&&s.selectedLayoutElement.node.id===e.id?(s.selectedLayoutElement=l,l.className("selected")):s.selectedLayoutElement||"root"!==e.id?l.className(""):(s.selectedLayoutElement=l,l.className("selected")),"root"!==e.id&&(p.node.onmouseup=function(t){if(confirm("Are you sure you want to delete this element?\r\nThis will also remove any child elements as well and can not be undone")){var i=r.findParentElementById(e.id);r.deleteChildElement(i,e)}t.preventDefault(),t.stopPropagation()},l.append(p)),l.node.onmouseover=function(t){"root"===e.id?r.highlightLayoutElement(r.workspaceElementTrack):r.highlightLayoutElement(r.activeLayoutRenderTrack.getCachedElement(e.id)),t.preventDefault(),t.stopPropagation()},l.node.onmouseout=function(t){r.removeElementHightlight(),t.preventDefault(),t.stopPropagation()},l.node.onmouseup=function(t){"root"===e.id?r.selectLayoutElement(null,l):r.selectLayoutElement(e,l),t.preventDefault(),t.stopPropagation()},s.layoutElementListTrack.append(l),e.children&&e.children.length>0){var c=i+1;s.outputLayoutElementsListItems(e.children,l,c)}},s=this,a=0,u=t;a<u.length;a++){n(u[a])}},t}(),tu=function(t){function e(e,i){return t.call(this,e,i)||this}return u(e,t),e.prototype.width=function(t,e){return this.styleLengthEnum("width",t,e,gs.REQUIRES_RESIZE)},e.prototype.minWidth=function(t,e){return this.styleLengthEnum("min-width",t,e)},e.prototype.maxWidth=function(t,e){return this.styleLengthEnum("max-width",t,e)},e.prototype.height=function(t,e){return this.styleLengthEnum("height",t,e,gs.REQUIRES_RESIZE)},e.prototype.minHeight=function(t,e){return this.styleLengthEnum("min-height",t,e)},e.prototype.maxHeight=function(t,e){return this.styleLengthEnum("max-height",t,e)},e.prototype.type=function(t,e){return this.attribute("type",t,e)},e.prototype.value=function(t,e){return this.attribute("value",t,e)},e.prototype.placeholder=function(t,e){return this.attribute("placeholder",t,e)},e.prototype.autocomplete=function(t,e){return this.attribute("autocomplete",t,e)},e.prototype.selected=function(t,e){return this.attributeBoolean("selected",t,e)},e.prototype.checked=function(t,e){return this.attributeBoolean("checked",t,e)},e.prototype.disabled=function(t,e){return this.attributeBoolean("disabled",t,e)},e.prototype.title=function(t,e){return this.attribute("title",t,e)},e.prototype.display=function(t,e){return this.styleEnum("display",t,e)},e.prototype.visibility=function(t,e){return this.styleEnum("visibility",t,e)},e.prototype.position=function(t,e){return this.styleEnum("position",t,e)},e.prototype.justifyContent=function(t,e){return this.styleEnum("justify-content",t,e)},e.prototype.alignContent=function(t,e){return this.styleEnum("align-content",t,e)},e.prototype.alignItems=function(t,e){return this.styleEnum("align-items",t,e)},e.prototype.alignSelf=function(t,e){return this.styleEnum("align-self",t,e)},e.prototype.flexDirection=function(t,e){return this.styleEnum("flex-direction",t,e)},e.prototype.flexWrap=function(t,e){return this.styleEnum("flex-wrap",t,e)},e.prototype.flexGrow=function(t,e){return this.styleNumber("flex-grow",t,e)},e.prototype.flexShrink=function(t,e){return this.styleNumber("flex-shrink",t,e)},e.prototype.flexBasis=function(t,e){return this.styleLengthEnum("flex-basis",t,e)},e.prototype.order=function(t,e){return this.styleNumber("order",t,e)},e.prototype.verticalAlign=function(t,e){return this.styleLengthEnum("vertical-align",t,e)},e.prototype.overflowX=function(t,e){return this.styleEnum("overflow-x",t,e)},e.prototype.overflowY=function(t,e){return this.styleEnum("overflow-y",t,e)},e.prototype.overflow=function(t,e){return this.styleEnum("overflow",t,e)},e.prototype.pointerEvents=function(t,e){return this.styleEnum("pointer-events",t,e)},e.prototype.cursor=function(t,e){return this.styleEnum("cursor",t,e)},e.prototype.opacity=function(t,e){return this.styleNumber("opacity",t,e)},e.prototype.backgroundColor=function(t,e){return this.styleColor("background-color",t,e)},e.prototype.backdropFilter=function(t,e){return this.style("backdrop-filter",t,e)},e.prototype.filter=function(t,e){return this.style("filter",t,e)},e.prototype.boxShadow=function(t,e){null!=t&&(t=un.fromAny(t));var i=this.style("box-shadow",t,e);return"string"==typeof i&&(i=un.fromAny(i)),i},e.prototype.boxSizing=function(t,e){return this.styleEnum("box-sizing",t,e)},e.prototype.transform=function(t,e){return this.styleTransform("transform",t,e)},e.prototype.top=function(t,e){return this.styleLengthEnum("top",t,e)},e.prototype.right=function(t,e){return this.styleLengthEnum("right",t,e)},e.prototype.bottom=function(t,e){return this.styleLengthEnum("bottom",t,e)},e.prototype.left=function(t,e){return this.styleLengthEnum("left",t,e)},e.prototype.marginTop=function(t,e){return this.styleLengthEnum("margin-top",t,e)},e.prototype.marginRight=function(t,e){return this.styleLengthEnum("margin-right",t,e)},e.prototype.marginBottom=function(t,e){return this.styleLengthEnum("margin-bottom",t,e)},e.prototype.marginLeft=function(t,e){return this.styleLengthEnum("margin-left",t,e)},e.prototype.margin=function(t,e){return void 0===t?[this.marginTop(),this.marginRight(),this.marginBottom(),this.marginLeft()]:(Array.isArray(t)?(t.length>=1&&this.marginTop(t[0],e),t.length>=2&&this.marginRight(t[1],e),t.length>=3&&this.marginBottom(t[2],e),t.length>=4&&this.marginLeft(t[3],e)):(this.marginTop(t,e),this.marginRight(t,e),this.marginBottom(t,e),this.marginLeft(t,e)),this)},e.prototype.paddingTop=function(t,e){return this.styleLength("padding-top",t,e)},e.prototype.paddingRight=function(t,e){return this.styleLength("padding-right",t,e)},e.prototype.paddingBottom=function(t,e){return this.styleLength("padding-bottom",t,e)},e.prototype.paddingLeft=function(t,e){return this.styleLength("padding-left",t,e)},e.prototype.padding=function(t,e){return void 0===t?[this.paddingTop(),this.paddingRight(),this.paddingBottom(),this.paddingLeft()]:(Array.isArray(t)?(t.length>=1&&this.paddingTop(t[0],e),t.length>=2&&this.paddingRight(t[1],e),t.length>=3&&this.paddingBottom(t[2],e),t.length>=4&&this.paddingLeft(t[3],e)):(this.paddingTop(t,e),this.paddingRight(t,e),this.paddingBottom(t,e),this.paddingLeft(t,e)),this)},e.prototype.borderTopWidth=function(t,e){return this.styleLengthEnum("border-top-width",t,e)},e.prototype.borderRightWidth=function(t,e){return this.styleLengthEnum("border-right-width",t,e)},e.prototype.borderBottomWidth=function(t,e){return this.styleLengthEnum("border-bottom-width",t,e)},e.prototype.borderLeftWidth=function(t,e){return this.styleLengthEnum("border-left-width",t,e)},e.prototype.borderWidth=function(t,e){return void 0===t?[this.borderTopWidth(),this.borderRightWidth(),this.borderBottomWidth(),this.borderLeftWidth()]:(Array.isArray(t)?(t.length>=1&&this.borderTopWidth(t[0],e),t.length>=2&&this.borderRightWidth(t[1],e),t.length>=3&&this.borderBottomWidth(t[2],e),t.length>=4&&this.borderLeftWidth(t[3],e)):(this.borderTopWidth(t,e),this.borderRightWidth(t,e),this.borderBottomWidth(t,e),this.borderLeftWidth(t,e)),this)},e.prototype.borderTopStyle=function(t,e){return this.styleEnum("border-top-style",t,e)},e.prototype.borderRightStyle=function(t,e){return this.styleEnum("border-right-style",t,e)},e.prototype.borderBottomStyle=function(t,e){return this.styleEnum("border-bottom-style",t,e)},e.prototype.borderLeftStyle=function(t,e){return this.styleEnum("border-left-style",t,e)},e.prototype.borderStyle=function(t,e){return void 0===t?[this.borderTopStyle(),this.borderRightStyle(),this.borderBottomStyle(),this.borderLeftStyle()]:(Array.isArray(t)?(t.length>=1&&this.borderTopStyle(t[0],e),t.length>=2&&this.borderRightStyle(t[1],e),t.length>=3&&this.borderBottomStyle(t[2],e),t.length>=4&&this.borderLeftStyle(t[3],e)):(this.borderTopStyle(t,e),this.borderRightStyle(t,e),this.borderBottomStyle(t,e),this.borderLeftStyle(t,e)),this)},e.prototype.borderTopColor=function(t,e){return this.styleColorEnum("border-top-color",t,e)},e.prototype.borderRightColor=function(t,e){return this.styleColorEnum("border-right-color",t,e)},e.prototype.borderBottomColor=function(t,e){return this.styleColorEnum("border-bottom-color",t,e)},e.prototype.borderLeftColor=function(t,e){return this.styleColorEnum("border-left-color",t,e)},e.prototype.borderColor=function(t,e){return void 0===t?[this.borderTopColor(),this.borderRightColor(),this.borderBottomColor(),this.borderLeftColor()]:(Array.isArray(t)?(t.length>=1&&this.borderTopColor(t[0],e),t.length>=2&&this.borderRightColor(t[1],e),t.length>=3&&this.borderBottomColor(t[2],e),t.length>=4&&this.borderLeftColor(t[3],e)):(this.borderTopColor(t,e),this.borderRightColor(t,e),this.borderBottomColor(t,e),this.borderLeftColor(t,e)),this)},e.prototype.borderTopLeftRadius=function(t,e){return this.styleLength("border-top-left-radius",t,e)},e.prototype.borderTopRightRadius=function(t,e){return this.styleLength("border-top-right-radius",t,e)},e.prototype.borderBottomRightRadius=function(t,e){return this.styleLength("border-bottom-right-radius",t,e)},e.prototype.borderBottomLeftRadius=function(t,e){return this.styleLength("border-bottom-left-radius",t,e)},e.prototype.borderRadius=function(t,e){return this.styleLength("border-radius",t,e)},e.prototype.borderCollapse=function(t,e){return this.styleEnum("border-collapse",t,e)},e.prototype.borderSpacing=function(t,e){return this.style("border-spacing",t,e)},e.prototype.outlineWidth=function(t,e){return this.styleLengthEnum("outline-width",t,e)},e.prototype.outlineStyle=function(t,e){return this.styleEnum("outline-style",t,e)},e.prototype.outlineColor=function(t,e){return this.styleColorEnum("outline-color",t,e)},e.prototype.appearance=function(t,e){return this.styleEnum("appearance",t,e)},e.prototype.zIndex=function(t,e){return this.styleNumberEnum("z-index",t,e)},e.prototype.fontFamily=function(t,e){return this.style("font-family",t,e)},e.prototype.fontSize=function(t,e){return this.styleLengthEnum("font-size",t,e)},e.prototype.fontStyle=function(t,e){return this.styleEnum("font-style",t,e)},e.prototype.fontWeight=function(t,e){return this.styleEnum("font-weight",t,e)},e.prototype.fontVariant=function(t,e){return this.style("font-variant",t,e)},e.prototype.lineHeight=function(t,e){return"number"==typeof t&&(t=qo.fromAny(t,"")),this.styleLengthEnum("line-height",t,e)},e.prototype.textTransform=function(t,e){return this.styleEnum("text-transform",t,e)},e.prototype.textOverflow=function(t,e){return this.style("text-overflow",t,e)},e.prototype.textAlign=function(t,e){return this.styleEnum("text-align",t,e)},e.prototype.textDecorationLine=function(t,e){return this.style("text-decoration-line",t,e)},e.prototype.textDecorationStyle=function(t,e){return this.styleEnum("text-decoration-style",t,e)},e.prototype.textDecorationColor=function(t,e){return this.styleColorEnum("text-decoration-color",t,e)},e.prototype.whiteSpace=function(t,e){return this.styleEnum("white-space",t,e)},e.prototype.userSelect=function(t,e){return this.styleEnum("-webkit-user-select",t,e),this.styleEnum("-moz-user-select",t,e),this.styleEnum("-ms-user-select",t,e),this.styleEnum("user-select",t,e)},e.prototype.color=function(t,e){return this.styleColorEnum("color",t,e)},e.prototype.fill=function(t,e){return this.styleColorEnum("fill",t,e)},e.prototype.fillRule=function(t,e){return this.style("fill-rule",t,e)},e.prototype.stroke=function(t,e){return this.styleColorEnum("stroke",t,e)},e.prototype.strokeWidth=function(t,e){return this.styleNumber("stroke-width",t,e)},e.prototype.strokeDashArray=function(t,e){return this.styleNumber("stroke-dasharray",t,e)},e.prototype.createChildView=function(t){return e.create(t)},e.prototype.append=function(e){return t.prototype.append.call(this,e)},e.prototype.prepend=function(e){return t.prototype.prepend.call(this,e)},e.prototype.insertBefore=function(e,i){return t.prototype.insertBefore.call(this,e,i)},e.prototype.renderLayout=function(t){this.node.innerHTML="";var e=new Za(this.node);return e.setLayoutDefinition(t),t.renderType&&"recon"===t.renderType?e.buildReconLayout():e.buildJsonLayout(),e},e.create=function(t){return t instanceof ba?t:"string"==typeof t?new wa.HtmlView(document.createElement(t)):t.view?t.view:t instanceof HTMLElement?new wa.HtmlView(t):t instanceof SVGElement?new wa.SvgView(t):t instanceof Element?new wa.ElemView(t):t instanceof Text?new wa.TextView(t):new ba(t)},e}(Na);wa.HtmlView=tu;var eu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(ja),iu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.materializeViewParam=function(e,i,r,o){return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return t.prototype.materializeModelParam.call(this,e,i,r,o)},e}(Ya),ru=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.materializeView=function(t,e,i,r,o,n){void 0===n&&(n=o);var s=L.empty();return e.forEach(function(e){if(e instanceof R&&e.key.value===o)if(e.value instanceof L){s.attr(n);var a=L.empty(1+e.value.length).attr("attrs");e.value.forEach(function(e){if(e instanceof T){var i=e.key.value,r="";e.value instanceof F?e.value.forEach(function(t){t.value instanceof I?r+=t.key+": "+t.value+"; ":r+=t+"; "}):r=e.value.value,t.node.setAttribute(i,r)}a.push(e)},this),s.push(a)}else o!==n?s.attr(n,e.value):s.push(e);else{if(e instanceof T){var u=e.key.value,h="";e.value instanceof F?e.value.forEach(function(t){t.value instanceof I?h+=t.key+": "+t.value+"; ":h+=t+"; "}):h=e.value.value,t.node.setAttribute(u,h)}(e=this.materializeViewParam(t,e,i,r,!1))instanceof L&&void 0===e.tag?e.forEach(function(e){(e=this.materializeViewParam(t,e,i,r,!0))instanceof w&&e.isDefined()&&s.push(e)},this):e instanceof w&&e.isDefined()&&s.push(e)}},this),s},e.prototype.materializeViewParam=function(e,i,r,o,n){if(i instanceof I){var s=Oa.create(i.value);return e.append(s),s}if(i instanceof b){var a=o.castView(i.toValue(),r,o);if(a instanceof ba)return e.append(a),a;if(a instanceof wa)return e.appendChildView(a),a;if(n&&i.isDefined()&&void 0===i.tag){s=Oa.create();var u=L.empty(1).attr("text",i);return s.setModel(u),s}}return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModel=function(t,e,i,r,o){var n=L.empty();return e.forEach(function(e){(e=this.materializeModelParam(t,e,i,r,o))instanceof w&&e.isDefined()&&n.push(e)},this),n},e.prototype.materializeModelParam=function(e,i,r,o,n){return i instanceof R&&i.key.value===n?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e}(iu),ou=function(t){function e(e){var i=t.call(this)||this;return i.tag=e,i}return u(e,t),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=tu.create(this.tag),o=this.materializeView(r,t,e,i,this.tag);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new eu,o=this.materializeModel(r,t,e,i,this.tag);return r.setData(o),r}},e}(ru);Aa.addGlobal(new ou("article")),Aa.addGlobal(new ou("section")),Aa.addGlobal(new ou("nav")),Aa.addGlobal(new ou("aside")),Aa.addGlobal(new ou("h1")),Aa.addGlobal(new ou("h2")),Aa.addGlobal(new ou("h3")),Aa.addGlobal(new ou("h4")),Aa.addGlobal(new ou("h5")),Aa.addGlobal(new ou("h6")),Aa.addGlobal(new ou("hgroup")),Aa.addGlobal(new ou("header")),Aa.addGlobal(new ou("footer")),Aa.addGlobal(new ou("address")),Aa.addGlobal(new ou("p")),Aa.addGlobal(new ou("hr")),Aa.addGlobal(new ou("pre")),Aa.addGlobal(new ou("blockquote")),Aa.addGlobal(new ou("ol")),Aa.addGlobal(new ou("ul")),Aa.addGlobal(new ou("menu")),Aa.addGlobal(new ou("li")),Aa.addGlobal(new ou("dl")),Aa.addGlobal(new ou("dt")),Aa.addGlobal(new ou("dd")),Aa.addGlobal(new ou("figure")),Aa.addGlobal(new ou("figcaption")),Aa.addGlobal(new ou("main")),Aa.addGlobal(new ou("div")),Aa.addGlobal(new ou("a")),Aa.addGlobal(new ou("em")),Aa.addGlobal(new ou("strong")),Aa.addGlobal(new ou("small")),Aa.addGlobal(new ou("s")),Aa.addGlobal(new ou("cite")),Aa.addGlobal(new ou("q")),Aa.addGlobal(new ou("dfn")),Aa.addGlobal(new ou("abbr")),Aa.addGlobal(new ou("ruby")),Aa.addGlobal(new ou("rt")),Aa.addGlobal(new ou("rp")),Aa.addGlobal(new ou("data")),Aa.addGlobal(new ou("time")),Aa.addGlobal(new ou("code")),Aa.addGlobal(new ou("var")),Aa.addGlobal(new ou("samp")),Aa.addGlobal(new ou("kbd")),Aa.addGlobal(new ou("sub")),Aa.addGlobal(new ou("sup")),Aa.addGlobal(new ou("i")),Aa.addGlobal(new ou("b")),Aa.addGlobal(new ou("u")),Aa.addGlobal(new ou("mark")),Aa.addGlobal(new ou("bdi")),Aa.addGlobal(new ou("bdo")),Aa.addGlobal(new ou("span")),Aa.addGlobal(new ou("br")),Aa.addGlobal(new ou("wbr")),Aa.addGlobal(new ou("a")),Aa.addGlobal(new ou("ins")),Aa.addGlobal(new ou("del")),Aa.addGlobal(new ou("picture")),Aa.addGlobal(new ou("source")),Aa.addGlobal(new ou("img")),Aa.addGlobal(new ou("iframe")),Aa.addGlobal(new ou("embed")),Aa.addGlobal(new ou("object")),Aa.addGlobal(new ou("param")),Aa.addGlobal(new ou("video")),Aa.addGlobal(new ou("audio")),Aa.addGlobal(new ou("track")),Aa.addGlobal(new ou("table")),Aa.addGlobal(new ou("caption")),Aa.addGlobal(new ou("colgroup")),Aa.addGlobal(new ou("col")),Aa.addGlobal(new ou("tbody")),Aa.addGlobal(new ou("thead")),Aa.addGlobal(new ou("tfoot")),Aa.addGlobal(new ou("tr")),Aa.addGlobal(new ou("td")),Aa.addGlobal(new ou("th")),Aa.addGlobal(new ou("form")),Aa.addGlobal(new ou("label")),Aa.addGlobal(new ou("input")),Aa.addGlobal(new ou("button")),Aa.addGlobal(new ou("select")),Aa.addGlobal(new ou("datalist")),Aa.addGlobal(new ou("optgroup")),Aa.addGlobal(new ou("option")),Aa.addGlobal(new ou("textarea")),Aa.addGlobal(new ou("output")),Aa.addGlobal(new ou("progress")),Aa.addGlobal(new ou("meter")),Aa.addGlobal(new ou("fieldset")),Aa.addGlobal(new ou("legend")),Aa.addGlobal(new ou("details")),Aa.addGlobal(new ou("summary")),Aa.addGlobal(new ou("dialog")),Aa.addGlobal(new ou("script")),Aa.addGlobal(new ou("noscript"));var nu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.isCustomElement=function(t){return"undefined"!=typeof customElements&&customElements.get(t)},e.prototype.castView=function(t,e,i){var r=t.tag;if(void 0!==r&&this.isCustomElement(r)){var o=tu.create(r),n=this.materializeView(o,t,e,i,r,"customElement");return o.setModel(n),o}},e.prototype.castModel=function(t,e,i){if("customElement"===t.tag){var r=new eu,o=this.materializeModel(r,t,e,i,"customElement");return r.setData(o),r}},e.Form=new e,e}(ru);Aa.addGlobal(nu.Form);var su=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.prototype.didSetStateParam=function(e,i){"rules"===e?this.didSetStyleRules(i):t.prototype.didSetStateParam.call(this,e,i)},e.prototype.didSetStyleRules=function(t){var i=0;t.forEach(function(t){if(t instanceof T&&t.key instanceof I&&t.value instanceof L&&t.value.isObject()){var r=void 0;if(void 0!==(r=t.value instanceof L&&t.value.isObject()?e.castCssRules(t.key.value,t.value):e.castCssRule(t.key.value,t.value))){var o=this.node.sheet;i<o.cssRules.length&&o.deleteRule(i),o.insertRule(r,i),i+=1}}},this)},e.castCssRules=function(t,i){var r=t+" {";return i.forEach(function(t){if(t instanceof T&&t.key instanceof I){var i=void 0;void 0!==(i=t.value instanceof L&&t.value.isObject()?e.castCssRules(t.key.value,t.value):e.castCssRule(t.key.value,t.value))&&(r+=" "+i)}}),r+=" }"},e.castCssRule=function(t,e){if(void 0!==e.stringValue())return t+": "+e.stringValue()+";"},e.create=function(){var t=document.createElement("style");return t.setAttribute("type","text/css"),new e(t)},e}(tu),au=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.willRemodel=function(e,i){t.prototype.willRemodel.call(this,e,i);var r=this._modelScope._record.evaluate(i);e.slot("rules",r)},e.prototype.stack=function(){return this._parentModel?this._parentModel.stack():D.of(Sa.GlobalScope)},e}(eu),uu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"stylesheet"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=su.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new au,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(iu);Aa.addGlobal(uu.Form);var hu,lu,pu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(ja),cu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.materializeViewParam=function(e,i,r,o){return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return t.prototype.materializeModelParam.call(this,e,i,r,o)},e}(Ya),du=function(t){function e(e,i){var r=t.call(this)||this;return r.target=e,r.arc=i,r.innerRadius=void 0,r.outerRadius=void 0,r.startAngle=void 0,r.deltaAngle=void 0,r.padAngle=void 0,r.padRadius=void 0,r.cornerRadius=void 0,r}return u(e,t),e.prototype.onFrame=function(t){this.innerRadius&&this.innerRadius.onFrame(t),this.outerRadius&&this.outerRadius.onFrame(t),this.startAngle&&this.startAngle.onFrame(t),this.deltaAngle&&this.deltaAngle.onFrame(t),this.padAngle&&this.padAngle.onFrame(t),this.padRadius&&this.padRadius.onFrame(t),this.cornerRadius&&this.cornerRadius.onFrame(t),this.update()},e.prototype.update=function(){this.arc.dirty&&this.target.setAttribute("d",this.arc.draw())},e}(ws),fu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.arc.innerRadius(t)},e.get=function(t){return t.arc.innerRadius()},e.set=function(t,e){null===e?t.arcAnimator.innerRadius=void 0:(t.arc.innerRadius(e),t.arcAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.arcAnimator.innerRadius||(t.arcAnimator.innerRadius=new e(t.arcAnimator,i,r)),t.arcAnimator.innerRadius},e}(xs),yu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.arc.outerRadius(t)},e.get=function(t){return t.arc.outerRadius()},e.set=function(t,e){null===e?t.arcAnimator.outerRadius=void 0:(t.arc.outerRadius(e),t.arcAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.arcAnimator.outerRadius||(t.arcAnimator.outerRadius=new e(t.arcAnimator,i,r)),t.arcAnimator.outerRadius},e}(xs),mu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.arc.startAngle(t)},e.get=function(t){return t.arc.startAngle()},e.set=function(t,e){null===e?t.arcAnimator.startAngle=void 0:(t.arc.startAngle(e),t.arcAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.arcAnimator.startAngle||(t.arcAnimator.startAngle=new e(t.arcAnimator,i,r)),t.arcAnimator.startAngle},e}(xs),vu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.arc.deltaAngle(t)},e.get=function(t){return t.arc.deltaAngle()},e.set=function(t,e){null===e?t.arcAnimator.deltaAngle=void 0:(t.arc.deltaAngle(e),t.arcAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.arcAnimator.deltaAngle||(t.arcAnimator.deltaAngle=new e(t.arcAnimator,i,r)),t.arcAnimator.deltaAngle},e}(xs),gu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.arc.padAngle(t)},e.get=function(t){return t.arc.padAngle()},e.set=function(t,e){null===e?t.arcAnimator.padAngle=void 0:(t.arc.padAngle(e),t.arcAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.arcAnimator.padAngle||(t.arcAnimator.padAngle=new e(t.arcAnimator,i,r)),t.arcAnimator.padAngle},e}(xs),wu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.arc.padRadius(t)},e.get=function(t){return t.arc.padRadius()},e.set=function(t,e){null===e&&(t.arcAnimator.padRadius=void 0),t.arc.padRadius(e),t.arcAnimator.animate()},e.animator=function(t,i,r){return void 0===i||t.arcAnimator.padRadius||(t.arcAnimator.padRadius=new e(t.arcAnimator,i,r)),t.arcAnimator.padRadius},e}(xs),bu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.arc.cornerRadius(t)},e.get=function(t){return t.arc.cornerRadius()},e.set=function(t,e){null===e?t.arcAnimator.cornerRadius=void 0:(t.arc.cornerRadius(e),t.arcAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.arcAnimator.cornerRadius||(t.arcAnimator.cornerRadius=new e(t.arcAnimator,i,r)),t.arcAnimator.cornerRadius},e}(xs),_u=function(t){function e(e,i){void 0===i&&(i=new Xs);var r=t.call(this,e)||this;return r.arc=i,r.arcAnimator=new du(e,i),r}return u(e,t),e.prototype.innerRadius=function(t,e){return this.propertyNumber(fu,t,e)},e.prototype.outerRadius=function(t,e){return this.propertyNumber(yu,t,e)},e.prototype.startAngle=function(t,e){return this.propertyAngle(mu,t,e)},e.prototype.deltaAngle=function(t,e){return this.propertyAngle(vu,t,e)},e.prototype.padAngle=function(t,e){return this.propertyAngle(gu,t,e)},e.prototype.padRadius=function(t,e){null!=t&&(t=+t);var i=this.property(wu,t,e);return"string"==typeof i&&(i=+i),i},e.prototype.cornerRadius=function(t,e){return this.propertyNumber(bu,t,e)},e.create=function(t,i){if(t instanceof e)return t;if(t instanceof ba)throw new TypeError(""+t);if("string"==typeof t)return new e(document.createElementNS(Xa.NS,"path"),i);if(t.view instanceof e)return t.view;if(t.view)throw new TypeError(""+t.view);if(t instanceof SVGPathElement)return new e(t,i);throw new TypeError(""+t)},e}(Xa);(lu=hu||(hu={}))[lu.Hidden=0]="Hidden",lu[lu.Showing=1]="Showing",lu[lu.Visible=2]="Visible",lu[lu.Hiding=3]="Hiding";var xu,Au,ku=function(t){function e(e,i){var r=t.call(this)||this;return r.popover=e,r.popoverState=i,r.opacity=void 0,r.backgroundColor=void 0,r.borderRadius=void 0,r.arrowWidth=void 0,r.arrowHeight=void 0,r.viewportLeft=void 0,r.viewportRight=void 0,r.viewportTop=void 0,r.viewportBottom=void 0,r.sourceLeft=void 0,r.sourceTop=void 0,r.sourceWidth=void 0,r.sourceHeight=void 0,r}return u(e,t),e.prototype.onFrame=function(t){this.opacity&&this.opacity.onFrame(t),this.backgroundColor&&this.backgroundColor.onFrame(t),this.borderRadius&&this.borderRadius.onFrame(t),this.arrowWidth&&this.arrowWidth.onFrame(t),this.arrowHeight&&this.arrowHeight.onFrame(t),this.viewportLeft&&this.viewportLeft.onFrame(t),this.viewportRight&&this.viewportRight.onFrame(t),this.viewportTop&&this.viewportTop.onFrame(t),this.viewportBottom&&this.viewportBottom.onFrame(t),this.sourceLeft&&this.sourceLeft.onFrame(t),this.sourceTop&&this.sourceTop.onFrame(t),this.sourceWidth&&this.sourceWidth.onFrame(t),this.sourceHeight&&this.sourceHeight.onFrame(t),this.update()},e.prototype.show=function(t){if(0===this.popoverState||3===this.popoverState){t=fs.fromAny(t||!0,1);var e=this.opacity;return e||(t.f||(t=t.range(0)),e=new Eu(this,0,t),this.opacity=e),this.popover.willShow(),this.popover.node.style.setProperty("pointer-events","auto"),this.popoverState=1,e.set(1,t),!0}return!1},e.prototype.hide=function(t){if(2===this.popoverState||1===this.popoverState){t=fs.fromAny(t||!0,0);var e=this.opacity;return e||(t.f||(t=t.range(1)),e=new Eu(this,1,t),this.opacity=e),this.popover.willHide(),this.popover.node.style.setProperty("pointer-events","none"),this.popoverState=3,e.set(0,t),!0}return!1},e.prototype.update=function(){this.popover.place(),this.popover.render()},e}(ws),Eu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.popover.node.style.setProperty("opacity",""+t)},e.prototype.onEnd=function(t){1===this.parent.popoverState?(this.parent.popover.node.style.setProperty("pointer-events","auto"),this.parent.popoverState=2,this.parent.popover.didShow()):3===this.parent.popoverState&&(this.parent.popover.node.style.setProperty("pointer-events","none"),this.parent.popoverState=0,this.parent.popover.didHide())},e.get=function(t){return+t.node.style.getPropertyValue("opacity")},e.set=function(t,e){null===e?(t.popoverAnimator.opacity=void 0,t.node.style.removeProperty("opacity")):t.node.style.setProperty("opacity",""+e)},e.animator=function(t,i,r){return void 0===i||t.popoverAnimator.opacity||(t.popoverAnimator.opacity=new e(t.popoverAnimator,i,r)),t.popoverAnimator.opacity},e}(xs),Cu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.popover.backgroundColor(t)},e.get=function(t){return t.popover.backgroundColor()},e.set=function(t,e){null===e?t.popoverAnimator.backgroundColor=void 0:t.popover.backgroundColor(e)},e.animator=function(t,i,r){return void 0===i||t.popoverAnimator.backgroundColor||(t.popoverAnimator.backgroundColor=new e(t.popoverAnimator,i,r)),t.popoverAnimator.backgroundColor},e}(xs),Su=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.popover.borderRadius(t)},e.get=function(t){return t.popover.borderRadius()},e.set=function(t,e){null===e?t.popoverAnimator.borderRadius=void 0:t.popover.borderRadius(e)},e.animator=function(t,i,r){return void 0===i||t.popoverAnimator.borderRadius||(t.popoverAnimator.borderRadius=new e(t.popoverAnimator,i,r)),t.popoverAnimator.borderRadius},e}(xs),Vu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.popover.arrowWidth(t)},e.get=function(t){return t.popover.arrowWidth()},e.set=function(t,e){null===e?t.popoverAnimator.arrowWidth=void 0:t.popover.arrowWidth(e)},e.animator=function(t,i,r){return void 0===i||t.popoverAnimator.arrowWidth||(t.popoverAnimator.arrowWidth=new e(t.popoverAnimator,i,r)),t.popoverAnimator.arrowWidth},e}(xs),Du=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.popover.arrowHeight(t)},e.get=function(t){return t.popover.arrowHeight()},e.set=function(t,e){null===e?t.popoverAnimator.arrowHeight=void 0:t.popover.arrowHeight(e)},e.animator=function(t,i,r){return void 0===i||t.popoverAnimator.arrowHeight||(t.popoverAnimator.arrowHeight=new e(t.popoverAnimator,i,r)),t.popoverAnimator.arrowHeight},e}(xs),Mu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.popover.viewportLeft(t)},e.get=function(t){return t.popover.viewportLeft()},e.set=function(t,e){null===e?t.popoverAnimator.viewportLeft=void 0:t.popover.viewportLeft(e)},e.animator=function(t,i,r){return void 0===i||t.popoverAnimator.viewportLeft||(t.popoverAnimator.viewportLeft=new e(t.popoverAnimator,i,r)),t.popoverAnimator.viewportLeft},e}(xs),Ru=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.popover.viewportRight(t)},e.get=function(t){return t.popover.viewportRight()},e.set=function(t,e){null===e?t.popoverAnimator.viewportRight=void 0:t.popover.viewportRight(e)},e.animator=function(t,i,r){return void 0===i||t.popoverAnimator.viewportRight||(t.popoverAnimator.viewportRight=new e(t.popoverAnimator,i,r)),t.popoverAnimator.viewportRight},e}(xs),Tu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.popover.viewportTop(t)},e.get=function(t){return t.popover.viewportTop()},e.set=function(t,e){null===e?t.popoverAnimator.viewportTop=void 0:t.popover.viewportTop(e)},e.animator=function(t,i,r){return void 0===i||t.popoverAnimator.viewportTop||(t.popoverAnimator.viewportTop=new e(t.popoverAnimator,i,r)),t.popoverAnimator.viewportTop},e}(xs),Pu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.popover.viewportBottom(t)},e.get=function(t){return t.popover.viewportBottom()},e.set=function(t,e){null===e?t.popoverAnimator.viewportBottom=void 0:t.popover.viewportBottom(e)},e.animator=function(t,i,r){return void 0===i||t.popoverAnimator.viewportBottom||(t.popoverAnimator.viewportBottom=new e(t.popoverAnimator,i,r)),t.popoverAnimator.viewportBottom},e}(xs),Lu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.popover.sourceLeft(t)},e.get=function(t){return t.popover.sourceLeft()},e.set=function(t,e){null===e?t.popoverAnimator.sourceLeft=void 0:t.popover.sourceLeft(e)},e.animator=function(t,i,r){return void 0===i||t.popoverAnimator.sourceLeft||(t.popoverAnimator.sourceLeft=new e(t.popoverAnimator,i,r)),t.popoverAnimator.sourceLeft},e}(xs),Fu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.popover.sourceTop(t)},e.get=function(t){return t.popover.sourceTop()},e.set=function(t,e){null===e?t.popoverAnimator.sourceTop=void 0:t.popover.sourceTop(e)},e.animator=function(t,i,r){return void 0===i||t.popoverAnimator.sourceTop||(t.popoverAnimator.sourceTop=new e(t.popoverAnimator,i,r)),t.popoverAnimator.sourceTop},e}(xs),zu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.popover.sourceWidth(t)},e.get=function(t){return t.popover.sourceWidth()},e.set=function(t,e){null===e?t.popoverAnimator.sourceWidth=void 0:t.popover.sourceWidth(e)},e.animator=function(t,i,r){return void 0===i||t.popoverAnimator.sourceWidth||(t.popoverAnimator.sourceWidth=new e(t.popoverAnimator,i,r)),t.popoverAnimator.sourceWidth},e}(xs),Iu=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.popover.sourceHeight(t)},e.get=function(t){return t.popover.sourceHeight()},e.set=function(t,e){null===e?t.popoverAnimator.sourceHeight=void 0:t.popover.sourceHeight(e)},e.animator=function(t,i,r){return void 0===i||t.popoverAnimator.sourceHeight||(t.popoverAnimator.sourceHeight=new e(t.popoverAnimator,i,r)),t.popoverAnimator.sourceHeight},e}(xs),Uu=function(t){function e(e){var i=t.call(this,e.node)||this;return i.popover=e,i._source=null,i._sourceZIndex=null,i._replaceDelay=0,i.resizeObserver=null,i.mutationObserver=null,i.replaceTimer=0,i.popoverAnimator=new ku(i.popover,0),i.replace=i.replace.bind(i),i.onResize=i.onResize.bind(i),i.onMutation=i.onMutation.bind(i),i.onClick=i.onClick.bind(i),i.node.addEventListener("click",i.onClick),i}return u(e,t),e.prototype.isVisible=function(){return 2===this.popoverAnimator.popoverState||1===this.popoverAnimator.popoverState},e.prototype.isViewable=function(){return!0},e.prototype.show=function(t){return this.popover.addObserver(this),this.popoverAnimator.show(t)&&(this.observeSource(this._source),(null!==this._sourceZIndex&&this._source instanceof HTMLElement||this._source instanceof SVGElement)&&this._source.style.setProperty("z-index",""+this._sourceZIndex)),this},e.prototype.hide=function(t){return this.popoverAnimator.hide(t),this},e.prototype.opacity=function(t,e){return this.propertyNumber(Eu,t,e)},e.prototype.backgroundColor=function(t,e){return this.propertyColor(Cu,t,e)},e.prototype.borderRadius=function(t,e){return this.propertyLength(Su,t,e)},e.prototype.arrowWidth=function(t,e){return this.propertyLength(Vu,t,e)},e.prototype.arrowHeight=function(t,e){return this.propertyLength(Du,t,e)},e.prototype.placement=function(t){return void 0===t?this.popover.placement():(this.popover.placement(t),this)},e.prototype.viewportLeft=function(t,e){return this.propertyLength(Mu,t,e)},e.prototype.viewportRight=function(t,e){return this.propertyLength(Ru,t,e)},e.prototype.viewportTop=function(t,e){return this.propertyLength(Tu,t,e)},e.prototype.viewportBottom=function(t,e){return this.propertyLength(Pu,t,e)},e.prototype.source=function(t){var e=this._source;return void 0===t?e:(e!==t?(this.popover.sourceWillChange(t,e),this.unobserveSource(e),this._source=t,t&&(this.replace(),this.observeSource(t)),this.popover.sourceDidChange(t,e)):t&&this.replace(),this)},e.prototype.sourceLeft=function(t,e){return this.propertyLength(Lu,t,e)},e.prototype.sourceTop=function(t,e){return this.propertyLength(Fu,t,e)},e.prototype.sourceWidth=function(t,e){return this.propertyLength(zu,t,e)},e.prototype.sourceHeight=function(t,e){return this.propertyLength(Iu,t,e)},e.prototype.sourceZIndex=function(t){return void 0===t?this._sourceZIndex:(this._sourceZIndex=t,this)},e.prototype.replaceDelay=function(t){return void 0===t?this._replaceDelay:(this._replaceDelay=t,this)},e.prototype.render=function(){this.popoverAnimator.update()},e.prototype.didResize=function(){t.prototype.didResize.call(this),this.onReplace()},e.prototype.addObserver=function(t){this.popover.addObserver(t)},e.prototype.removeObserver=function(t){this.popover.removeObserver(t)},e.prototype.observeSource=function(t){t&&(this.resizeObserver||(this.resizeObserver=new cr(this.onResize)),this.mutationObserver||(this.mutationObserver=new MutationObserver(this.onMutation)),this.resizeObserver.observe(t),this.mutationObserver.observe(t,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["style"]}))},e.prototype.unobserveSource=function(t){t&&(this.resizeObserver&&this.resizeObserver.unobserve(t),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null))},e.prototype.replace=function(){this.replaceTimer=0;for(var t=this._source;t&&!(t instanceof HTMLElement);)t=t.parentNode||t.host;if(t){var e=t.getBoundingClientRect(),i=e.left-t.offsetLeft,r=e.top-t.offsetTop,o=this.node.getBoundingClientRect(),n=o.left-this.node.offsetLeft,s=o.top-this.node.offsetTop;this.popover.sourceLeft(t.offsetLeft+i-n),this.popover.sourceTop(t.offsetTop+r-s),this.popover.sourceWidth(t.offsetWidth),this.popover.sourceHeight(t.offsetHeight),this.popoverAnimator.update()}},e.prototype.onReplace=function(){this._replaceDelay<0?this.replace():0===this.replaceTimer&&(this.replaceTimer=setTimeout(this.replace,this._replaceDelay))},e.prototype.onResize=function(t){this.onReplace()},e.prototype.onMutation=function(t){this.onReplace()},e.prototype.onClick=function(t){t.stopPropagation()},e.prototype.popoverDidPlace=function(t,e){this.requireReview(),this.requireResize()},e.prototype.popoverWillShow=function(t){this.requireReview(),this.requireResize()},e.prototype.popoverDidShow=function(t){this.requireReview(),this.requireResize()},e.prototype.popoverDidHide=function(t){(null!==this._sourceZIndex&&this._source instanceof HTMLElement||this._source instanceof SVGElement)&&this._source.style.removeProperty("z-index"),this.replaceTimer&&(clearTimeout(this.replaceTimer),this.replaceTimer=0),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null),this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null),this.popover.removeObserver(this)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("transition").cast(fs.Form),o=e.get("backgroundColor").cast(Qo.Form);o&&this.backgroundColor(o,r);var n=e.get("borderRadius").cast(qo.Form);n&&this.borderRadius(n,r);var s=e.get("arrowWidth").cast(qo.Form);s&&this.arrowWidth(s,r);var a=e.get("arrowHeight").cast(qo.Form);a&&this.arrowHeight(a,r);var u=e.get("viewportLeft").cast(qo.Form);u&&this.viewportLeft(u,r);var h=e.get("viewportRight").cast(qo.Form);h&&this.viewportRight(h,r);var l=e.get("viewportTop").cast(qo.Form);l&&this.viewportTop(l,r);var p=e.get("viewportBottom").cast(qo.Form);p&&this.viewportBottom(p,r)},e.create=function(t){if(t instanceof e)return t;if(t instanceof ba)throw new TypeError(""+t);if(void 0===t||"string"==typeof t)return new e(Qs.create(t));if(t.view instanceof e)return t.view;if(t.view)throw new TypeError(""+t.view);if(t instanceof HTMLElement)return new e(new Qs(t));throw new TypeError(""+t)},e}(tu),Wu=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e.Params=eu.Params.concat([new Ca("backgroundColor",B.get("backgroundColor").or(B.get("popover").get("backgroundColor"))),new Ca("borderRadius",B.get("borderRadius").or(B.get("popover").get("borderRadius"))),new Ca("arrowWidth",B.get("arrowWidth").or(B.get("popover").get("arrowWidth"))),new Ca("arrowHeight",B.get("arrowHeight").or(B.get("popover").get("arrowHeight"))),new Ca("viewportLeft",B.get("viewportLeft").or(B.get("popover").get("viewportLeft"))),new Ca("viewportRight",B.get("viewportRight").or(B.get("popover").get("viewportRight"))),new Ca("viewportTop",B.get("viewportTop").or(B.get("popover").get("viewportTop"))),new Ca("viewportBottom",B.get("viewportBottom").or(B.get("popover").get("viewportBottom")))]),e}(eu);(Au=xu||(xu={}))[Au.Hidden=0]="Hidden",Au[Au.Showing=1]="Showing",Au[Au.Visible=2]="Visible",Au[Au.Hiding=3]="Hiding";var Ou=function(t){function e(e,i,r){var o=t.call(this,i,r)||this;return o.shadowBox=e,o}return u(e,t),e.prototype.update=function(t){this.shadowBox.backgroundColor(this.shadowBox.shadowColor().alpha(t))},e.prototype.onEnd=function(t){1===this.shadowBox.shadowBoxState?(this.shadowBox.shadowBoxState=2,this.shadowBox.didShow()):3===this.shadowBox.shadowBoxState&&(this.shadowBox.shadowBoxState=0,this.shadowBox.didHide())},e}(As),Bu=function(t){function e(e){var i=t.call(this,e)||this;return i._shadowColor=Qo.black(),i._shadowOpacity=.5,i._shadowTransition=new fs(250,pn.quadOut).range(0),i.shadowBoxState=0,i.shadowBoxAnimator=new Ou(i,0,i._shadowTransition),i}return u(e,t),e.prototype.isVisible=function(){return 2===this.shadowBoxState||1===this.shadowBoxState},e.prototype.shadowColor=function(t){return void 0===t?this._shadowColor:(this._shadowColor=Qo.fromAny(t),this)},e.prototype.shadowOpacity=function(t){return void 0===t?this._shadowOpacity:(this._shadowOpacity=t,this)},e.prototype.shadowTransition=function(t){return void 0===t?this._shadowTransition:(this._shadowTransition=fs.fromAny(t),this)},e.prototype.show=function(t){2!==this.shadowBoxState&&(t=void 0===t?this._shadowTransition:fs.fromAny(t||this._shadowTransition,0),this.willShow(),this.shadowBoxState=1,this.shadowBoxAnimator.set(this._shadowOpacity,t))},e.prototype.hide=function(t){0!==this.shadowBoxState&&(t=void 0===t?this._shadowTransition:fs.fromAny(t||this._shadowTransition,this._shadowOpacity),this.willHide(),this.shadowBoxState=3,this.shadowBoxAnimator.set(0,t))},e.prototype.willShow=function(){},e.prototype.didShow=function(){},e.prototype.willHide=function(){},e.prototype.didHide=function(){},e.create=function(){return new e(document.createElement("div")).className("shadow-box").display("flex").position("absolute").top(0).right(0).bottom(0).left(0).pointerEvents("none").zIndex(50)},e}(tu),qu=function(){return function(){}}(),Gu=function(){return function(){}}(),Hu=function(t){function e(e){var i=t.call(this)||this;return i._appModel=e,i.onMessage=i.onMessage.bind(i),self.addEventListener("message",i.onMessage),i}return u(e,t),e.prototype.appendChild=function(t,e,i){i=b.fromAny(i);var r=new da(t,e,"",i);this.postEnvelope(r)},e.prototype.prependChild=function(t,e,i){i=b.fromAny(i);var r=new fa(t,e,"",i);this.postEnvelope(r)},e.prototype.insertChild=function(t,e,i,r){r=b.fromAny(r);var o=new ya(t,e,i,r);this.postEnvelope(o)},e.prototype.removeChild=function(t,e){var i=new ma(t,e,"");this.postEnvelope(i)},e.prototype.setState=function(t,e){e=b.fromAny(e);var i=new va(t,e);this.postEnvelope(i)},e.prototype.postEnvelope=function(t){var e=t.toRecon();self.postMessage(e)},e.prototype.onEnvelope=function(t){t instanceof da?this.onAppendEnvelope(t):t instanceof fa?this.onPrependEnvelope(t):t instanceof ya?this.onInsertEnvelope(t):t instanceof ma?this.onRemoveEnvelope(t):t instanceof ga?this.onModelEnvelope(t):this.onUnknownEnvelope(t)},e.prototype.onAppendEnvelope=function(t){var e=t.parent(),i=t.child(),r=t.body(),o=this._appModel.getModel(e);if(o){var n=Aa.Global.castModel(r,o.stack(),Aa.Global);n||(n=new Sa(i)),n&&(n._id=i,o.appendChildModel(n))}},e.prototype.onPrependEnvelope=function(t){var e=t.parent(),i=t.child(),r=t.body(),o=this._appModel.getModel(e);if(o){var n=Aa.Global.castModel(r,o.stack(),Aa.Global);n||(n=new Sa(i)),n&&(n._id=i,o.prependChildModel(n))}},e.prototype.onInsertEnvelope=function(t){var e=t.parent(),i=t.child(),r=t.target(),o=t.body(),n=this._appModel.getModel(e);if(n){var s=Aa.Global.castModel(o,n.stack(),Aa.Global);if(s||(s=new Sa(i)),s){s._id=i;var a=this._appModel.getModel(r)||null;n.insertChildModel(s,a)}}},e.prototype.onRemoveEnvelope=function(t){var e=t.parent(),i=t.child(),r=this._appModel.getModel(e);if(r){var o=this._appModel.getModel(i);o&&r.removeChildModel(o)}},e.prototype.onModelEnvelope=function(t){var e=t.child(),i=t.body(),r=this._appModel.getModel(e);r&&r.setData(i)},e.prototype.onUnknownEnvelope=function(t){},e.prototype.onMessage=function(t){var e=t.data;if("string"==typeof e){var i=la.parseRecon(e);i?this.onEnvelope(i):this.onUnknownEnvelope(e)}},e}(qu),Nu=function(t){function e(e,i){var r=t.call(this)||this;return r._appView=e,r._worker=i,r.onMessage=r.onMessage.bind(r),r._worker.addEventListener("message",r.onMessage),r}return u(e,t),Object.defineProperty(e.prototype,"worker",{get:function(){return this._worker},enumerable:!0,configurable:!0}),e.prototype.appendChild=function(t,e,i){i=b.fromAny(i);var r=new da(t,e,"",i);this.postEnvelope(r)},e.prototype.prependChild=function(t,e,i){i=b.fromAny(i);var r=new fa(t,e,"",i);this.postEnvelope(r)},e.prototype.insertChild=function(t,e,i,r){r=b.fromAny(r);var o=new ya(t,e,i,r);this.postEnvelope(o)},e.prototype.removeChild=function(t,e){var i=new ma(t,e,"");this.postEnvelope(i)},e.prototype.setModel=function(t,e){e=b.fromAny(e);var i=new ga(t,e);this.postEnvelope(i)},e.prototype.postEnvelope=function(t){var e=t.toRecon();this._worker.postMessage(e)},e.prototype.onEnvelope=function(t){t instanceof da?this.onAppendEnvelope(t):t instanceof fa?this.onPrependEnvelope(t):t instanceof ya?this.onInsertEnvelope(t):t instanceof ma?this.onRemoveEnvelope(t):t instanceof va?this.onStateEnvelope(t):this.onUnknownEnvelope(t)},e.prototype.onAppendEnvelope=function(t){var e=t.parent(),i=t.child(),r=t.body(),o=this._appView.getView(e);if(o){var n=Aa.Global.castView(r,o.stack(),Aa.Global);n&&(n._id=i,o.appendChildView(n))}},e.prototype.onPrependEnvelope=function(t){var e=t.parent(),i=t.child(),r=t.body(),o=this._appView.getView(e);if(o){var n=Aa.Global.castView(r,o.stack(),Aa.Global);n&&(n._id=i,o.prependChildView(n))}},e.prototype.onInsertEnvelope=function(t){var e=t.parent(),i=t.child(),r=t.target(),o=t.body(),n=this._appView.getView(e);if(n){var s=Aa.Global.castView(o,n.stack(),Aa.Global);if(s){s._id=i;var a=this._appView.getView(r)||null;n.insertChildView(s,a)}}},e.prototype.onRemoveEnvelope=function(t){var e=t.parent(),i=t.child(),r=this._appView.getView(e);if(r){var o=this._appView.getView(i);o&&r.removeChildView(o)}},e.prototype.onStateEnvelope=function(t){var e=t.child(),i=t.body(),r=this._appView.getView(e);r&&r.setState(i)},e.prototype.onUnknownEnvelope=function(t){},e.prototype.onMessage=function(t){var e=t.data;if("string"==typeof e){var i=la.parseRecon(e);i?this.onEnvelope(i):this.onUnknownEnvelope(e)}},e}(Gu),ju=function(t){function e(e){var i=t.call(this)||this;return i._appView=e,i}return u(e,t),Object.defineProperty(e.prototype,"appView",{get:function(){return this._appView},enumerable:!0,configurable:!0}),e.prototype.appendChild=function(t,e,i){i=b.fromAny(i);var r=this._appView.getView(t);if(r){var o=Aa.Global.castView(i,r.stack(),Aa.Global);o&&(o._id=e,r.appendChildView(o))}},e.prototype.prependChild=function(t,e,i){i=b.fromAny(i);var r=this._appView.getView(t);if(r){var o=Aa.Global.castView(i,r.stack(),Aa.Global);o&&(o._id=e,r.prependChildView(o))}},e.prototype.insertChild=function(t,e,i,r){r=b.fromAny(r);var o=this._appView.getView(t);if(o){var n=Aa.Global.castView(r,o.stack(),Aa.Global);if(n){n._id=e;var s=this._appView.getView(i)||null;o.insertChildView(n,s)}}},e.prototype.removeChild=function(t,e){var i=this._appView.getView(t);if(i){var r=this._appView.getView(e);r&&i.removeChildView(r)}},e.prototype.setState=function(t,e){e=b.fromAny(e);var i=this._appView.getView(t);i&&i.setState(e)},e}(qu),Yu=function(t){function e(e){var i=t.call(this)||this;return i._appModel=e,i}return u(e,t),Object.defineProperty(e.prototype,"appModel",{get:function(){return this._appModel},enumerable:!0,configurable:!0}),e.prototype.appendChild=function(t,e,i){i=b.fromAny(i);var r=this._appModel.getModel(t);if(r){var o=Aa.Global.castModel(i,r.stack(),Aa.Global);o||(o=new Sa(e)),o&&(o._id=e,r.appendChildModel(o))}},e.prototype.prependChild=function(t,e,i){i=b.fromAny(i);var r=this._appModel.getModel(t);if(r){var o=Aa.Global.castModel(i,r.stack(),Aa.Global);o||(o=new Sa(e)),o&&(o._id=e,r.prependChildModel(o))}},e.prototype.insertChild=function(t,e,i,r){r=b.fromAny(r);var o=this._appModel.getModel(t);if(o){var n=Aa.Global.castModel(r,o.stack(),Aa.Global);if(n||(n=new Sa(e)),n){n._id=e;var s=this._appModel.getModel(i)||null;o.insertChildModel(n,s)}}},e.prototype.removeChild=function(t,e){var i=this._appModel.getModel(t);if(i){var r=this._appModel.getModel(e);r&&i.removeChildModel(r)}},e.prototype.setModel=function(t,e){e=b.fromAny(e);var i=this._appModel.getModel(t);i&&i.setData(e)},e}(Gu),Xu=function(t){function e(e){var i=t.call(this,"app")||this;return i._appModel=i,void 0===e&&(e=new Hu(i)),i._port=e,i._routeScope=new Da(i),i._descendantModels={},i._descendantModels[i._id]=i,i._lastRefreshTime=0,i._refreshTimer=0,i.onRefresh=i.onRefresh.bind(i),i}return u(e,t),Object.defineProperty(e.prototype,"appModel",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"routeScope",{get:function(){return this._routeScope},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentScope",{get:function(){return this._routeScope},enumerable:!0,configurable:!0}),e.prototype.getModel=function(t){return this._descendantModels[t]},e.prototype.addDescendantModels=function(t,e){this._descendantModels[t._id]||(this._descendantModels[t._id]=t,t.setAppModel(this));for(var i=0;i<t._childModels.length;i+=1)this.addDescendantModels(t._childModels[i],t)},e.prototype.removeDescendantModels=function(t,e){for(var i=0;i<t._childModels.length;i+=1)this.removeDescendantModels(t._childModels[i],t);this._descendantModels[t._id]&&(t.setAppModel(null),delete this._descendantModels[t._id])},e.prototype.appendChildView=function(t,e,i){2===arguments.length&&(i=e,e=t,t=this._id),this._port.appendChild(t,e,i)},e.prototype.prependChildView=function(t,e,i){2===arguments.length&&(i=e,e=t,t=this._id),this._port.prependChild(t,e,i)},e.prototype.insertChildView=function(t,e,i,r){3===arguments.length&&(r=i,i=e,e=t,t=this._id),this._port.insertChild(t,e,i,r)},e.prototype.removeChildView=function(t,e){1===arguments.length&&(e=t,t=this._id),this._port.removeChild(t,e)},e.prototype.setState=function(e,i){void 0===i?t.prototype.setState.call(this,e):this._port.setState(i._id,e)},e.prototype.requestRestate=function(){0==(this._flags&Sa.REQUEST_RESTATE)&&(this._flags|=Sa.REQUEST_RESTATE,this._refreshTimer||(this._refreshTimer=setTimeout(this.onRefresh,1/60)))},e.prototype.onRefresh=function(){this._refreshTimer=0,0!=(this._flags&Sa.REQUEST_RESTATE)&&(this.cascadeWillRestate(),this.cascadeDidRestate())},e}(Sa);Sa.AppModel=Xu;var Ku=function(t){function e(e,i){var r=t.call(this,e,"app")||this;if(r._appView=r,void 0===i)for(var o=document.querySelectorAll("script"),n=0;n<o.length;n+=1){var s=o[n];if(s.hasAttribute("swim-app")){var a=s.getAttribute("src");if(a){var u=new Worker(a);i=new Nu(r,u);break}}}if(void 0===i){var h=new ju;h._appView=r;var l=new Yu;l._appModel=new Xu(h),i=l}return r._port=i,r._descendantViews={},r._descendantViews[r._id]=r,r.onPopState=r.onPopState.bind(r),r._popovers=[],r._modals=[],r._popoverTransition=new fs(250,pn.quadOut),r._modalTransition=r._popoverTransition,r._shadowBox=Bu.create(),r._shadowBox.didHide=r.shadowBoxDidHide.bind(r),r.onClick=r.onClick.bind(r),r.node.addEventListener("click",r.onClick),r._refreshFrame=0,r.onRefreshFrame=r.onRefreshFrame.bind(r),r.onResize=r.onResize.bind(r),r.onScroll=r.onScroll.bind(r),window.addEventListener("resize",r.onResize),window.addEventListener("scroll",r.onScroll),r._port.setModel(r._id,wa.Theme),r.refreshRouteState(),r}return u(e,t),Object.defineProperty(e.prototype,"appView",{get:function(){return this},enumerable:!0,configurable:!0}),e.prototype.getView=function(t){return this._descendantViews[t]},e.prototype.addDescendantViews=function(t,e){this._descendantViews[t._id]||(this._descendantViews[t._id]=t,t.setAppView(this),this._port.appendChild(e._id,t._id,t._model));for(var i=0;i<t._childViews.length;i+=1)this.addDescendantViews(t._childViews[i],t)},e.prototype.removeDescendantViews=function(t,e){for(var i=0;i<t._childViews.length;i+=1)this.removeDescendantViews(t._childViews[i],t);this._descendantViews[t._id]&&(this._port.removeChild(e._id,t._id),t.setAppView(null),delete this._descendantViews[t._id])},e.prototype.setModel=function(e,i){void 0===i?t.prototype.setModel.call(this,e):this._port.setModel(i._id,e)},e.prototype.popoverTransition=function(t){return void 0===t?this._popoverTransition:(this._popoverTransition=fs.fromAny(t),this)},e.prototype.modalTransition=function(t){return void 0===t?this._modalTransition:(this._modalTransition=fs.fromAny(t),this)},e.prototype.pushRouteState=function(t,e){},e.prototype.replaceRouteState=function(t,e){},e.prototype.refreshRouteState=function(){},e.prototype.onPopState=function(t){this.refreshRouteState()},e.prototype.indexOfPopover=function(t){t instanceof Uu&&(t=t.popover);for(var e=0;e<this._popovers.length;e+=1)if(this._popovers[e].popover===t)return e;return-1},e.prototype.showPopover=function(t,e,i){void 0===i&&void 0!==e&&(i=e),e=e;var r=this.indexOfPopover(t);r>=0?t=this._popovers[r]:(e&&void 0!==e.exclusive&&!e.exclusive||this.hideAll(i),t instanceof Qs&&(t=new Uu(t)),this._popovers.push(t),this.appendPopover(t),t.addObserver(this)),void 0===i&&(i=this._popoverTransition),t.show(i)},e.prototype.hidePopover=function(t,e){var i=this.indexOfPopover(t);i>=0&&(void 0===e&&(e=this._popoverTransition),this._popovers[i].hide(e))},e.prototype.hidePopovers=function(t){void 0===t&&(t=this._popoverTransition);for(var e=0;e<this._popovers.length;e+=1)this._popovers[e].hide(t)},e.prototype.appendPopover=function(t){this.node.appendChild(t.node)},e.prototype.showShadowBox=function(t){this._shadowBox.isVisible()||(this._shadowBox.node.parentNode||this.appendShadowBox(this._shadowBox),this._shadowBox.show(t))},e.prototype.hideShadowBox=function(t){this._shadowBox.isVisible()&&this._shadowBox.hide(t)},e.prototype.appendShadowBox=function(t){this.append(t)},e.prototype.shadowBoxDidHide=function(){this._shadowBox.remove()},e.prototype.indexOfModal=function(t){t instanceof Uu&&(t=t.popover);for(var e=0;e<this._modals.length;e+=1)if(this._modals[e].popover===t)return e;return-1},e.prototype.showModal=function(t,e,i){void 0===i&&void 0!==e&&(i=e),e=e;var r=this.indexOfModal(t);r>=0?t=this._modals[r]:(e&&void 0!==e.exclusive&&!e.exclusive||this.hideAll(i),t instanceof Qs&&(t=new Uu(t)),this.showShadowBox(i),this._modals.push(t),this._shadowBox.append(t),t.addObserver(this)),void 0===i&&(i=this._modalTransition),t.show(i)},e.prototype.hideModal=function(t,e){var i=this.indexOfModal(t);i>=0&&(void 0===e&&(e=this._modalTransition),this._modals[i].hide(e));for(var r=0;r<this._modals.length;r+=1)if(this._modals[r].isVisible())return;this.hideShadowBox(e)},e.prototype.hideModals=function(t){void 0===t&&(t=this._modalTransition);for(var e=0;e<this._modals.length;e+=1)this._modals[e].hide(t);this.hideShadowBox(t)},e.prototype.hideAll=function(t){this.hidePopovers(),this.hideModals()},e.prototype.popoverDidShow=function(t){this.requireReview(),this.requireResize()},e.prototype.popoverDidHide=function(t){var e=this.indexOfPopover(t);return e>=0?((t=this._popovers[e]).remove(),void this._popovers.splice(e,1)):(e=this.indexOfModal(t))>=0?((t=this._modals[e]).remove(),void this._modals.splice(e,1)):void 0},e.prototype.onPassthroughClick=function(t){this.hideAll()},e.prototype.onClick=function(t){this.onPassthroughClick(t)},e.prototype.requestResize=function(){0==(this._flags&wa.REQUEST_RESIZE)&&(this._flags|=wa.REQUEST_RESIZE,this._refreshFrame||(this._refreshFrame=requestAnimationFrame(this.onRefreshFrame)))},e.prototype.requestReview=function(){0==(this._flags&wa.REQUEST_REVIEW)&&(this._flags|=wa.REQUEST_REVIEW,this._refreshFrame||(this._refreshFrame=requestAnimationFrame(this.onRefreshFrame)))},e.prototype.requestRedraw=function(){0==(this._flags&wa.REQUEST_REDRAW)&&(this._flags|=wa.REQUEST_REDRAW,this._refreshFrame||(this._refreshFrame=requestAnimationFrame(this.onRefreshFrame)))},e.prototype.onRefreshFrame=function(){this._refreshFrame=0,0!=(this._flags&wa.REQUEST_RESIZE)&&(this.cascadeWillResize(),this.cascadeDidResize()),0!=(this._flags&wa.REQUEST_REVIEW)&&(this.cascadeWillReview(),this.cascadeDidReview()),0!=(this._flags&wa.REQUEST_REDRAW)&&(this.cascadeWillRedraw(),this.cascadeDidRedraw())},e.prototype.onResize=function(t){this.requireResize()},e.prototype.onScroll=function(t){this.requireReview()},e.create=function(t){if(void 0===t&&(t="div"),t instanceof e)return t;if(t instanceof ba)throw new TypeError(""+t);if("string"==typeof t)return new e(document.createElement(t));if(t.view instanceof e)return t.view;if(t.view)throw new TypeError(""+t.view);if(t instanceof HTMLElement)return new e(t);throw new TypeError(""+t)},e}(tu);wa.AppView=Ku;var Qu=function(t){function e(){var e=t.call(this)||this;return e._bindings=L.empty(),e._attrs=L.Empty,e}return u(e,t),e.prototype.reattr=function(t,e){var i=L.empty(this._bindings.length);this._bindings.forEach(function(t){if(t instanceof T&&t.key instanceof I){var r=t.value.evaluate(e).toValue();r.isDefined()&&i.slot(t.key,r)}},this),this._attrs.equals(i)||(this._attrs=i,t.slot("attrs",i))},e.prototype.willRemodel=function(t,e){this.reattr(t,e)},e}(Ia),Zu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"attrs"},enumerable:!0,configurable:!0}),e.prototype.cast=function(t){if(t.tag===this.tag){var e=new Qu;return t.forEach(function(t){this.materializeDirectiveParam(e,t)},this),e}},e.prototype.materializeDirectiveParam=function(t,e){e instanceof R&&e.key.value===this.tag||e instanceof M&&t._bindings.push(e)},e.Form=new e,e}(_a);_a.addGlobal(Zu.Form);var Ju=function(t){function e(){var e=t.call(this)||this;return e._bindings=L.empty(),e._style=L.Empty,e}return u(e,t),e.prototype.restyle=function(t,e){var i=L.empty(this._bindings.length);this._bindings.forEach(function(t){if(t instanceof T&&t.key instanceof I){var r=t.value.evaluate(e).toValue();r.isDefined()&&i.slot(t.key,r)}},this),this._style.equals(i)||(this._style=i,t.slot("style",i))},e.prototype.willRemodel=function(t,e){this.restyle(t,e)},e}(Ia),$u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"style"},enumerable:!0,configurable:!0}),e.prototype.cast=function(t){if(t.tag===this.tag){var e=new Ju;return t.forEach(function(t){this.materializeDirectiveParam(e,t)},this),e}},e.prototype.materializeDirectiveParam=function(t,e){e instanceof R&&e.key.value===this.tag||e instanceof M&&t._bindings.push(e)},e.Form=new e,e}(_a);_a.addGlobal($u.Form);var th=function(t){function e(e,i){var r=t.call(this)||this;return r._key=e,r._rhs=i,r._value=b.Absent,r}return u(e,t),e.prototype.reevaluate=function(t){void 0===t&&(t=this.stack());var e=this._value,i=this._rhs.evaluate(t).toValue();i.isDefined()?e.equals(i)||(this._value=i.commit(),this._model._modelScope._record.set(this._key,i),this._model.requireRestate()):e.isDefined()&&(this._value=i.commit(),this._model._modelScope._record.delete(this._key),this._model.requireRestate())},e.prototype.willRestate=function(){this.reevaluate()},e}(Ia),eh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.cast=function(t){if(t instanceof M){var e=t.key,i=t.value.header("let");if(i.isDefined())return new th(e,i)}},e.Form=new e,e}(_a);_a.addGlobal(eh.Form);var ih=function(t){function e(){var e=t.call(this)||this;return e._bindings=L.Empty,e._template=L.empty(),e._keySelector=B.Identity,e._childDirectives=new Ze,e}return u(e,t),Object.defineProperty(e.prototype,"bindings",{get:function(){return this._bindings},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0}),e.prototype.createChildDirectives=function(t,e,i){var r=[];return i.push(e),this._template.forEach(function(t){var i=C.generateId(),o=new rh(i);e.forEach(function(t){t instanceof M&&o._scope.set(t.key,t.value)},this),this._model.appendChildView(i,t.toValue().clone()),r.push(o)},this),i.pop(),r},e.prototype.updateChildDirectives=function(t,e,i,r){for(var o=function(t){var r=i[t];e.forEach(function(t){t instanceof M&&r._scope.set(t.key,t.value)},n),r.updateData()},n=this,s=0;s<i.length;s+=1)o(s)},e.prototype.deleteChildDirectives=function(t,e){for(var i=0;i<e.length;i+=1){var r=e[i];this._model.removeChildView(r._id)}},e.prototype.instantiate=function(t,e,i,r){if(i<this._bindings.length){var o=this._bindings.getItem(i),n=o.key.isDefined()?o.key:U.valueOf(i);r.push(e);var s=o.toValue().evaluate(r);r.pop(),s.forEach(function(o){this.instantiate(t,e.branch().slot(n,o.toValue()),i+1,r)},this)}else{var a=this._keySelector.evaluate(e).toValue(),u=this._childDirectives.get(a);u?this.updateChildDirectives(a,e,u,r):(u=this.createChildDirectives(a,e,r)).length&&this._childDirectives.set(a,u),u.length&&t.set(a,u)}},e.prototype.reinstantiate=function(){var t=new Ze;this.instantiate(t,L.empty(),0,this.stack()),t.size<this._childDirectives.size&&this._childDirectives.forEach(function(e,i){t.has(e)||(this._childDirectives.delete(e),this.deleteChildDirectives(e,i))},this)},e.prototype.willRestate=function(){this.reinstantiate()},e.prototype.didInsertChildModel=function(t){this._childDirectives.forEach(function(e,i){for(var r=0;r<i.length;r+=1){var o=i[r];o._id===t._id&&(t.addDirective(o),o.initData())}})},e}(Ia),rh=function(t){function e(e){var i=t.call(this)||this;return i._id=e,i._scope=L.empty(),i}return u(e,t),e.prototype.initData=function(){this._model&&(this._model._modelScope._record=this._scope.concat(this._model._modelScope._record),this._model.requireRestate())},e.prototype.updateData=function(){if(this._model){var t=this._model._modelScope._record,e=!1;this._scope.forEach(function(i){if(i instanceof M){var r=t.get(i.key),o=i.value;r.equals(o)||(t.set(i.key,i.value),e=!0)}},this),e&&this._model.requireRestate()}},e}(Ia),oh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"each"},enumerable:!0,configurable:!0}),e.prototype.cast=function(t){if(t.tag===this.tag){var e=new ih;return t.forEach(function(t){this.materializeDirectiveParam(e,t)},this),e}},e.prototype.materializeDirectiveParam=function(t,e){if(e instanceof R&&e.key.value===this.tag)e.value instanceof L&&(t._bindings=e.value.commit());else if(e.key instanceof I){"key"===e.key.value&&(t._keySelector=e.toValue())}else e instanceof b&&t._template.push(e)},e.Form=new e,e}(_a);_a.addGlobal(oh.Form);var nh=function(t){function e(){var e=t.call(this)||this;return e._selector=B.literal(b.Absent),e._bindings=L.empty(),e}return u(e,t),Object.defineProperty(e.prototype,"selector",{get:function(){return this._selector},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bindings",{get:function(){return this._bindings},enumerable:!0,configurable:!0}),e.prototype.reinject=function(t){void 0===t&&(t=this.stack());var e=this._selector.evaluate(t);e instanceof L&&this._bindings.forEach(function(i){var r=i.key.evaluate(t).toValue();if(r.isDefined()){var o=e.get(r),n=i.toValue().evaluate(t).toValue();n.isDefined()?o.equals(n)||e.set(r,n):o.isDefined()&&e.delete(r)}},this)},e.prototype.willRestate=function(){this.reinject()},e}(Ia),sh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"inject"},enumerable:!0,configurable:!0}),e.prototype.cast=function(t){if(t.tag===this.tag){var e=new nh;return t.forEach(function(t){this.materializeDirectiveParam(e,t)},this),e}},e.prototype.materializeDirectiveParam=function(t,e){e instanceof R&&e.key.value===this.tag&&e.value instanceof B?t._selector=e.value:e instanceof M&&t._bindings.push(e)},e.Form=new e,e}(_a);_a.addGlobal(sh.Form);var ah=function(t){function e(e){var i=t.call(this)||this;return i._timeout=e,i._deadline=0,i._timer=0,i.onTick=i.onTick.bind(i),i}return u(e,t),e.prototype.reschedule=function(t){var e=this._timeout.evaluate(t).numberValue();if(e){var i=Date.now()+e;Math.abs(this._deadline-i)>16&&(this._timer&&clearTimeout(this._timer),this._deadline=i,this._timer=setTimeout(this.onTick,e))}else this._timer&&(clearTimeout(this._timer),this._deadline=0,this._timer=0)},e.prototype.onTick=function(){this._deadline=0,this._timer=0,this._model.requireRestate(),this.reschedule(this.stack())},e.prototype.didRemodel=function(e,i){t.prototype.didRemodel.call(this,e,i),this.reschedule(i)},e}(Ia),uh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"tick"},enumerable:!0,configurable:!0}),e.prototype.cast=function(t){var e=t.header(this.tag);if(e.isDefined())return new ah(e)},e.Form=new e,e}(_a);_a.addGlobal(uh.Form);var hh=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r._deauthedTemplate=b.Absent,r._authedTemplate=b.Absent,r.onGoogleAuth2Loaded=r.onGoogleAuth2Loaded.bind(r),r.onGoogleUserChanged=r.onGoogleUserChanged.bind(r),r.display("flex").flexGrow(1),r}return u(e,t),e.prototype.isAuthenticated=function(){return!!this._auth2&&this._auth2.isSignedIn.get()},e.prototype.didSetAppView=function(t){t&&"undefined"!=typeof gapi&&void 0!==this._googleClientId&&gapi.load("auth2",this.onGoogleAuth2Loaded)},e.prototype.onGoogleAuth2Loaded=function(){this._auth2=gapi.auth2.init({client_id:this._googleClientId,scope:"profile email"}),this._auth2.currentUser.listen(this.onGoogleUserChanged),this._auth2.isSignedIn.get()&&this._auth2.signIn()},e.prototype.onGoogleUserChanged=function(t){if(t.isSignedIn()){var e=t.getAuthResponse().id_token;this.setModel(this._model.withSlot("openIDToken",e))}else this.setModel(this._model.withoutKey("openIDToken").toValue())},e.create=function(){return new e(document.createElement("div")).className("authenticated")},e.applyTheme=function(t){var e=L.empty().slot("width","180px").slot("height","240px"),i=L.empty().slot("baseColor",B.get("primaryColor")),r=L.empty().slot("popover",e).slot("button",i);t.set("account",r)},e}(tu);hh.applyTheme(hh.Theme);var lh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.remodel=function(e){void 0===e&&(e=this.stack());var i,r=this._openIDToken,o=ph.evaluate(e).stringValue();r!==o&&(this._openIDToken=o,i=void 0!==o?L.empty().attr("idToken",o):b.Absent,Ji._options.credentials=i,Ji._hosts.forEach(function(t,e){e.authenticate(i)},this));t.prototype.remodel.call(this,e)},e}(eu),ph=B.get("openIDToken"),ch=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"authenticated"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=hh.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new lh,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){i.key instanceof I&&("googleClientId"===i.key.value&&(e._googleClientId=i.toValue().stringValue()));var n=o.castView(i.toValue(),r,o);return n instanceof ba&&e.append(n),t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(iu);Aa.addGlobal(ch.Form);var dh=function(t){function e(e){var i=t.call(this,e)||this;return i.onGoogleUserChanged=i.onGoogleUserChanged.bind(i),i.onSignOut=i.onSignOut.bind(i),i.display("flex").position("absolute").justifyContent("center").alignItems("center").placement(["top","bottom"]).boxShadow("0 2px 4px 0 rgba(0, 0, 0, 0.12), 0 0 4px 0 rgba(0, 0, 0, 0.08)").borderRadius(3),i._googleSignInButton=tu.create("div"),i._googleSignInButton.elemId(i._googleSignInButton._id),i._signOutButton=tu.create("button").text("Sign Out"),i._signOutButton.on("click",i.onSignOut),i}return u(e,t),Object.defineProperty(e.prototype,"authenticatedView",{get:function(){for(var t=this._parentView;t;){if(t instanceof hh)return t;t=t._parentView}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"auth2",{get:function(){var t=this.authenticatedView;if(t){var e=t._auth2;if(e)return e}},enumerable:!0,configurable:!0}),e.prototype.onGoogleUserChanged=function(t){t.isSignedIn()?(this._googleSignInButton.remove(),this.append(this._signOutButton)):this._googleSignInButton._parentView||(this._signOutButton.remove(),this.append(this._googleSignInButton),gapi.signin2.render(this._googleSignInButton._id,{scope:"profile email"})),this.hide()},e.prototype.onSignOut=function(t){var e=this.auth2;e&&e.disconnect()},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("popoverWidth").cast(qo.Form);r&&(this.width(r),this.requireResize());var o=e.get("popoverHeight").cast(qo.Form);o&&(this.height(o),this.requireResize())},e.prototype.popoverWillShow=function(e){t.prototype.popoverWillShow.call(this,e);var i=this.auth2;i&&(i.currentUser.listen(this.onGoogleUserChanged),this.onGoogleUserChanged(i.currentUser.get()))},e.create=function(t){if(t instanceof e)return t;if(t instanceof ba)throw new TypeError(""+t);if(void 0===t||"string"==typeof t)return new e(Qs.create(t)).className("account-popover");if(t.view instanceof e)return t.view;if(t.view)throw new TypeError(""+t.view);if(t instanceof HTMLElement)return new e(new Qs(t));throw new TypeError(""+t)},e}(Uu),fh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=Wu.Params.concat([new Ca("popoverWidth",B.get("popoverWidth").or(B.get("account").get("popover").get("width"))),new Ca("popoverHeight",B.get("popoverHeight").or(B.get("account").get("popover").get("height")))]),e}(Wu),yh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"accountPopover"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=dh.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new fh,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(iu);Aa.addGlobal(yh.Form);var mh=function(t){function e(e){var i=t.call(this,e)||this;return i._autoPrompt=!1,i._accountPopoverTemplate=L.empty().attr("accountPopover"),i.onClick=i.onClick.bind(i),i.display("flex").visibility("hidden").flexGrow(1).flexShrink(0).justifyContent("center").alignItems("center"),i._iconBox=i.append("div").cursor("pointer"),i._iconView=Xa.create("svg").width(32).height(32).viewBox("0 0 32 32"),i._iconBox.append(i._iconView),i._baseView=i._iconView.append("circle").cx(16).cy(16).r(16),i._headView=i._iconView.append("path").d("M7.24,24.22 L8.99,24.22 C10.91,24.22 12.48,22.65 12.48,20.72 L12.48,19.56 C11.79,18.73 11.24,17.78 10.91,16.75 C10.84,16.54 10.80,16.29 10.61,16.16 C9.85,15.54 9.64,14.37 10.11,13.51 C10.207,13.34 10.37,13.20 10.35,12.99 C10.35,11.94 10.34,10.90 10.36,9.86 C10.40,8.88 10.64,7.90 11.19,7.09 C11.82,6.16 12.83,5.53 13.91,5.25 C15.14,4.94 16.45,4.93 17.70,5.17 C18.70,5.35 19.66,5.79 20.36,6.53 C21.22,7.45 21.58,8.73 21.60,9.97 C21.61,10.99 21.60,12.02 21.60,13.05 C21.60,13.20 21.72,13.30 21.79,13.42 C22.29,14.23 22.16,15.36 21.49,16.03 C21.37,16.16 21.18,16.25 21.14,16.45 C20.80,17.60 20.24,18.68 19.47,19.60 L19.47,20.72 C19.47,22.65 21.04,24.22 22.97,24.22 L24.71,24.22 C24.71,24.22 26.35,24.67 28.04,26.54 C25.10,29.89 20.80,32 16,32 C11.19,32 6.87,29.88 3.94,26.52 C5.62,24.67 7.24,24.22 7.24,24.22 Z").fill(Qo.white()),i._iconBox.on("click",i.onClick),i}return u(e,t),Object.defineProperty(e.prototype,"authenticatedView",{get:function(){for(var t=this._parentView;t;){if(t instanceof hh)return t;t=t._parentView}},enumerable:!0,configurable:!0}),e.prototype.autoPrompt=function(t){if(void 0===t)return this._autoPrompt;if(this._autoPrompt!==t&&(this._autoPrompt=t,t)){var e=this.authenticatedView;e&&!e.isAuthenticated()&&this.showAccountPopover()}return this},e.prototype.showAccountPopover=function(){var t=this.appView;t&&(this._accountPopover=yh.Form.castView(this._accountPopoverTemplate,this.stack(),Aa.Global),this._accountPopover&&(this._accountPopover.addObserver(this),this._accountPopover.source(this._iconView.node),this.appendChildView(this._accountPopover),t.showPopover(this._accountPopover)))},e.prototype.hideAccountPopover=function(){this._accountPopover&&this._accountPopover.hide()},e.prototype.toggleAccountPopover=function(){this._accountPopover?this.hideAccountPopover():this.showAccountPopover()},e.prototype.didSetAppView=function(t){if(t&&this._autoPrompt){var e=this.authenticatedView;e&&!e.isAuthenticated()&&this.showAccountPopover()}},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("autoPrompt").booleanValue();void 0!==r&&this.autoPrompt(r);var o=e.get("baseColor").cast(Qo.Form);o&&this._baseView.fill(o),i.isDefined()||this.visibility(null)},e.prototype.onClick=function(t){t.stopPropagation(),this.toggleAccountPopover()},e.prototype.popoverDidHide=function(t){this._accountPopover&&this._accountPopover.popover===t&&(this._accountPopover=void 0)},e.create=function(){return new e(document.createElement("div")).className("account-button")},e}(tu),vh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=eu.Params.concat([new Ca("autoPrompt",B.get("autoPrompt").or(B.get("account").get("autoPrompt"))),new Ca("baseColor",B.get("baseColor").or(B.get("account").get("button").get("baseColor")))]),e}(eu),gh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"accountButton"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=mh.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new vh,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(iu);Aa.addGlobal(gh.Form);var wh=function(t){function e(e){var i=t.call(this,e)||this;return i.position("relative").flexGrow(1).flexBasis(0),i._surfaceView=null,i._overlayView=i.append("div").display("flex").position("absolute").top(0).right(0).bottom(0).left(0).pointerEvents("none"),i._middleView=i._overlayView.append("div").display("flex").flexDirection("column").flexGrow(1).flexBasis(0),i._centerView=i._middleView.append("div").display("flex").flexGrow(1).flexBasis(0),i._leftView=null,i._rightView=null,i._topView=null,i._bottomView=null,i}return u(e,t),e.prototype.surfaceView=function(t){return void 0===t?this._surfaceView:(this._surfaceView!==t&&(this._surfaceView&&this._surfaceView.remove(),this._surfaceView=t,this._surfaceView&&(this._surfaceView.position("absolute").top(0).right(0).bottom(0).left(0),this.insertBefore(this._surfaceView,this._overlayView))),this)},e.prototype.leftView=function(t){return void 0===t?this._leftView:(this._leftView!==t&&(this._leftView&&this._leftView.remove(),this._leftView=t,this._leftView&&(this._leftView.pointerEvents("auto"),this._overlayView.insertBefore(this._leftView,this._middleView))),this)},e.prototype.rightView=function(t){return void 0===t?this._rightView:(this._rightView!==t&&(this._rightView&&this._rightView.remove(),this._rightView=t,this._rightView&&(this._rightView.pointerEvents("auto"),this._overlayView.append(this._rightView))),this)},e.prototype.topView=function(t){return void 0===t?this._topView:(this._topView!==t&&(this._topView&&this._topView.remove(),this._topView=t,this._topView&&(this._topView.pointerEvents("auto"),this._middleView.insertBefore(this._topView,this._centerView))),this)},e.prototype.bottomView=function(t){return void 0===t?this._bottomView:(this._bottomView!==t&&(this._bottomView&&this._bottomView.remove(),this._bottomView=t,this._bottomView&&(this._bottomView.pointerEvents("auto"),this._middleView.append(this._bottomView))),this)},e.create=function(){return new e(document.createElement("div")).className("board")},e}(tu),bh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(eu),_h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"board"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=wh.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new bh,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){if(i.key instanceof I){var n=i.key.value;if("surface"===n){var s=o.castView(i.toValue(),r,o);if(s)return e.surfaceView(s),e.surfaceView()}else if("left"===n){var a=o.castView(i.toValue(),r,o);if(a)return e.leftView(a),e.leftView()}else if("right"===n){var u=o.castView(i.toValue(),r,o);if(u)return e.rightView(u),e.rightView()}else if("top"===n){var h=o.castView(i.toValue(),r,o);if(h)return e.topView(h),e.topView()}else if("bottom"===n){var l=o.castView(i.toValue(),r,o);if(l)return e.bottomView(l),e.bottomView()}}return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(iu);Aa.addGlobal(_h.Form);var xh,Ah,kh=Math.sqrt(50),Eh=Math.sqrt(10),Ch=Math.sqrt(2),Sh=36e5,Vh=864e5,Dh=(new Ze).set(1e3,ho.seconds()).set(5e3,ho.seconds(5)).set(15e3,ho.seconds(15)).set(3e4,ho.seconds(30)).set(6e4,ho.minutes(1)).set(3e5,ho.minutes(5)).set(9e5,ho.minutes(15)).set(18e5,ho.minutes(30)).set(Sh,ho.hours()).set(3*Sh,ho.hours(3)).set(6*Sh,ho.hours(6)).set(432e5,ho.hours(12)).set(Vh,ho.days()).set(2*Vh,ho.days(2)).set(6048e5,ho.weeks()).set(2592e6,ho.months()).set(7776e6,ho.months(3)).set(31536e6,ho.years()),Mh=Er.pattern(".%L"),Rh=Er.pattern(":%S"),Th=Er.pattern("%I:%M"),Ph=Er.pattern("%I %p"),Lh=Er.pattern("%a %d"),Fh=Er.pattern("%b %d"),zh=Er.pattern("%B"),Ih=Er.pattern("%Y"),Uh=function(){function t(){}return t.prototype.format=function(t){return""+t},t.prototype.createElement=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","g");e.setAttribute("class","tick"),e.tickValue=t;var i=document.createElementNS("http://www.w3.org/2000/svg","line");i.setAttribute("slot","tick-mark"),i.setAttribute("class","tick-mark"),e.appendChild(i);var r=document.createElementNS("http://www.w3.org/2000/svg","text");return r.setAttribute("slot","tick-label"),r.setAttribute("class","tick-label"),r.textContent=this.format(t),e.appendChild(r),e},t.scale=function(t,e){if(void 0===e&&(e=10),t instanceof Tn){var i=t.domain();return new Oh(i[0],i[1],e)}i=t.domain();return new Wh(i[0],i[1],e)},t.step=function(t,e){var i=Math.abs(t)/e,r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),o=i/r;return o>=kh?r*=10:o>=Eh?r*=5:o>=Ch&&(r*=2),t<0?-r:r},t}(),Wh=function(t){function e(e,i,r){var o=t.call(this)||this;return o.x0=e,o.dx=i-o.x0,o.n=Math.max(0,r),o}return u(e,t),e.prototype.count=function(t){return void 0===t?this.n:(this.n=Math.max(0,t),this)},e.prototype.domain=function(t,e){return void 0===t?[this.x0,this.x0+this.dx]:void 0===e?(t=t,this.x0=t[0],this.dx=t[1]-this.x0,this):(this.x0=t,this.dx=e-this.x0,this)},e.prototype.generate=function(){var t,i;this.dx<0?t=(i=this.x0)+this.dx:i=(t=this.x0)+this.dx;var r,o=e.interval(i-t,this.n);if(0===o||!isFinite(o))return[];if(o>0){t=Math.ceil(t/o),i=Math.floor(i/o);var n=Math.ceil(i-t+1);r=new Array(n);for(var s=0;s<n;s+=1)r[s]=(t+s)*o}else{t=Math.floor(t*o),i=Math.ceil(i*o);n=Math.ceil(t-i+1);r=new Array(n);for(s=0;s<n;s+=1)r[s]=(t-s)/o}return this.dx<0&&r.reverse(),r},e.interval=function(t,e){void 0===e&&(e=10);var i=t/e,r=Math.floor(Math.log(i)/Math.LN10),o=Math.pow(10,r),n=i/o,s=n>=kh?10:n>=Eh?5:n>=Ch?2:1;return r>=0?o*s:-Math.pow(10,-r)/s},e}(Uh),Oh=function(t){function e(e,i,r,o){var n=t.call(this)||this;return e=oo.fromAny(e),i=oo.fromAny(i),n.t0=e.time(),n.dt=i.time()-n.t0,n.zone=o||e.zone(),n.n=Math.max(0,r),n}return u(e,t),e.prototype.count=function(t){return void 0===t?this.n:(this.n=Math.max(0,t),this)},e.prototype.domain=function(t,e){return void 0===t?[new oo(this.t0,this.zone),new oo(this.t0+this.dt,this.zone)]:(void 0===e?(e=(t=t)[1],t=t[0]):t=t,t=oo.fromAny(t),e=oo.fromAny(e),this.t0=t.time(),this.dt=e.time()-this.t0,this)},e.prototype.generate=function(t){var i,r;this.dt<0?i=(r=this.t0)+this.dt:r=(i=this.t0)+this.dt,void 0===t&&(t=this.n);var o=(t=e.interval(r-i,t)).range(new oo(i,this.zone),new oo(r+1,this.zone));return this.dt<0&&o.reverse(),o},e.prototype.format=function(t){return ho.seconds().floor(t)<t?Mh.format(t):ho.minutes().floor(t)<t?Rh.format(t):ho.hours().floor(t)<t?Th.format(t):ho.days().floor(t)<t?Ph.format(t):ho.months().floor(t)<t?ho.weeks().floor(t)<t?Lh.format(t):Fh.format(t):ho.years().floor(t)<t?zh.format(t):Ih.format(t)},e.interval=function(t,e){if(void 0===e&&(e=10),"number"==typeof e){var i=Math.abs(t)/e,r=Dh.nextKey(i);if(void 0===r){var o=Uh.step(t/31536e6,e);e=ho.years(o)}else if(r>1e3)e=i/Dh.previousKey(i)<r/i?Dh.previousValue(i):Dh.nextValue(i);else{o=Math.max(1,Uh.step(t,e));e=ho.milliseconds(o)}}return e},e}(Uh),Bh=function(){function t(t,e){this.node=t,this.ticks=new Ze,this._frame=null,this._scale=e,this._domainColor=Qo.transparent(),this._domainWidth=1,this._domainSerif=6,this._tickMarkColor=Qo.transparent(),this._tickMarkWidth=1,this._tickMarkLength=6,this._tickLabelColor=Qo.transparent(),this._tickLabelPadding=0,this.dirty=!0,this.observers=[],this.domainPath=document.createElementNS("http://www.w3.org/2000/svg","path"),this.domainPath.setAttribute("class","domain"),this.domainPath.setAttribute("fill","none"),this.node.appendChild(this.domainPath)}return t.prototype.frame=function(t){if(void 0===t)return this._frame;this._frame=t;for(var e=0;e<this.observers.length;e+=1){var i=this.observers[e];i.axisDidScale&&i.axisDidScale(this._scale,this)}return this},t.prototype.scale=function(e){if(void 0===e)return this._scale;if(e=t.scale(e),!this._scale.equals(e)){this._scale=e,this.dirty=!0;for(var i=0;i<this.observers.length;i+=1){var r=this.observers[i];r.axisDidScale&&r.axisDidScale(this._scale,this)}}return this},t.prototype.domain=function(e,i){if(void 0===e)return this._scale.domain();"string"==typeof e&&(e=t.scale(e).domain());var r=this._scale.domain(e,i);if(!this._scale.equals(r)){this._scale=r,this.dirty=!0;for(var o=0;o<this.observers.length;o+=1){var n=this.observers[o];n.axisDidScale&&n.axisDidScale(this._scale,this)}}return this},t.prototype.range=function(t,e){if(void 0===t)return this._scale.range();var i=this._scale.range(t,e);if(!this._scale.equals(i)){this._scale=i,this.dirty=!0;for(var r=0;r<this.observers.length;r+=1){var o=this.observers[r];o.axisDidScale&&o.axisDidScale(this._scale,this)}}return this},t.prototype.transformFrameX=function(){if(this._frame){var t=this._frame.domain(),e=this._scale.domain(),i=this._frame.scale(t[0]),r=this._frame.scale(t[1]),o=this._frame.scale(e[0]),n=this._frame.scale(e[1]),s=i-o,a=r-n,u=Math.abs(s-a)>.5&&Math.abs(r-i)>.5?(r-i)/(n-o):1,h=dn.translateX(u*s);return 1!==u&&(h=h.scaleX(u)),h}return null},t.prototype.transformFrameY=function(){if(this._frame){var t=this._frame.domain(),e=this._scale.domain(),i=this._frame.scale(t[0]),r=this._frame.scale(t[1]),o=this._frame.scale(e[0]),n=this._frame.scale(e[1]),s=i-o,a=r-n,u=Math.abs(s-a)>.5&&Math.abs(r-i)>.5?(r-i)/(n-o):1,h=dn.translateY(u*s);return 1!==u&&(h=h.scaleY(u)),h}return null},t.prototype.domainColor=function(t){return void 0===t?this._domainColor:(t=Qo.fromAny(t),this._domainColor.equals(t)||(this._domainColor=t,this.dirty=!0),this)},t.prototype.domainWidth=function(t){return void 0===t?this._domainWidth:(this._domainWidth!==t&&(this._domainWidth=t,this.dirty=!0),this)},t.prototype.domainSerif=function(t){return void 0===t?this._domainSerif:(this._domainSerif!==t&&(this._domainSerif=t,this.dirty=!0),this)},t.prototype.tickMarkColor=function(t){return void 0===t?this._tickMarkColor:(t=Qo.fromAny(t),this._tickMarkColor.equals(t)||(this._tickMarkColor=t,this.dirty=!0),this)},t.prototype.tickMarkWidth=function(t){return void 0===t?this._tickMarkWidth:(this._tickMarkWidth!==t&&(this._tickMarkWidth=t,this.dirty=!0),this)},t.prototype.tickMarkLength=function(t){return void 0===t?this._tickMarkLength:(this._tickMarkLength!==t&&(this._tickMarkLength=t,this.dirty=!0),this)},t.prototype.tickLabelColor=function(t){return void 0===t?this._tickLabelColor:(t=Qo.fromAny(t),this._tickLabelColor.equals(t)||(this._tickLabelColor=t,this.dirty=!0),this)},t.prototype.tickLabelPadding=function(t){return void 0===t?this._tickLabelPadding:(this._tickLabelPadding!==t&&(this._tickLabelPadding=t,this.dirty=!0),this)},t.prototype.getTick=function(t){return this.ticks.get(t)},t.prototype.insertTick=function(t){for(var e=0;e<this.observers.length;e+=1){if((r=this.observers[e]).axisWillInsertTick){var i=r.axisWillInsertTick(t,this);if(i)t=i;else if(null===i)return}}this.ticks.set(t.tickValue,t),this.node.insertBefore(t,this.ticks.nextValue(t.tickValue)||null),this.renderTick(t);for(e=0;e<this.observers.length;e+=1){var r;(r=this.observers[e]).axisDidInsertTick&&r.axisDidInsertTick(t,this)}},t.prototype.removeTick=function(t){if(t.parentNode===this.node){for(var e=0;e<this.observers.length;e+=1){(i=this.observers[e]).axisWillRemoveTick&&i.axisWillRemoveTick(t,this)}this.node.removeChild(t),this.ticks.delete(t.tickValue);for(e=0;e<this.observers.length;e+=1){var i;(i=this.observers[e]).axisDidRemoveTick&&i.axisDidRemoveTick(t,this)}}},t.prototype.addObserver=function(t){this.observers.indexOf(t)<0&&this.observers.push(t)},t.prototype.removeObserver=function(t){var e=this.observers.indexOf(t);e>=0&&this.observers.splice(e,1)},t.prototype.render=function(){this.dirty&&(this.dirty=!1,this.renderDomainPath(),this.renderTicks())},t.prototype.renderDomainPath=function(){this.domainPath.setAttribute("stroke",""+this._domainColor),this.domainPath.setAttribute("stroke-width",""+this._domainWidth)},t.prototype.renderTicks=function(){this.ticks.forEach(function(t,e){this.renderTick(e)},this)},t.prototype.renderTick=function(t){for(var e=0;e<t.childNodes.length;e+=1){var i=t.childNodes[e];i instanceof Element&&("tick-mark"===i.getAttribute("slot")?this.renderTickMark(i,t):"tick-label"===i.getAttribute("slot")&&this.renderTickLabel(i,t))}},t.prototype.renderTickMark=function(t,e){t.setAttribute("stroke",""+this._tickMarkColor),t.setAttribute("stroke-width",""+this._tickMarkWidth)},t.prototype.renderTickLabel=function(t,e){t.setAttribute("fill",""+this._tickLabelColor)},t.top=function(e){var i=document.createElementNS("http://www.w3.org/2000/svg","g");return i.setAttribute("pointer-events","all"),i.setAttribute("class","axis axis-top"),new qh(i,t.scale(e))},t.right=function(e){var i=document.createElementNS("http://www.w3.org/2000/svg","g");return i.setAttribute("pointer-events","all"),i.setAttribute("class","axis axis-right"),new Gh(i,t.scale(e))},t.bottom=function(e){var i=document.createElementNS("http://www.w3.org/2000/svg","g");return i.setAttribute("pointer-events","all"),i.setAttribute("class","axis axis-bottom"),new Hh(i,t.scale(e))},t.left=function(e){var i=document.createElementNS("http://www.w3.org/2000/svg","g");return i.setAttribute("pointer-events","all"),i.setAttribute("class","axis axis-left"),new Nh(i,t.scale(e))},t.scale=function(t){if(t instanceof Mn)return t;if("string"==typeof t){if("linear"===t)return new Rn(0,1,new zn(0,0));if("time"===t){var e=oo.current(),i=new oo(+e,e.zone());return i.day(i.day()-1),new Tn(i,e,new zn(0,0))}var r=t.split("..."),o=Zs.parse(r[0]),n=Zs.parse(r[1]);if("number"==typeof o&&"number"==typeof n)return new Rn(o,n,new zn(0,0));if(o instanceof oo&&n instanceof oo)return new Tn(o,n,new zn(0,0))}throw new TypeError(t)},t}(),qh=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r._tickLabelPadding=2,r}return u(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){return"top"},enumerable:!0,configurable:!0}),e.prototype.transformFrame=function(){return this.transformFrameX()},e.prototype.renderDomainPath=function(){var e=this._scale.interpolate(),i=e.map(0),r=e.map(1),o=this._domainSerif,n=new Gs;o?(n.moveTo(i,-o),n.lineTo(i,0),n.lineTo(r,0),n.lineTo(r,-o)):(n.moveTo(i,0),n.lineTo(r,0)),this.domainPath.setAttribute("d",n.toString()),t.prototype.renderDomainPath.call(this)},e.prototype.renderTick=function(e){var i=this._scale.scale(e.tickValue);e.tickCoord=i;var r=dn.translateX(i);e.setAttribute("transform",r.toAttributeString()),t.prototype.renderTick.call(this,e)},e.prototype.renderTickMark=function(e,i){"line"===e.tagName&&(e.setAttribute("x1","0"),e.setAttribute("y1","0"),e.setAttribute("x2","0"),e.setAttribute("y2",""+-this._tickMarkLength)),t.prototype.renderTickMark.call(this,e,i)},e.prototype.renderTickLabel=function(e,i){var r=-(this._tickMarkLength+this._tickLabelPadding);if("g"===e.tagName){var o=dn.translateY(r);e.setAttribute("transform",o.toAttributeString())}else"text"===e.tagName&&(e.setAttribute("y",""+r),e.setAttribute("text-anchor","middle"),e.setAttribute("dominant-baseline","text-after-edge"));t.prototype.renderTickLabel.call(this,e,i)},e}(Bh),Gh=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r._tickLabelPadding=4,r}return u(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){return"right"},enumerable:!0,configurable:!0}),e.prototype.transformFrame=function(){return this.transformFrameY()},e.prototype.renderDomainPath=function(){var e=this._scale.interpolate(),i=e.map(0),r=e.map(1),o=this._domainSerif,n=new Gs;o?(n.moveTo(o,i),n.lineTo(0,i),n.lineTo(0,r),n.lineTo(o,r)):(n.moveTo(0,i),n.lineTo(0,r)),this.domainPath.setAttribute("d",n.toString()),t.prototype.renderDomainPath.call(this)},e.prototype.renderTick=function(e){var i=this._scale.scale(e.tickValue);e.tickCoord=i;var r=dn.translateY(i);e.setAttribute("transform",r.toAttributeString()),t.prototype.renderTick.call(this,e)},e.prototype.renderTickMark=function(e,i){"line"===e.tagName&&(e.setAttribute("x1","0"),e.setAttribute("y1","0"),e.setAttribute("x2",""+this._tickMarkLength),e.setAttribute("y2","0")),t.prototype.renderTickMark.call(this,e,i)},e.prototype.renderTickLabel=function(e,i){var r=this._tickMarkLength+this._tickLabelPadding;if("g"===e.tagName){var o=dn.translateX(r);e.setAttribute("transform",o.toAttributeString())}else"text"===e.tagName&&(e.setAttribute("x",""+r),e.setAttribute("text-anchor","start"),e.setAttribute("dominant-baseline","central"));t.prototype.renderTickLabel.call(this,e,i)},e}(Bh),Hh=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r._tickLabelPadding=2,r}return u(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){return"bottom"},enumerable:!0,configurable:!0}),e.prototype.transformFrame=function(){return this.transformFrameX()},e.prototype.renderDomainPath=function(){var e=this._scale.interpolate(),i=e.map(0),r=e.map(1),o=this._domainSerif,n=new Gs;o?(n.moveTo(i,o),n.lineTo(i,0),n.lineTo(r,0),n.lineTo(r,o)):(n.moveTo(i,0),n.lineTo(r,0)),this.domainPath.setAttribute("d",n.toString()),t.prototype.renderDomainPath.call(this)},e.prototype.renderTick=function(e){var i=this._scale.scale(e.tickValue);e.tickCoord=i;var r=dn.translateX(i);e.setAttribute("transform",r.toAttributeString()),t.prototype.renderTick.call(this,e)},e.prototype.renderTickMark=function(e,i){"line"===e.tagName&&(e.setAttribute("x1","0"),e.setAttribute("y1","0"),e.setAttribute("x2","0"),e.setAttribute("y2",""+this._tickMarkLength)),t.prototype.renderTickMark.call(this,e,i)},e.prototype.renderTickLabel=function(e,i){var r=this._tickMarkLength+this._tickLabelPadding;if("g"===e.tagName){var o=dn.translateY(r);e.setAttribute("transform",o.toAttributeString())}else"text"===e.tagName&&(e.setAttribute("y",""+r),e.setAttribute("text-anchor","middle"),e.setAttribute("dominant-baseline","text-before-edge"));t.prototype.renderTickLabel.call(this,e,i)},e}(Bh),Nh=function(t){function e(e,i){var r=t.call(this,e,i)||this;return r._tickLabelPadding=4,r}return u(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){return"left"},enumerable:!0,configurable:!0}),e.prototype.transformFrame=function(){return this.transformFrameY()},e.prototype.renderDomainPath=function(){var e=this._scale.interpolate(),i=e.map(0),r=e.map(1),o=this._domainSerif,n=new Gs;o?(n.moveTo(-o,i),n.lineTo(0,i),n.lineTo(0,r),n.lineTo(-o,r)):(n.moveTo(0,i),n.lineTo(0,r)),this.domainPath.setAttribute("d",n.toString()),t.prototype.renderDomainPath.call(this)},e.prototype.renderTick=function(e){var i=this._scale.scale(e.tickValue);e.tickCoord=i;var r=dn.translateY(i);e.setAttribute("transform",r.toAttributeString()),t.prototype.renderTick.call(this,e)},e.prototype.renderTickMark=function(e,i){"line"===e.tagName&&(e.setAttribute("x1","0"),e.setAttribute("y1","0"),e.setAttribute("x2",""+-this._tickMarkLength),e.setAttribute("y2","0")),t.prototype.renderTickMark.call(this,e,i)},e.prototype.renderTickLabel=function(e,i){var r=-(this._tickMarkLength+this._tickLabelPadding);if("g"===e.tagName){var o=dn.translateX(r);e.setAttribute("transform",o.toAttributeString())}else"text"===e.tagName&&(e.setAttribute("x",""+r),e.setAttribute("text-anchor","end"),e.setAttribute("dominant-baseline","central"));t.prototype.renderTickLabel.call(this,e,i)},e}(Bh),jh=function(t){function e(e,i,r,o){var n=t.call(this)||this;return n.axis=e,n.tickGenerator=i,n.tickSpacing=r,n.tickTransition=o,n.scale=void 0,n.domain=void 0,n.range=void 0,n.domainColor=void 0,n.domainWidth=void 0,n.domainSerif=void 0,n.tickMarkColor=void 0,n.tickMarkWidth=void 0,n.tickMarkLength=void 0,n.tickLabelColor=void 0,n.tickLabelPadding=void 0,n.dirtyScale=!1,n.ticks=new Ze,n}return u(e,t),e.prototype.onFrame=function(t){this.scale&&this.scale.onFrame(t),this.domain&&this.domain.onFrame(t),this.range&&this.range.onFrame(t),this.domainColor&&this.domainColor.onFrame(t),this.domainWidth&&this.domainWidth.onFrame(t),this.domainSerif&&this.domainSerif.onFrame(t),this.tickMarkColor&&this.tickMarkColor.onFrame(t),this.tickMarkWidth&&this.tickMarkWidth.onFrame(t),this.tickMarkLength&&this.tickMarkLength.onFrame(t),this.tickLabelColor&&this.tickLabelColor.onFrame(t),this.tickLabelPadding&&this.tickLabelPadding.onFrame(t),this.dirtyScale&&this.updateTicks(),this.update(),this.ticks.forEach(function(e,i){i.onFrame(t)},this)},e.prototype.updateTicks=function(){this.dirtyScale=!1;var t=this.axis.scale();if(this.tickSpacing){var e=t.range(),i=Math.abs(e[1]-e[0]),r=Math.max(1,Math.floor(i/this.tickSpacing));this.tickGenerator.count(r)}this.tickGenerator.domain(t.domain());var o=this.ticks.clone(),n=this.tickGenerator.generate(),s=0;t:for(;s<n.length;){for(var a=n[s],u=o.firstKey();void 0!==u;){if(+a==+u){var h=o.get(u);o.delete(u),h.fadeIn(this.tickTransition),n.splice(s,1);continue t}u=o.nextKey(u)}var l=this.insertTick(a);l&&l.fadeIn(this.tickTransition),s+=1}o.forEach(function(t,e){e.fadeOut(this.tickTransition)},this)},e.prototype.insertTick=function(t){var e=this.tickGenerator.createElement(t);if(e){e.style.setProperty("opacity","0");var i=new ol(this,e,t);return this.axis.insertTick(e),this.ticks.set(t,i),i}return null},e.prototype.removeTick=function(t){this.axis.removeTick(t.node),this.ticks.delete(t.tickValue)},e.prototype.update=function(){this.axis.render()},e}(ws),Yh=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.axis.scale(t),this.parent.dirtyScale=!0},e.get=function(t){return t.axis.scale()},e.set=function(t,e){null===e?t.axisAnimator.scale=void 0:(t.axis.scale(e),t.axisAnimator.updateTicks(),t.axisAnimator.update(),t.axisAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.axisAnimator.scale||(t.axisAnimator.scale=new e(t.axisAnimator,i,r)),t.axisAnimator.scale},e}(xs),Xh=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.axis.domain(t.domain()),this.parent.dirtyScale=!0},e.get=function(t){return t.axis.scale()},e.set=function(t,e){null===e?t.axisAnimator.domain=void 0:(t.axis.scale(e),t.axisAnimator.updateTicks(),t.axisAnimator.update(),t.axisAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.axisAnimator.domain||(t.axisAnimator.domain=new e(t.axisAnimator,i,r)),t.axisAnimator.domain},e}(xs),Kh=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.axis.range(t.range()),this.parent.dirtyScale=!0},e.get=function(t){return t.axis.scale()},e.set=function(t,e){null===e?t.axisAnimator.range=void 0:(t.axis.scale(e),t.axisAnimator.updateTicks(),t.axisAnimator.update(),t.axisAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.axisAnimator.range||(t.axisAnimator.range=new e(t.axisAnimator,i,r)),t.axisAnimator.range},e}(xs),Qh=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.axis.domainColor(t)},e.get=function(t){return t.axis.domainColor()},e.set=function(t,e){null===e?t.axisAnimator.domainColor=void 0:t.axis.domainColor(e)},e.animator=function(t,i,r){return void 0===i||t.axisAnimator.domainColor||(t.axisAnimator.domainColor=new e(t.axisAnimator,i,r)),t.axisAnimator.domainColor},e}(xs),Zh=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.axis.domainWidth(t)},e.get=function(t){return t.axis.domainWidth()},e.set=function(t,e){null===e?t.axisAnimator.domainWidth=void 0:t.axis.domainWidth(e)},e.animator=function(t,i,r){return void 0===i||t.axisAnimator.domainWidth||(t.axisAnimator.domainWidth=new e(t.axisAnimator,i,r)),t.axisAnimator.domainWidth},e}(xs),Jh=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.axis.domainSerif(t)},e.get=function(t){return t.axis.domainSerif()},e.set=function(t,e){null===e?t.axisAnimator.domainSerif=void 0:t.axis.domainSerif(e)},e.animator=function(t,i,r){return void 0===i||t.axisAnimator.domainSerif||(t.axisAnimator.domainSerif=new e(t.axisAnimator,i,r)),t.axisAnimator.domainSerif},e}(xs),$h=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.axis.tickMarkColor(t)},e.get=function(t){return t.axis.tickMarkColor()},e.set=function(t,e){null===e?t.axisAnimator.tickMarkColor=void 0:t.axis.tickMarkColor(e)},e.animator=function(t,i,r){return void 0===i||t.axisAnimator.tickMarkColor||(t.axisAnimator.tickMarkColor=new e(t.axisAnimator,i,r)),t.axisAnimator.tickMarkColor},e}(xs),tl=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.axis.tickMarkWidth(t)},e.get=function(t){return t.axis.tickMarkWidth()},e.set=function(t,e){null===e?t.axisAnimator.tickMarkWidth=void 0:t.axis.tickMarkWidth(e)},e.animator=function(t,i,r){return void 0===i||t.axisAnimator.tickMarkWidth||(t.axisAnimator.tickMarkWidth=new e(t.axisAnimator,i,r)),t.axisAnimator.tickMarkWidth},e}(xs),el=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.axis.tickMarkLength(t)},e.get=function(t){return t.axis.tickMarkLength()},e.set=function(t,e){null===e?t.axisAnimator.tickMarkLength=void 0:t.axis.tickMarkLength(e)},e.animator=function(t,i,r){return void 0===i||t.axisAnimator.tickMarkLength||(t.axisAnimator.tickMarkLength=new e(t.axisAnimator,i,r)),t.axisAnimator.tickMarkLength},e}(xs),il=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.axis.tickLabelColor(t)},e.get=function(t){return t.axis.tickLabelColor()},e.set=function(t,e){null===e?t.axisAnimator.tickLabelColor=void 0:t.axis.tickLabelColor(e)},e.animator=function(t,i,r){return void 0===i||t.axisAnimator.tickLabelColor||(t.axisAnimator.tickLabelColor=new e(t.axisAnimator,i,r)),t.axisAnimator.tickLabelColor},e}(xs),rl=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.axis.tickLabelPadding(t)},e.get=function(t){return t.axis.tickLabelPadding()},e.set=function(t,e){null===e?t.axisAnimator.tickLabelPadding=void 0:t.axis.tickLabelPadding(e)},e.animator=function(t,i,r){return void 0===i||t.axisAnimator.tickLabelPadding||(t.axisAnimator.tickLabelPadding=new e(t.axisAnimator,i,r)),t.axisAnimator.tickLabelPadding},e}(xs);(Ah=xh||(xh={}))[Ah.Excluded=0]="Excluded",Ah[Ah.Entering=1]="Entering",Ah[Ah.Included=2]="Included",Ah[Ah.Leaving=3]="Leaving";var ol=function(t){function e(e,i,r){var o=t.call(this,e)||this;return o.node=i,o.tickValue=r,o.tickState=0,o.opacity=null,o.coord0=NaN,o}return u(e,t),e.prototype.onFrame=function(t){this.opacity&&this.opacity.onFrame(t)},e.prototype.remove=function(){this.parent.removeTick(this)},e.prototype.fadeIn=function(t){if(0===this.tickState||3===this.tickState){this.coord0=NaN;var e=this.opacity;e||(t.f||(t=t.range(0)),e=new nl(this,0,t),this.opacity=e),this.tickState=1,e.set(1,t)}},e.prototype.fadeOut=function(t){if(1===this.tickState||2===this.tickState){this.coord0=NaN;var e=this.opacity;e||(t.f||(t=t.range(1)),e=new nl(this,1,t),this.opacity=e),this.tickState=3,e.set(0,t)}},e}(bs),nl=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.map=function(t){var e=+this.parent.node.tickCoord;isNaN(this.parent.coord0)&&(this.parent.coord0=e);var i=this.parent.parent.tickSpacing/2,r=Math.min(Math.abs(e-this.parent.coord0)/i,1)||0;return this.f.map(Math.max(t,r))},e.prototype.update=function(t){this.parent.node.style.setProperty("opacity",""+t)},e.prototype.onEnd=function(t){this.parent.coord0=NaN,0===t?(this.parent.tickState=0,this.parent.remove()):1===t&&(this.parent.tickState=2)},e}(xs),sl=function(t){function e(e,i,r,o){void 0===i&&(i=Uh.scale(e.scale())),void 0===r&&(r="left"===e.orientation||"right"===e.orientation?40:80),void 0===o&&(o=new fs(200,"linear"));var n=t.call(this,e.node)||this;return n.axis=e,n._tickGenerator=i,n._tickSpacing=r,n._tickTransition=o,n.axisAnimator=new jh(n.axis,n._tickGenerator,n._tickSpacing,n._tickTransition),n}return u(e,t),Object.defineProperty(e.prototype,"orientation",{get:function(){return this.axis.orientation},enumerable:!0,configurable:!0}),e.prototype.frame=function(t){return void 0===t?this.axis.frame():(this.axis.frame(t),this)},e.prototype.scale=function(t,e){return void 0!==t&&(t=Bh.scale(t)),this.property(Yh,t,e)},e.prototype.domain=function(t,e,i){var r=this.axis.scale();"string"==typeof t?r=r.domain(Bh.scale(t).domain()):void 0!==t&&(r=r.domain(t,e));var o=this.property(Xh,r,i);return o instanceof Mn&&(o=o.domain()),o},e.prototype.range=function(t,e,i){var r=this.axis.scale();"string"==typeof t?r=r.range(Bh.scale(t).range()):void 0!==t&&(r=r.range(t,e));var o=this.property(Kh,r,i);return o instanceof Mn&&(o=o.range()),o},e.prototype.transformFrame=function(){return this.axis.transformFrame()},e.prototype.domainColor=function(t,e){return this.propertyColor(Qh,t,e)},e.prototype.domainWidth=function(t,e){return this.propertyNumber(Zh,t,e)},e.prototype.domainSerif=function(t,e){return this.propertyNumber(Jh,t,e)},e.prototype.tickGenerator=function(t){return void 0===t?this._tickGenerator:(this._tickGenerator=t,this.axisAnimator.tickGenerator=t,this.axisAnimator.animate(),this)},e.prototype.tickSpacing=function(t){return void 0===t?this._tickSpacing:(this._tickSpacing=t,this.axisAnimator.tickSpacing=t,this.axisAnimator.animate(),this)},e.prototype.tickTransition=function(t){return void 0===t?this._tickTransition:(this._tickTransition=t,this.axisAnimator.tickTransition=t,this)},e.prototype.tickMarkColor=function(t,e){return this.propertyColor($h,t,e)},e.prototype.tickMarkWidth=function(t,e){return this.propertyNumber(tl,t,e)},e.prototype.tickMarkLength=function(t,e){return this.propertyNumber(el,t,e)},e.prototype.tickLabelColor=function(t,e){return this.propertyColor(il,t,e)},e.prototype.tickLabelPadding=function(t,e){return this.propertyNumber(rl,t,e)},e.prototype.render=function(){this.axisAnimator.updateTicks(),this.axisAnimator.update()},e.prototype.didReview=function(e){t.prototype.didReview.call(this,e),this.axisAnimator.enabled(e)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("transition").cast(fs.Form);e.get("hidden").booleanValue()?this.node.setAttribute("visibility","hidden"):this.node.removeAttribute("visibility");var o=e.get("domainColor").cast(Qo.Form);o&&this.domainColor(o,r);var n=e.get("domainWidth").numberValue();void 0!==n&&this.domainWidth(n,r);var s=e.get("domainSerif").numberValue();void 0!==s&&this.domainSerif(s,r);var a=e.get("tickSpacing").numberValue();void 0!==a&&this.tickSpacing(a);var u=e.get("tickTransition").cast(fs.Form);void 0!==u&&this.tickTransition(u);var h=e.get("tickMarkColor").cast(Qo.Form);h&&this.tickMarkColor(h,r);var l=e.get("tickMarkWidth").numberValue();void 0!==l&&this.tickMarkWidth(l,r);var p=e.get("tickMarkLength").numberValue();void 0!==p&&this.tickMarkLength(p,r);var c=e.get("tickLabelColor").cast(Qo.Form);c&&this.tickLabelColor(c,r);var d=e.get("tickLabelPadding").numberValue();void 0!==d&&this.tickLabelPadding(d,r);var f=e.get("tickLabelWeight").numberValue();void 0!==f&&this.node.setAttribute("font-weight",""+f)},e.prototype.addObserver=function(t){this.axis.addObserver(t)},e.prototype.removeObserver=function(t){this.axis.removeObserver(t)},e.top=function(t,i,r,o){return new e(Bh.top(t),i,r,o)},e.right=function(t,i,r,o){return new e(Bh.right(t),i,r,o)},e.bottom=function(t,i,r,o){return new e(Bh.bottom(t),i,r,o)},e.left=function(t,i,r,o){return new e(Bh.left(t),i,r,o)},e.applyTheme=function(t){var e=L.empty().slot("domainColor","#ececec").slot("tickMarkColor","#ececec").slot("tickLabelColor",B.get("textColor")).slot("tickLabelWeight",300);t.set("axis",e)},e}(Xa);sl.applyTheme(sl.Theme);var al=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=pu.Params.concat([new Ca("transition",B.get("transition").or(B.get("axis").get("transition"))),new Ca("hidden",B.get("hidden")),new Ca("domainColor",B.get("domainColor").or(B.get("axis").get("domainColor"))),new Ca("domainWidth",B.get("domainWidth").or(B.get("axis").get("domainWidth"))),new Ca("domainSerif",B.get("domainSerif").or(B.get("axis").get("domainSerif"))),new Ca("tickSpacing",B.get("tickSpacing").or(B.get("axis").get("tickSpacing"))),new Ca("tickTransition",B.get("tickTransition").or(B.get("axis").get("tickTransition"))),new Ca("tickMarkColor",B.get("tickMarkColor").or(B.get("axis").get("tickMarkColor"))),new Ca("tickMarkWidth",B.get("tickMarkWidth").or(B.get("axis").get("tickMarkWidth"))),new Ca("tickMarkLength",B.get("tickMarkLength").or(B.get("axis").get("tickMarkLength"))),new Ca("tickLabelColor",B.get("tickLabelColor").or(B.get("axis").get("tickLabelColor"))),new Ca("tickLabelPadding",B.get("tickLabelPadding").or(B.get("axis").get("tickLabelPadding"))),new Ca("tickLabelWeight",B.get("tickLabelWeight").or(B.get("axis").get("tickLabelWeight")))]),e}(pu),ul=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"axis"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new al,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){if(i.key instanceof I&&"domain"===i.key.value){var n=i.toValue().getItem(0).cast(Zs.Form),s=i.toValue().getItem(1).cast(Zs.Form);void 0!==n&&void 0!==s&&e.domain([n,s])}return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(cu);Aa.addGlobal(ul.Form);var hl=function(t){function e(e){var i=t.call(this,e.node)||this;return i.plot=e,i._axisX=null,i._axisY=null,i.plot.addObserver(i),i}return u(e,t),e.prototype.getPoint=function(t){return this.plot.getPoint(t)},e.prototype.insertPoint=function(t){this.plot.insertPoint(t)},e.prototype.removePoint=function(t){this.plot.removePoint(t)},e.prototype.axisX=function(t){return void 0===t?this._axisX:(this._axisX=t,this.plot.axisX(t?t.axis:null),this)},e.prototype.scaleX=function(t,e){if(!this._axisX)throw new Error;return void 0===t?this._axisX.scale():(this._axisX.scale(t,e),this)},e.prototype.domainX=function(t,e,i){if(!this._axisX)throw new Error;return void 0===t?this._axisX.domain():(this._axisX.domain(t,e,i),this)},e.prototype.rangeX=function(t,e,i){if(!this._axisX)throw new Error;return void 0===t?this._axisX.range():(this._axisX.range(t,e,i),this)},e.prototype.axisY=function(t){return void 0===t?this._axisY:(this._axisY=t,this.plot.axisY(t?t.axis:null),this)},e.prototype.scaleY=function(t,e){if(!this._axisY)throw new Error;return void 0===t?this._axisY.scale():(this._axisY.scale(t,e),this)},e.prototype.domainY=function(t,e,i){if(!this._axisY)throw new Error;return void 0===t?this._axisY.domain():(this._axisY.domain(t,e,i),this)},e.prototype.rangeY=function(t,e,i){if(!this._axisY)throw new Error;return void 0===t?this._axisY.range():(this._axisY.range(t,e,i),this)},e.prototype.transformX=function(t){return void 0===t?this.plot.transformX():(this.plot.transformX(t),this)},e.prototype.transformY=function(t){return void 0===t?this.plot.transformY():(this.plot.transformY(t),this)},e.prototype.plotDidScaleX=function(t,e,i){},e.prototype.plotDidScaleY=function(t,e,i){},e.prototype.plotDidInsertPoint=function(t,e){},e.prototype.plotDidRemovePoint=function(t,e){},e.prototype.insertPlotPointViews=function(){for(var t=0;t<this._childViews.length;t+=1){var e=this._childViews[t];e instanceof ll&&void 0!==e.x&&this.insertPoint(e)}},e.prototype.render=function(){},e.prototype.addObserver=function(t){this.plot.addObserver(t)},e.prototype.removeObserver=function(t){this.plot.removeObserver(t)},e}(Xa),ll=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("x").cast(Zs.Form);void 0!==r&&(this.x=r);var o=e.get("y").cast(Zs.Form);void 0!==o&&(this.y=o);var n=e.get("dy").cast(Zs.Form);void 0!==n&&(this.dy=n);var s=e.get("r").numberValue();void 0!==s&&(this.r=s);var a=e.get("color").cast(Qo.Form);a&&(this.color=a);var u=e.get("opacity").numberValue();void 0!==u&&(this.opacity=u);var h=e.get("offsetX").numberValue();void 0!==h&&(this.offsetX=h);var l=e.get("offsetY").numberValue();void 0!==l&&(this.offsetY=l);var p=e.get("offsetDY").numberValue();void 0!==p&&(this.offsetDY=p),this.parentView instanceof hl&&this.parentView.render()},e}(wa),pl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=Sa.Params.concat([new Ca("x",B.get("x")),new Ca("y",B.get("y")),new Ca("dy",B.get("dy")),new Ca("r",B.get("r")),new Ca("color",B.get("color")),new Ca("opacity",B.get("opacity")),new Ca("offsetX",B.get("offsetX")),new Ca("offsetY",B.get("offsetY")),new Ca("offsetDY",B.get("offsetDY"))]),e}(Sa),cl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"plotPoint"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=new ll,o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new pl,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(Aa);Aa.addGlobal(cl.Form);var dl=function(){function t(t){this.node=t,this._axisX=null,this._axisY=null,this._scaleX=null,this._scaleY=null,this._transformX=null,this._transformY=null,this._points=new Ze,this._dirty=!0,this._observers=[]}return t.prototype.getPoint=function(t){return this._points.get(t)},t.prototype.willInsertPoint=function(t){},t.prototype.didInsertPoint=function(t){},t.prototype.willRemovePoint=function(t){},t.prototype.didRemovePoint=function(t){},t.prototype.insertPoint=function(t){if(!this._points.has(t.x)){for(var e=0;e<this._observers.length;e+=1){(i=this._observers[e]).plotWillInsertPoint&&i.plotWillInsertPoint(t,this)}this.willInsertPoint(t),this._points.set(t.x,t),this._dirty=!0,this.didInsertPoint(t);for(e=0;e<this._observers.length;e+=1){var i;(i=this._observers[e]).plotDidInsertPoint&&i.plotDidInsertPoint(t,this)}}},t.prototype.removePoint=function(t){var e=this._points.get(t);if(e){for(var i=0;i<this._observers.length;i+=1){(r=this._observers[i]).plotWillRemovePoint&&r.plotWillRemovePoint(e,this)}this.willRemovePoint(e),this._points.delete(t),this._dirty=!0,this.didRemovePoint(e);for(i=0;i<this._observers.length;i+=1){var r;(r=this._observers[i]).plotDidRemovePoint&&r.plotDidRemovePoint(e,this)}}},t.prototype.dataDomainX=function(){if(!this._points.isEmpty())return[this._points.firstKey(),this._points.lastKey()]},t.prototype.dataRangeX=function(){if(!this._points.isEmpty()){var t=this._scaleX;return[t.scale(this._points.firstKey()),t.scale(this._points.lastKey())]}},t.prototype.dataDomainY=function(){var t,e;if(!this._points.isEmpty()&&(this._points.forEach(function(i,r){var o=r.y;void 0!==o&&((void 0===t||V(t,o)>0)&&(t=o),(void 0===e||V(e,o)<0)&&(e=o))},this),void 0!==t&&void 0!==e))return[t,e]},t.prototype.dataRangeY=function(){if(!this._points.isEmpty()){var t,e,i=this._scaleY;if(this._points.forEach(function(r,o){if(void 0!==o.y){var n=i.scale(o.y);(void 0===t||t>n)&&(t=n),(void 0===e||e<n)&&(e=n)}},this),void 0!==t&&void 0!==e)return[t,e]}},t.prototype.axisX=function(t){return void 0===t?this._axisX:(this._axisX&&this._axisX.removeObserver(this),this._axisX=t,this._axisX&&(this._scaleX=this._axisX.scale(),this._axisX.addObserver(this),this._dirty=!0),this)},t.prototype.scaleX=function(t){if(!this._axisX)throw new Error;return void 0===t?this._axisX.scale():(this._axisX.scale(t),this._dirty=!0,this)},t.prototype.domainX=function(t,e){if(!this._axisX)throw new Error;return void 0===t?this._axisX.domain():(this._axisX.domain(t,e),this._dirty=!0,this)},t.prototype.rangeX=function(t,e){if(!this._axisX)throw new Error;return void 0===t?this._axisX.range():(this._axisX.range(t,e),this._dirty=!0,this)},t.prototype.axisY=function(t){return void 0===t?this._axisY:(this._axisY&&this._axisY.removeObserver(this),this._axisY=t,this._axisY&&(this._scaleY=this._axisY.scale(),this._axisY.addObserver(this),this._dirty=!0),this)},t.prototype.scaleY=function(t){if(!this._axisY)throw new Error;return void 0===t?this._axisY.scale():(this._axisY.scale(t),this._dirty=!0,this)},t.prototype.domainY=function(t,e){if(!this._axisY)throw new Error;return void 0===t?this._axisY.domain():(this._axisY.domain(t,e),this._dirty=!0,this)},t.prototype.rangeY=function(t,e){if(!this._axisY)throw new Error;return void 0===t?this._axisY.range():(this._axisY.range(t,e),this._dirty=!0,this)},t.prototype.transformX=function(t){return void 0===t?this._transformX:(this._transformX=t,t?this.retransform():this._dirty=!0,this)},t.prototype.transformY=function(t){return void 0===t?this._transformY:(this._transformY=t,t?this.retransform():this._dirty=!0,this)},t.prototype.transform=function(){return this._transformX&&this._transformY?this._transformX.transform(this._transformY):this._transformX?this._transformX:this._transformY?this._transformY:null},t.prototype.retransform=function(){var t=this.transform();t?this.node.setAttribute("transform",t.toAttributeString()):this.node.removeAttribute("transform")},t.prototype.addObserver=function(t){this._observers.indexOf(t)<0&&this._observers.push(t)},t.prototype.removeObserver=function(t){var e=this._observers.indexOf(t);e>=0&&this._observers.splice(e,1)},t.prototype.axisDidScale=function(t,e){e===this._axisX?this.axisXDidScale(t):e===this._axisY&&this.axisYDidScale(t)},t.prototype.axisXDidScale=function(t){this._transformX=this._axisX.transformFrame(),this._transformX?this.retransform():(this._scaleX=t,this._dirty=!0);for(var e=0;e<this._observers.length;e+=1){var i=this._observers[e];i.plotDidScaleX&&i.plotDidScaleX(t,this._axisX,this)}},t.prototype.axisYDidScale=function(t){this._transformY=this._axisY.transformFrame(),this._transformY?this.retransform():(this._scaleY=t,this._dirty=!0);for(var e=0;e<this._observers.length;e+=1){var i=this._observers[e];i.plotDidScaleY&&i.plotDidScaleY(t,this._axisY,this)}},t}(),fl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(pu),yl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.addGlobal=function(t){e.Global=e.Global.withUiForm(t)},e.removeGlobal=function(t){e.Global=e.Global.withoutUiForm(t)},e.Global=new ka([]),e}(cu),ml=function(t){function e(e){var i=t.call(this,e)||this;return i._areaFill=null,i._lineColor=Qo.black(),i._lineWidth=1,i._lineDashArray=[],i.areaPath=document.createElementNS("http://www.w3.org/2000/svg","path"),i.areaPath.setAttribute("class","area"),i.areaPath.setAttribute("stroke","none"),i.linePath=document.createElementNS("http://www.w3.org/2000/svg","path"),i.linePath.setAttribute("class","line"),i.linePath.setAttribute("fill","none"),i.linePath.setAttribute("vector-effect","non-scaling-stroke"),i.node.appendChild(i.linePath),i}return u(e,t),e.prototype.areaFill=function(t){return void 0===t?this._areaFill:null===t?(null!==this._areaFill&&(this._areaFill=null,this._dirty=!0),this):(t=Qo.fromAny(t),this._areaFill&&this._areaFill.equals(t)||(this._areaFill=t,this._dirty=!0),this)},e.prototype.lineColor=function(t){return void 0===t?this._lineColor:(t=Qo.fromAny(t),this._lineColor.equals(t)||(this._lineColor=t,this._dirty=!0),this)},e.prototype.lineWidth=function(t){return void 0===t?this._lineWidth:(this._lineWidth!==t&&(this._lineWidth=t,this._dirty=!0),this)},e.prototype.lineDashArray=function(t){return void 0===t?this._lineDashArray:(this._lineDashArray!==t&&(this._lineDashArray=t,this._dirty=!0),this)},e.prototype.render=function(){this._dirty&&this._axisX&&this._axisY&&(this._dirty=!1,this.renderPlot())},e.prototype.renderPlot=function(){var t,e=this._scaleX,i=this._scaleY,r=this._areaFill?new Gs:null,o=new Gs,n=this._points.size,s=i.scale(0);if(n>0){var a=this._points.firstValue();a.offsetX=e.scale(a.x),a.offsetY=i.scale(a.y),r&&(r.moveTo(a.offsetX,s),r.lineTo(a.offsetX,a.offsetY)),o.moveTo(a.offsetX,a.offsetY);var u=this._points.lastValue();t=e.scale(u.x)}else t=NaN;var h=this._points.entries();for(h.next();h.hasNext();){var l=h.next().value[1];l.offsetX=e.scale(l.x),l.offsetY=i.scale(l.y),r&&r.lineTo(l.offsetX,l.offsetY),o.lineTo(l.offsetX,l.offsetY)}n>0&&r&&(r.lineTo(t,s),r.closePath()),this.retransform(),r?(this.areaPath.parentNode||this.node.insertBefore(this.areaPath,this.node.firstChild),this.areaPath.setAttribute("fill",this._areaFill.toString()),this.areaPath.setAttribute("d",r.toString())):this.areaPath.parentNode&&this.node.removeChild(this.areaPath),this.linePath.setAttribute("stroke",this._lineColor.toString()),this.linePath.setAttribute("stroke-width",""+this._lineWidth);var p=this._lineDashArray,c=p.length;if(c>0){for(var d=""+p[0],f=1;f<c;f+=1)d+=","+p[f];this.linePath.setAttribute("stroke-dasharray",d)}else this.linePath.removeAttribute("stroke-dasharray");this.linePath.setAttribute("d",o.toString())},e.create=function(){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.setAttribute("pointer-events","none"),t.setAttribute("class","plot line-plot"),new e(t)},e}(dl),vl=function(t){function e(e){var i=t.call(this)||this;return i.plot=e,i.areaFill=void 0,i.lineColor=void 0,i.lineWidth=void 0,i.lineDashArray=void 0,i}return u(e,t),e.prototype.onFrame=function(t){this.areaFill&&this.areaFill.onFrame(t),this.lineColor&&this.lineColor.onFrame(t),this.lineWidth&&this.lineWidth.onFrame(t),this.lineDashArray&&this.lineDashArray.onFrame(t),this.update()},e.prototype.update=function(){var t=this.plot.node;t.view instanceof xl&&t.view.insertPlotPointViews(),this.plot.render()},e}(ws),gl=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.plot.areaFill(t)},e.get=function(t){return t.plot.areaFill()||Qo.transparent()},e.set=function(t,e){null===e?t.plotAnimator.areaFill=void 0:t.plot.areaFill(e)},e.animator=function(t,i,r){return void 0===i||t.plotAnimator.areaFill||(t.plotAnimator.areaFill=new e(t.plotAnimator,i,r)),t.plotAnimator.areaFill},e}(xs),wl=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.plot.lineColor(t)},e.get=function(t){return t.plot.lineColor()},e.set=function(t,e){null===e?t.plotAnimator.lineColor=void 0:t.plot.lineColor(e)},e.animator=function(t,i,r){return void 0===i||t.plotAnimator.lineColor||(t.plotAnimator.lineColor=new e(t.plotAnimator,i,r)),t.plotAnimator.lineColor},e}(xs),bl=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.plot.lineWidth(t)},e.get=function(t){return t.plot.lineWidth()},e.set=function(t,e){null===e?t.plotAnimator.lineWidth=void 0:t.plot.lineWidth(e)},e.animator=function(t,i,r){return void 0===i||t.plotAnimator.lineWidth||(t.plotAnimator.lineWidth=new e(t.plotAnimator,i,r)),t.plotAnimator.lineWidth},e}(xs),_l=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.plot.lineDashArray(t)},e.get=function(t){return t.plot.lineDashArray()},e.set=function(t,e){null===e?t.plotAnimator.lineDashArray=void 0:t.plot.lineDashArray(e)},e.animator=function(t,i,r){return void 0===i||t.plotAnimator.lineDashArray||(t.plotAnimator.lineDashArray=new e(t.plotAnimator,i,r)),t.plotAnimator.lineDashArray},e}(xs),xl=function(t){function e(e){var i=t.call(this,e)||this;return i.plotAnimator=new vl(i.plot),i}return u(e,t),e.prototype.areaFill=function(t,e){return this.propertyColor(gl,t,e)},e.prototype.lineColor=function(t,e){return this.propertyColor(wl,t,e)},e.prototype.lineWidth=function(t,e){return this.propertyNumber(bl,t,e)},e.prototype.lineDashArray=function(t,e){return this.property(_l,t,e)},e.prototype.didRemoveChildView=function(e){t.prototype.didRemoveChildView.call(this,e),e instanceof ll&&this.removePoint(e.x)},e.prototype.plotDidScaleX=function(t,e,i){this.plotAnimator.animate()},e.prototype.plotDidScaleY=function(t,e,i){this.plotAnimator.animate()},e.prototype.plotDidInsertPoint=function(t,e){this.plotAnimator.animate()},e.prototype.plotDidRemovePoint=function(t,e){this.plotAnimator.animate()},e.prototype.render=function(){this.plotAnimator.update()},e.prototype.didReview=function(e){t.prototype.didReview.call(this,e),this.plotAnimator.enabled(e)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("transition").cast(fs.Form),o=e.get("lineColor").cast(Qo.Form);o&&this.lineColor(o,r);var n=e.get("lineWidth").numberValue();n&&this.lineWidth(n,r);var s=e.get("lineDashArray");if(s.isDefined()){var a=[];s.forEach(function(t){var e=t.numberValue();void 0!==e&&a.push(e)},this),this.lineDashArray(a,r)}},e.create=function(){return new e(ml.create())},e.applyTheme=function(t){var e=B.get("value"),i=B.get("primaryHue").invoke(e).or(B.get("primaryColor")),r=L.empty().slot("lineColor",i).slot("lineWidth","0").slot("lineDashArray","0");t.set("plotLine",r)},e}(hl);xl.applyTheme(xl.Theme);var Al=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=fl.Params.concat([new Ca("transition",B.get("transition").or(B.get("plotLine").get("transition"))),new Ca("lineColor",B.get("lineColor").or(B.get("plotLine").get("lineColor"))),new Ca("lineWidth",B.get("lineWidth").or(B.get("plotLine").get("lineWidth"))),new Ca("lineDashArray",B.get("lineDashArray").or(B.get("plotLine").get("lineDashArray")))]),e}(fl),kl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"plot"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){var r;if(t.header(this.tag).forEach(function(t,e){var i=t.key.stringValue();void 0!==i&&"type"===i?r=t.toValue().stringValue(r):t instanceof b&&0===e&&(r=t.stringValue(r))}),"line"===r){var o=xl.create(),n=this.materializeView(o,t,e,i);return o.setModel(n),o}},e.prototype.castModel=function(t,e,i){var r;if(t.header(this.tag).forEach(function(t,e){var i=t.key.stringValue();void 0!==i&&"type"===i?r=t.toValue().stringValue(r):t instanceof b&&0===e&&(r=t.stringValue(r))}),"line"===r){var o=new Al,n=this.materializeModel(o,t,e,i);return o.setData(n),o}},e.prototype.materializeViewParam=function(e,i,r,o){var n=o.castView(i.toValue(),r,o);return n instanceof wa?(e.appendChildView(n),n):t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(yl);Aa.addGlobal(kl.Form),yl.addGlobal(kl.Form);var El=function(t){function e(e){var i=t.call(this,e)||this;return i._areaFill=Qo.black(),i._lineColor=null,i._lineWidth=1,i._circleRadius=5,i.circlePath=new Ze,i}return u(e,t),e.prototype.areaFill=function(t){return void 0===t?this._areaFill:(t=Qo.fromAny(t),this._areaFill.equals(t)||(this._areaFill=t,this._dirty=!0),this)},e.prototype.lineColor=function(t){return void 0===t?this._lineColor:null===t?(null!==this._lineColor&&(this._lineColor=null,this._dirty=!0),this):(t=Qo.fromAny(t),this._lineColor&&this._lineColor.equals(t)||(this._lineColor=t,this._dirty=!0),this)},e.prototype.lineWidth=function(t){return void 0===t?this._lineWidth:(this._lineWidth!==t&&(this._lineWidth=t,this._dirty=!0),this)},e.prototype.circleRadius=function(t){return void 0===t?this._lineWidth:(this._circleRadius!==t&&(this._circleRadius=t,this._dirty=!0),this)},e.prototype.render=function(){this._dirty&&this._axisX&&this._axisY&&(this._dirty=!1,this.renderPlot())},e.prototype.didInsertPoint=function(t){var e=document.createElementNS("http://www.w3.org/2000/svg","circle");e.setAttribute("data-index",""+t.x),this.node.appendChild(e),this.circlePath.set(t.x,e)},e.prototype.didRemovePoint=function(t){var e=this.circlePath.get(t.x);e&&(this.node.removeChild(e),this.circlePath.delete(t.x))},e.prototype.renderPlot=function(){var t=this._scaleX,e=this._scaleY,i=this._points.entries();for(i.next();i.hasNext();){var r=i.next().value,o=r[0],n=r[1],s=n.r?n.r:this._circleRadius;n.offsetX=t.scale(n.x),n.offsetY=e.scale(n.y);var a=this.circlePath.get(o);a&&(a.setAttribute("r",""+s),a.setAttribute("cx",""+n.offsetX),a.setAttribute("cy",""+n.offsetY),a.setAttribute("fill",""+(n.color?n.color:this._areaFill)),a.setAttribute("stroke",""+(this._lineColor?this._lineColor:"none"))),this.retransform()}},e.create=function(){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.setAttribute("pointer-events","none"),t.setAttribute("class","plot circle-plot"),new e(t)},e}(dl),Cl=function(t){function e(e){var i=t.call(this)||this;return i.plot=e,i.areaFill=void 0,i.lineColor=void 0,i.lineWidth=void 0,i}return u(e,t),e.prototype.onFrame=function(t){this.areaFill&&this.areaFill.onFrame(t),this.lineColor&&this.lineColor.onFrame(t),this.lineWidth&&this.lineWidth.onFrame(t),this.update()},e.prototype.update=function(){var t=this.plot.node;t.view instanceof Ml&&t.view.insertPlotPointViews(),this.plot.render()},e}(ws),Sl=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.plot.areaFill(t)},e.get=function(t){return t.plot.areaFill()},e.set=function(t,e){null===e?t.plotAnimator.areaFill=void 0:t.plot.areaFill(e)},e.animator=function(t,i,r){return void 0===i||t.plotAnimator.areaFill||(t.plotAnimator.areaFill=new e(t.plotAnimator,i,r)),t.plotAnimator.areaFill},e}(xs),Vl=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.plot.lineColor(t)},e.get=function(t){return t.plot.lineColor()||Qo.transparent()},e.set=function(t,e){null===e?t.plotAnimator.lineColor=void 0:t.plot.lineColor(e)},e.animator=function(t,i,r){return void 0===i||t.plotAnimator.lineColor||(t.plotAnimator.lineColor=new e(t.plotAnimator,i,r)),t.plotAnimator.lineColor},e}(xs),Dl=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.plot.lineWidth(t)},e.get=function(t){return t.plot.lineWidth()},e.set=function(t,e){null===e?t.plotAnimator.lineWidth=void 0:t.plot.lineWidth(e)},e.animator=function(t,i,r){return void 0===i||t.plotAnimator.lineWidth||(t.plotAnimator.lineWidth=new e(t.plotAnimator,i,r)),t.plotAnimator.lineWidth},e}(xs),Ml=function(t){function e(e){var i=t.call(this,e)||this;return i.plotAnimator=new Cl(i.plot),i}return u(e,t),e.prototype.areaFill=function(t,e){return this.propertyColor(Sl,t,e)},e.prototype.lineColor=function(t,e){return this.propertyColor(Vl,t,e)},e.prototype.lineWidth=function(t,e){return this.propertyNumber(Dl,t,e)},e.prototype.didRemoveChildView=function(e){t.prototype.didRemoveChildView.call(this,e),e instanceof ll&&this.removePoint(e.x)},e.prototype.plotDidScaleX=function(t,e,i){this.plotAnimator.animate()},e.prototype.plotDidScaleY=function(t,e,i){this.plotAnimator.animate()},e.prototype.plotDidInsertPoint=function(t,e){this.plotAnimator.animate()},e.prototype.plotDidRemovePoint=function(t,e){this.plotAnimator.animate()},e.prototype.render=function(){this.plotAnimator.update()},e.prototype.didReview=function(e){t.prototype.didReview.call(this,e),this.plotAnimator.enabled(e)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("transition").cast(fs.Form),o=e.get("areaFill").cast(Qo.Form);o&&this.areaFill(o,r);var n=e.get("lineColor").cast(Qo.Form);n&&this.lineColor(n,r);var s=e.get("lineWidth").numberValue();s&&this.lineWidth(s,r)},e.create=function(){return new e(El.create())},e.applyTheme=function(t){var e=B.get("value"),i=B.get("primaryHue").invoke(e).or(B.get("primaryColor")),r=L.empty().slot("areaFill",i);t.set("plotCircle",r)},e}(hl);Ml.applyTheme(Ml.Theme);var Rl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=fl.Params.concat([new Ca("transition",B.get("transition").or(B.get("plotCircle").get("transition"))),new Ca("areaFill",B.get("areaFill").or(B.get("plotCircle").get("areaFill"))),new Ca("lineColor",B.get("lineColor")),new Ca("lineWidth",B.get("lineWidth"))]),e}(fl),Tl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"plot"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){var r;if(t.header(this.tag).forEach(function(t,e){var i=t.key.stringValue();void 0!==i?"type"===i&&(r=t.toValue().stringValue(r)):t instanceof b&&0===e&&(r=t.stringValue(r))}),"circle"===r){var o=Ml.create(),n=this.materializeView(o,t,e,i);return o.setModel(n),o}},e.prototype.castModel=function(t,e,i){var r;if(t.header(this.tag).forEach(function(t,e){var i=t.key.stringValue();void 0!==i?"type"===i&&(r=t.toValue().stringValue(r)):t instanceof b&&0===e&&(r=t.stringValue(r))}),"circle"===r){var o=new Rl,n=this.materializeModel(o,t,e,i);return o.setData(n),o}},e.prototype.materializeViewParam=function(e,i,r,o){var n=o.castView(i.toValue(),r,o);return n instanceof wa?(e.appendChildView(n),n):t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(yl);Aa.addGlobal(Tl.Form),yl.addGlobal(Tl.Form);var Pl=function(t){function e(e){var i=t.call(this,e)||this;return i._stops=new Ze,i._areaFill=Qo.transparent(.5),i.areaPath=document.createElementNS("http://www.w3.org/2000/svg","path"),i.areaPath.setAttribute("class","area"),i.areaPath.setAttribute("stroke","none"),i.node.appendChild(i.areaPath),i.gradient=document.createElementNS("http://www.w3.org/2000/svg","linearGradient"),i.gradient.setAttribute("id",C.generateId()),i.gradient.setAttribute("gradientUnits","userSpaceOnUse"),i.gradient.setAttribute("x1","0"),i.gradient.setAttribute("y1","0"),i.gradient.setAttribute("x2","0"),i.gradient.setAttribute("y2","0"),i}return u(e,t),e.prototype.areaFill=function(t){return void 0===t?this._areaFill:(t=Qo.fromAny(t),this._areaFill.equals(t)||(this._areaFill=t,this._dirty=!0),this)},e.prototype.didInsertPoint=function(t){var e=this._stops.get(t.x);if(e&&(this._stops.delete(t.x),this.gradient.removeChild(e)),t.color||void 0!==t.opacity){var i=document.createElementNS("http://www.w3.org/2000/svg","stop");t.color&&i.setAttribute("stop-color",t.color.toString()),void 0!==t.opacity&&i.setAttribute("stop-opacity",""+t.opacity),this._stops.set(t.x,i),this.gradient.insertBefore(i,this._stops.nextValue(t.x)||null)}},e.prototype.willRemovePoint=function(t){var e=this._stops.get(t.x);e&&(this._stops.delete(t.x),this.gradient.removeChild(e))},e.prototype.render=function(){this._dirty&&this._axisX&&this._axisY&&(this._dirty=!1,this.renderPlot())},e.prototype.renderPlot=function(){var t,e,i,r=this._scaleX,o=this._scaleY,n=new Gs,s=this._points.size;if(s>0){var a=this._points.firstValue(),u=this._points.lastValue();t=r.scale(a.x),i=(e=r.scale(u.x))-t,a.offsetX=t,a.offsetY=o.scale(a.y),n.moveTo(a.offsetX,a.offsetY);var h=this._stops.get(a.x);if(h&&(a.color||h.setAttribute("stop-color",this._areaFill.toString()),i)){var l=(a.offsetX-t)/i;h.setAttribute("offset",""+l)}}else t=NaN,e=NaN,i=NaN;var p=this._points.entries();for(p.next();p.hasNext();){var c=p.next().value,d=c[0];(y=c[1]).offsetX=r.scale(y.x),y.offsetY=o.scale(y.y),n.lineTo(y.offsetX,y.offsetY);var f=this._stops.get(d);if(f&&(y.color||f.setAttribute("stop-color",this._areaFill.toString()),i)){l=(y.offsetX-t)/i;f.setAttribute("offset",""+l)}}for(;p.hasPrevious();){var y;(y=p.previous().value[1]).offsetDY=void 0!==y.dy?o.scale(y.dy):y.offsetY,n.lineTo(y.offsetX,y.offsetDY)}s>0&&n.closePath(),this.retransform(),isFinite(t)&&isFinite(e)&&(this.gradient.setAttribute("x1",""+t),this.gradient.setAttribute("x2",""+e),this._stops.size?(this.gradient.parentNode||this.node.insertBefore(this.gradient,this.node.firstChild),this.areaPath.setAttribute("fill","url(#"+this.gradient.getAttribute("id")+")")):(this.gradient.parentNode&&this.node.removeChild(this.gradient),this.areaPath.setAttribute("fill",this._areaFill.toString()))),this.areaPath.setAttribute("d",n.toString())},e.create=function(){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.setAttribute("pointer-events","none"),t.setAttribute("class","plot area-plot"),new e(t)},e}(dl),Ll=function(t){function e(e){var i=t.call(this)||this;return i.plot=e,i.areaFill=void 0,i}return u(e,t),e.prototype.onFrame=function(t){this.areaFill&&this.areaFill.onFrame(t),this.update()},e.prototype.update=function(){var t=this.plot.node;t.view instanceof zl&&t.view.insertPlotPointViews(),this.plot.render()},e}(ws),Fl=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.plot.areaFill(t)},e.get=function(t){return t.plot.areaFill()},e.set=function(t,e){null===e?t.plotAnimator.areaFill=void 0:t.plot.areaFill(e)},e.animator=function(t,i,r){return void 0===i||t.plotAnimator.areaFill||(t.plotAnimator.areaFill=new e(t.plotAnimator,i,r)),t.plotAnimator.areaFill},e}(xs),zl=function(t){function e(e){var i=t.call(this,e)||this;return i.plotAnimator=new Ll(i.plot),i}return u(e,t),e.prototype.areaFill=function(t,e){return this.propertyColor(Fl,t,e)},e.prototype.didRemoveChildView=function(e){t.prototype.didRemoveChildView.call(this,e),e instanceof ll&&this.removePoint(e.x)},e.prototype.plotDidScaleX=function(t,e,i){this.plotAnimator.animate()},e.prototype.plotDidScaleY=function(t,e,i){this.plotAnimator.animate()},e.prototype.plotDidInsertPoint=function(t,e){this.plotAnimator.animate()},e.prototype.plotDidRemovePoint=function(t,e){this.plotAnimator.animate()},e.prototype.render=function(){this.plotAnimator.update()},e.prototype.didReview=function(e){t.prototype.didReview.call(this,e),this.plotAnimator.enabled(e)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("transition").cast(fs.Form),o=e.get("areaFill").cast(Qo.Form);o&&this.areaFill(o,r)},e.create=function(){return new e(Pl.create())},e.applyTheme=function(t){var e=B.get("value"),i=B.get("primaryHue").invoke(e).or(B.get("primaryColor")),r=L.empty().slot("areaFill",i);t.set("plotArea",r)},e}(hl);zl.applyTheme(zl.Theme);var Il=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=fl.Params.concat([new Ca("transition",B.get("transition").or(B.get("plotCircle").get("transition"))),new Ca("areaFill",B.get("areaFill").or(B.get("plotCircle").get("areaFill")))]),e}(fl),Ul=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"plot"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){var r;if(t.header(this.tag).forEach(function(t,e){var i=t.key.stringValue();void 0!==i?"type"===i&&(r=t.toValue().stringValue(r)):t instanceof b&&0===e&&(r=t.stringValue(r))}),"area"===r){var o=zl.create(),n=this.materializeView(o,t,e,i);return o.setModel(n),o}},e.prototype.castModel=function(t,e,i){var r;if(t.header(this.tag).forEach(function(t,e){var i=t.key.stringValue();void 0!==i?"type"===i&&(r=t.toValue().stringValue(r)):t instanceof b&&0===e&&(r=t.stringValue(r))}),"area"===r){var o=new Il,n=this.materializeModel(o,t,e,i);return o.setData(n),o}},e.prototype.materializeViewParam=function(e,i,r,o){var n=o.castView(i.toValue(),r,o);return n instanceof wa?(e.appendChildView(n),n):t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(yl);Aa.addGlobal(Ul.Form),yl.addGlobal(Ul.Form);var Wl=function(){function t(t){this.node=t,this._plots=[],this._axisTop=null,this._axisRight=null,this._axisBottom=null,this._axisLeft=null,this._gutterTop=qo.px(20,t),this._gutterRight=qo.px(40,t),this._gutterBottom=qo.px(20,t),this._gutterLeft=qo.px(40,t),this._width=qo.zero(t),this._height=qo.zero(t),this._dirty=!0,this._observers=[],this.defs=document.createElementNS("http://www.w3.org/2000/svg","defs"),this.node.appendChild(this.defs),this.clipPath=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),this.clipPath.setAttribute("id",C.generateId()),this.defs.appendChild(this.clipPath),this.clipRect=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.clipPath.appendChild(this.clipRect),this.surfaceRect=document.createElementNS("http://www.w3.org/2000/svg","rect"),this.surfaceRect.setAttribute("fill","none"),this.surfaceRect.setAttribute("stroke","none"),this.surfaceRect.setAttribute("pointer-events","all"),this.surfaceRect.setAttribute("class","surfaceRect"),this.node.appendChild(this.surfaceRect),this.plotsGroup=document.createElementNS("http://www.w3.org/2000/svg","g"),this.plotsGroup.setAttribute("clip-path","url(#"+this.clipPath.getAttribute("id")+")"),this.plotsGroup.setAttribute("class","plots"),this.node.appendChild(this.plotsGroup),this.axesGroup=document.createElementNS("http://www.w3.org/2000/svg","g"),this.axesGroup.setAttribute("class","axes"),this.node.appendChild(this.axesGroup)}return t.prototype.plots=function(){return this._plots.slice(0)},t.prototype.addPlot=function(t){if(this._plots.indexOf(t)<0){for(var e=0;e<this._observers.length;e+=1){if((r=this._observers[e]).chartWillAddPlot){var i=r.chartWillAddPlot(t,this);if(i)t=i;else if(null===i)return}}this._plots.push(t),this.plotsGroup.appendChild(t.node),t.addObserver(this),t.axisX()||(this._axisBottom?t.axisX(this._axisBottom):this._axisTop&&t.axisX(this._axisTop)),t.axisY()||(this._axisLeft?t.axisY(this._axisLeft):this._axisRight&&t.axisY(this._axisRight)),this._dirty=!0;for(e=0;e<this._observers.length;e+=1){var r;(r=this._observers[e]).chartDidAddPlot&&r.chartDidAddPlot(t,this)}}},t.prototype.removePlot=function(t){var e=this._plots.indexOf(t);if(e>=0){for(var i=0;i<this._observers.length;i+=1){(o=this._observers[i]).chartWillRemovePlot&&o.chartWillRemovePlot(t,this)}t.removeObserver(this),this.plotsGroup.removeChild(t.node),this._plots.splice(e,1);for(var r=0;r<this._observers.length;r+=1){var o;(o=this._observers[r]).chartDidRemovePlot&&o.chartDidRemovePlot(t,this)}}},t.prototype.axisTop=function(t){if(void 0===t)return this._axisTop;if(null===t)return this._axisTop&&(this._axisTop.removeObserver(this),this.axesGroup.removeChild(this._axisTop.node)),this._axisTop=null,this;this._axisTop?(this._axisTop.removeObserver(this),this.axesGroup.replaceChild(t.node,this._axisTop.node)):this.axesGroup.appendChild(t.node),this._axisTop=t,this._axisTop.addObserver(this);for(var e=0;e<this._plots.length;e+=1){var i=this._plots[e];i.axisX()||i.axisX(this._axisTop)}return this._dirty=!0,this},t.prototype.axisRight=function(t){if(void 0===t)return this._axisRight;if(null===t)return this._axisRight&&(this._axisRight.removeObserver(this),this.axesGroup.removeChild(this._axisRight.node)),this._axisRight=null,this;this._axisRight?(this._axisRight.removeObserver(this),this.axesGroup.replaceChild(t.node,this._axisRight.node)):this.axesGroup.appendChild(t.node),this._axisRight=t,this._axisRight.addObserver(this);for(var e=0;e<this._plots.length;e+=1){var i=this._plots[e];i.axisY()||i.axisY(this._axisRight)}return this._dirty=!0,this},t.prototype.axisBottom=function(t){if(void 0===t)return this._axisBottom;if(null===t)return this._axisBottom&&(this._axisBottom.removeObserver(this),this.axesGroup.removeChild(this._axisBottom.node)),this._axisBottom=null,this;this._axisBottom?(this._axisBottom.removeObserver(this),this.axesGroup.replaceChild(t.node,this._axisBottom.node)):this.axesGroup.appendChild(t.node),this._axisBottom=t,this._axisBottom.addObserver(this);for(var e=0;e<this._plots.length;e+=1){var i=this._plots[e];i.axisX()||i.axisX(this._axisBottom)}return this._dirty=!0,this},t.prototype.axisLeft=function(t){if(void 0===t)return this._axisLeft;if(null===t)return this._axisLeft&&(this._axisLeft.removeObserver(this),this.axesGroup.removeChild(this._axisLeft.node)),this._axisLeft=null,this;this._axisLeft?(this._axisLeft.removeObserver(this),this.axesGroup.replaceChild(t.node,this._axisLeft.node)):this.axesGroup.appendChild(t.node),this._axisLeft=t,this._axisLeft.addObserver(this);for(var e=0;e<this._plots.length;e+=1){var i=this._plots[e];i.axisY()||i.axisY(this._axisLeft)}return this._dirty=!0,this},t.prototype.gutterTop=function(t){return void 0===t?this._gutterTop:(t=qo.fromAny(t,this.node),this._gutterTop.equals(t)||(this._gutterTop=t,this._dirty=!0),this)},t.prototype.gutterRight=function(t){return void 0===t?this._gutterRight:(t=qo.fromAny(t,this.node),this._gutterRight.equals(t)||(this._gutterRight=t,this._dirty=!0),this)},t.prototype.gutterBottom=function(t){return void 0===t?this._gutterBottom:(t=qo.fromAny(t,this.node),this._gutterBottom.equals(t)||(this._gutterBottom=t,this._dirty=!0),this)},t.prototype.gutterLeft=function(t){return void 0===t?this._gutterLeft:(t=qo.fromAny(t,this.node),this._gutterLeft.equals(t)||(this._gutterLeft=t,this._dirty=!0),this)},t.prototype.width=function(t){return void 0===t?this._width:(t=qo.fromAny(t,this.node),this._width.equals(t)||(this._width=t,this._dirty=!0),this)},t.prototype.height=function(t){return void 0===t?this._height:(t=qo.fromAny(t,this.node),this._height.equals(t)||(this._height=t,this._dirty=!0),this)},t.prototype.dataDomainX=function(){var t=this._plots.length;if(t){for(var e=void 0,i=void 0,r=0;r<t;r+=1){var o=this._plots[r].dataDomainX();o&&((void 0===e||V(e,o[0])>0)&&(e=o[0]),(void 0===i||V(i,o[1])<0)&&(i=o[1]))}if(void 0!==e&&void 0!==i)return[e,i]}},t.prototype.dataRangeX=function(){var t=this._plots.length;if(t){for(var e=void 0,i=void 0,r=0;r<t;r+=1){var o=this._plots[r].dataRangeX();o&&((void 0===e||e>o[0])&&(e=o[0]),(void 0===i||i<o[1])&&(i=o[1]))}if(void 0!==e&&void 0!==i)return[e,i]}},t.prototype.dataDomainY=function(){var t=this._plots.length;if(t){for(var e=void 0,i=void 0,r=0;r<t;r+=1){var o=this._plots[r].dataDomainY();o&&((void 0===e||V(e,o[0])>0)&&(e=o[0]),(void 0===i||V(i,o[1])<0)&&(i=o[1]))}if(void 0!==e&&void 0!==i)return[e,i]}},t.prototype.dataRangeY=function(){var t=this._plots.length;if(t){for(var e=void 0,i=void 0,r=0;r<t;r+=1){var o=this._plots[r].dataRangeY();o&&((void 0===e||e>o[0])&&(e=o[0]),(void 0===i||i<o[1])&&(i=o[1]))}if(void 0!==e&&void 0!==i)return[e,i]}},t.prototype.update=function(){this._dirty&&(this._dirty=!1,this.updateClipPath(),this.updateSurface(),this.updatePlots(),this.updateAxes())},t.prototype.updateClipPath=function(){var t=Math.max(0,this._width.pxValue()-this._gutterLeft.pxValue()-this._gutterRight.pxValue()),e=Math.max(0,this._height.pxValue()-this._gutterTop.pxValue()-this._gutterBottom.pxValue());this.clipRect.setAttribute("x","0"),this.clipRect.setAttribute("y","0"),this.clipRect.setAttribute("width",""+t),this.clipRect.setAttribute("height",""+e)},t.prototype.updateSurface=function(){var t=this._gutterLeft.pxValue(),e=this._gutterTop.pxValue(),i=Math.max(0,this._width.pxValue()-t-this._gutterRight.pxValue()),r=Math.max(0,this._height.pxValue()-e-this._gutterBottom.pxValue());this.surfaceRect.setAttribute("x",""+t),this.surfaceRect.setAttribute("y",""+e),this.surfaceRect.setAttribute("width",""+i),this.surfaceRect.setAttribute("height",""+r)},t.prototype.updatePlots=function(){var t=dn.translate(this._gutterLeft.pxValue(),this._gutterTop.pxValue());this.plotsGroup.setAttribute("transform",t.toAttributeString());for(var e=0;e<this._plots.length;e+=1)this.updatePlot(this._plots[e])},t.prototype.updatePlot=function(t){var e=t.axisX();e&&(e===this._axisBottom?e.scale(this._axisBottom.scale()):e===this._axisTop&&e.scale(this._axisTop.scale()));var i=t.axisY();i&&(i===this._axisLeft?i.scale(this._axisLeft.scale()):i===this._axisRight&&i.scale(this._axisRight.scale()))},t.prototype.updateAxes=function(){this.updateAxisTop(),this.updateAxisRight(),this.updateAxisBottom(),this.updateAxisLeft()},t.prototype.updateAxisTop=function(){if(this._axisTop){var t=this._gutterLeft.pxValue(),e=this._gutterTop.pxValue(),i=dn.translate(t,e);this._axisTop.node.setAttribute("transform",i.toAttributeString()),this._axisTop.range(0,Math.max(0,this._width.pxValue()-t-this._gutterRight.pxValue()))}},t.prototype.updateAxisRight=function(){if(this._axisRight){var t=Math.max(this._gutterLeft.pxValue(),this._width.pxValue()-this._gutterRight.pxValue()),e=this._gutterTop.pxValue(),i=dn.translate(t,e);this._axisRight.node.setAttribute("transform",i.toAttributeString()),this._axisRight.range(Math.max(this._height.pxValue()-e-this._gutterBottom.pxValue()),0)}},t.prototype.updateAxisBottom=function(){if(this._axisBottom){var t=this._gutterLeft.pxValue(),e=Math.max(this._gutterTop.pxValue(),this._height.pxValue()-this._gutterBottom.pxValue()),i=dn.translate(t,e);this._axisBottom.node.setAttribute("transform",i.toAttributeString()),this._axisBottom.range(0,Math.max(this._width.pxValue()-t-this._gutterRight.pxValue()))}},t.prototype.updateAxisLeft=function(){if(this._axisLeft){var t=this._gutterLeft.pxValue(),e=this._gutterTop.pxValue(),i=dn.translate(t,e);this._axisLeft.node.setAttribute("transform",i.toAttributeString()),this._axisLeft.range(Math.max(0,this._height.pxValue()-e-this._gutterBottom.pxValue()),0)}},t.prototype.render=function(){this.renderSurface(),this.renderPlots(),this.renderAxes()},t.prototype.renderSurface=function(){this.updateSurface()},t.prototype.renderPlots=function(){this.updatePlots();for(var t=0;t<this._plots.length;t+=1)this._plots[t].render()},t.prototype.renderAxes=function(){this.updateAxes(),this._axisTop&&this._axisTop.render(),this._axisRight&&this._axisRight.render(),this._axisBottom&&this._axisBottom.render(),this._axisLeft&&this._axisLeft.render()},t.prototype.addObserver=function(t){this._observers.indexOf(t)<0&&this._observers.push(t)},t.prototype.removeObserver=function(t){var e=this._observers.indexOf(t);e>=0&&this._observers.splice(e,1)},t.prototype.plotDidScaleX=function(t,e,i){e===this._axisBottom?this.axisDidScaleBottom(t):e===this._axisTop&&this.axisDidScaleTop(t)},t.prototype.plotDidScaleY=function(t,e,i){e===this._axisLeft?this.axisDidScaleLeft(t):e===this._axisRight&&this.axisDidScaleRight(t)},t.prototype.plotDidInsertPoint=function(t,e){for(var i=0;i<this._observers.length;i+=1){var r=this._observers[i];r.chartDidInsertPoint&&r.chartDidInsertPoint(t,e,this)}},t.prototype.plotDidRemovePoint=function(t,e){for(var i=0;i<this._observers.length;i+=1){var r=this._observers[i];r.chartDidRemovePoint&&r.chartDidRemovePoint(t,e,this)}},t.prototype.axisDidScale=function(t,e){e===this._axisTop?this.axisDidScaleTop(t):e===this._axisRight?this.axisDidScaleRight(t):e===this._axisBottom?this.axisDidScaleBottom(t):e===this._axisLeft&&this.axisDidScaleLeft(t)},t.prototype.axisDidScaleTop=function(t){for(var e=0;e<this._observers.length;e+=1){var i=this._observers[e];i.chartDidScaleTop&&i.chartDidScaleTop(t,this._axisTop,this)}},t.prototype.axisDidScaleRight=function(t){for(var e=0;e<this._observers.length;e+=1){var i=this._observers[e];i.chartDidScaleRight&&i.chartDidScaleRight(t,this._axisRight,this)}},t.prototype.axisDidScaleBottom=function(t){for(var e=0;e<this._observers.length;e+=1){var i=this._observers[e];i.chartDidScaleBottom&&i.chartDidScaleBottom(t,this._axisBottom,this)}},t.prototype.axisDidScaleLeft=function(t){for(var e=0;e<this._observers.length;e+=1){var i=this._observers[e];i.chartDidScaleLeft&&i.chartDidScaleLeft(t,this._axisLeft,this)}},t.create=function(e){void 0===e&&(e="svg");var i=document.createElementNS("http://www.w3.org/2000/svg",e);return i.setAttribute("class","chart"),i.style.setProperty("-webkit-user-select","none"),i.style.setProperty("-moz-user-select","none"),i.style.setProperty("-ms-user-select","none"),i.style.setProperty("user-select","none"),i.style.setProperty("cursor","default"),new t(i)},t}(),Ol=function(t){function e(e,i){var r=t.call(this)||this;return r.chart=e,r.childViews=i,r.axisTop=null,r.axisRight=null,r.axisBottom=null,r.axisLeft=null,r.gutterTop=void 0,r.gutterRight=void 0,r.gutterBottom=void 0,r.gutterLeft=void 0,r.width=void 0,r.height=void 0,r}return u(e,t),e.prototype.onFrame=function(t){this.gutterTop&&this.gutterTop.onFrame(t),this.gutterRight&&this.gutterRight.onFrame(t),this.gutterBottom&&this.gutterBottom.onFrame(t),this.gutterLeft&&this.gutterLeft.onFrame(t),this.width&&this.width.onFrame(t),this.height&&this.height.onFrame(t),this.update()},e.prototype.updatePlots=function(){for(var t=0;t<this.childViews.length;t+=1){var e=this.childViews[t];e instanceof hl&&e.render()}},e.prototype.updateAxes=function(){this.axisTop&&this.axisTop.render(),this.axisRight&&this.axisRight.render(),this.axisBottom&&this.axisBottom.render(),this.axisLeft&&this.axisLeft.render()},e.prototype.update=function(){var t=this.chart.node;t.view instanceof Yl&&(t.view.autoscale(),t.view.rebound()),this.chart.update(),this.updatePlots(),this.updateAxes()},e}(ws),Bl=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.chart.gutterTop(t)},e.get=function(t){return t.chart.gutterTop()},e.set=function(t,e){null===e?t.chartAnimator.gutterTop=void 0:t.chart.gutterTop().equals(e)||(t.chart.gutterTop(e),t.requireResize())},e.animator=function(t,i,r){return void 0===i||t.chartAnimator.gutterTop||(t.chartAnimator.gutterTop=new e(t.chartAnimator,i,r)),t.chartAnimator.gutterTop},e}(xs),ql=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.chart.gutterRight(t)},e.get=function(t){return t.chart.gutterRight()},e.set=function(t,e){null===e?t.chartAnimator.gutterRight=void 0:t.chart.gutterRight().equals(e)||(t.chart.gutterRight(e),t.requireResize())},e.animator=function(t,i,r){return void 0===i||t.chartAnimator.gutterRight||(t.chartAnimator.gutterRight=new e(t.chartAnimator,i,r)),t.chartAnimator.gutterRight},e}(xs),Gl=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.chart.gutterBottom(t)},e.get=function(t){return t.chart.gutterBottom()},e.set=function(t,e){null===e?t.chartAnimator.gutterBottom=void 0:t.chart.gutterBottom().equals(e)||(t.chart.gutterBottom(e),t.requireResize())},e.animator=function(t,i,r){return void 0===i||t.chartAnimator.gutterBottom||(t.chartAnimator.gutterBottom=new e(t.chartAnimator,i,r)),t.chartAnimator.gutterBottom},e}(xs),Hl=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.chart.gutterLeft(t)},e.get=function(t){return t.chart.gutterLeft()},e.set=function(t,e){null===e?t.chartAnimator.gutterLeft=void 0:t.chart.gutterLeft().equals(e)||(t.chart.gutterLeft(e),t.requireResize())},e.animator=function(t,i,r){return void 0===i||t.chartAnimator.gutterLeft||(t.chartAnimator.gutterLeft=new e(t.chartAnimator,i,r)),t.chartAnimator.gutterLeft},e}(xs),Nl=function(t){function e(e,i,r){return t.call(this,e,i,r,gs.REQUIRES_RESIZE)||this}return u(e,t),e.prototype.update=function(t){this.parent.chart.width(t),this.updateTarget(this.parent.chart.node)},e.get=function(t){return t.chart.width()},e.set=function(t,e){if(null===e)t.chartAnimator.width=void 0,t.chart.node.removeAttribute("width");else{t.chart.width(e);var i=t.chart.node.getAttribute("width"),r=""+e.pxValue();i!==r&&(t.chart.node.setAttribute("width",r),t.requireResize())}},e.animator=function(t,i,r){return void 0===i||t.chartAnimator.width||(t.chartAnimator.width=new e(t.chartAnimator,i,r)),t.chartAnimator.width},e}(xs),jl=function(t){function e(e,i,r){return t.call(this,e,i,r,gs.REQUIRES_RESIZE)||this}return u(e,t),e.prototype.update=function(t){this.parent.chart.height(t),this.updateTarget(this.parent.chart.node)},e.get=function(t){return t.chart.height()},e.set=function(t,e){if(null===e)t.chartAnimator.height=void 0,t.chart.node.removeAttribute("height");else{t.chart.height(e);var i=t.chart.node.getAttribute("height"),r=""+e.pxValue();i!==r&&(t.chart.node.setAttribute("height",r),t.requireResize())}},e.animator=function(t,i,r){return void 0===i||t.chartAnimator.height||(t.chartAnimator.height=new e(t.chartAnimator,i,r)),t.chartAnimator.height},e}(xs),Yl=function(t){function e(i){var r=t.call(this,i.node)||this;return r.chart=i,r._axisTop=null,r._axisRight=null,r._axisBottom=null,r._axisLeft=null,r._kinematic=null,r._kinematicScaleTop=null,r._kinematicScaleRight=null,r._kinematicScaleBottom=null,r._kinematicScaleLeft=null,r._domainBoundTop=null,r._domainBoundRight=null,r._domainBoundBottom=null,r._domainBoundLeft=null,r._domainPaddingTop=null,r._domainPaddingRight=null,r._domainPaddingBottom=null,r._domainPaddingLeft=null,r._scaleTransition=null,r._flags=r._flags|e.FitX|e.TrackX|e.FitY|e.TrackY,r.chartAnimator=new Ol(r.chart,r._childViews),r.chart.addObserver(r),i.node.addEventListener("kinematicscalestart",r.onKinematicScaleStart.bind(r)),i.node.addEventListener("kinematicscaleupdate",r.onKinematicScaleUpdate.bind(r)),i.node.addEventListener("kinematicscaleend",r.onKinematicScaleEnd.bind(r)),r}return u(e,t),e.prototype.plots=function(){for(var t=[],e=0;e<this._childViews.length;e+=1){var i=this._childViews[e];i instanceof hl&&t.push(i)}return t},e.prototype.addPlot=function(t){this.appendChildView(t)},e.prototype.removePlot=function(t){this.removeChildView(t)},e.prototype.didInsertChildView=function(e){e instanceof hl&&(e.axisX()||(this._axisBottom?e.axisX(this._axisBottom):this._axisTop&&e.axisX(this._axisTop)),e.axisY()||(this._axisLeft?e.axisY(this._axisLeft):this._axisRight&&e.axisY(this._axisRight)),this.chart.addPlot(e.plot)),t.prototype.didInsertChildView.call(this,e)},e.prototype.didRemoveChildView=function(e){e instanceof hl&&this.chart.removePlot(e.plot),t.prototype.didRemoveChildView.call(this,e)},e.prototype.axisTop=function(t){return void 0===t?this._axisTop:(this._axisTop&&this.removeChildView(this._axisTop),this._axisTop=t,this._axisTop&&this.appendChildView(this._axisTop),this.chartAnimator.axisTop=t,this.chart.axisTop(t?t.axis:null),this)},e.prototype.axisRight=function(t){return void 0===t?this._axisRight:(this._axisRight&&this.removeChildView(this._axisRight),this._axisRight=t,this._axisRight&&this.appendChildView(this._axisRight),this.chartAnimator.axisRight=t,this.chart.axisRight(t?t.axis:null),this)},e.prototype.axisBottom=function(t){return void 0===t?this._axisBottom:(this._axisBottom&&this.removeChildView(this._axisBottom),this._axisBottom=t,this._axisBottom&&this.appendChildView(this._axisBottom),this.chartAnimator.axisBottom=t,this.chart.axisBottom(t?t.axis:null),this)},e.prototype.axisLeft=function(t){return void 0===t?this._axisLeft:(this._axisLeft&&this.removeChildView(this._axisLeft),this._axisLeft=t,this._axisLeft&&this.appendChildView(this._axisLeft),this.chartAnimator.axisLeft=t,this.chart.axisLeft(t?t.axis:null),this)},e.prototype.kinematic=function(t){return void 0===t?this._kinematic:(!0===t?t=Ts.create():!1===t&&(t=null),this._kinematic&&this._kinematic.surface(null),this._kinematic=t,this._kinematic&&this._kinematic.surface(this.chart.surfaceRect),this)},e.prototype.kinematicScaleTop=function(t){return void 0===t?this._kinematicScaleTop:(!0===t?t=Is.horizontal():!1===t&&(t=null),this._kinematicScaleTop&&this._kinematicScaleTop.kinematic(null).ruler(null).scale(null),this._kinematicScaleTop=t,this._kinematicScaleTop&&(this._kinematic||this.kinematic(!0),this._kinematicScaleTop.kinematic(this._kinematic).ruler(this.chart.surfaceRect).scale(this.chart.axisTop().scale()),this.reboundX()),this)},e.prototype.kinematicScaleRight=function(t){return void 0===t?this._kinematicScaleRight:(!0===t?t=Is.vertical():!1===t&&(t=null),this._kinematicScaleRight&&this._kinematicScaleRight.kinematic(null).ruler(null).scale(null),this._kinematicScaleRight=t,this._kinematicScaleRight&&(this._kinematic||this.kinematic(!0),this._kinematicScaleRight.kinematic(this._kinematic).ruler(this.chart.surfaceRect).scale(this.chart.axisRight().scale()),this.reboundY()),this)},e.prototype.kinematicScaleBottom=function(t){return void 0===t?this._kinematicScaleBottom:(!0===t?t=Is.horizontal():!1===t&&(t=null),this._kinematicScaleBottom&&this._kinematicScaleBottom.kinematic(null).ruler(null).scale(null),this._kinematicScaleBottom=t,this._kinematicScaleBottom&&(this._kinematic||this.kinematic(!0),this._kinematicScaleBottom.kinematic(this._kinematic).ruler(this.chart.surfaceRect).scale(this.chart.axisBottom().scale()),this.reboundX()),this)},e.prototype.kinematicScaleLeft=function(t){return void 0===t?this._kinematicScaleLeft:(!0===t?t=Is.vertical():!1===t&&(t=null),this._kinematicScaleLeft&&this._kinematicScaleLeft.kinematic(null).ruler(null).scale(null),this._kinematicScaleLeft=t,this._kinematicScaleLeft&&(this._kinematic||this.kinematic(!0),this._kinematicScaleLeft.kinematic(this._kinematic).ruler(this.chart.surfaceRect).scale(this.chart.axisLeft().scale()),this.reboundY()),this)},e.prototype.gutterTop=function(t,e){return this.propertyLength(Bl,t,e)},e.prototype.gutterRight=function(t,e){return this.propertyLength(ql,t,e)},e.prototype.gutterBottom=function(t,e){return this.propertyLength(Gl,t,e)},e.prototype.gutterLeft=function(t,e){return this.propertyLength(Hl,t,e)},e.prototype.width=function(t,e){return this.propertyLength(Nl,t,e)},e.prototype.height=function(t,e){return this.propertyLength(jl,t,e)},e.prototype.domainBoundTop=function(t){return void 0===t?this._domainBoundTop:(S(this._domainBoundTop,t)||(this._domainBoundTop=t,this.reboundY()),this)},e.prototype.domainBoundRight=function(t){return void 0===t?this._domainBoundRight:(S(this._domainBoundRight,t)||(this._domainBoundRight=t,this.reboundX()),this)},e.prototype.domainBoundBottom=function(t){return void 0===t?this._domainBoundBottom:(S(this._domainBoundBottom,t)||(this._domainBoundBottom=t,this.reboundY()),this)},e.prototype.domainBoundLeft=function(t){return void 0===t?this._domainBoundLeft:(S(this._domainBoundLeft,t)||(this._domainBoundLeft=t,this.reboundX()),this)},e.prototype.domainPaddingTop=function(t){return void 0===t?this._domainPaddingTop:(S(this._domainPaddingTop,t)||(this._domainPaddingTop=t,this.chartAnimator.animate()),this)},e.prototype.domainPaddingRight=function(t){return void 0===t?this._domainPaddingRight:(S(this._domainPaddingRight,t)||(this._domainPaddingRight=t,this.chartAnimator.animate()),this)},e.prototype.domainPaddingBottom=function(t){return void 0===t?this._domainPaddingBottom:(S(this._domainPaddingBottom,t)||(this._domainPaddingBottom=t,this.chartAnimator.animate()),this)},e.prototype.domainPaddingLeft=function(t){return void 0===t?this._domainPaddingLeft:(S(this._domainPaddingLeft,t)||(this._domainPaddingLeft=t,this.chartAnimator.animate()),this)},e.prototype.scaleTransition=function(t){return void 0===t?this._scaleTransition:(null!==t&&(t=fs.fromAny(t)),this._scaleTransition=t,this)},e.prototype.fitX=function(t){if(void 0===t)return 0!=(this._flags&e.FitX);var i=this._flags,r=void 0;return i!==(r=t?i|e.FitX|e.TrackX:i&~(e.FitX|e.TrackX))&&(this._flags=r,this.chartAnimator.animate()),this},e.prototype.fitY=function(t){if(void 0===t)return 0!=(this._flags&e.FitY);var i=this._flags,r=void 0;return i!==(r=t?i|e.FitY|e.TrackY:i&~(e.FitY|e.TrackY))&&(this._flags=r,this.chartAnimator.animate()),this},e.prototype.dataDomainX=function(){var t=this.chart.dataDomainX();return t&&(this._domainPaddingLeft&&(t[0]=+t[0]-+this._domainPaddingLeft),this._domainPaddingRight&&(t[1]=+t[1]+ +this._domainPaddingRight)),t},e.prototype.dataRangeX=function(){return this.chart.dataRangeX()},e.prototype.dataDomainY=function(){var t=this.chart.dataDomainY();return t&&(this._domainPaddingBottom&&(t[0]=+t[0]-+this._domainPaddingBottom),this._domainPaddingTop&&(t[1]=+t[1]+ +this._domainPaddingTop)),t},e.prototype.dataRangeY=function(){return this.chart.dataRangeY()},e.prototype.domainColor=function(t,e){return t=Qo.fromAny(t),this._axisTop&&this._axisTop.domainColor(t,e),this._axisRight&&this._axisRight.domainColor(t,e),this._axisBottom&&this._axisBottom.domainColor(t,e),this._axisLeft&&this._axisLeft.domainColor(t,e),this},e.prototype.domainWidth=function(t,e){return this._axisTop&&this._axisTop.domainWidth(t,e),this._axisRight&&this._axisRight.domainWidth(t,e),this._axisBottom&&this._axisBottom.domainWidth(t,e),this._axisLeft&&this._axisLeft.domainWidth(t,e),this},e.prototype.domainSerif=function(t,e){return this._axisTop&&this._axisTop.domainSerif(t,e),this._axisRight&&this._axisRight.domainSerif(t,e),this._axisBottom&&this._axisBottom.domainSerif(t,e),this._axisLeft&&this._axisLeft.domainSerif(t,e),this},e.prototype.tickTransition=function(t){return this._axisTop&&this._axisTop.tickTransition(t),this._axisRight&&this._axisRight.tickTransition(t),this._axisBottom&&this._axisBottom.tickTransition(t),this._axisLeft&&this._axisLeft.tickTransition(t),this},e.prototype.tickMarkColor=function(t,e){return t=Qo.fromAny(t),this._axisTop&&this._axisTop.tickMarkColor(t,e),this._axisRight&&this._axisRight.tickMarkColor(t,e),this._axisBottom&&this._axisBottom.tickMarkColor(t,e),this._axisLeft&&this._axisLeft.tickMarkColor(t,e),this},e.prototype.tickMarkWidth=function(t,e){return this._axisTop&&this._axisTop.tickMarkWidth(t,e),this._axisRight&&this._axisRight.tickMarkWidth(t,e),this._axisBottom&&this._axisBottom.tickMarkWidth(t,e),this._axisLeft&&this._axisLeft.tickMarkWidth(t,e),this},e.prototype.tickMarkLength=function(t,e){return this._axisTop&&this._axisTop.tickMarkLength(t,e),this._axisRight&&this._axisRight.tickMarkLength(t,e),this._axisBottom&&this._axisBottom.tickMarkLength(t,e),this._axisLeft&&this._axisLeft.tickMarkLength(t,e),this},e.prototype.tickLabelColor=function(t,e){return t=Qo.fromAny(t),this._axisTop&&this._axisTop.tickLabelColor(t,e),this._axisRight&&this._axisRight.tickLabelColor(t,e),this._axisBottom&&this._axisBottom.tickLabelColor(t,e),this._axisLeft&&this._axisLeft.tickLabelColor(t,e),this},e.prototype.tickLabelPadding=function(t,e){return this._axisTop&&this._axisTop.tickLabelPadding(t,e),this._axisRight&&this._axisRight.tickLabelPadding(t,e),this._axisBottom&&this._axisBottom.tickLabelPadding(t,e),this._axisLeft&&this._axisLeft.tickLabelPadding(t,e),this},e.prototype.render=function(){this.chartAnimator.update()},e.prototype.reboundX=function(){var t=this._kinematicScaleBottom,e=this._kinematicScaleTop,i=this._domainBoundLeft,r=this._domainBoundRight;if((t||e)&&(null!==i||null!==r)){var o=this.dataDomainX();if(o){var n=o[0];null!==i&&"boolean"!=typeof i&&(n=+n-+i);var s=o[1];null!==r&&"boolean"!=typeof r&&(s=+s+ +r),t&&(null!==i&&t.domainMin(n),null!==r&&t.domainMax(s)),e&&(null!==i&&e.domainMin(n),null!==r&&e.domainMax(s))}}},e.prototype.reboundY=function(){var t=this._kinematicScaleLeft,e=this._kinematicScaleRight,i=this._domainBoundBottom,r=this._domainBoundTop;if((t||e)&&null!==i&&null!==r){var o=this.dataDomainY();if(o){var n=o[0];"boolean"!=typeof i&&(n=+n-+i);var s=o[1];"boolean"!=typeof r&&(s=+s+ +r),t&&(null!==i&&t.domainMin(n),null!==r&&t.domainMax(s)),e&&(null!==i&&e.domainMin(n),null!==r&&e.domainMax(s))}}},e.prototype.rebound=function(){this.reboundX(),this.reboundY()},e.prototype.autoscaleX=function(t){if(0!=(this._flags&e.TrackX)){var i=this._axisBottom,r=this._axisTop;if(i||r){var o=this.dataDomainX();o&&(i&&i.domain(o,void 0,t),r&&r.domain(o,void 0,t))}}},e.prototype.autoscaleY=function(t){if(0!=(this._flags&e.TrackY)){var i=this._axisLeft,r=this._axisRight;if(i||r){var o=this.dataDomainY();o&&(i&&i.domain(o,void 0,t),r&&r.domain(o,void 0,t))}}},e.prototype.autoscale=function(t){void 0===t&&(t=this._scaleTransition||void 0),this.autoscaleX(t),this.autoscaleY(t)},e.prototype.autosize=function(){for(var t=this.node;;){var e=t.parentNode;if(!e)return;if(e instanceof HTMLElement)return void this.width(e.offsetWidth).height(e.offsetHeight);t=e}},e.prototype.didResize=function(){t.prototype.didResize.call(this),this.autosize(),this.render()},e.prototype.didReview=function(e){t.prototype.didReview.call(this,e),this.chartAnimator.enabled(e)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("transition").cast(fs.Form),o=e.get("scaleTransition").cast(fs.Form);o&&this.scaleTransition(o);var n=e.get("domainBoundTop").cast(Zs.Form);void 0!==n&&this.domainBoundTop(n);var s=e.get("domainBoundRight").cast(Zs.Form);void 0!==s&&this.domainBoundRight(s);var a=e.get("domainBoundBottom").cast(Zs.Form);void 0!==a&&this.domainBoundBottom(a);var u=e.get("domainBoundLeft").cast(Zs.Form);void 0!==u&&this.domainBoundLeft(u);var h=e.get("domainPaddingTop").cast(Zs.Form);void 0!==h&&this.domainPaddingTop(h);var l=e.get("domainPaddingRight").cast(Zs.Form);void 0!==l&&this.domainPaddingRight(l);var p=e.get("domainPaddingBottom").cast(Zs.Form);void 0!==p&&this.domainPaddingBottom(p);var c=e.get("domainPaddingLeft").cast(Zs.Form);void 0!==c&&this.domainPaddingLeft(c);var d=e.get("gutterTop").cast(qo.Form);d&&this.gutterTop(d,r);var f=e.get("gutterRight").cast(qo.Form);f&&this.gutterRight(f,r);var y=e.get("gutterBottom").cast(qo.Form);y&&this.gutterBottom(y,r);var m=e.get("gutterLeft").cast(qo.Form);m&&this.gutterLeft(m,r)},e.prototype.addObserver=function(t){this.chart.addObserver(t)},e.prototype.removeObserver=function(t){this.chart.removeObserver(t)},e.prototype.chartDidInsertPoint=function(t,e,i){this.chartAnimator.animate()},e.prototype.chartDidRemovePoint=function(t,e,i){this.chartAnimator.animate()},e.prototype.chartDidScaleTop=function(t,e,i){this._kinematicScaleTop&&this._kinematicScaleTop.scale(t);for(var r=0;r<this._childViews.length;r+=1){var o=this._childViews[r];o instanceof hl&&o.axisX()===this._axisTop&&o.scaleX(t)}},e.prototype.chartDidScaleRight=function(t,e,i){this._kinematicScaleRight&&this._kinematicScaleRight.scale(t);for(var r=0;r<this._childViews.length;r+=1){var o=this._childViews[r];o instanceof hl&&o.axisY()===this._axisRight&&o.scaleY(t)}},e.prototype.chartDidScaleBottom=function(t,e,i){this._kinematicScaleBottom&&this._kinematicScaleBottom.scale(t);for(var r=0;r<this._childViews.length;r+=1){var o=this._childViews[r];o instanceof hl&&o.axisX()===this._axisBottom&&o.scaleX(t)}},e.prototype.chartDidScaleLeft=function(t,e,i){this._kinematicScaleLeft&&this._kinematicScaleLeft.scale(t);for(var r=0;r<this._childViews.length;r+=1){var o=this._childViews[r];o instanceof hl&&o.axisY()===this._axisLeft&&o.scaleY(t)}},e.prototype.xScaleDidStart=function(t){this._flags&=~e.TrackX},e.prototype.yScaleDidStart=function(t){this._flags&=~e.TrackY},e.prototype.xScaleDidEnd=function(t){if(0!=(this._flags&e.FitX)){var i=t.scale().domain(),r=t.domainMin(),o=t.domainMax();if(i&&null!==r&&null!==o){var n=i[0],s=i[1],a=V(n,s);a<0?V(n,r)<=0&&V(s,o)>=0&&(this._flags|=e.TrackX):a>0&&V(s,r)<=0&&V(n,o)>=0&&(this._flags|=e.TrackX)}}},e.prototype.yScaleDidEnd=function(t){if(0!=(this._flags&e.FitY)){var i=t.scale().domain(),r=t.domainMin(),o=t.domainMax();if(i&&null!==r&&null!==o){var n=i[0],s=i[1],a=V(n,s);a<0?V(n,r)<=0&&V(s,o)>=0&&(this._flags|=e.TrackX):a>0&&V(s,r)<=0&&V(n,o)>=0&&(this._flags|=e.TrackX)}}},e.prototype.onKinematicScaleStart=function(t){this._axisTop&&t.kinematicScale===this._kinematicScaleTop?(this._axisTop.frame(this._axisTop.scale()),this._axisTop.domain(t.scale.domain()),this.xScaleDidStart(t.kinematicScale)):this._axisRight&&t.kinematicScale===this._kinematicScaleRight?(this._axisRight.frame(this._axisRight.scale()),this._axisRight.domain(t.scale.domain()),this.yScaleDidStart(t.kinematicScale)):this._axisBottom&&t.kinematicScale===this._kinematicScaleBottom?(this._axisBottom.frame(this._axisBottom.scale()),this._axisBottom.domain(t.scale.domain()),this.xScaleDidStart(t.kinematicScale)):this._axisLeft&&t.kinematicScale===this._kinematicScaleLeft&&(this._axisLeft.frame(this._axisLeft.scale()),this._axisLeft.domain(t.scale.domain()),this.yScaleDidStart(t.kinematicScale))},e.prototype.onKinematicScaleUpdate=function(t){this._axisTop&&t.kinematicScale===this._kinematicScaleTop?this._axisTop.domain(t.scale.domain()):this._axisRight&&t.kinematicScale===this._kinematicScaleRight?this._axisRight.domain(t.scale.domain()):this._axisBottom&&t.kinematicScale===this._kinematicScaleBottom?this._axisBottom.domain(t.scale.domain()):this._axisLeft&&t.kinematicScale===this._kinematicScaleLeft&&this._axisLeft.domain(t.scale.domain())},e.prototype.onKinematicScaleEnd=function(t){this._axisTop&&t.kinematicScale===this._kinematicScaleTop?(this._axisTop.frame(null),this._axisTop.domain(t.scale.domain()),this.xScaleDidEnd(t.kinematicScale)):this._axisRight&&t.kinematicScale===this._kinematicScaleRight?(this._axisRight.frame(null),this._axisRight.domain(t.scale.domain()),this.yScaleDidEnd(t.kinematicScale)):this._axisBottom&&t.kinematicScale===this._kinematicScaleBottom?(this._axisBottom.frame(null),this._axisBottom.domain(t.scale.domain()),this.xScaleDidEnd(t.kinematicScale)):this._axisLeft&&t.kinematicScale===this._kinematicScaleLeft&&(this._axisLeft.frame(null),this._axisLeft.domain(t.scale.domain()),this.yScaleDidEnd(t.kinematicScale))},e.create=function(t){if(t instanceof e)return t;if(t instanceof ba)throw new TypeError(""+t);if(void 0===t||"string"==typeof t)return new e(Wl.create(t));if(t.view instanceof e)return t.view;if(t.view)throw new TypeError(""+t.view);if(t instanceof SVGElement)return new e(new Wl(t));throw new TypeError(""+t)},e.FitX=65536,e.TrackX=1<<17,e.FitY=1<<18,e.TrackY=1<<19,e}(Xa),Xl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=pu.Params.concat([new Ca("transition",B.get("transition").or(B.get("chart").get("transition"))),new Ca("scaleTransition",B.get("scaleTransition").or(B.get("chart").get("scaleTransition"))),new Ca("domainBoundTop",B.get("domainBoundTop")),new Ca("domainBoundRight",B.get("domainBoundRight")),new Ca("domainBoundBottom",B.get("domainBoundBottom")),new Ca("domainBoundLeft",B.get("domainBoundLeft")),new Ca("domainPaddingTop",B.get("domainPaddingTop").or(B.get("chart").get("domainPaddingTop"))),new Ca("domainPaddingRight",B.get("domainPaddingRight").or(B.get("chart").get("domainPaddingRight"))),new Ca("domainPaddingBottom",B.get("domainPaddingBottom").or(B.get("chart").get("domainPaddingBottom"))),new Ca("domainPaddingLeft",B.get("domainPaddingLeft").or(B.get("chart").get("domainPaddingLeft"))),new Ca("gutterTop",B.get("top").get("gutter").or(B.get("chart").get("top").get("gutter"))),new Ca("gutterRight",B.get("right").get("gutter").or(B.get("chart").get("right").get("gutter"))),new Ca("gutterBottom",B.get("bottom").get("gutter").or(B.get("chart").get("bottom").get("gutter"))),new Ca("gutterLeft",B.get("left").get("gutter").or(B.get("chart").get("left").get("gutter")))]),e}(pu),Kl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"chart"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=Yl.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new Xl,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeKinematic=function(t,e){var i=e.get("wheel");i.isDefined()&&t.wheel(i.booleanValue(!1))},e.prototype.materializeAxisTop=function(t,e,i,r,o){var n=sl.top(e);n.setModel(ul.Form.materializeView(n,i,r,o)),t.axisTop(n);var s=i.get("kinematic");return s.isDefined()&&!1!==s.booleanValue()&&(t.kinematicScaleTop(!0),this.materializeKinematic(t.kinematicScaleTop(),s)),n},e.prototype.materializeAxisRight=function(t,e,i,r,o){var n=sl.right(e);n.setModel(ul.Form.materializeView(n,i,r,o)),t.axisRight(n);var s=i.get("kinematic");return s.isDefined()&&!1!==s.booleanValue()&&(t.kinematicScaleRight(!0),this.materializeKinematic(t.kinematicScaleRight(),s)),n},e.prototype.materializeAxisBottom=function(t,e,i,r,o){var n=sl.bottom(e);n.setModel(ul.Form.materializeView(n,i,r,o)),t.axisBottom(n);var s=i.get("kinematic");return s.isDefined()&&!1!==s.booleanValue()&&(t.kinematicScaleBottom(!0),this.materializeKinematic(t.kinematicScaleBottom(),s)),n},e.prototype.materializeAxisLeft=function(t,e,i,r,o){var n=sl.left(e);n.setModel(ul.Form.materializeView(n,i,r,o)),t.axisLeft(n);var s=i.get("kinematic");return s.isDefined()&&!1!==s.booleanValue()&&(t.kinematicScaleLeft(!0),this.materializeKinematic(t.kinematicScaleLeft(),s)),n},e.prototype.materializeViewParam=function(e,i,r,o){if(i.key instanceof I){var n=i.key.value;if("top"===n){var s=i.toValue().header("axis");if(s.isDefined()){var a=s.get("type").stringValue("linear");this.materializeAxisTop(e,a,i.toValue(),r,o)}}else if("right"===n){var u=i.toValue().header("axis");if(u.isDefined()){a=u.get("type").stringValue("linear");this.materializeAxisRight(e,a,i.toValue(),r,o)}}else if("bottom"===n){var h=i.toValue().header("axis");if(h.isDefined()){a=h.get("type").stringValue("linear");this.materializeAxisBottom(e,a,i.toValue(),r,o)}}else if("left"===n){var l=i.toValue().header("axis");if(l.isDefined()){a=l.get("type").stringValue("linear");this.materializeAxisLeft(e,a,i.toValue(),r,o)}}}else{var p=yl.Global.castView(i.toValue(),r,o);if(p)return e.addPlot(p),p}return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(cu);Aa.addGlobal(Kl.Form);var Ql=function(){function t(t){this.node=t,this._meter=0,this._width=qo.zero(t),this._height=qo.zero(t),this._innerRadius=qo.zero(),this._outerRadius=qo.zero(),this._faceColor=Qo.black(),this._dialColor=Qo.black(),this._dialCornerRadius=qo.zero(),this._value=null,this._valueSize=null,this._valueColor=Qo.black(),this.dirty=!0,this.observers=[],this.gaugeBox=document.createElementNS("http://www.w3.org/2000/svg","g"),this.gaugeBox.setAttribute("class","gauge-box"),this.node.appendChild(this.gaugeBox),this.arcGroup=document.createElementNS("http://www.w3.org/2000/svg","g"),this.arcGroup.setAttribute("class","arc-group"),this.gaugeBox.appendChild(this.arcGroup),this.face=_u.create("face"),this.face.node.setAttribute("class","face"),this.face.deltaAngle(2*Math.PI*1,void 0),this.arcGroup.appendChild(this.face.node),this.dial=_u.create("dial"),this.dial.node.setAttribute("class","dial"),this.dial.deltaAngle(2*Math.PI*0,void 0),this.arcGroup.appendChild(this.dial.node)}return t.prototype.meter=function(t){if(void 0===t)return this._meter;var e=this._meter;if(e!==t){this._meter=t,this.dirty=!0;for(var i=0;i<this.observers.length;i+=1){var r=this.observers[i];r.gaugeDidSetMeter&&r.gaugeDidSetMeter(t,e,this)}}return this},t.prototype.width=function(t){return void 0===t?this._width:(t=qo.fromAny(t,this.node),this._width.equals(t)||(this._width=t,this.dirty=!0),this)},t.prototype.height=function(t){return void 0===t?this._height:(t=qo.fromAny(t,this.node),this._height.equals(t)||(this._height=t,this.dirty=!0),this)},t.prototype.innerRadius=function(t){return void 0===t?this._innerRadius:(t=qo.fromAny(t),this._innerRadius.equals(t)||(this._innerRadius=t,this.dirty=!0),this)},t.prototype.outerRadius=function(t){return void 0===t?this._outerRadius:(t=qo.fromAny(t),this._outerRadius.equals(t)||(this._outerRadius=t,this.dirty=!0),this)},t.prototype.faceColor=function(t){return void 0===t?this._faceColor:(t=Qo.fromAny(t),this._faceColor.equals(t)||(this._faceColor=t,this.dirty=!0),this)},t.prototype.dialColor=function(t){return void 0===t?this._dialColor:(t=Qo.fromAny(t),this._dialColor.equals(t)||(this._dialColor=t,this.dirty=!0),this)},t.prototype.dialCornerRadius=function(t){return void 0===t?this._dialCornerRadius:(t=qo.fromAny(t),this._dialCornerRadius.equals(t)||(this._dialCornerRadius=t,this.dirty=!0),this)},t.prototype.value=function(t){return void 0===t?this._value:(this._value!==t?(this._value&&this.arcGroup.removeChild(this._value),this._value=t,this._value&&this.arcGroup.appendChild(this._value),this.dirty=!0,this.render()):this.dirty=!0,this)},t.prototype.valueSize=function(t){return void 0===t?this._valueSize:(null!==t&&(t=qo.fromAny(t)),(this._valueSize?this._valueSize.equals(t):this._valueSize===t)||(this._valueSize=t,this.dirty=!0),this)},t.prototype.valueColor=function(t){return void 0===t?this._valueColor:(t=Qo.fromAny(t),this._valueColor.equals(t)||(this._valueColor=t,this.dirty=!0),this)},t.prototype.render=function(t){this.dirty&&(this.dirty=!1,this.renderLayout(),this.renderMeter(t),this.renderStyle())},t.prototype.renderStyle=function(){this._faceColor&&this.face.node.setAttribute("fill",this._faceColor.toString()),this._dialColor&&this.dial.node.setAttribute("fill",this._dialColor.toString())},t.prototype.renderLayout=function(){var t=this._width.pxValue(),e=this._height.pxValue(),i=Math.min(t,e);if(i){var r=this._outerRadius.pxValue(i/2),o=this._innerRadius.pxValue(r),n=dn.translate(t/2-r,e/2-r);this.gaugeBox.setAttribute("transform",n.toAttributeString());var s=dn.translate(r,r);this.arcGroup.setAttribute("transform",s.toAttributeString()),this.face.innerRadius(o).outerRadius(r),this.dial.innerRadius(o).outerRadius(r),null===this._dialCornerRadius&&void 0===this._dialCornerRadius||this.dial.cornerRadius(this._dialCornerRadius.pxValue(r-o/2));var a=this._value;if(a){if(a instanceof SVGGElement){var u=dn.translate(r,r);a.setAttribute("transform",u.toAttributeString()),a.setAttribute("width",""+o)}else a instanceof SVGTextElement&&(a.removeAttribute("visibility"),a.setAttribute("text-anchor","middle"),a.setAttribute("alignment-baseline","middle"),this._valueSize&&a.setAttribute("font-size",""+Math.ceil(this._valueSize.pxValue(o))));this._valueColor&&a.setAttribute("fill",this._valueColor.toString())}}},t.prototype.renderMeter=function(t){var e=Math.min(Math.max(0,this._meter),1)||0;this.dial.deltaAngle(2*Math.PI*e,t||void 0)},t.prototype.addObserver=function(t){this.observers.indexOf(t)<0&&this.observers.push(t)},t.prototype.removeObserver=function(t){var e=this.observers.indexOf(t);e>=0&&this.observers.splice(e,1)},t.create=function(e){void 0===e&&(e="svg");var i=document.createElementNS("http://www.w3.org/2000/svg",e);return i.setAttribute("class","gauge"),i.style.setProperty("-webkit-user-select","none"),i.style.setProperty("-moz-user-select","none"),i.style.setProperty("-ms-user-select","none"),i.style.setProperty("user-select","none"),i.style.setProperty("cursor","default"),new t(i)},t}(),Zl=function(t){function e(e){var i=t.call(this)||this;return i.gauge=e,i.meter=void 0,i.width=void 0,i.height=void 0,i.innerRadius=void 0,i.outerRadius=void 0,i.faceColor=void 0,i.dialColor=void 0,i.dialCornerRadius=void 0,i.valueSize=void 0,i.valueColor=void 0,i}return u(e,t),e.prototype.onFrame=function(t){this.meter&&this.meter.onFrame(t),this.width&&this.width.onFrame(t),this.height&&this.height.onFrame(t),this.innerRadius&&this.innerRadius.onFrame(t),this.outerRadius&&this.outerRadius.onFrame(t),this.faceColor&&this.faceColor.onFrame(t),this.dialColor&&this.dialColor.onFrame(t),this.dialCornerRadius&&this.dialCornerRadius.onFrame(t),this.valueSize&&this.valueSize.onFrame(t),this.valueColor&&this.valueColor.onFrame(t),this.update()},e.prototype.update=function(){this.gauge.render()},e}(ws),Jl=function(t){function e(e,i,r){var o=t.call(this,e,i,r)||this;return o.update(i),o}return u(e,t),e.prototype.update=function(t){this.parent.gauge.meter(t)},e.get=function(t){return t.gauge.meter()},e.set=function(t,e){null===e?t.gaugeAnimator.meter=void 0:(t.gauge.meter(e),t.gaugeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.gaugeAnimator.meter||(t.gaugeAnimator.meter=new e(t.gaugeAnimator,i,r)),t.gaugeAnimator.meter},e}(xs),$l=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.gauge.width(t)},e.get=function(t){return t.gauge.width()},e.set=function(t,e){if(null===e)t.gaugeAnimator.width=void 0,t.gauge.node.removeAttribute("width");else{t.gauge.width(e);var i=t.gauge.node.getAttribute("width"),r=""+e.pxValue();i!==r&&(t.gauge.node.setAttribute("width",r),t.requireResize())}},e.animator=function(t,i,r){return void 0===i||t.gaugeAnimator.width||(t.gaugeAnimator.width=new e(t.gaugeAnimator,i,r)),t.gaugeAnimator.width},e}(xs),tp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.gauge.height(t)},e.get=function(t){return t.gauge.height()},e.set=function(t,e){if(null===e)t.gaugeAnimator.height=void 0,t.gauge.node.removeAttribute("height");else{t.gauge.height(e);var i=t.gauge.node.getAttribute("height"),r=""+e.pxValue();i!==r&&(t.gauge.node.setAttribute("height",r),t.requireResize())}},e.animator=function(t,i,r){return void 0===i||t.gaugeAnimator.height||(t.gaugeAnimator.height=new e(t.gaugeAnimator,i,r)),t.gaugeAnimator.height},e}(xs),ep=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.gauge.innerRadius(t)},e.get=function(t){return t.gauge.innerRadius()},e.set=function(t,e){null===e?t.gaugeAnimator.innerRadius=void 0:(t.gauge.innerRadius(e),t.gaugeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.gaugeAnimator.innerRadius||(t.gaugeAnimator.innerRadius=new e(t.gaugeAnimator,i,r)),t.gaugeAnimator.innerRadius},e}(xs),ip=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.gauge.outerRadius(t)},e.get=function(t){return t.gauge.outerRadius()},e.set=function(t,e){null===e?t.gaugeAnimator.outerRadius=void 0:(t.gauge.outerRadius(e),t.gaugeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.gaugeAnimator.outerRadius||(t.gaugeAnimator.outerRadius=new e(t.gaugeAnimator,i,r)),t.gaugeAnimator.outerRadius},e}(xs),rp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.gauge.faceColor(t)},e.get=function(t){return t.gauge.faceColor()},e.set=function(t,e){null===e?t.gaugeAnimator.faceColor=void 0:t.gauge.faceColor(e)},e.animator=function(t,i,r){return void 0===i||t.gaugeAnimator.faceColor||(t.gaugeAnimator.faceColor=new e(t.gaugeAnimator,i,r)),t.gaugeAnimator.faceColor},e}(xs),op=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.gauge.dialColor(t)},e.get=function(t){return t.gauge.dialColor()},e.set=function(t,e){null===e?t.gaugeAnimator.dialColor=void 0:t.gauge.dialColor(e)},e.animator=function(t,i,r){return void 0===i||t.gaugeAnimator.dialColor||(t.gaugeAnimator.dialColor=new e(t.gaugeAnimator,i,r)),t.gaugeAnimator.dialColor},e}(xs),np=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.gauge.dialCornerRadius(t)},e.get=function(t){return t.gauge.dialCornerRadius()},e.set=function(t,e){null===e?t.gaugeAnimator.dialCornerRadius=void 0:(t.gauge.dialCornerRadius(e),t.gaugeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.gaugeAnimator.dialCornerRadius||(t.gaugeAnimator.dialCornerRadius=new e(t.gaugeAnimator,i,r)),t.gaugeAnimator.dialCornerRadius},e}(xs),sp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.gauge.valueSize(t)},e.get=function(t){return t.gauge.valueSize()},e.set=function(t,e){null===e?t.gaugeAnimator.valueSize=void 0:(t.gauge.valueSize(e),t.gaugeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.gaugeAnimator.valueSize||(t.gaugeAnimator.valueSize=new e(t.gaugeAnimator,i,r)),t.gaugeAnimator.valueSize},e}(xs),ap=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.gauge.valueColor(t)},e.get=function(t){return t.gauge.valueColor()},e.set=function(t,e){null===e?t.gaugeAnimator.valueColor=void 0:t.gauge.valueColor(e)},e.animator=function(t,i,r){return void 0===i||t.gaugeAnimator.valueColor||(t.gaugeAnimator.valueColor=new e(t.gaugeAnimator,i,r)),t.gaugeAnimator.valueColor},e}(xs),up=function(t){function e(e){var i=t.call(this,e.node)||this;return i.gauge=e,i.gaugeAnimator=new Zl(i.gauge),i}return u(e,t),e.prototype.meter=function(t,e){return this.propertyNumber(Jl,t,e)},e.prototype.width=function(t,e){return this.propertyLength($l,t,e)},e.prototype.height=function(t,e){return this.propertyLength(tp,t,e)},e.prototype.innerRadius=function(t,e){return this.propertyLength(ep,t,e)},e.prototype.outerRadius=function(t,e){return this.propertyLength(ip,t,e)},e.prototype.faceColor=function(t,e){return this.propertyColor(rp,t,e)},e.prototype.dialColor=function(t,e){return this.propertyColor(op,t,e)},e.prototype.dialCornerRadius=function(t,e){return this.propertyLength(np,t,e)},e.prototype.gaugeValue=function(t){var e=this.gauge.value();if(void 0===t)return e;if("string"==typeof t?t=document.createTextNode(t):(t instanceof Xa||t instanceof Oa)&&(t=t.node),t instanceof Text)if(e){for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(t),t=e}else{var i=Xa.create("text").className("value");i.append(t),t=i.node}if(e){var r=e.view;e!==t&&r&&this.removeChildView(r)}if(this.gauge.value(t),t){var o=t.view;e!==t&&o&&this.appendChildView(o)}return this.gaugeAnimator.animate(),this},e.prototype.valueSize=function(t,e){return this.propertyLength(sp,t,e)},e.prototype.valueColor=function(t,e){return this.propertyColor(ap,t,e)},e.prototype.render=function(){this.gaugeAnimator.update()},e.prototype.didReview=function(e){t.prototype.didReview.call(this,e),this.gaugeAnimator.enabled(e)},e.prototype.autosize=function(){for(var t=this.node;;){var e=t.parentNode;if(!e)return;if(e instanceof HTMLElement)return void this.width(e.offsetWidth).height(e.offsetHeight);t=e}},e.prototype.didResize=function(){t.prototype.didResize.call(this),this.autosize(),this.render()},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("transition").cast(fs.Form),o=e.get("meter").numberValue();void 0!==o&&this.meter(o,r);var n=e.get("gaugeWidth").cast(qo.Form);n&&this.width(n);var s=e.get("gaugeHeight").cast(qo.Form);s&&this.height(s);var a=e.get("innerRadius").cast(qo.Form);a&&this.innerRadius(a,r);var u=e.get("outerRadius").cast(qo.Form);u&&this.outerRadius(u,r);var h=e.get("faceColor").cast(Qo.Form);h&&this.faceColor(h,r);var l=e.get("dialColor").cast(Qo.Form);l&&this.dialColor(l,r);var p=e.get("dialCornerRadius").cast(qo.Form);p&&this.dialCornerRadius(p,r);var c=e.get("valueSize").cast(qo.Form);c&&this.valueSize(c,r);var d=e.get("valueColor").cast(Qo.Form);d&&this.valueColor(d,r);var f=this.gaugeValue();if(f){var y=e.get("valueWeight").numberValue();y&&(f.style.fontWeight=""+y)}},e.create=function(){return new e(Ql.create())},e.applyTheme=function(t){var e=B.get("value").divide(B.get("total").or(U.One)),i=B.get("primaryHue").invoke(e).or(B.get("primaryColor")),r=B.get("contrast").invoke(L.of(i,U.valueOf(2))),o=L.empty().slot("meter","0").slot("innerRadius","80%").slot("outerRadius","100%").slot("faceColor",i).slot("dialColor",i).slot("dialCornerRadius","0").slot("valueColor",r).slot("valueSize","10px").slot("valueWeight",400);t.set("gauge",o)},e}(Xa);up.applyTheme(up.Theme);var hp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.updateValue=function(t){void 0===t&&(t=this.stack());var i=e.ValueSelector.evaluate(t).toValue().numberValue(NaN);if(isFinite(i))for(var r=0;r<this._childModels.length;r+=1)this._childModels[r]._modelScope._record.set("value",i);return i},e.ValueSelector=B.get("value"),e.Params=pu.Params.concat([new Ca("transition",B.get("transition").or(B.get("gauge").get("transition"))),new Ca("meter",B.get("meter").or(B.get("gauge").get("meter"))),new Ca("gaugeWidth",B.get("gaugeWidth").or(B.get("gauge").get("width"))),new Ca("gaugeHeight",B.get("gaugeHeight").or(B.get("gauge").get("height"))),new Ca("innerRadius",B.get("innerRadius").or(B.get("gauge").get("innerRadius"))),new Ca("outerRadius",B.get("outerRadius").or(B.get("gauge").get("outerRadius"))),new Ca("faceColor",B.get("faceColor").or(B.get("gauge").get("faceColor"))),new Ca("dialColor",B.get("dialColor").or(B.get("gauge").get("dialColor"))),new Ca("dialCornerRadius",B.get("dialCornerRadius").or(B.get("gauge").get("dialCornerRadius"))),new Ca("valueSize",B.get("valueSize").or(B.get("gauge").get("valueSize"))),new Ca("valueColor",B.get("valueColor").or(B.get("gauge").get("valueColor"))),new Ca("valueWeight",B.get("valueWeight").or(B.get("gauge").get("valueWeight")))]),e}(pu),lp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"gauge"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=up.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new hp,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){if(i.key instanceof I&&"value"===i.key.value){var n=o.castView(i.toValue(),r,o);if(void 0===n&&(n=i.toValue().stringValue()),void 0!==n)return e.gaugeValue(n),w.Absent}return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(cu);Aa.addGlobal(lp.Form);var pp=function(){function t(t){this.box=t,this.node=t.node,this._width=qo.zero(t.node),this._height=qo.zero(t.node),this._backgroundColor=null,this._ledColor=Qo.transparent(),this._title=null,this._titleSize=null,this._titleColor=null,this._subtitle=null,this._subtitleSize=null,this._subtitleColor=null,this._value=null,this._valueSize=null,this._valueColor=null,this._label=null,this._labelSize=null,this._labelColor=null,this._notice=null,this._noticeSize=null,this._noticeColor=null,this._meter=0,this._cylinderHeight=qo.zero(t.node),this._cylinderColor=Qo.transparent(),this._pistonColor=Qo.transparent(),this.dirty=!0,this.observers=[],this._gauge=null,this._chart=null,this.kpiBox=this.box.append("article").className("kpi-box").display("flex").flexDirection("column").flexGrow(1),this.header=this.kpiBox.append("header").className("header").display("flex"),this.ledBox=this.header.append("div").className("led-box").display("flex").justifyContent("center").alignItems("center"),this.led=this.ledBox.append("div").className("led").borderRadius("50%").width("100%").height("100%"),this.titleBox=this.header.append("div").className("title-box").display("flex").flexGrow(1).alignItems("center"),this.subtitleBox=this.header.append("div").className("subtitle-box").display("flex").flexShrink(1).alignItems("center"),this.body=this.kpiBox.append("div").className("body").display("flex").flexGrow(1).justifyContent("center").alignItems("center").flexDirection("column"),this.point=this.body.append("div").className("point").minWidth("67%").display("flex").flexDirection("column").justifyContent("center"),this.valueBox=this.point.append("div").className("value-box").lineHeight(1).textAlign("center"),this.labelbox=this.point.append("div").className("label-box").lineHeight(1).textAlign("right"),this.guageBox=this.body.append("div").className("gauge-box").width("100%"),this.chartBox=this.body.append("div").className("chart-box").width("100%"),this.belt=this.kpiBox.append("div").className("belt").display("flex").marginBottom(5),this.noticeSpan=this.belt.append("span").className("notice").display("block").lineHeight(1),this.footer=this.kpiBox.append("div").className("footer").display("flex").alignItems("flex-end"),this.cylinder=this.footer.append("div").className("cylinder").position("relative").width("100%").height("100%"),this.piston=this.cylinder.append("div").className("piston").width(0).height("100%")}return t.prototype.gauge=function(){return this._gauge},t.prototype.addGauge=function(t){for(var e=0;e<this.observers.length;e+=1){if((r=this.observers[e]).kpiWillAddGauge){var i=r.kpiWillAddGauge(t,this);if(i)t=i;else if(null===i)return}}this._gauge=t,this.guageBox.removeAll(),this.guageBox.node.appendChild(t.node),t.addObserver(this),this.dirty=!0;for(e=0;e<this.observers.length;e+=1){var r;(r=this.observers[e]).kpiDidAddGauge&&r.kpiDidAddGauge(t,this)}},t.prototype.removeGauge=function(t){for(var e=0;e<this.observers.length;e+=1){(i=this.observers[e]).kpiWillRemoveGauge&&i.kpiWillRemoveGauge(t,this)}t.removeObserver(this),this.guageBox.node.removeChild(t.node),this._gauge=null,this.dirty=!0;for(e=0;e<this.observers.length;e+=1){var i;(i=this.observers[e]).kpiDidRemoveGauge&&i.kpiDidRemoveGauge(t,this)}},t.prototype.chart=function(){return this._chart},t.prototype.addChart=function(t){for(var e=0;e<this.observers.length;e+=1){if((r=this.observers[e]).kpiWillAddChart){var i=r.kpiWillAddChart(t,this);if(i)t=i;else if(null===i)return}}this._chart=t,this.chartBox.removeAll(),this.chartBox.node.appendChild(t.node),this.dirty=!0;for(e=0;e<this.observers.length;e+=1){var r;(r=this.observers[e]).kpiDidAddChart&&r.kpiDidAddChart(t,this)}},t.prototype.removeChart=function(t){for(var e=0;e<this.observers.length;e+=1){(i=this.observers[e]).kpiWillRemoveChart&&i.kpiWillRemoveChart(t,this)}this.guageBox.node.removeChild(t.node),this._gauge=null,this.dirty=!0;for(e=0;e<this.observers.length;e+=1){var i;(i=this.observers[e]).kpiDidRemoveChart&&i.kpiDidRemoveChart(t,this)}},t.prototype.width=function(t){return void 0===t?this._width:(t=qo.fromAny(t,this.node),this._width.equals(t)||(this._width=t,this.dirty=!0),this)},t.prototype.height=function(t){return void 0===t?this._height:(t=qo.fromAny(t,this.node),this._height.equals(t)||(this._height=t,this.dirty=!0),this)},t.prototype.backgroundColor=function(t){return void 0===t?this._backgroundColor:(null===t?null!==this._backgroundColor&&(this._backgroundColor=t,this.dirty=!0):(t=Qo.fromAny(t),null!==this._backgroundColor&&this._backgroundColor.equals(t)||(this._backgroundColor=t,this.dirty=!0)),this)},t.prototype.ledColor=function(t){return void 0===t?this._ledColor:(t=Qo.fromAny(t),this._ledColor.equals(t)||(this._ledColor=t,this.dirty=!0),this)},t.prototype.title=function(t){return void 0===t?this._title:(this._title!==t?(this._title&&this.titleBox.node.removeChild(this._title),this._title=t,this._title&&this.titleBox.node.appendChild(this._title),this.dirty=!0,this.render()):this.dirty=!0,this)},t.prototype.titleSize=function(t){return void 0===t?this._titleSize:(null!==t&&(t=qo.fromAny(t)),(this._titleSize?this._titleSize.equals(t):this._titleSize===t)||(this._titleSize=t,this.dirty=!0),this)},t.prototype.titleColor=function(t){return void 0===t?this._titleColor:(null!==t&&(t=Qo.fromAny(t)),(this._titleColor?this._titleColor.equals(t):this._titleColor===t)||(this._titleColor=t,this.dirty=!0),this)},t.prototype.subtitle=function(t){return void 0===t?this._subtitle:(this._subtitle!==t?(this._subtitle&&this.subtitleBox.node.removeChild(this._subtitle),this._subtitle=t,this._subtitle&&this.subtitleBox.node.appendChild(this._subtitle),this.dirty=!0,this.render()):this.dirty=!0,this)},t.prototype.subtitleSize=function(t){return void 0===t?this._subtitleSize:(null!==t&&(t=qo.fromAny(t)),(this._subtitleSize?this._subtitleSize.equals(t):this._subtitleSize===t)||(this._subtitleSize=t,this.dirty=!0),this)},t.prototype.subtitleColor=function(t){return void 0===t?this._subtitleColor:(null!==t&&(t=Qo.fromAny(t)),(this._subtitleColor?this._subtitleColor.equals(t):this._subtitleColor===t)||(this._subtitleColor=t,this.dirty=!0),this)},t.prototype.value=function(t){return void 0===t?this._value:(this._value!==t?(this._value&&this.valueBox.node.removeChild(this._value),this._value=t,this._value&&this.valueBox.node.appendChild(this._value),this.dirty=!0,this.render()):this.dirty=!0,this)},t.prototype.valueSize=function(t){return void 0===t?this._valueSize:(null!==t&&(t=qo.fromAny(t)),(this._valueSize?this._valueSize.equals(t):this._valueSize===t)||(this._valueSize=t,this.dirty=!0),this)},t.prototype.valueColor=function(t){return void 0===t?this._valueColor:(null!==t&&(t=Qo.fromAny(t)),(this._valueColor?this._valueColor.equals(t):this._valueColor===t)||(this._valueColor=t,this.dirty=!0),this)},t.prototype.label=function(t){return void 0===t?this._label:(this._label!==t?(this._label&&this.labelbox.node.removeChild(this._label),this._label=t,this._label&&this.labelbox.node.appendChild(this._label),this.dirty=!0,this.render()):this.dirty=!0,this)},t.prototype.labelSize=function(t){return void 0===t?this._labelSize:(null!==t&&(t=qo.fromAny(t)),(this._labelSize?this._labelSize.equals(t):this._labelSize===t)||(this._labelSize=t,this.dirty=!0),this)},t.prototype.labelColor=function(t){return void 0===t?this._labelColor:(null!==t&&(t=Qo.fromAny(t)),(this._labelColor?this._labelColor.equals(t):this._labelColor===t)||(this._labelColor=t,this.dirty=!0),this)},t.prototype.notice=function(t){return void 0===t?this._notice:(this._notice!==t?(this._notice&&this.noticeSpan.node.removeChild(this._notice),this._notice=t,this._notice&&this.noticeSpan.node.appendChild(this._notice),this.dirty=!0,this.render()):this.dirty=!0,this)},t.prototype.noticeSize=function(t){return void 0===t?this._noticeSize:(null!==t&&(t=qo.fromAny(t)),(this._noticeSize?this._noticeSize.equals(t):this._noticeSize===t)||(this._noticeSize=t,this.dirty=!0),this)},t.prototype.noticeColor=function(t){return void 0===t?this._noticeColor:(null!==t&&(t=Qo.fromAny(t)),(this._noticeColor?this._noticeColor.equals(t):this._noticeColor===t)||(this._noticeColor=t,this.dirty=!0),this)},t.prototype.meter=function(t){if(void 0===t)return this._meter;var e=this._meter;if(e!==t){this._meter=t,this.dirty=!0;for(var i=0;i<this.observers.length;i+=1){var r=this.observers[i];r.kpiDidSetMeter&&r.kpiDidSetMeter(t,e,this)}}return this},t.prototype.cylinderHeight=function(t){return void 0===t?this._cylinderHeight:(t=qo.fromAny(t),this._cylinderHeight.equals(t)||(this._cylinderHeight=t,this.dirty=!0),this)},t.prototype.cylinderColor=function(t){return void 0===t?this._cylinderColor:(t=Qo.fromAny(t),this._cylinderColor.equals(t)||(this._cylinderColor=t,this.dirty=!0),this)},t.prototype.pistonColor=function(t){return void 0===t?this._pistonColor:(t=Qo.fromAny(t),this._pistonColor.equals(t)||(this._pistonColor=t,this.dirty=!0),this)},t.prototype.update=function(){this.dirty&&(this.dirty=!1)},t.prototype.render=function(t){this.dirty&&(this.dirty=!1,this.renderMeter(t),this.renderStyle(t))},t.prototype.renderStyle=function(t){var e=this._width.pxValue(),i=this._height.pxValue();if(Math.min(e,i)){var r=this._cylinderHeight.pxValue(this._height.pxValue());r&&(this.footer.height(r,t),this.cylinder.backgroundColor(this._cylinderColor),this.piston.backgroundColor(this._pistonColor)),this._backgroundColor&&(this.header.padding(15),this.belt.paddingLeft(15),this.kpiBox.backgroundColor(this._backgroundColor)),this.led.backgroundColor(this._ledColor),this.ledBox.width(Math.ceil(this.ledBox.node.offsetHeight)).marginRight(5),this._title&&(this._title.style.color=this._titleColor?""+this._titleColor:"",this._title.style.fontSize=this._titleSize?""+this._titleSize:""),this._subtitle&&(this._subtitle.style.color=this._subtitleColor?""+this._subtitleColor:"",this._subtitle.style.fontSize=this._subtitleSize?""+this._subtitleSize:""),this._value&&(this._value.style.color=this._valueColor?""+this._valueColor:"",this._value.style.fontSize=this._valueSize?""+this._valueSize:""),this._label&&(this._label.style.color=this._labelColor?""+this._labelColor:"",this._label.style.fontSize=this._labelSize?""+this._labelSize:""),this._notice?(this._notice.style.color=this._noticeColor?""+this._noticeColor:"",this._notice.style.fontSize=this._noticeSize?""+this._noticeSize:""):this.belt.display("none");var o=0+(this._gauge?1:0)+(this._value&&this._label?1:0)+(this._chart?1:0);if(this._value||this._label?this.point.height(this.body.node.offsetHeight*(1===o?o:2===o?.66:.33)):this.point.display("none"),this._gauge){var n=this.body.node.offsetHeight*(1===o?o:.33);this.guageBox.height(n),this._gauge.node.setAttribute("height",""+n),this._gauge.height(n),this._gauge.renderLayout()}else this.guageBox.display("none");if(this._chart){var s=this.body.node.offsetHeight*(1===o?o:.33);this.chartBox.height(s),this._chart.node.setAttribute("height",""+s),this._chart.height(s),this._chart.update()}else this.chartBox.display("none")}},t.prototype.renderMeter=function(t){var e=this._width.pxValue(),i=this._height.pxValue(),r=Math.min(e,i);if(r){this.kpiBox.width(r).height(r).marginLeft("auto").marginRight("auto");var o=Math.min(Math.max(0,this._meter),1)||0;this.piston.width(100*o,t)}},t.prototype.gaugeDidSetMeter=function(t,e,i){for(var r=0;r<this.observers.length;r+=1){var o=this.observers[r];o.kpiGaugeDidSetMeter&&o.kpiGaugeDidSetMeter(t,e,i,this)}},t.prototype.addObserver=function(t){this.observers.indexOf(t)<0&&this.observers.push(t)},t.prototype.removeObserver=function(t){var e=this.observers.indexOf(t);e>=0&&this.observers.splice(e,1)},t.create=function(e){void 0===e&&(e="div");var i=tu.create(e);return i.className("kpi-card"),i.style("-webkit-user-select","none"),i.style("-moz-user-select","none"),i.style("-ms-user-select","none"),i.style("user-select","none"),i.style("cursor","default"),new t(i)},t}(),cp=function(t){function e(e,i){var r=t.call(this)||this;return r.kpi=e,r.childViews=i,r.value=void 0,r.width=void 0,r.height=void 0,r.backgroundColor=void 0,r.ledColor=void 0,r.titleSize=void 0,r.titleColor=void 0,r.subtitleSize=void 0,r.subtitleColor=void 0,r.valueSize=void 0,r.valueColor=void 0,r.labelSize=void 0,r.labelColor=void 0,r.noticeSize=void 0,r.noticeColor=void 0,r.meter=void 0,r.cylinderHeight=void 0,r.cylinderColor=void 0,r.pistonColor=void 0,r}return u(e,t),e.prototype.onFrame=function(t){this.value&&this.value.onFrame(t),this.width&&this.width.onFrame(t),this.height&&this.height.onFrame(t),this.backgroundColor&&this.backgroundColor.onFrame(t),this.ledColor&&this.ledColor.onFrame(t),this.titleSize&&this.titleSize.onFrame(t),this.titleColor&&this.titleColor.onFrame(t),this.subtitleSize&&this.subtitleSize.onFrame(t),this.subtitleColor&&this.subtitleColor.onFrame(t),this.valueSize&&this.valueSize.onFrame(t),this.valueColor&&this.valueColor.onFrame(t),this.labelSize&&this.labelSize.onFrame(t),this.labelColor&&this.labelColor.onFrame(t),this.noticeSize&&this.noticeSize.onFrame(t),this.noticeColor&&this.noticeColor.onFrame(t),this.meter&&this.meter.onFrame(t),this.cylinderHeight&&this.cylinderHeight.onFrame(t),this.cylinderColor&&this.cylinderColor.onFrame(t),this.pistonColor&&this.pistonColor.onFrame(t),this.update()},e.prototype.renderChildView=function(){for(var t=0;t<this.childViews.length;t+=1){var e=this.childViews[t];e instanceof up?e.render():e instanceof Yl&&e.render()}},e.prototype.update=function(){this.kpi.render(),this.renderChildView()},e}(ws),dp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.width(t)},e.get=function(t){return t.kpi.width()},e.set=function(t,e){if(null===e)t.kpiAnimator.width=void 0,t.kpi.node.removeAttribute("width");else{t.kpi.width(e);var i=t.kpi.node.getAttribute("width"),r=""+e.pxValue();i!==r&&(t.kpi.node.setAttribute("width",r),t.requireResize())}},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.width||(t.kpiAnimator.width=new e(t.kpiAnimator,i,r)),t.kpiAnimator.width},e}(xs),fp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.height(t)},e.get=function(t){return t.kpi.height()},e.set=function(t,e){if(null===e)t.kpiAnimator.height=void 0,t.kpi.node.removeAttribute("height");else{t.kpi.height(e);var i=t.kpi.node.getAttribute("height"),r=""+e.pxValue();i!==r&&(t.kpi.node.setAttribute("height",r),t.requireResize())}},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.height||(t.kpiAnimator.height=new e(t.kpiAnimator,i,r)),t.kpiAnimator.height},e}(xs),yp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.backgroundColor(t)},e.get=function(t){return t.kpi.backgroundColor()},e.set=function(t,e){null===e?t.kpiAnimator.backgroundColor=void 0:t.kpi.backgroundColor(e)},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.backgroundColor||(t.kpiAnimator.backgroundColor=new e(t.kpiAnimator,i,r)),t.kpiAnimator.backgroundColor},e}(xs),mp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.ledColor(t)},e.get=function(t){return t.kpi.ledColor()},e.set=function(t,e){null===e?t.kpiAnimator.ledColor=void 0:t.kpi.ledColor(e)},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.ledColor||(t.kpiAnimator.ledColor=new e(t.kpiAnimator,i,r)),t.kpiAnimator.ledColor},e}(xs),vp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.titleSize(t)},e.get=function(t){return t.kpi.titleSize()},e.set=function(t,e){null===e?t.kpiAnimator.titleSize=void 0:(t.kpi.titleSize(e),t.kpiAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.titleSize||(t.kpiAnimator.titleSize=new e(t.kpiAnimator,i,r)),t.kpiAnimator.titleSize},e}(xs),gp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.titleColor(t)},e.get=function(t){return t.kpi.titleColor()},e.set=function(t,e){null===e?t.kpiAnimator.titleColor=void 0:t.kpi.titleColor(e)},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.titleColor||(t.kpiAnimator.titleColor=new e(t.kpiAnimator,i,r)),t.kpiAnimator.titleColor},e}(xs),wp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.subtitleSize(t)},e.get=function(t){return t.kpi.subtitleSize()},e.set=function(t,e){null===e?t.kpiAnimator.subtitleSize=void 0:(t.kpi.subtitleSize(e),t.kpiAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.subtitleSize||(t.kpiAnimator.subtitleSize=new e(t.kpiAnimator,i,r)),t.kpiAnimator.subtitleSize},e}(xs),bp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.subtitleColor(t)},e.get=function(t){return t.kpi.subtitleColor()},e.set=function(t,e){null===e?t.kpiAnimator.subtitleColor=void 0:t.kpi.subtitleColor(e)},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.subtitleColor||(t.kpiAnimator.subtitleColor=new e(t.kpiAnimator,i,r)),t.kpiAnimator.subtitleColor},e}(xs),_p=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.valueSize(t)},e.get=function(t){return t.kpi.valueSize()},e.set=function(t,e){null===e?t.kpiAnimator.valueSize=void 0:(t.kpi.valueSize(e),t.kpiAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.valueSize||(t.kpiAnimator.valueSize=new e(t.kpiAnimator,i,r)),t.kpiAnimator.valueSize},e}(xs),xp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.valueColor(t)},e.get=function(t){return t.kpi.valueColor()},e.set=function(t,e){null===e?t.kpiAnimator.valueColor=void 0:t.kpi.valueColor(e)},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.valueColor||(t.kpiAnimator.valueColor=new e(t.kpiAnimator,i,r)),t.kpiAnimator.valueColor},e}(xs),Ap=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.labelSize(t)},e.get=function(t){return t.kpi.labelSize()},e.set=function(t,e){null===e?t.kpiAnimator.labelSize=void 0:(t.kpi.labelSize(e),t.kpiAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.labelSize||(t.kpiAnimator.labelSize=new e(t.kpiAnimator,i,r)),t.kpiAnimator.labelSize},e}(xs),kp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.labelColor(t)},e.get=function(t){return t.kpi.labelColor()},e.set=function(t,e){null===e?t.kpiAnimator.labelColor=void 0:t.kpi.labelColor(e)},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.labelColor||(t.kpiAnimator.labelColor=new e(t.kpiAnimator,i,r)),t.kpiAnimator.labelColor},e}(xs),Ep=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.noticeSize(t)},e.get=function(t){return t.kpi.noticeSize()},e.set=function(t,e){null===e?t.kpiAnimator.noticeSize=void 0:(t.kpi.noticeSize(e),t.kpiAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.noticeSize||(t.kpiAnimator.noticeSize=new e(t.kpiAnimator,i,r)),t.kpiAnimator.noticeSize},e}(xs),Cp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.noticeColor(t)},e.get=function(t){return t.kpi.noticeColor()},e.set=function(t,e){null===e?t.kpiAnimator.noticeColor=void 0:t.kpi.noticeColor(e)},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.noticeColor||(t.kpiAnimator.noticeColor=new e(t.kpiAnimator,i,r)),t.kpiAnimator.noticeColor},e}(xs),Sp=function(t){function e(e,i,r){var o=t.call(this,e,i,r)||this;return o.update(i),o}return u(e,t),e.prototype.update=function(t){this.parent.kpi.meter(t)},e.get=function(t){return t.kpi.meter()},e.set=function(t,e){null===e?t.kpiAnimator.meter=void 0:(t.kpi.meter(e),t.kpiAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.meter||(t.kpiAnimator.meter=new e(t.kpiAnimator,i,r)),t.kpiAnimator.meter},e}(xs),Vp=function(t){function e(e,i,r){var o=t.call(this,e,i,r)||this;return o.update(i),o}return u(e,t),e.prototype.update=function(t){this.parent.kpi.cylinderHeight(t)},e.get=function(t){return t.kpi.cylinderHeight()},e.set=function(t,e){null===e?t.kpiAnimator.cylinderHeight=void 0:(t.kpi.cylinderHeight(e),t.kpiAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.cylinderHeight||(t.kpiAnimator.cylinderHeight=new e(t.kpiAnimator,i,r)),t.kpiAnimator.cylinderHeight},e}(xs),Dp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.cylinderColor(t)},e.get=function(t){return t.kpi.cylinderColor()},e.set=function(t,e){null===e?t.kpiAnimator.cylinderColor=void 0:t.kpi.cylinderColor(e)},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.cylinderColor||(t.kpiAnimator.cylinderColor=new e(t.kpiAnimator,i,r)),t.kpiAnimator.cylinderColor},e}(xs),Mp=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.kpi.pistonColor(t)},e.get=function(t){return t.kpi.pistonColor()},e.set=function(t,e){null===e?t.kpiAnimator.pistonColor=void 0:t.kpi.pistonColor(e)},e.animator=function(t,i,r){return void 0===i||t.kpiAnimator.pistonColor||(t.kpiAnimator.pistonColor=new e(t.kpiAnimator,i,r)),t.kpiAnimator.pistonColor},e}(xs),Rp=function(t){function e(e){var i=t.call(this,e.node)||this;return i.kpi=e,i.kpiAnimator=new cp(i.kpi,i._childViews),i.kpi.addObserver(i),i}return u(e,t),e.prototype.gauge=function(){for(var t=null,e=0;e<this._childViews.length;e+=1){var i=this._childViews[e];i instanceof up&&(t=i)}return t},e.prototype.addGauge=function(t){this.appendChildView(t)},e.prototype.removeGauge=function(t){this.removeChildView(t)},e.prototype.chart=function(){for(var t=null,e=0;e<this._childViews.length;e+=1){var i=this._childViews[e];i instanceof Yl&&(t=i)}return t},e.prototype.addChart=function(t){this.appendChildView(t)},e.prototype.removeChart=function(t){this.removeChildView(t)},e.prototype.didInsertChildView=function(e){e instanceof up?this.kpi.addGauge(e.gauge):e instanceof Yl&&this.kpi.addChart(e.chart),t.prototype.didInsertChildView.call(this,e)},e.prototype.didRemoveChildView=function(e){e instanceof up?this.kpi.removeGauge(e.gauge):e instanceof Yl&&this.kpi.removeChart(e.chart),t.prototype.didRemoveChildView.call(this,e)},e.prototype.kpiWidth=function(t,e){return this.propertyLength(dp,t,e)},e.prototype.kpiHeight=function(t,e){return this.propertyLength(fp,t,e)},e.prototype.backgroundColor=function(t,e){return this.propertyColor(yp,t,e)},e.prototype.ledColor=function(t,e){return this.propertyColor(mp,t,e)},e.prototype.kpiTitle=function(t){var e=this.kpi.title();if(void 0===t)return e;if("string"==typeof t?t=document.createTextNode(t):(t instanceof tu||t instanceof Oa)&&(t=t.node),t instanceof Text)if(e){for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(t),t=e}else{var i=tu.create("span").className("title");i.append(t),t=i.node}if(e){var r=e.view;e!==t&&r&&this.removeChildView(r)}if(this.kpi.title(t),t){var o=t.view;e!==t&&o&&this.appendChildView(o)}return this.kpiAnimator.animate(),this},e.prototype.titleSize=function(t,e){return this.propertyLength(vp,t,e)},e.prototype.titleColor=function(t,e){return this.propertyColor(gp,t,e)},e.prototype.subtitle=function(t){var e=this.kpi.subtitle();if(void 0===t)return e;if("string"==typeof t?t=document.createTextNode(t):(t instanceof tu||t instanceof Oa)&&(t=t.node),t instanceof Text)if(e){for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(t),t=e}else{var i=tu.create("span").className("subtitle");i.append(t),t=i.node}if(e){var r=e.view;e!==t&&r&&this.removeChildView(r)}if(this.kpi.subtitle(t),t){var o=t.view;e!==t&&o&&this.appendChildView(o)}return this.kpiAnimator.animate(),this},e.prototype.subtitleSize=function(t,e){return this.propertyLength(wp,t,e)},e.prototype.subtitleColor=function(t,e){return this.propertyColor(bp,t,e)},e.prototype.kpiValue=function(t){var e=this.kpi.value();if(void 0===t)return e;if("string"==typeof t?t=document.createTextNode(t):(t instanceof tu||t instanceof Oa)&&(t=t.node),t instanceof Text)if(e){for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(t),t=e}else{var i=tu.create("span").className("value");i.append(t),t=i.node}if(e){var r=e.view;e!==t&&r&&this.removeChildView(r)}if(this.kpi.value(t),t){var o=t.view;e!==t&&o&&this.appendChildView(o)}return this.kpiAnimator.animate(),this},e.prototype.valueSize=function(t,e){return this.propertyLength(_p,t,e)},e.prototype.valueColor=function(t,e){return this.propertyColor(xp,t,e)},e.prototype.label=function(t){var e=this.kpi.label();if(void 0===t)return e;if("string"==typeof t?t=document.createTextNode(t):(t instanceof tu||t instanceof Oa)&&(t=t.node),t instanceof Text)if(e){for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(t),t=e}else{var i=tu.create("span").className("label");i.append(t),t=i.node}if(e){var r=e.view;e!==t&&r&&this.removeChildView(r)}if(this.kpi.label(t),t){var o=t.view;e!==t&&o&&this.appendChildView(o)}return this.kpiAnimator.animate(),this},e.prototype.labelSize=function(t,e){return this.propertyLength(Ap,t,e)},e.prototype.labelColor=function(t,e){return this.propertyColor(kp,t,e)},e.prototype.notice=function(t){var e=this.kpi.notice();if(void 0===t)return e;if("string"==typeof t?t=document.createTextNode(t):(t instanceof tu||t instanceof Oa)&&(t=t.node),t instanceof Text)if(e){for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(t),t=e}else{var i=tu.create("span").className("label");i.append(t),t=i.node}if(e){var r=e.view;e!==t&&r&&this.removeChildView(r)}if(this.kpi.notice(t),t){var o=t.view;e!==t&&o&&this.appendChildView(o)}return this.kpiAnimator.animate(),this},e.prototype.noticeSize=function(t,e){return this.propertyLength(Ep,t,e)},e.prototype.noticeColor=function(t,e){return this.propertyColor(Cp,t,e)},e.prototype.meter=function(t,e){return this.propertyNumber(Sp,t,e)},e.prototype.cylinderHeight=function(t,e){return this.propertyLength(Vp,t,e)},e.prototype.cylinderColor=function(t,e){return this.propertyColor(Dp,t,e)},e.prototype.pistonColor=function(t,e){return this.propertyColor(Mp,t,e)},e.prototype.render=function(){this.kpiAnimator.update()},e.prototype.didReview=function(e){t.prototype.didReview.call(this,e),this.kpiAnimator.enabled(e)},e.prototype.autosize=function(){for(var t=this.node;;){var e=t.parentNode;if(!e)return;if(e instanceof HTMLElement)return void this.kpiWidth(e.offsetWidth).kpiHeight(e.offsetHeight);t=e}},e.prototype.didResize=function(){t.prototype.didResize.call(this),this.autosize(),this.render()},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("transition").cast(fs.Form),o=e.get("kpiWidth").cast(qo.Form);o&&this.kpiWidth(o);var n=e.get("kpiHeight").cast(qo.Form);n&&this.kpiHeight(n);var s=e.get("backgroundColor").cast(Qo.Form);s&&this.backgroundColor(s,r);var a=e.get("ledColor").cast(Qo.Form);a&&this.ledColor(a,r);var u=e.get("titleSize").cast(qo.Form);u&&this.titleSize(u,r);var h=e.get("titleColor").cast(Qo.Form);h&&this.titleColor(h,r);var l=this.kpiTitle();if(l){var p=e.get("titleWeight").numberValue();p&&(l.style.fontWeight=""+p)}var c=e.get("subtitleSize").cast(qo.Form);c&&this.subtitleSize(c,r);var d=e.get("subtitleColor").cast(Qo.Form);d&&this.subtitleColor(d,r);var f=this.subtitle();if(f){var y=e.get("subtitleWeight").numberValue();y&&(f.style.fontWeight=""+y)}var m=e.get("valueSize").cast(qo.Form);m&&this.valueSize(m,r);var v=e.get("valueColor").cast(Qo.Form);v&&this.valueColor(v,r);var g=this.kpiValue();if(g){var w=e.get("valueWeight").numberValue();w&&(g.style.fontWeight=""+w)}var b=e.get("labelSize").cast(qo.Form);b&&this.labelSize(b,r);var _=e.get("labelColor").cast(Qo.Form);_&&this.labelColor(_,r);var x=this.label();if(x){var A=e.get("labelWeight").numberValue();A&&(x.style.fontWeight=""+A)}var k=e.get("noticeSize").cast(qo.Form);k&&this.noticeSize(k,r);var E=e.get("noticeColor").cast(Qo.Form);E&&this.noticeColor(E,r);var C=this.notice();if(C){var S=e.get("noticeWeight").numberValue();S&&(C.style.fontWeight=""+S)}var V=e.get("meter").numberValue();void 0!==V&&this.meter(V,r);var D=e.get("cylinderHeight").cast(qo.Form);D&&this.cylinderHeight(D,r);var M=e.get("cylinderColor").cast(Qo.Form);M&&this.cylinderColor(M,r);var R=e.get("pistonColor").cast(Qo.Form);R&&this.pistonColor(R,r)},e.prototype.kpiGaugeDidSetMeter=function(t,e,i,r){this.kpiAnimator.animate()},e.prototype.addObserver=function(t){this.kpi.addObserver(t)},e.prototype.removeObserver=function(t){this.kpi.removeObserver(t)},e.create=function(t){if(t instanceof e)return t;if(t instanceof ba)throw new TypeError(""+t);if(void 0===t||"string"==typeof t)return new e(pp.create(t));if(t.view instanceof e)return t.view;if(t.view)throw new TypeError(""+t.view);if(t instanceof tu)return new e(new pp(t));throw new TypeError(""+t)},e.applyTheme=function(t){var e=B.get("value").divide(B.get("total").or(U.One)),i=B.get("primaryHue").invoke(e).or(B.get("primaryColor")),r=B.get("contrast").invoke(L.of(i,U.valueOf(2))),o=L.empty().slot("ledColor",i).slot("titleSize","14px").slot("titleWeight","300").slot("subtitleSize","14px").slot("subtitleWeight","300").slot("labelSize","36px").slot("labelWeight","400").slot("labelSize","14px").slot("labelWeight","300").slot("noticeSize","14px").slot("noticeWeight","300").slot("meter","0").slot("cylinderHeight","5%").slot("cylinderColor",r).slot("pistonColor",i);t.set("kpi",o)},e}(tu);Rp.applyTheme(Rp.Theme);var Tp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=eu.Params.concat([new Ca("transition",B.get("transition").or(B.get("kpi").get("transition"))),new Ca("meter",B.get("meter").or(B.get("kpi").get("meter"))),new Ca("kpiWidth",B.get("kpiWidth").or(B.get("kpi").get("width"))),new Ca("kpiHeight",B.get("kpiHeight").or(B.get("kpi").get("height"))),new Ca("backgroundColor",B.get("backgroundColor").or(B.get("kpi").get("backgroundColor"))),new Ca("ledColor",B.get("ledColor").or(B.get("kpi").get("ledColor"))),new Ca("titleSize",B.get("titleSize").or(B.get("kpi").get("titleSize"))),new Ca("titleColor",B.get("titleColor").or(B.get("kpi").get("titleColor"))),new Ca("titleWeight",B.get("titleWeight").or(B.get("kpi").get("titleWeight"))),new Ca("subtitleSize",B.get("subtitleSize").or(B.get("kpi").get("subtitleSize"))),new Ca("subtitleColor",B.get("subtitleColor").or(B.get("kpi").get("subtitleColor"))),new Ca("subtitleWeight",B.get("subtitleWeight").or(B.get("kpi").get("subtitleWeight"))),new Ca("valueSize",B.get("valueSize").or(B.get("kpi").get("valueSize"))),new Ca("valueColor",B.get("valueColor").or(B.get("kpi").get("valueColor"))),new Ca("valueWeight",B.get("valueWeight").or(B.get("kpi").get("valueWeight"))),new Ca("labelSize",B.get("labelSize").or(B.get("kpi").get("labelSize"))),new Ca("labelColor",B.get("labelColor").or(B.get("kpi").get("labelColor"))),new Ca("labelWeight",B.get("labelWeight").or(B.get("kpi").get("labelWeight"))),new Ca("noticeSize",B.get("noticeSize").or(B.get("kpi").get("noticeSize"))),new Ca("noticeColor",B.get("noticeColor").or(B.get("kpi").get("noticeColor"))),new Ca("noticeWeight",B.get("noticeWeight").or(B.get("kpi").get("noticeWeight"))),new Ca("cylinderHeight",B.get("cylinderHeight").or(B.get("kpi").get("cylinderHeight"))),new Ca("cylinderColor",B.get("cylinderColor").or(B.get("kpi").get("cylinderColor"))),new Ca("pistonColor",B.get("pistonColor").or(B.get("kpi").get("pistonColor")))]),e}(eu),Pp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"kpi"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=Rp.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new Tp,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){if(i.key instanceof I){var n=i.key.value;if("title"===n){var s=o.castView(i.toValue(),r,o);if(void 0===s&&(s=i.toValue().stringValue()),void 0!==s)return e.kpiTitle(s),w.Absent}else if("subtitle"===n){var a=o.castView(i.toValue(),r,o);if(void 0===a&&(a=i.toValue().stringValue()),void 0!==a)return e.subtitle(a),w.Absent}else if("value"===n){var u=o.castView(i.toValue(),r,o);if(void 0===u&&(u=i.toValue().stringValue()),void 0!==u)return e.kpiValue(u),w.Absent}else if("label"===n){var h=o.castView(i.toValue(),r,o);if(void 0===h&&(h=i.toValue().stringValue()),void 0!==h)return e.label(h),w.Absent}else if("notice"===n){var l=o.castView(i.toValue(),r,o);if(void 0===l&&(l=i.toValue().stringValue()),void 0!==l)return e.notice(l),w.Absent}}var p=lp.Form.castView(i.toValue(),r,o);if(p)return e.addGauge(p),p;var c=Kl.Form.castView(i.toValue(),r,o);return c?(e.addChart(c),c):t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(iu);Aa.addGlobal(Pp.Form);var Lp=function(t){function e(e){return t.call(this,e)||this}return u(e,t),e}(tu),Fp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(eu),zp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(iu),Ip=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(wa),Up=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.addLayer=function(t){this.appendChildView(t)},e.prototype.removeLayer=function(t){this.appendChildView(t)},e.prototype.addGeometry=function(t){this.appendChildView(t)},e.prototype.removeGeometry=function(t){this.appendChildView(t)},e.prototype.collectFeatures=function(t){for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof e?r.collectFeatures(t):r instanceof Ip&&t.push(r.toGeoJson())}},e.prototype.toGeoJson=function(){var t=[];return this.collectFeatures(t),{type:"FeatureCollection",features:t}},e}(wa),Wp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(Sa),Op=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(Aa),Bp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(Sa),qp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(Aa),Gp={LngLatForm:new(function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return u(i,t),Object.defineProperty(i.prototype,"unit",{get:function(){},enumerable:!0,configurable:!0}),i.prototype.mold=function(t){return t?L.empty(2).slot("lng",t.lng).slot("lat",t.lat):b.Absent},i.prototype.cast=function(t){var i=t.get("lng").numberValue(),r=t.get("lat").numberValue();if(void 0!==i&&void 0!==r)return new e.LngLat(i,r)},i}(ye))},Hp=function(t){function e(e){var i=t.call(this,e)||this;return i.display("flex").visibility("hidden").position("absolute").placement(["top","bottom","right","left"]).borderRadius(3),i}return u(e,t),e.prototype.setMap=function(t,e){this._map&&this._map.off("render",this.replace),this._map=t,this._position=e,this._map.on("render",this.replace),this.replace()},e.prototype.replace=function(){if(this._map){var e=this._map.project(this._position),i=this._map.getContainer(),r=i.getBoundingClientRect(),o=r.left-i.offsetLeft,n=r.top-i.offsetTop,s=this.node.getBoundingClientRect(),a=s.left-this.node.offsetLeft,u=s.top-this.node.offsetTop,h=Math.round(e.x-5+o-a),l=Math.round(e.y-5+n-u);h===this.popover.sourceLeft().pxValue()&&l===this.popover.sourceTop().pxValue()||(this.popover.sourceLeft(h),this.popover.sourceTop(l),this.popover.sourceWidth(10),this.popover.sourceHeight(10),this.popoverAnimator.update())}else t.prototype.replace.call(this)},e.prototype.popoverDidHide=function(e){t.prototype.popoverDidHide.call(this,e),this._map&&this._map.off("render",this.replace)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("popoverWidth").cast(qo.Form);r&&(this.width(r),this.requireResize());var o=e.get("popoverHeight").cast(qo.Form);o&&(this.height(o),this.requireResize()),i.isDefined()||(this.visibility(null),this.render())},e.create=function(t){if(t instanceof e)return t;if(t instanceof ba)throw new TypeError(""+t);if(void 0===t||"string"==typeof t)return new e(Qs.create(t));if(t.view instanceof e)return t.view;if(t.view)throw new TypeError(""+t.view);if(t instanceof HTMLElement)return new e(new Qs(t));throw new TypeError(""+t)},e}(Uu),Np=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=Wu.Params.concat([new Ca("popoverWidth",B.get("popoverWidth").or(B.get("popover").get("width"))),new Ca("popoverHeight",B.get("popoverHeight").or(B.get("popover").get("height")))]),e}(Wu),jp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"mapboxPopover"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=Hp.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new Np,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){if(i.key instanceof I&&"body"===i.key.value){var n=o.castView(i.toValue(),r,o);if(n)return e.append(n),n}return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(iu);Aa.addGlobal(jp.Form);var Yp=function(t){function e(){var e=t.call(this)||this;return e._featureId=C.generateId(),e}return u(e,t),Object.defineProperty(e.prototype,"center",{get:function(){},enumerable:!0,configurable:!0}),e.prototype.setMap=function(t){this._map=t},e.prototype.requestRedraw=function(){0==(this._flags&wa.REQUEST_REDRAW)&&(this._flags|=wa.REQUEST_REDRAW,this._parentView&&this._parentView.requireRedraw())},e.prototype.onMapMouseEnter=function(t,e){if(this._hoverPopoverTemplate){var i=this.appView;if(i&&(this._hoverPopover=jp.Form.castView(this._hoverPopoverTemplate,this.stack(),Aa.Global),this._hoverPopover)){var r=this.center||t.lngLat;this._hoverPopover.setMap(e,r),this._hoverPopover.addObserver(this),this.appendChildView(this._hoverPopover),i.showPopover(this._hoverPopover,{exclusive:!1})}}},e.prototype.onMapMouseLeave=function(t,e){this._hoverPopover&&this._hoverPopover.hide()},e.prototype.onMapClick=function(t,e){var i=t.originalEvent;if(i.stopPropagation(),this._clickPopover)this._clickPopover.hide();else if(this._clickPopoverTemplate){var r=this.appView,o=this.center||t.lngLat;r&&(this._clickPopover=jp.Form.castView(this._clickPopoverTemplate,this.stack(),Aa.Global),this._clickPopover?(this._hoverPopover&&this._hoverPopover.hide(),this._clickPopover.setMap(e,o),this._clickPopover.addObserver(this),this.appendChildView(this._clickPopover),r.showPopover(this._clickPopover,{exclusive:!i.shiftKey})):this._hoverPopover&&(this._clickPopover=this._hoverPopover,this._hoverPopover=void 0)),void 0!==this._clickFlyToZoom&&e.flyTo({center:[o.lng,o.lat],zoom:this._clickFlyToZoom})}},e.prototype.popoverDidHide=function(t){this._hoverPopover&&this._hoverPopover.popover===t&&(this._hoverPopover=void 0),this._clickPopover&&this._clickPopover.popover===t&&(this._clickPopover=void 0)},e}(Ip),Xp=function(t){function e(){var e=t.call(this)||this;return e.onMapSourceData=e.onMapSourceData.bind(e),e}return u(e,t),e.prototype.getGeometry=function(t){for(var i,r=0;void 0===i&&r<this._childViews.length;r+=1){var o=this._childViews[r];if(o instanceof e)i=o.getGeometry(t);else if(o instanceof Yp&&o._featureId===t){i=o;break}}return i},e.prototype.setMap=function(t){this._map=t,void 0!==this._layerType&&(this._sourceId=C.generateId(),this._layerId=C.generateId(),t.addSource(this._sourceId,{type:"geojson",data:{type:"FeatureCollection",features:[]}}),t.addLayer({id:this._layerId,type:this._layerType,source:this._sourceId}),this.updateLayerStyle(this._state,t),t.on("sourcedata",this.onMapSourceData));for(var e=0;e<this._childViews.length;e+=1)this.initChildView(this._childViews[e],t)},e.prototype.initChildView=function(t,i){t instanceof e?t.setMap(i):t instanceof Yp&&t.setMap(i)},e.prototype.didInsertChildView=function(e){var i=this._map;i&&this.initChildView(e,i),t.prototype.didInsertChildView.call(this,e)},e.prototype.setZoomRange=function(t,e){this._map.setLayerZoomRange(this._layerId,t,e)},e.prototype.setPaintProperty=function(t,e){this._map.setPaintProperty(this._layerId,t,e)},e.prototype.updatePaintProperty=function(t,e){var i;if(e instanceof U)i=e.numberValue();else{var r=Zs.Form.cast(e);i=void 0!==r?r.toString():{type:"identity",property:e.stringValue()}}void 0!==i&&this.setPaintProperty(t,i)},e.prototype.updateLayerStyle=function(t,e){var i=t.get("zoomRange").toValue();if(i.isDefined()){var r=i.getItem(0).numberValue(),o=i.getItem(1).numberValue();void 0!==r&&void 0!==o&&this.setZoomRange(r,o)}var n=t.get("fillColor");n.isDefined()&&this.updatePaintProperty("fill-color",n);var s=t.get("fillOpacity");s.isDefined()&&this.updatePaintProperty("fill-opacity",s);var a=t.get("circleColor");a.isDefined()&&this.updatePaintProperty("circle-color",a);var u=t.get("circleOpacity");u.isDefined()&&this.updatePaintProperty("circle-opacity",u);var h=t.get("circleRadius");h.isDefined()&&this.updatePaintProperty("circle-radius",h)},e.prototype.requestRedraw=function(){0==(this._flags&wa.REQUEST_REDRAW)&&(this._flags|=wa.REQUEST_REDRAW,this._parentView&&this._parentView.requireRedraw())},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=this._map;r&&void 0!==this._layerId&&this.updateLayerStyle(e,r),this.requireRedraw()},e.prototype.didRedraw=function(){if(t.prototype.didRedraw.call(this),0!=(this._flags&e.SourceLoaded)){var i=this._map.getSource(this._sourceId),r=this.toGeoJson();i.setData(r)}},e.prototype.onMapSourceData=function(){var t=this._map;t.isSourceLoaded(this._sourceId)&&(t.off("sourcedata",this.onMapSourceData),this._flags|=e.SourceLoaded,this.requireRedraw())},e.prototype.onFeatureClick=function(t,e){if(t.properties&&void 0!==t.properties.id){var i=this.getGeometry(t.properties.id);i&&i.onMapClick(e,this._map)}},e.SourceLoaded=65536,e}(Up),Kp=function(t){function i(e){var i=t.call(this,e)||this;return i._hoverGeometry={},i.position("relative").visibility("hidden").flexGrow(1),i.onClick=i.onClick.bind(i),i.onMapLoad=i.onMapLoad.bind(i),i.onMapZoom=i.onMapZoom.bind(i),i.onMapClick=i.onMapClick.bind(i),i.onMapMouseMove=i.onMapMouseMove.bind(i),i.node.addEventListener("click",i.onClick),i}return u(i,t),Object.defineProperty(i.prototype,"layerIds",{get:function(){for(var t=[],e=0;e<this._childViews.length;e+=1){var i=this._childViews[e];i instanceof Xp&&void 0!==i._layerId&&t.push(i._layerId)}return t},enumerable:!0,configurable:!0}),i.prototype.getLayer=function(t){for(var e=0;e<this._childViews.length;e+=1){var i=this._childViews[e];if(i instanceof Xp&&i._layerId===t)return i}},i.prototype.addLayer=function(t){this.appendChildView(t)},i.prototype.removeLayer=function(t){this.removeChildView(t)},i.prototype.getGeometry=function(t,e){var i=this.getLayer(e);if(i)return i.getGeometry(t)},i.prototype.initMap=function(t){var i=this._map;return i||(t.container=this.node,this._map=i=new e.Map(t),i.on("load",this.onMapLoad),i.on("zoom",this.onMapZoom),i.on("click",this.onMapClick),i.on("mousemove",this.onMapMouseMove)),i},i.prototype.initChildView=function(t,e){t instanceof Xp&&t.setMap(e)},i.prototype.didInsertChildView=function(e){0!=(this._flags&i.MapLoaded)&&this.initChildView(e,this._map),t.prototype.didInsertChildView.call(this,e)},i.prototype.didResize=function(){t.prototype.didResize.call(this),0!=(this._flags&i.MapLoaded)&&this._map.resize()},i.prototype.didSetState=function(i,r){t.prototype.didSetState.call(this,i,r);var o=i.get("accessToken").stringValue();if(void 0!==o&&o!==e.accessToken){Object.getOwnPropertyDescriptor(e,"accessToken").set(o);var n={};n.style=i.get("style").stringValue(),n.center=i.get("center").cast(Gp.LngLatForm),n.pitch=i.get("pitch").numberValue(),n.zoom=i.get("zoom").numberValue(),void 0!==n.style&&this.initMap(n)}},i.prototype.onMapLoad=function(){var t=this._map;t.off("load",this.onMapLoad),t.resize(),this._flags&=~i.MapLoaded,this.visibility(null);for(var e=0;e<this._childViews.length;e+=1)this.initChildView(this._childViews[e],t)},i.prototype.onMapZoom=function(){var t=this._map,e=this._model,i=e.get("zoom").numberValue(),r=Math.round(t.getZoom());if(i!==r){var o=e.withSlot("zoom",r);this.setModel(o)}},i.prototype.onClick=function(t){t.stopPropagation()},i.prototype.onMapClick=function(t){var e=this._map.queryRenderedFeatures(t.point,{layers:this.layerIds});if(e.length)for(var i=0;i<e.length;i+=1){var r=e[i],o=this.getLayer(r.layer.id);o&&o.onFeatureClick(r,t)}else{var n=this.appView;n&&n.onPassthroughClick(t.originalEvent)}},i.prototype.onMapMouseMove=function(t){for(var e={},i=this._map.queryRenderedFeatures(t.point,{layers:this.layerIds}),r=0;r<i.length;r+=1){var o=i[r];if(o.properties&&void 0!==o.properties.id){var n=o.properties.id,s=o.layer.id;(a=this.getGeometry(n,s))&&(this._hoverGeometry[n]||a.onMapMouseEnter(t,this._map),e[n]=a)}}for(var n in this._hoverGeometry){var a;(a=this._hoverGeometry[n])&&!e[n]&&a.onMapMouseLeave(t,this._map)}this._hoverGeometry=e,this._map.getCanvas().style.cursor=e.length?"pointer":""},i.create=function(){return new i(document.createElement("div")).className("map mapbox")},i.applyTheme=function(t){var e=L.empty();t.set("mapbox",e)},i.MapLoaded=65536,i}(Lp);Kp.applyTheme(Kp.Theme);var Qp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.willRemodel=function(t,e){if(this._state.get("zoom").numberValue()!==t.get("zoom").numberValue())for(var i=0;i<this._childModels.length;i+=1)this._childModels[i].requireRestate()},e.Params=Fp.Params.concat([new Ca("accessToken",B.get("accessToken")),new Ca("style",B.get("style")),new Ca("center",B.get("center")),new Ca("pitch",B.get("pitch")),new Ca("zoom",B.get("zoom"))]),e}(Fp),Zp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=Wp.Params.concat([new Ca("zoomRange",B.get("zoomRange")),new Ca("fillColor",B.get("fillColor")),new Ca("fillOpacity",B.get("fillOpacity")),new Ca("circleColor",B.get("circleColor")),new Ca("circleOpacity",B.get("circleOpacity")),new Ca("circleRadius",B.get("circleRadius"))]),e}(Wp),Jp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.addGlobal=function(t){e.Global=e.Global.withUiForm(t)},e.removeGlobal=function(t){e.Global=e.Global.withoutUiForm(t)},e.prototype.materializeViewParam=function(e,i,r,o){if(i.key instanceof I){var n=i.key.value;if("hover"===n){var s=i.toValue();e._hoverPopoverTemplate=s.get("popover")}else if("click"===n){var a=i.toValue();e._clickPopoverTemplate=a.get("popover");var u=a.get("flyTo");u.isDefined()&&(e._clickFlyToZoom=u.get("zoom").numberValue())}}return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.Global=new ka([]),e}(qp),$p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"mapboxLayer"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=new Xp,o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new Zp,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(i,r,o,n){if(r.key instanceof I){"type"===r.key.value&&(i._layerType=r.toValue().evaluate(o).toValue().stringValue(i._layerType))}else{var s=e.Form.castView(r.toValue(),o,n);if(s)return i.addLayer(s),s;var a=Jp.Global.castView(r.toValue(),o,n);if(void 0!==a)return i.addGeometry(a),a}return t.prototype.materializeViewParam.call(this,i,r,o,n)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(Op);Aa.addGlobal($p.Form);var tc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"mapboxMap"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=Kp.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new Qp,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){var n=$p.Form.castView(i.toValue(),r,o);return n?(e.addLayer(n),n):t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(zp);Aa.addGlobal(tc.Form);var ec=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(Bp),ic=function(t){function i(){var e=t.call(this)||this;return e._feature={type:"Feature",geometry:{type:"Point",coordinates:[]},properties:{id:e._featureId}},e}return u(i,t),Object.defineProperty(i.prototype,"center",{get:function(){var t=this._feature.geometry.coordinates;if(2===t.length)return new e.LngLat(t[0],t[1])},enumerable:!0,configurable:!0}),i.prototype.coordinates=function(t){return void 0===t?this._feature.geometry.coordinates:(this._feature.geometry.coordinates=t,this)},i.prototype.properties=function(t){if(void 0===t)return this._feature.properties;if(this._feature.properties&&t)for(var e in t){var i=t[e];i&&(this._feature.properties[e]=i)}else this._feature.properties=t;return this},i.prototype.toGeoJson=function(){return this._feature},i.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r,o,n=e.get("coordinates");n.isDefined()&&(n.forEach(function(t,e){var i=t.key.stringValue();void 0!==i?"lng"===i?r=t.toValue().numberValue(r):"lat"===i&&(o=t.toValue().numberValue(o)):t instanceof b&&(0===e?r=t.numberValue(r):1===e&&(o=t.numberValue(o)))}),void 0!==r&&void 0!==o&&this.coordinates([r,o]));var s=e.get("properties");s.isDefined()&&this.properties(s.toAny()),this.requireRedraw()},i}(Yp),rc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=ec.Params.concat([new Ca("coordinates",B.get("coordinates")),new Ca("properties",B.get("properties"))]),e}(ec),oc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"mapboxPoint"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=new ic,o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new rc,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(Jp);Aa.addGlobal(oc.Form),Jp.addGlobal(oc.Form);var nc=function(t){function i(){var e=t.call(this)||this;return e._feature={type:"Feature",geometry:{type:"Polygon",coordinates:[[]]},properties:{id:e._featureId}},e}return u(i,t),Object.defineProperty(i.prototype,"center",{get:function(){for(var t=this._feature.geometry.coordinates,i=0,r=0,o=0,n=0,s=t.length;n<s;n+=1)for(var a=t[n],u=0,h=a.length;u<h;u+=1){var l=a[u];2===l.length&&(i+=l[0],r+=l[1],o+=1)}if(o>0)return new e.LngLat(i/o,r/o)},enumerable:!0,configurable:!0}),i.prototype.coordinates=function(t){return void 0===t?this._feature.geometry.coordinates:(this._feature.geometry.coordinates=t,this)},i.prototype.properties=function(t){if(void 0===t)return this._feature.properties;if(this._feature.properties&&t)for(var e in t){var i=t[e];i&&(this._feature.properties[e]=i)}else this._feature.properties=t;return this._feature.properties=this._feature.properties,this},i.prototype.toGeoJson=function(){return this._feature},i.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("coordinates");if(r.isDefined()){var o=[];r.forEach(function(t){var e,i;t.forEach(function(t,r){var o=t.key.stringValue();void 0!==o?"lng"===o?e=t.toValue().numberValue(e):"lat"===o&&(i=t.toValue().numberValue(i)):t instanceof b&&(0===r?e=t.numberValue(e):1===r&&(i=t.numberValue(i)))}),void 0!==e&&void 0!==i&&o.push([e,i])}),this.coordinates([o])}var n=e.get("properties");n.isDefined()&&this.properties(n.toAny()),this.requireRedraw()},i}(Yp),sc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=ec.Params.concat([new Ca("coordinates",B.get("coordinates")),new Ca("properties",B.get("properties"))]),e}(ec),ac=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"mapboxPolygon"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=new nc,o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new sc,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(Jp);Aa.addGlobal(ac.Form),Jp.addGlobal(ac.Form);var uc=Math.PI,hc=2*uc,lc=uc/2,pc=1e-12,cc=function(){function t(t){this.node=t,this._value=NaN,this._total=NaN,this._width=qo.zero(),this._height=qo.zero(),this._arc=new Xs,this._minAngle=To.zero(),this._innerRadius=qo.zero(),this._outerRadius=qo.zero(),this._arcColor=Qo.black(),this._tickAlign=.5,this._tickRadius=qo.zero(),this._tickLength=qo.zero(),this._tickWidth=qo.px(1),this._tickPadding=qo.px(3),this._tickColor=Qo.black(),this._label=null,this._labelRadius=qo.zero(),this._labelSize=null,this._labelColor=null,this._legend=null,this._legendSize=null,this._legendColor=null,this.dirty=!0,this.observers=[],this.arcPath=document.createElementNS("http://www.w3.org/2000/svg","path"),this.arcPath.setAttribute("class","arc"),this.node.appendChild(this.arcPath),this.tickPath=document.createElementNS("http://www.w3.org/2000/svg","path"),this.tickPath.setAttribute("class","tick"),this.tickPath.setAttribute("fill","none"),this.node.appendChild(this.tickPath)}return t.prototype.value=function(t){if(void 0===t)return this._value;var e=this._value;if(e!==t){this._value=t,this.dirty=!0;for(var i=0;i<this.observers.length;i+=1){var r=this.observers[i];r.wedgeDidSetValue&&r.wedgeDidSetValue(t,e,this)}}return this},t.prototype.total=function(t){return void 0===t?this._total:(this._total!==t&&(this._total=t,this.dirty=!0),this)},t.prototype.width=function(t){return void 0===t?this._width:(t=qo.fromAny(t,this.node),this._width.equals(t)||(this._width=t,this.dirty=!0),this)},t.prototype.height=function(t){return void 0===t?this._height:(t=qo.fromAny(t,this.node),this._height.equals(t)||(this._height=t,this.dirty=!0),this)},t.prototype.arc=function(t){return void 0===t?this._arc:(this._arc!==t&&(this._arc=t,this.dirty=!0),this)},t.prototype.arcColor=function(t){return void 0===t?this._arcColor:(t=Qo.fromAny(t),this._arcColor.equals(t)||(this._arcColor=t,this.dirty=!0),this)},t.prototype.innerRadius=function(t){return void 0===t?this._innerRadius:(t=qo.fromAny(t),this._innerRadius.equals(t)||(this._innerRadius=t,this.dirty=!0),this)},t.prototype.outerRadius=function(t){return void 0===t?this._outerRadius:(t=qo.fromAny(t),this._outerRadius.equals(t)||(this._outerRadius=t,this.dirty=!0),this)},t.prototype.startAngle=function(t){return void 0===t?this._arc.startAngle():(t=To.fromAny(t),this._arc.startAngle().equals(t)||(this._arc.startAngle(t),this.dirty=!0),this)},t.prototype.deltaAngle=function(t){return void 0===t?this._arc.deltaAngle():(t=To.fromAny(t),this._arc.deltaAngle().equals(t)||(this._arc.deltaAngle(t),this.dirty=!0),this)},t.prototype.minAngle=function(t){return void 0===t?this._minAngle:(t=To.fromAny(t),this._minAngle.equals(t)||(this._minAngle=t,this.dirty=!0),this)},t.prototype.padAngle=function(t){return void 0===t?this._arc.padAngle():(t=To.fromAny(t),this._arc.padAngle().equals(t)||(this._arc.padAngle(t),this.dirty=!0),this)},t.prototype.padRadius=function(t){return void 0===t?this._arc.padRadius():(this._arc.padRadius()!==t&&(this._arc.padRadius(t),this.dirty=!0),this)},t.prototype.cornerRadius=function(t){return void 0===t?this._arc.cornerRadius():(this._arc.cornerRadius()!==t&&(this._arc.cornerRadius(t),this.dirty=!0),this)},t.prototype.tickAlign=function(t){return void 0===t?this._tickAlign:(this._tickAlign!==t&&(this._tickAlign=t,this.dirty=!0),this)},t.prototype.tickRadius=function(t){return void 0===t?this._tickRadius:(t=qo.fromAny(t),this._tickRadius.equals(t)||(this._tickRadius=t,this.dirty=!0),this)},t.prototype.tickLength=function(t){return void 0===t?this._tickLength:(t=qo.fromAny(t),this._tickLength.equals(t)||(this._tickLength=t,this.dirty=!0),this)},t.prototype.tickWidth=function(t){return void 0===t?this._tickWidth:(t=qo.fromAny(t),this._tickWidth!==t&&(this._tickWidth=t,this.dirty=!0),this)},t.prototype.tickPadding=function(t){return void 0===t?this._tickPadding:(t=qo.fromAny(t),this._tickPadding!==t&&(this._tickPadding=t,this.dirty=!0),this)},t.prototype.tickColor=function(t){return void 0===t?this._tickColor:(t=Qo.fromAny(t),this._tickColor.equals(t)||(this._tickColor=t,this.dirty=!0),this)},t.prototype.label=function(t){return void 0===t?this._label:(this._label!==t?(this._label&&this.node.removeChild(this._label),this._label=t,this._label&&this.node.appendChild(this._label),this.dirty=!0,this.render()):this.dirty=!0,this)},t.prototype.labelRadius=function(t){return void 0===t?this._labelRadius:(t=qo.fromAny(t),this._labelRadius.equals(t)||(this._labelRadius=t,this.dirty=!0),this)},t.prototype.labelSize=function(t){return void 0===t?this._labelSize:(null!==t&&(t=qo.fromAny(t)),(this._labelSize?this._labelSize.equals(t):this._labelSize===t)||(this._labelSize=t,this.dirty=!0),this)},t.prototype.labelColor=function(t){return void 0===t?this._labelColor:(null!==t&&(t=Qo.fromAny(t)),(this._labelColor?this._labelColor.equals(t):this._labelColor===t)||(this._labelColor=t,this.dirty=!0),this)},t.prototype.legend=function(t){return void 0===t?this._legend:(this._legend!==t?(this._legend&&this.node.removeChild(this._legend),this._legend=t,this._legend&&this.node.appendChild(this._legend),this.dirty=!0,this.render()):this.dirty=!0,this)},t.prototype.legendSize=function(t){return void 0===t?this._legendSize:(null!==t&&(t=qo.fromAny(t)),(this._legendSize?this._legendSize.equals(t):this._legendSize===t)||(this._legendSize=t,this.dirty=!0),this)},t.prototype.legendColor=function(t){return void 0===t?this._legendColor:(null!==t&&(t=Qo.fromAny(t)),(this._legendColor?this._legendColor.equals(t):this._legendColor===t)||(this._legendColor=t,this.dirty=!0),this)},t.prototype.render=function(){this.dirty&&(this.dirty=!1,this.renderArc(),this.renderTick())},t.prototype.renderArc=function(){var t=this._arc.deltaAngle().radValue(),e=Math.max(pc,this._minAngle.radValue()),i=this._label;if(t>e){var r=this._width.pxValue(),o=this._height.pxValue(),n=Math.min(r,o),s=this._innerRadius.pxValue(n),a=this._outerRadius.pxValue(n);if(this._arc.innerRadius(s).outerRadius(a),this.arcPath.setAttribute("d",this._arc.draw()),this.arcPath.setAttribute("fill",this._arcColor.toString()),i){var u=this._arc.startAngle().radValue()-lc+t/2,h=s+this._labelRadius.pxValue(a-s),l=h*Math.cos(u),p=h*Math.sin(u);if(i.removeAttribute("visibility"),i instanceof SVGGElement){var c=dn.translate(l,p);i.setAttribute("transform",c.toAttributeString())}else i instanceof SVGTextElement&&(i.setAttribute("x",""+l),i.setAttribute("y",""+p),i.setAttribute("text-anchor","middle"),i.setAttribute("dominant-baseline","central"),this._labelSize&&i.setAttribute("font-size",""+Math.ceil(this._labelSize.pxValue(n))));this._labelColor&&i.setAttribute("fill",this._labelColor.toString())}}else this.arcPath.removeAttribute("d"),this.arcPath.removeAttribute("fill"),i&&i.setAttribute("visibility","hidden")},t.prototype.renderTick=function(){var t=Math.min(this._arc.deltaAngle().radValue(),hc),e=Math.max(pc,this._minAngle.radValue()),i=this._legend;if(t>e&&i){var r=this._width.pxValue(),o=this._height.pxValue(),n=Math.min(r,o),s=this._arc.startAngle().radValue()-lc+t*this._tickAlign,a=this._arc.outerRadius(),u=this._tickRadius.pxValue(n),h=this._tickLength.pxValue(r),l=new Gs,p=a*Math.cos(s+pc),c=a*Math.sin(s+pc),d=u*Math.cos(s+pc),f=u*Math.sin(s+pc),y=0;if(l.moveTo(p,c),l.lineTo(d,f),h&&(d>=0?(l.lineTo(h,f),y=h-d):d<0&&(l.lineTo(-h,f),y=h+d)),this.tickPath.setAttribute("d",l.toString()),this.tickPath.setAttribute("stroke",this._tickColor.toString()),this.tickPath.setAttribute("stroke-width",""+this._tickWidth.pxValue(n)),i instanceof SVGGElement){var m=dn.translate(d,f);i.setAttribute("transform",m.toAttributeString()),i.setAttribute("width",""+y)}else if(i instanceof SVGTextElement){var v=void 0,g=void 0;d>=0?(v=y,g="end"):(v=-y,g="start"),i.removeAttribute("visibility"),i.setAttribute("x",""+d),i.setAttribute("y",""+f),i.setAttribute("dx",""+v),i.setAttribute("dy",""+-this._tickPadding.pxValue(n)),i.setAttribute("text-anchor",g),this._legendSize&&i.setAttribute("font-size",""+Math.ceil(this._legendSize.pxValue(n)))}this._legendColor&&i.setAttribute("fill",this._legendColor.toString())}else this.tickPath.removeAttribute("d"),this.tickPath.removeAttribute("stroke"),this.tickPath.removeAttribute("stroke-width"),i&&i.setAttribute("visibility","hidden")},t.prototype.addObserver=function(t){this.observers.indexOf(t)<0&&this.observers.push(t)},t.prototype.removeObserver=function(t){var e=this.observers.indexOf(t);e>=0&&this.observers.splice(e,1)},t.create=function(){return new t(document.createElementNS("http://www.w3.org/2000/svg","g"))},t}(),dc=function(t){function e(e){var i=t.call(this)||this;return i.wedge=e,i.value=void 0,i.innerRadius=void 0,i.outerRadius=void 0,i.startAngle=void 0,i.deltaAngle=void 0,i.minAngle=void 0,i.padAngle=void 0,i.padRadius=void 0,i.cornerRadius=void 0,i.arcColor=void 0,i.tickAlign=void 0,i.tickRadius=void 0,i.tickLength=void 0,i.tickWidth=void 0,i.tickPadding=void 0,i.tickColor=void 0,i.labelRadius=void 0,i.labelSize=void 0,i.labelColor=void 0,i.legendSize=void 0,i.legendColor=void 0,i}return u(e,t),e.prototype.onFrame=function(t){this.value&&this.value.onFrame(t),this.innerRadius&&this.innerRadius.onFrame(t),this.outerRadius&&this.outerRadius.onFrame(t),this.startAngle&&this.startAngle.onFrame(t),this.deltaAngle&&this.deltaAngle.onFrame(t),this.minAngle&&this.minAngle.onFrame(t),this.padAngle&&this.padAngle.onFrame(t),this.padRadius&&this.padRadius.onFrame(t),this.cornerRadius&&this.cornerRadius.onFrame(t),this.arcColor&&this.arcColor.onFrame(t),this.tickAlign&&this.tickAlign.onFrame(t),this.tickRadius&&this.tickRadius.onFrame(t),this.tickLength&&this.tickLength.onFrame(t),this.tickWidth&&this.tickWidth.onFrame(t),this.tickPadding&&this.tickPadding.onFrame(t),this.tickColor&&this.tickColor.onFrame(t),this.labelRadius&&this.labelRadius.onFrame(t),this.labelSize&&this.labelSize.onFrame(t),this.labelColor&&this.labelColor.onFrame(t),this.legendSize&&this.legendSize.onFrame(t),this.legendColor&&this.legendColor.onFrame(t),this.update()},e.prototype.update=function(){this.wedge.render()},e}(ws),fc=function(t){function e(e,i,r){var o=t.call(this,e,i,r)||this;return o.update(i),o}return u(e,t),e.prototype.update=function(t){this.parent.wedge.value(t)},e.get=function(t){return t.wedge.value()},e.set=function(t,e){null===e?t.wedgeAnimator.value=void 0:(t.wedge.value(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.value||(t.wedgeAnimator.value=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.value},e}(xs),yc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.innerRadius(t)},e.get=function(t){return t.wedge.innerRadius()},e.set=function(t,e){null===e?t.wedgeAnimator.innerRadius=void 0:(t.wedge.innerRadius(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.innerRadius||(t.wedgeAnimator.innerRadius=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.innerRadius},e}(xs),mc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.outerRadius(t)},e.get=function(t){return t.wedge.outerRadius()},e.set=function(t,e){null===e?t.wedgeAnimator.outerRadius=void 0:(t.wedge.outerRadius(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.outerRadius||(t.wedgeAnimator.outerRadius=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.outerRadius},e}(xs),vc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.startAngle(t)},e.get=function(t){return t.wedge.startAngle()},e.set=function(t,e){null===e?t.wedgeAnimator.startAngle=void 0:(t.wedge.startAngle(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.startAngle||(t.wedgeAnimator.startAngle=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.startAngle},e}(xs),gc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.deltaAngle(t)},e.get=function(t){return t.wedge.deltaAngle()},e.set=function(t,e){null===e?t.wedgeAnimator.deltaAngle=void 0:(t.wedge.deltaAngle(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.deltaAngle||(t.wedgeAnimator.deltaAngle=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.deltaAngle},e}(xs),wc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.minAngle(t)},e.get=function(t){return t.wedge.minAngle()},e.set=function(t,e){null===e?t.wedgeAnimator.minAngle=void 0:(t.wedge.minAngle(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.minAngle||(t.wedgeAnimator.minAngle=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.minAngle},e}(xs),bc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.padAngle(t)},e.get=function(t){return t.wedge.padAngle()},e.set=function(t,e){null===e?t.wedgeAnimator.padAngle=void 0:(t.wedge.padAngle(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.padAngle||(t.wedgeAnimator.padAngle=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.padAngle},e}(xs),_c=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.padRadius(t)},e.get=function(t){return t.wedge.padRadius()},e.set=function(t,e){null===e&&(t.wedgeAnimator.padRadius=void 0),t.wedge.padRadius(e),t.wedgeAnimator.animate()},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.padRadius||(t.wedgeAnimator.padRadius=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.padRadius},e}(xs),xc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.cornerRadius(t)},e.get=function(t){return t.wedge.cornerRadius()},e.set=function(t,e){null===e?t.wedgeAnimator.cornerRadius=void 0:(t.wedge.cornerRadius(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.cornerRadius||(t.wedgeAnimator.cornerRadius=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.cornerRadius},e}(xs),Ac=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.arcColor(t)},e.get=function(t){return t.wedge.arcColor()},e.set=function(t,e){null===e?t.wedgeAnimator.arcColor=void 0:t.wedge.arcColor(e)},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.arcColor||(t.wedgeAnimator.arcColor=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.arcColor},e}(xs),kc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.tickAlign(t)},e.get=function(t){return t.wedge.tickAlign()},e.set=function(t,e){null===e?t.wedgeAnimator.tickAlign=void 0:(t.wedge.tickAlign(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.tickAlign||(t.wedgeAnimator.tickAlign=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.tickAlign},e}(xs),Ec=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.tickRadius(t)},e.get=function(t){return t.wedge.tickRadius()},e.set=function(t,e){null===e?t.wedgeAnimator.tickRadius=void 0:(t.wedge.tickRadius(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.tickRadius||(t.wedgeAnimator.tickRadius=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.tickRadius},e}(xs),Cc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.tickLength(t)},e.get=function(t){return t.wedge.tickLength()},e.set=function(t,e){null===e?t.wedgeAnimator.tickLength=void 0:(t.wedge.tickLength(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.tickLength||(t.wedgeAnimator.tickLength=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.tickLength},e}(xs),Sc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.tickWidth(t)},e.get=function(t){return t.wedge.tickWidth()},e.set=function(t,e){null===e?t.wedgeAnimator.tickWidth=void 0:(t.wedge.tickWidth(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.tickWidth||(t.wedgeAnimator.tickWidth=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.tickWidth},e}(xs),Vc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.tickPadding(t)},e.get=function(t){return t.wedge.tickPadding()},e.set=function(t,e){null===e?t.wedgeAnimator.tickPadding=void 0:(t.wedge.tickPadding(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.tickPadding||(t.wedgeAnimator.tickPadding=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.tickPadding},e}(xs),Dc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.tickColor(t)},e.get=function(t){return t.wedge.tickColor()},e.set=function(t,e){null===e?t.wedgeAnimator.tickColor=void 0:t.wedge.tickColor(e)},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.tickColor||(t.wedgeAnimator.tickColor=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.tickColor},e}(xs),Mc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.labelRadius(t)},e.get=function(t){return t.wedge.labelRadius()},e.set=function(t,e){null===e?t.wedgeAnimator.labelRadius=void 0:(t.wedge.labelRadius(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.labelRadius||(t.wedgeAnimator.labelRadius=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.labelRadius},e}(xs),Rc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.labelSize(t)},e.get=function(t){return t.wedge.labelSize()},e.set=function(t,e){null===e?t.wedgeAnimator.labelSize=void 0:(t.wedge.labelSize(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.labelSize||(t.wedgeAnimator.labelSize=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.labelSize},e}(xs),Tc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.labelColor(t)},e.get=function(t){return t.wedge.labelColor()},e.set=function(t,e){null===e?t.wedgeAnimator.labelColor=void 0:t.wedge.labelColor(e)},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.labelColor||(t.wedgeAnimator.labelColor=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.labelColor},e}(xs),Pc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.legendSize(t)},e.get=function(t){return t.wedge.legendSize()},e.set=function(t,e){null===e?t.wedgeAnimator.legendSize=void 0:(t.wedge.legendSize(e),t.wedgeAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.legendSize||(t.wedgeAnimator.legendSize=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.legendSize},e}(xs),Lc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.wedge.legendColor(t)},e.get=function(t){return t.wedge.legendColor()},e.set=function(t,e){null===e?t.wedgeAnimator.legendColor=void 0:t.wedge.legendColor(e)},e.animator=function(t,i,r){return void 0===i||t.wedgeAnimator.legendColor||(t.wedgeAnimator.legendColor=new e(t.wedgeAnimator,i,r)),t.wedgeAnimator.legendColor},e}(xs),Fc=function(t){function e(e){var i=t.call(this,e.node)||this;return i.wedge=e,i.wedgeAnimator=new dc(i.wedge),i}return u(e,t),e.prototype.value=function(t,e){return this.propertyNumber(fc,t,e)},e.prototype.total=function(t){return void 0===t?this.wedge.total():(this.wedge.total(t),this)},e.prototype.innerRadius=function(t,e){return this.propertyLength(yc,t,e)},e.prototype.outerRadius=function(t,e){return this.propertyLength(mc,t,e)},e.prototype.startAngle=function(t,e){return this.propertyAngle(vc,t,e)},e.prototype.deltaAngle=function(t,e){return this.propertyAngle(gc,t,e)},e.prototype.minAngle=function(t,e){return this.propertyAngle(wc,t,e)},e.prototype.padAngle=function(t,e){return this.propertyAngle(bc,t,e)},e.prototype.padRadius=function(t,e){null!=t&&(t=+t);var i=this.property(_c,t,e);return"string"==typeof i&&(i=+i),i},e.prototype.cornerRadius=function(t,e){return this.propertyNumber(xc,t,e)},e.prototype.arcColor=function(t,e){return this.propertyColor(Ac,t,e)},e.prototype.tickAlign=function(t,e){return this.propertyNumber(kc,t,e)},e.prototype.tickRadius=function(t,e){return this.propertyLength(Ec,t,e)},e.prototype.tickLength=function(t,e){return this.propertyLength(Cc,t,e)},e.prototype.tickWidth=function(t,e){return this.propertyLength(Sc,t,e)},e.prototype.tickPadding=function(t,e){return this.propertyLength(Vc,t,e)},e.prototype.tickColor=function(t,e){return this.propertyColor(Dc,t,e)},e.prototype.label=function(t){var e=this.wedge.label();if(void 0===t)return e;if("string"==typeof t?t=document.createTextNode(t):(t instanceof Xa||t instanceof Oa)&&(t=t.node),t instanceof Text)if(e){for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(t),t=e}else{var i=Xa.create("text").className("label");i.append(t),t=i.node}if(e){var r=e.view;e!==t&&r&&this.removeChildView(r)}if(this.wedge.label(t),t){var o=t.view;e!==t&&o&&this.appendChildView(o)}return this.wedgeAnimator.animate(),this},e.prototype.labelRadius=function(t,e){return this.propertyLength(Mc,t,e)},e.prototype.labelSize=function(t,e){return this.propertyLength(Rc,t,e)},e.prototype.labelColor=function(t,e){return this.propertyColor(Tc,t,e)},e.prototype.legend=function(t){var e=this.wedge.legend();if(void 0===t)return e;if("string"==typeof t?t=document.createTextNode(t):(t instanceof Xa||t instanceof Oa)&&(t=t.node),t instanceof Text)if(e){for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(t),t=e}else{var i=Xa.create("text").className("legend");i.append(t),t=i.node}if(e){var r=e.view;e!==t&&r&&this.removeChildView(r)}if(this.wedge.legend(t),t){var o=t.view;e!==t&&o&&this.appendChildView(o)}return this.wedgeAnimator.animate(),this},e.prototype.legendSize=function(t,e){return this.propertyLength(Pc,t,e)},e.prototype.legendColor=function(t,e){return this.propertyColor(Lc,t,e)},e.prototype.render=function(){this.wedgeAnimator.update()},e.prototype.didReview=function(e){t.prototype.didReview.call(this,e),this.wedgeAnimator.enabled(e)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("transition").cast(fs.Form),o=e.get("value").numberValue();void 0!==o&&this.value(o,r);var n=e.get("innerRadius").cast(qo.Form);n&&this.innerRadius(n,r);var s=e.get("outerRadius").cast(qo.Form);s&&this.outerRadius(s,r);var a=e.get("startAngle").cast(To.Form);a&&this.startAngle(a,r);var u=e.get("deltaAngle").cast(To.Form);u&&this.deltaAngle(u,r);var h=e.get("minAngle").cast(To.Form);h&&this.minAngle(h,r);var l=e.get("padAngle").cast(To.Form);l&&this.padAngle(l,r);var p=e.get("padRadius").numberValue();void 0!==p&&this.padRadius(p,r);var c=e.get("cornerRadius").numberValue();void 0!==c&&this.cornerRadius(c,r);var d=e.get("arcColor").cast(Qo.Form);d&&this.arcColor(d,r);var f=e.get("tickAlign").numberValue();void 0!==f&&this.tickAlign(f,r);var y=e.get("tickRadius").cast(qo.Form);y&&this.tickRadius(y,r);var m=e.get("tickLength").cast(qo.Form);m&&this.tickLength(m,r);var v=e.get("tickWidth").cast(qo.Form);v&&this.tickWidth(v,r);var g=e.get("tickPadding").cast(qo.Form);g&&this.tickPadding(g,r);var w=e.get("tickColor").cast(Qo.Form);w&&this.tickColor(w,r);var b=e.get("labelRadius").cast(qo.Form);b&&this.labelRadius(b,r);var _=e.get("labelSize").cast(qo.Form);_&&this.labelSize(_,r);var x=e.get("labelColor").cast(Qo.Form);x&&this.labelColor(x,r);var A=this.label();if(A){var k=e.get("labelWeight").numberValue();k&&A.setAttribute("font-weight",""+k)}var E=e.get("legendSize").cast(qo.Form);E&&this.legendSize(E,r);var C=e.get("legendColor").cast(Qo.Form);C&&this.legendColor(C,r);var S=this.legend();if(S){var V=e.get("legendWeight").numberValue();V&&S.setAttribute("font-weight",""+V)}},e.create=function(){return new e(cc.create())},e}(Xa),zc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.updateValue=function(t){void 0===t&&(t=this.stack());var i=e.ValueSelector.evaluate(t).toValue().numberValue(NaN);if(isFinite(i))for(var r=0;r<this._childModels.length;r+=1)this._childModels[r]._modelScope._record.set("value",i);return i},e.ValueSelector=B.get("value"),e.Params=pu.Params.concat([new Ca("transition",B.get("transition").or(B.get("pie").get("transition"))),new Ca("value",e.ValueSelector),new Ca("innerRadius",B.get("innerRadius").or(B.get("pie").get("innerRadius"))),new Ca("outerRadius",B.get("outerRadius").or(B.get("pie").get("outerRadius"))),new Ca("startAngle",B.get("startAngle")),new Ca("deltaAngle",B.get("deltaAngle")),new Ca("minAngle",B.get("minAngle").or(B.get("pie").get("minAngle"))),new Ca("padAngle",B.get("padAngle").or(B.get("pie").get("padAngle"))),new Ca("padRadius",B.get("padRadius").or(B.get("pie").get("padRadius"))),new Ca("cornerRadius",B.get("cornerRadius").or(B.get("pie").get("cornerRadius"))),new Ca("arcColor",B.get("arcColor").or(B.get("pie").get("arcColor"))),new Ca("tickAlign",B.get("tickAlign").or(B.get("pie").get("tickAlign"))),new Ca("tickRadius",B.get("tickRadius").or(B.get("pie").get("tickRadius"))),new Ca("tickLength",B.get("tickLength").or(B.get("pie").get("tickLength"))),new Ca("tickWidth",B.get("tickWidth").or(B.get("pie").get("tickWidth"))),new Ca("tickPadding",B.get("tickPadding").or(B.get("pie").get("tickPadding"))),new Ca("tickColor",B.get("tickColor").or(B.get("pie").get("tickColor"))),new Ca("labelRadius",B.get("labelRadius").or(B.get("pie").get("labelRadius"))),new Ca("labelSize",B.get("labelSize").or(B.get("pie").get("labelSize"))),new Ca("labelColor",B.get("labelColor").or(B.get("pie").get("labelColor"))),new Ca("labelWeight",B.get("labelWeight").or(B.get("pie").get("labelWeight"))),new Ca("legendSize",B.get("legendSize").or(B.get("pie").get("legendSize"))),new Ca("legendColor",B.get("legendColor").or(B.get("pie").get("legendColor"))),new Ca("legendWeight",B.get("legendWeight").or(B.get("pie").get("legendWeight")))]),e}(pu),Ic=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"wedge"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=Fc.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new zc,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){if(i.key instanceof I){var n=i.key.value;if("label"===n){var s=o.castView(i.toValue(),r,o);if(void 0===s&&(s=i.toValue().stringValue()),void 0!==s)return e.label(s),w.Absent}else if("legend"===n){var a=o.castView(i.toValue(),r,o);if(void 0===a&&(a=i.toValue().stringValue()),void 0!==a)return e.legend(a),w.Absent}}return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(cu);Aa.addGlobal(Ic.Form);var Uc=function(){function t(t){this.node=t,this._wedges=[],this._total=NaN,this._limit=0,this._originAngle=To.zero(),this._width=qo.zero(t),this._height=qo.zero(t),this._title=null,this._titleSize=null,this._titleColor=null,this.dirty=!0,this.observers=[],this.wedgesGroup=document.createElementNS("http://www.w3.org/2000/svg","g"),this.wedgesGroup.setAttribute("class","wedges"),this.node.appendChild(this.wedgesGroup)}return t.prototype.wedges=function(){return this._wedges.slice(0)},t.prototype.addWedge=function(t){if(this._wedges.indexOf(t)<0){for(var e=0;e<this.observers.length;e+=1){if((r=this.observers[e]).pieWillAddWedge){var i=r.pieWillAddWedge(t,this);if(i)t=i;else if(null===i)return}}this._wedges.push(t),this.wedgesGroup.appendChild(t.node),t.addObserver(this),this.dirty=!0;for(e=0;e<this.observers.length;e+=1){var r;(r=this.observers[e]).pieDidAddWedge&&r.pieDidAddWedge(t,this)}}},t.prototype.removeWedge=function(t){var e=this._wedges.indexOf(t);if(e>=0){for(var i=0;i<this.observers.length;i+=1){(o=this.observers[i]).pieWillRemoveWedge&&o.pieWillRemoveWedge(t,this)}t.removeObserver(this),this.wedgesGroup.removeChild(t.node),this._wedges.splice(e,1),this.dirty=!0;for(var r=0;r<this.observers.length;r+=1){var o;(o=this.observers[r]).pieDidRemoveWedge&&o.pieDidRemoveWedge(t,this)}}},t.prototype.total=function(){return this._total},t.prototype.limit=function(t){return void 0===t?this._limit:(this._limit!==t&&(this._limit=t,this._total=t,this.dirty=!0),this)},t.prototype.originAngle=function(t){return void 0===t?this._originAngle:(t=To.fromAny(t),this._originAngle.equals(t)||(this._originAngle=t,this.dirty=!0),this)},t.prototype.width=function(t){return void 0===t?this._width:(t=qo.fromAny(t,this.node),this._width.equals(t)||(this._width=t,this.dirty=!0),this)},t.prototype.height=function(t){return void 0===t?this._height:(t=qo.fromAny(t,this.node),this._height.equals(t)||(this._height=t,this.dirty=!0),this)},t.prototype.title=function(t){return void 0===t?this._title:(this._title!==t?(this._title&&this.node.removeChild(this._title),this._title=t,this._title&&this.node.appendChild(this._title),this.dirty=!0,this.render()):this.dirty=!0,this)},t.prototype.titleSize=function(t){return void 0===t?this._titleSize:(null!==t&&(t=qo.fromAny(t)),(this._titleSize?this._titleSize.equals(t):this._titleSize===t)||(this._titleSize=t,this.dirty=!0),this)},t.prototype.titleColor=function(t){return void 0===t?this._titleColor:(null!==t&&(t=Qo.fromAny(t)),(this._titleColor?this._titleColor.equals(t):this._titleColor===t)||(this._titleColor=t,this.dirty=!0),this)},t.prototype.update=function(){this.dirty&&(this.dirty=!1,this.updateTitle(),this.updateWedges())},t.prototype.updateTotal=function(){for(var t=0,e=0;e<this._wedges.length;e+=1){var i=this._wedges[e].value();if(!isFinite(i)){t=NaN;break}t+=i}var r=this._total;if(r!==t){this._total=t;for(e=0;e<this.observers.length;e+=1){var o=this.observers[e];o.pieDidSetTotal&&o.pieDidSetTotal(t,r,this)}if(isFinite(t))for(e=0;e<this._wedges.length;e+=1)this._wedges[e].total(t)}return t},t.prototype.updateTitle=function(){var t=this._title;if(t){var e=this._width.pxValue(),i=this._height.pxValue(),r=e/2,o=i/2;if(t instanceof SVGGElement){var n=dn.translate(r,o);t.setAttribute("transform",n.toAttributeString())}else if(t instanceof SVGTextElement&&(t.removeAttribute("visibility"),t.setAttribute("x",""+r),t.setAttribute("y",""+o),t.setAttribute("text-anchor","middle"),t.setAttribute("alignment-baseline","middle"),this._titleSize)){var s=Math.min(e,i);t.setAttribute("font-size",""+Math.ceil(this._titleSize.pxValue(s)))}this._titleColor&&t.setAttribute("fill",this._titleColor.toString())}},t.prototype.updateWedges=function(){var t=dn.translate(this._width.pxValue()/2,this._height.pxValue()/2);this.wedgesGroup.setAttribute("transform",t.toAttributeString());for(var e=Math.max(this.updateTotal(),this._limit),i=this._originAngle,r=0;r<this._wedges.length;r+=1){var o=this._wedges[r];if(isFinite(e)){var n=2*Math.PI*o.value()/(e||1);o.startAngle(i).deltaAngle(To.rad(n)),i=To.rad(i.radValue()+n)}this.updateWedge(this._wedges[r])}},t.prototype.updateWedge=function(t){t.width(this._width).height(this._height)},t.prototype.render=function(){this.renderTitle(),this.renderWedges()},t.prototype.renderTitle=function(){},t.prototype.renderWedges=function(){this.updateWedges();for(var t=0;t<this._wedges.length;t+=1)this.renderWedge(this._wedges[t])},t.prototype.renderWedge=function(t){t.render()},t.prototype.wedgeDidSetValue=function(t,e,i){for(var r=0;r<this.observers.length;r+=1){var o=this.observers[r];o.pieWedgeDidSetValue&&o.pieWedgeDidSetValue(t,e,i,this)}},t.prototype.addObserver=function(t){this.observers.indexOf(t)<0&&this.observers.push(t)},t.prototype.removeObserver=function(t){var e=this.observers.indexOf(t);e>=0&&this.observers.splice(e,1)},t.create=function(e){void 0===e&&(e="svg");var i=document.createElementNS("http://www.w3.org/2000/svg",e);return i.setAttribute("class","pie"),i.style.setProperty("flex-grow","1"),i.style.setProperty("flex-basis","0"),i.style.setProperty("-webkit-user-select","none"),i.style.setProperty("-moz-user-select","none"),i.style.setProperty("-ms-user-select","none"),i.style.setProperty("user-select","none"),i.style.setProperty("cursor","default"),new t(i)},t}(),Wc=function(t){function e(e,i){var r=t.call(this)||this;return r.pie=e,r.childViews=i,r.originAngle=void 0,r.width=void 0,r.height=void 0,r.titleSize=void 0,r.titleColor=void 0,r}return u(e,t),e.prototype.onFrame=function(t){this.originAngle&&this.originAngle.onFrame(t),this.width&&this.width.onFrame(t),this.height&&this.height.onFrame(t),this.titleSize&&this.titleSize.onFrame(t),this.titleColor&&this.titleColor.onFrame(t),this.update()},e.prototype.renderWedges=function(){for(var t=0;t<this.childViews.length;t+=1){var e=this.childViews[t];e instanceof Fc&&e.render()}},e.prototype.update=function(){this.pie.updateTitle(),this.pie.updateWedges(),this.renderWedges()},e}(ws),Oc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.pie.originAngle(t)},e.get=function(t){return t.pie.originAngle()},e.set=function(t,e){null===e?t.pieAnimator.originAngle=void 0:t.pie.originAngle(e)},e.animator=function(t,i,r){return void 0===i||t.pieAnimator.originAngle||(t.pieAnimator.originAngle=new e(t.pieAnimator,i,r)),t.pieAnimator.originAngle},e}(xs),Bc=function(t){function e(e,i,r){return t.call(this,e,i,r,gs.REQUIRES_RESIZE)||this}return u(e,t),e.prototype.update=function(t){this.parent.pie.width(t),this.updateTarget(this.parent.pie.node)},e.get=function(t){return t.pie.width()},e.set=function(t,e){if(null===e)t.pieAnimator.width=void 0,t.pie.node.removeAttribute("width");else{t.pie.width(e);var i=t.pie.node.getAttribute("width"),r=""+e.pxValue();i!==r&&(t.pie.node.setAttribute("width",r),t.requireResize())}},e.animator=function(t,i,r){return void 0===i||t.pieAnimator.width||(t.pieAnimator.width=new e(t.pieAnimator,i,r)),t.pieAnimator.width},e}(xs),qc=function(t){function e(e,i,r){return t.call(this,e,i,r,gs.REQUIRES_RESIZE)||this}return u(e,t),e.prototype.update=function(t){this.parent.pie.height(t),this.updateTarget(this.parent.pie.node)},e.get=function(t){return t.pie.height()},e.set=function(t,e){if(null===e)t.pieAnimator.height=void 0,t.pie.node.removeAttribute("height");else{t.pie.height(e);var i=t.pie.node.getAttribute("height"),r=""+e.pxValue();i!==r&&(t.pie.node.setAttribute("height",r),t.requireResize())}},e.animator=function(t,i,r){return void 0===i||t.pieAnimator.height||(t.pieAnimator.height=new e(t.pieAnimator,i,r)),t.pieAnimator.height},e}(xs),Gc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.pie.titleSize(t)},e.get=function(t){return t.pie.titleSize()},e.set=function(t,e){null===e?t.pieAnimator.titleSize=void 0:(t.pie.titleSize(e),t.pieAnimator.animate())},e.animator=function(t,i,r){return void 0===i||t.pieAnimator.titleSize||(t.pieAnimator.titleSize=new e(t.pieAnimator,i,r)),t.pieAnimator.titleSize},e}(xs),Hc=function(t){function e(e,i,r){return t.call(this,e,i,r)||this}return u(e,t),e.prototype.update=function(t){this.parent.pie.titleColor(t)},e.get=function(t){return t.pie.titleColor()},e.set=function(t,e){null===e?t.pieAnimator.titleColor=void 0:t.pie.titleColor(e)},e.animator=function(t,i,r){return void 0===i||t.pieAnimator.titleColor||(t.pieAnimator.titleColor=new e(t.pieAnimator,i,r)),t.pieAnimator.titleColor},e}(xs),Nc=function(t){function e(e){var i=t.call(this,e.node)||this;return i.pie=e,i.pieAnimator=new Wc(i.pie,i._childViews),i.pie.addObserver(i),i}return u(e,t),e.prototype.wedges=function(){for(var t=[],e=0;e<this._childViews.length;e+=1){var i=this._childViews[e];i instanceof Fc&&t.push(i)}return t},e.prototype.addWedge=function(t){this.appendChildView(t)},e.prototype.removeWedge=function(t){this.removeChildView(t)},e.prototype.didInsertChildView=function(e){e instanceof Fc&&this.pie.addWedge(e.wedge),t.prototype.didInsertChildView.call(this,e)},e.prototype.didRemoveChildView=function(e){e instanceof Fc&&this.pie.removeWedge(e.wedge),t.prototype.didRemoveChildView.call(this,e)},e.prototype.total=function(){return this.pie.total()},e.prototype.limit=function(t){return void 0===t?this.pie.limit():(this.pie.limit(t),this)},e.prototype.originAngle=function(t,e){return this.propertyAngle(Oc,t,e)},e.prototype.width=function(t,e){return this.propertyLength(Bc,t,e)},e.prototype.height=function(t,e){return this.propertyLength(qc,t,e)},e.prototype.innerRadius=function(t,e){for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.innerRadius(t,e)}return this},e.prototype.outerRadius=function(t,e){for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.outerRadius(t,e)}return this},e.prototype.padAngle=function(t,e){t=To.fromAny(t);for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.padAngle(t,e)}return this},e.prototype.padRadius=function(t,e){for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.padRadius(t,e)}return this},e.prototype.cornerRadius=function(t,e){for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.cornerRadius(t,e)}return this},e.prototype.arcColor=function(t,e){t=Qo.fromAny(t);for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.arcColor(t,e)}return this},e.prototype.tickRadius=function(t,e){for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.tickRadius(t,e)}return this},e.prototype.tickLength=function(t,e){for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.tickLength(t,e)}return this},e.prototype.tickWidth=function(t,e){for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.tickWidth(t,e)}return this},e.prototype.tickPadding=function(t,e){for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.tickPadding(t,e)}return this},e.prototype.tickColor=function(t,e){t=Qo.fromAny(t);for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.tickColor(t,e)}return this},e.prototype.labelRadius=function(t,e){for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.labelRadius(t,e)}return this},e.prototype.labelSize=function(t,e){for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.labelSize(t,e)}return this},e.prototype.labelColor=function(t,e){t=Qo.fromAny(t);for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.labelColor(t,e)}return this},e.prototype.legendSize=function(t,e){for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.legendSize(t,e)}return this},e.prototype.legendColor=function(t,e){t=Qo.fromAny(t);for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof Fc&&r.legendColor(t,e)}return this},e.prototype.title=function(t){var e=this.pie.title();if(void 0===t)return e;if("string"==typeof t?t=document.createTextNode(t):(t instanceof Xa||t instanceof Oa)&&(t=t.node),t instanceof Text)if(e){for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(t),t=e}else{var i=Xa.create("text").className("title");i.append(t),t=i.node}if(e){var r=e.view;e!==t&&r&&this.removeChildView(r)}if(this.pie.title(t),t){var o=t.view;e!==t&&o&&this.appendChildView(o)}return this.pieAnimator.animate(),this},e.prototype.titleSize=function(t,e){return this.propertyLength(Gc,t,e)},e.prototype.titleColor=function(t,e){return this.propertyColor(Hc,t,e)},e.prototype.render=function(){this.pieAnimator.update()},e.prototype.autosize=function(){for(var t=this.node;;){var e=t.parentNode;if(!e)return;if(e instanceof HTMLElement)return void this.width(e.offsetWidth).height(e.offsetHeight);t=e}},e.prototype.didResize=function(){t.prototype.didResize.call(this),this.autosize(),this.render()},e.prototype.didReview=function(e){t.prototype.didReview.call(this,e),this.pieAnimator.enabled(e)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("transition").cast(fs.Form),o=e.get("limit").numberValue();void 0!==o&&this.limit(o);var n=e.get("originAngle").cast(To.Form);n&&this.originAngle(n,r);var s=e.get("pieWidth").cast(qo.Form);s&&this.width(s);var a=e.get("pieHeight").cast(qo.Form);a&&this.height(a);var u=e.get("titleSize").cast(qo.Form);u&&this.titleSize(u,r);var h=e.get("titleColor").cast(Qo.Form);h&&this.titleColor(h,r);var l=this.title();if(l){var p=e.get("titleWeight").numberValue();p&&l.setAttribute("font-weight",""+p)}},e.prototype.pieWedgeDidSetValue=function(t,e,i,r){this.pie.updateTotal(),this.pieAnimator.animate()},e.prototype.addObserver=function(t){this.pie.addObserver(t)},e.prototype.removeObserver=function(t){this.pie.removeObserver(t)},e.create=function(t){if(t instanceof e)return t;if(t instanceof ba)throw new TypeError(""+t);if(void 0===t||"string"==typeof t)return new e(Uc.create(t));if(t.view instanceof e)return t.view;if(t.view)throw new TypeError(""+t.view);if(t instanceof SVGElement)return new e(new Uc(t));throw new TypeError(""+t)},e.applyTheme=function(t){var e=B.get("value").divide(B.get("total").or(U.One)),i=B.get("primaryHue").invoke(e).or(B.get("primaryColor")),r=B.get("contrast").invoke(L.of(i,U.valueOf(2))),o=L.empty().slot("innerRadius","3%").slot("outerRadius","25%").slot("arcColor",i).slot("tickRadius","30%").slot("tickLength","50%").slot("tickColor",i).slot("labelRadius","50%").slot("padAngle","2deg").slot("minAngle","2deg").slot("labelSize","10px").slot("labelColor",r).slot("labelWeight",500).slot("legendSize","12px").slot("legendColor",i).slot("legendWeight",300).slot("titleSize","14px").slot("titleColor",B.get("textColor")).slot("titleWeight",300);t.set("pie",o)},e}(Xa);Nc.applyTheme(Nc.Theme);var jc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.prototype.willRestate=function(){t.prototype.willRestate.call(this),this.updateTotal()},e.prototype.updateTotal=function(){for(var t=0,e=0;e<this._childModels.length;e+=1){var i=this._childModels[e];if(i instanceof zc){var r=i.updateValue();if(!isFinite(r)){t=NaN;break}t+=r}}return isFinite(t)?this._modelScope._record.set("total",t):this._modelScope._record.delete("total"),t},e.Params=pu.Params.concat([new Ca("transition",B.get("transition").or(B.get("pie").get("transition"))),new Ca("value",B.get("value")),new Ca("total",B.get("total")),new Ca("limit",B.get("limit")),new Ca("originAngle",B.get("originAngle").or(B.get("pie").get("originAngle"))),new Ca("pieWidth",B.get("pieWidth").or(B.get("pie").get("width"))),new Ca("pieHeight",B.get("pieHeight").or(B.get("pie").get("height"))),new Ca("titleSize",B.get("titleSize").or(B.get("pie").get("titleSize"))),new Ca("titleColor",B.get("titleColor").or(B.get("pie").get("titleColor"))),new Ca("titleWeight",B.get("titleWeight").or(B.get("pie").get("titleWeight")))]),e}(pu),Yc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"pie"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=Nc.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new jc,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){if(i.key instanceof I&&"title"===i.key.value){var n=o.castView(i.toValue(),r,o);if(void 0===n&&(n=i.toValue().stringValue()),void 0!==n)return e.title(n),w.Absent}var s=Ic.Form.castView(i.toValue(),r,o);return s?(e.addWedge(s),s):t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(cu);Aa.addGlobal(Yc.Form);var Xc=function(t){function e(e){var i=t.call(this,e)||this;return i.display("flex").position("relative").flexDirection("column").flexGrow(1).flexBasis(0).width("100%").height("100%"),i._contentView=i.append("div").display("flex").position("relative").flexGrow(1).flexBasis(0),i._bodyView=null,i}return u(e,t),e.prototype.contentView=function(){return this._contentView},e.prototype.bodyView=function(t){return void 0===t?this._bodyView:(this._bodyView!==t&&(this._bodyView&&this._bodyView.remove(),this._bodyView=t,this._bodyView&&this._contentView.append(this._bodyView)),this)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("marginTop").cast(qo.Form);r&&this._contentView.marginTop(r);var o=e.get("marginRight").cast(qo.Form);o&&this._contentView.marginRight(o);var n=e.get("marginBottom").cast(qo.Form);n&&this._contentView.marginBottom(n);var s=e.get("marginLeft").cast(qo.Form);s&&this._contentView.marginLeft(s)},e.create=function(){return new e(document.createElement("div")).className("placard")},e.applyTheme=function(t){var e=L.empty().slot("marginTop","8px").slot("marginRight","8px").slot("marginBottom","8px").slot("marginLeft","8px").slot("titleSize","12px").slot("titleColor",B.get("textColor")).slot("subtitleSize","10px").slot("subtitleColor",B.get("textColor"));t.set("placard",e)},e}(tu);Xc.applyTheme(Xc.Theme);var Kc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=eu.Params.concat([new Ca("transition",B.get("transition").or(B.get("placard").get("transition"))),new Ca("marginTop",B.get("marginTop").or(B.get("placard").get("marginTop"))),new Ca("marginRight",B.get("marginRight").or(B.get("placard").get("marginRight"))),new Ca("marginBottom",B.get("marginBottom").or(B.get("placard").get("marginBottom"))),new Ca("marginLeft",B.get("marginLeft").or(B.get("placard").get("marginLeft")))]),e}(eu),Qc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"placard"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=Xc.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new Kc,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){if(i.key instanceof I&&"body"===i.key.value){var n=o.castView(i.toValue(),r,o);if(n)return e.bodyView(n),e.bodyView()}return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(iu);Aa.addGlobal(Qc.Form);var Zc=function(t){function e(e){var i=t.call(this,e)||this;return i._proportion="any",i._placement="any",i._pieceMargin=0,i._pieceWidth=0,i._pieceHeight=0,i._reflowTransition=void 0,i}return u(e,t),e.prototype.proportion=function(t){return void 0===t?this._proportion:(this._proportion!==t&&(this._proportion=t,this._parentView&&this._parentView.requireResize()),this)},e.prototype.placement=function(t){return void 0===t?this._placement:(this._placement!==t&&(this._placement=t,this._parentView&&this._parentView.requireResize()),this)},e.prototype.pieceMargin=function(t,e){return void 0===t?this._pieceMargin:(this._pieceMargin=t,this)},e.prototype.pieceWidth=function(t,e){return void 0===t?this._pieceWidth:(this._pieceWidth=t,this)},e.prototype.pieceHeight=function(t,e){return void 0===t?this._pieceHeight:(this._pieceHeight=t,this)},e.prototype.reflowTransition=function(t){return void 0===t?this._reflowTransition||null:(this._reflowTransition=t||void 0,this)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("proportion").stringValue();void 0!==r&&this.proportion(r);var o=e.get("placement").stringValue();void 0!==o&&this.placement(o)},e}(tu),Jc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=eu.Params.concat([new Ca("proportion",B.get("proportion")),new Ca("placement",B.get("placement"))]),e}(eu),$c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.addGlobal=function(t){e.Global=e.Global.withUiForm(t)},e.removeGlobal=function(t){e.Global=e.Global.withoutUiForm(t)},e.Global=new ka([]),e}(iu),td=function(t){function e(e){var i=t.call(this,e)||this;return i.display("flex").flexDirection("column").flexGrow(1).borderRadius(8).backgroundColor(Qo.white()),i._headerView=i.append("div").display("flex").justifyContent("space-between").alignItems("baseline").flexShrink(0),i._titleView=null,i._subtitleView=null,i._contentView=i.append("div").display("flex").position("relative").flexGrow(1),i._bodyView=null,i.onClick=i.onClick.bind(i),i.node.addEventListener("click",i.onClick),i}return u(e,t),e.prototype.headerView=function(){return this._headerView},e.prototype.titleView=function(t){var e=this._titleView;if(void 0===t)return e;if("string"==typeof t?t=document.createTextNode(t):(t instanceof tu||t instanceof Oa)&&(t=t.node),t instanceof Text)if(e)e.removeAll(),e.append(t),t=e;else{var i=tu.create("text").className("title");i.append(t),t=i.node}return t instanceof HTMLElement&&(t=tu.create(t)),e!==t&&e&&this._headerView.remove(e),this._titleView=t,e!==t&&t&&this._headerView.insertBefore(t,this._subtitleView),this},e.prototype.subtitleView=function(t){var e=this._subtitleView;if(void 0===t)return e;if("string"==typeof t?t=document.createTextNode(t):(t instanceof tu||t instanceof Oa)&&(t=t.node),t instanceof Text)if(e)e.removeAll(),e.append(t),t=e;else{var i=tu.create("text").className("title");i.append(t),t=i.node}return t instanceof HTMLElement&&(t=tu.create(t)),e!==t&&e&&this._headerView.remove(e),this._subtitleView=t,e!==t&&t&&this._headerView.append(t),this},e.prototype.contentView=function(){return this._contentView},e.prototype.bodyView=function(t){return void 0===t?this._bodyView:(this._bodyView!==t&&(this._bodyView&&this._bodyView.remove(),this._bodyView=t,this._bodyView&&this._contentView.append(this._bodyView)),this)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("marginTop").cast(qo.Form);r&&(this.headerView().marginTop(r),this.contentView().marginTop(r));var o=e.get("marginRight").cast(qo.Form);o&&(this.headerView().marginRight(o),this.contentView().marginRight(o));var n=e.get("marginBottom").cast(qo.Form);n&&this.contentView().marginBottom(n);var s=e.get("marginLeft").cast(qo.Form);s&&(this.headerView().marginLeft(s),this.contentView().marginLeft(s));var a=this.titleView();if(a){var u=e.get("titleSize").cast(qo.Form);u&&a.fontSize(u);var h=e.get("titleColor").cast(Qo.Form);h&&a.color(h)}var l=this.subtitleView();if(l){var p=e.get("subtitleSize").cast(qo.Form);p&&l.fontSize(p);var c=e.get("subtitleColor").cast(Qo.Form);c&&l.color(c)}},e.prototype.onClick=function(t){},e.create=function(){return new e(document.createElement("div")).className("piece card")},e}(Zc),ed=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=Jc.Params.concat([new Ca("marginTop",B.get("marginTop").or(B.get("quilt").get("card").get("marginTop"))),new Ca("marginRight",B.get("marginRight").or(B.get("quilt").get("card").get("marginRight"))),new Ca("marginBottom",B.get("marginBottom").or(B.get("quilt").get("card").get("marginBottom"))),new Ca("marginLeft",B.get("marginLeft").or(B.get("quilt").get("card").get("marginLeft"))),new Ca("titleSize",B.get("titleSize").or(B.get("quilt").get("card").get("titleSize"))),new Ca("titleColor",B.get("titleColor").or(B.get("quilt").get("card").get("titleColor"))),new Ca("subtitleSize",B.get("subtitleSize").or(B.get("quilt").get("card").get("subtitleSize"))),new Ca("subtitleColor",B.get("subtitleColor").or(B.get("quilt").get("card").get("subtitleColor")))]),e}(Jc),id=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"card"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=td.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new ed,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){if(i.key instanceof I){var n=i.key.value;if("title"===n){var s=o.castView(i.toValue(),r,o);if(void 0===s&&(s=i.toValue().stringValue()),void 0!==s)return e.titleView(s),e.titleView()}else if("subtitle"===n){var a=o.castView(i.toValue(),r,o);if(void 0===a&&(a=i.toValue().stringValue()),void 0!==a)return e.subtitleView(a),e.subtitleView()}else if("body"===n){var u=o.castView(i.toValue(),r,o);if(u)return e.bodyView(u),e.bodyView()}}return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}($c);Aa.addGlobal(id.Form),$c.addGlobal(id.Form);var rd=function(t){function e(e){var i=t.call(this,e)||this;return i._blockMargin=0,i._blockWidth=0,i._blockHeight=0,i._reflowTransition=void 0,i}return u(e,t),e.prototype.blockMargin=function(t,e){return void 0===t?this._blockMargin:(this._blockMargin=t,this)},e.prototype.blockWidth=function(t,e){return void 0===t?this._blockWidth:(this._blockWidth=t,this)},e.prototype.blockHeight=function(t,e){return void 0===t?this._blockHeight:(this._blockHeight=t,this)},e.prototype.reflowTransition=function(t){return void 0===t?this._reflowTransition||null:(this._reflowTransition=t||void 0,this)},e.prototype.pieces=function(){for(var t=[],e=0;e<this._childViews.length;e+=1){var i=this._childViews[e];i instanceof Zc&&t.push(i)}return t},e.prototype.addPiece=function(t){this.append(t)},e.prototype.removePiece=function(t){this.remove(t)},e.prototype.willResize=function(){t.prototype.willResize.call(this),this.reflow()},e.prototype.reflow=function(){for(var t,e,i,r,o,n,s,a,u,h=this.pieces(),l=0;l<h.length;){var p=(c=h[l]).placement();t||r||o||"top"!==p?e||n||s||"middle"!==p?i||a||u||"bottom"!==p?r||t||(n||s)&&(a||!u)||"top-left"!==p?o||t||(n||s)&&(a||!u)||"top-right"!==p?n||e||(r||o)&&(a||u)||"middle-left"!==p?s||e||(r||o)&&(a||u)||"middle-right"!==p?a||i||(n||s)&&(r||o)||"bottom-left"!==p?u||i||(n||s)&&(r||o)||"bottom-right"!==p?l+=1:(u=c,h.splice(l,1)):(a=c,h.splice(l,1)):(s=c,h.splice(l,1)):(n=c,h.splice(l,1)):(o=c,h.splice(l,1)):(r=c,h.splice(l,1)):(i=c,h.splice(l,1)):(e=c,h.splice(l,1)):(t=c,h.splice(l,1))}for(l=0;l<h.length;){"square"===(c=h[l]).proportion()?!r&&o?(r=c,h.splice(l,1)):!o&&r?(o=c,h.splice(l,1)):!n&&s?(n=c,h.splice(l,1)):!s&&n?(s=c,h.splice(l,1)):!a&&u?(a=c,h.splice(l,1)):!u&&a?(u=c,h.splice(l,1)):r||t?a||i?n||e?l+=1:(n=c,h.splice(l,1)):(a=c,h.splice(l,1)):(r=c,h.splice(l,1)):l+=1}for(;h.length;){var c=h.shift();t||r||o?i||a||u?e||n||s||(e=c):i=c:t=c}var d=this._reflowTransition;(r||o)&&(n||s)?this.layout221(r,o,n,s,i,d):(r||o)&&(a||u)?this.layout212(r,o,e,a,u,d):(n||s)&&(a||u)?this.layout122(t,n,s,a,u,d):(r||o)&&e&&i?this.layout211(r,o,e,i,d):t&&(n||s)&&i?this.layout121(t,n,s,i,d):t&&e&&(a||u)?this.layout112(t,e,a,u,d):r||o?this.layout21(r,o,i||e,d):a||u?this.layout12(t||e,a,u,d):n||s?this.layout121(t,n,s,i,d):t&&e&&i?this.layout111(t,e,i,d):t&&(e||i)||i?this.layout11(t,e||i,d):e&&i?this.layout11(e,i,d):(t||e||i)&&this.layout1(t||e||i,d)},e.prototype.layout1=function(t,e){t&&t.position("absolute").left(0).top(0).width(this._blockWidth,e).height(this._blockHeight,e).pieceMargin(this._blockMargin,e).pieceWidth(this._blockWidth,e).pieceHeight(this._blockHeight,e).reflowTransition(e||null)},e.prototype.layout11=function(t,e,i){var r=Math.round((this._blockHeight-this._blockMargin)/2);t&&t.position("absolute").left(0,i).top(0,i).width(this._blockWidth,i).height(r,i).pieceMargin(this._blockMargin,i).pieceWidth(this._blockWidth,i).pieceHeight(r,i).reflowTransition(i||null),e&&e.position("absolute").left(0,i).top(this._blockHeight-r,i).width(this._blockWidth,i).height(r,i).pieceMargin(this._blockMargin,i).pieceWidth(this._blockWidth,i).pieceHeight(r,i).reflowTransition(i||null)},e.prototype.layout111=function(t,e,i,r){var o=Math.round((this._blockHeight-2*this._blockMargin)/3);t&&t.position("absolute").left(0,r).top(0,r).width(this._blockWidth,r).height(o,r).pieceMargin(this._blockMargin,r).pieceWidth(this._blockWidth,r).pieceHeight(o,r).reflowTransition(r||null),e&&e.position("absolute").left(0,r).top(o+this._blockMargin,r).width(this._blockWidth,r).height(o,r).pieceMargin(this._blockMargin,r).pieceWidth(this._blockWidth,r).pieceHeight(o,r).reflowTransition(r||null),i&&i.position("absolute").left(0,r).top(this._blockHeight-o,r).width(this._blockWidth,r).height(o,r).pieceMargin(this._blockMargin,r).pieceWidth(this._blockWidth,r).pieceHeight(o,r).reflowTransition(r||null)},e.prototype.layout12=function(t,e,i,r){var o=Math.round((this._blockWidth-this._blockMargin)/2);t&&t.position("absolute").left(0,r).top(0,r).width(this._blockWidth,r).height(this._blockHeight-o-this._blockMargin,r).pieceMargin(this._blockMargin,r).pieceWidth(this._blockWidth,r).pieceHeight(this._blockHeight-o-this._blockMargin,r).reflowTransition(r||null),e&&e.position("absolute").left(0,r).top(this._blockHeight-o,r).width(o,r).height(o,r).pieceMargin(this._blockMargin,r).pieceWidth(o,r).pieceHeight(o,r).reflowTransition(r||null),i&&i.position("absolute").left(this._blockWidth-o,r).top(this._blockHeight-o,r).width(o,r).height(o,r).pieceMargin(this._blockMargin,r).pieceWidth(o,r).pieceHeight(o,r).reflowTransition(r||null)},e.prototype.layout21=function(t,e,i,r){var o=Math.round((this._blockWidth-this._blockMargin)/2);t&&t.position("absolute").left(0,r).top(0,r).width(o,r).height(o,r).pieceMargin(this._blockMargin,r).pieceWidth(o,r).pieceHeight(o,r).reflowTransition(r||null),e&&e.position("absolute").left(this._blockWidth-o,r).top(0,r).width(o,r).height(o,r).pieceMargin(this._blockMargin,r).pieceWidth(o,r).pieceHeight(o,r).reflowTransition(r||null),i&&i.position("absolute").left(0,r).top(o+this._blockMargin,r).width(this._blockWidth,r).height(this._blockHeight-(o+this._blockMargin),r).pieceMargin(this._blockMargin,r).pieceWidth(this._blockWidth,r).pieceHeight(this._blockHeight-(o+this._blockMargin),r).reflowTransition(r||null)},e.prototype.layout112=function(t,e,i,r,o){var n=Math.round((this._blockWidth-this._blockMargin)/2),s=Math.round((this._blockHeight-n-2*this._blockMargin)/2);t&&t.position("absolute").left(0,o).top(0,o).width(this._blockWidth,o).height(s,o).pieceMargin(this._blockMargin,o).pieceWidth(this._blockWidth,o).pieceHeight(s,o).reflowTransition(o||null),e&&e.position("absolute").left(0,o).top(s+this._blockMargin,o).width(this._blockWidth,o).height(s,o).pieceMargin(this._blockMargin,o).pieceWidth(this._blockWidth,o).pieceHeight(s,o).reflowTransition(o||null),i&&i.position("absolute").left(0,o).top(this._blockHeight-n,o).width(n,o).height(n,o).pieceMargin(this._blockMargin,o).pieceWidth(n,o).pieceHeight(n,o).reflowTransition(o||null),r&&r.position("absolute").left(this._blockWidth-n,o).top(this._blockHeight-n,o).width(n,o).height(n,o).pieceMargin(this._blockMargin,o).pieceWidth(n,o).pieceHeight(n,o).reflowTransition(o||null)},e.prototype.layout121=function(t,e,i,r,o){var n=Math.round((this._blockWidth-this._blockMargin)/2),s=Math.round((this._blockHeight-n-2*this._blockMargin)/2);t&&t.position("absolute").left(0,o).top(0,o).width(this._blockWidth,o).height(s,o).pieceMargin(this._blockMargin,o).pieceWidth(this._blockWidth,o).pieceHeight(s,o).reflowTransition(o||null),e&&e.position("absolute").left(0,o).top(s+this._blockMargin,o).width(n,o).height(n,o).pieceMargin(this._blockMargin,o).pieceWidth(n,o).pieceHeight(n,o).reflowTransition(o||null),i&&i.position("absolute").left(this._blockWidth-n,o).top(s+this._blockMargin,o).width(n,o).height(n,o).pieceMargin(this._blockMargin,o).pieceWidth(n,o).pieceHeight(n,o).reflowTransition(o||null),r&&r.position("absolute").left(0,o).top(this._blockHeight-s,o).width(this._blockWidth,o).height(s,o).pieceMargin(this._blockMargin,o).pieceWidth(this._blockWidth,o).pieceHeight(s,o).reflowTransition(o||null)},e.prototype.layout211=function(t,e,i,r,o){var n=Math.round((this._blockWidth-this._blockMargin)/2),s=Math.round((this._blockHeight-n-2*this._blockMargin)/2);t&&t.position("absolute").left(0,o).top(0,o).width(n,o).height(n,o).pieceMargin(this._blockMargin,o).pieceWidth(n,o).pieceHeight(n,o).reflowTransition(o||null),e&&e.position("absolute").left(this._blockWidth-n,o).top(0,o).width(n,o).height(n,o).pieceMargin(this._blockMargin,o).pieceWidth(n,o).pieceHeight(n,o).reflowTransition(o||null),i&&i.position("absolute").left(0,o).top(n+this._blockMargin,o).width(this._blockWidth,o).height(s,o).pieceMargin(this._blockMargin,o).pieceWidth(this._blockWidth,o).pieceHeight(s,o).reflowTransition(o||null),r&&r.position("absolute").left(0,o).top(this._blockHeight-s,o).width(this._blockWidth,o).height(s,o).pieceMargin(this._blockMargin,o).pieceWidth(this._blockWidth,o).pieceHeight(s,o).reflowTransition(o||null)},e.prototype.layout122=function(t,e,i,r,o,n){var s=Math.round((this._blockWidth-this._blockMargin)/2),a=Math.round(this._blockHeight-2*s-2*this._blockMargin);t&&t.position("absolute").left(0,n).top(0,n).width(this._blockWidth,n).height(a,n).pieceMargin(this._blockMargin,n).pieceWidth(this._blockWidth,n).pieceHeight(a,n).reflowTransition(n||null),e&&e.position("absolute").left(0,n).top(a+this._blockMargin,n).width(s,n).height(s,n).pieceMargin(this._blockMargin,n).pieceWidth(s,n).pieceHeight(s,n).reflowTransition(n||null),i&&i.position("absolute").left(this._blockWidth-s,n).top(a+this._blockMargin,n).width(s,n).height(s,n).pieceMargin(this._blockMargin,n).pieceWidth(s,n).pieceHeight(s,n).reflowTransition(n||null),r&&r.position("absolute").left(0,n).top(this._blockHeight-s,n).width(s,n).height(s,n).pieceMargin(this._blockMargin,n).pieceWidth(s,n).pieceHeight(s,n).reflowTransition(n||null),o&&o.position("absolute").left(this._blockWidth-s,n).top(this._blockHeight-s,n).width(s,n).height(s,n).pieceMargin(this._blockMargin,n).pieceWidth(s,n).pieceHeight(s,n).reflowTransition(n||null)},e.prototype.layout212=function(t,e,i,r,o,n){var s=Math.round((this._blockWidth-this._blockMargin)/2),a=Math.round(this._blockHeight-2*s-2*this._blockMargin);t&&t.position("absolute").left(0,n).top(0,n).width(s,n).height(s,n).pieceMargin(this._blockMargin,n).pieceWidth(s,n).pieceHeight(s,n).reflowTransition(n||null),e&&e.position("absolute").left(this._blockWidth-s,n).top(0,n).width(s,n).height(s,n).pieceMargin(this._blockMargin,n).pieceWidth(s,n).pieceHeight(s,n).reflowTransition(n||null),i&&i.position("absolute").left(0,n).top(s+this._blockMargin,n).width(this._blockWidth,n).height(a,n).pieceMargin(this._blockMargin,n).pieceWidth(this._blockWidth,n).pieceHeight(a,n).reflowTransition(n||null),r&&r.position("absolute").left(0,n).top(this._blockHeight-s,n).width(s,n).height(s,n).pieceMargin(this._blockMargin,n).pieceWidth(s,n).pieceHeight(s,n).reflowTransition(n||null),o&&o.position("absolute").left(this._blockWidth-s,n).top(this._blockHeight-s,n).width(s,n).height(s,n).pieceMargin(this._blockMargin,n).pieceWidth(s,n).pieceHeight(s,n).reflowTransition(n||null)},e.prototype.layout221=function(t,e,i,r,o,n){var s=Math.round((this._blockWidth-this._blockMargin)/2),a=Math.round(this._blockHeight-2*s-2*this._blockMargin);t&&t.position("absolute").left(0,n).top(0,n).width(s,n).height(s,n).pieceMargin(this._blockMargin,n).pieceWidth(s,n).pieceHeight(s,n).reflowTransition(n||null),e&&e.position("absolute").left(this._blockWidth-s,n).top(0,n).width(s,n).height(s,n).pieceMargin(this._blockMargin,n).pieceWidth(s,n).pieceHeight(s,n).reflowTransition(n||null),i&&i.position("absolute").left(0,n).top(s+this._blockMargin,n).width(s,n).height(s,n).pieceMargin(this._blockMargin,n).pieceWidth(s,n).pieceHeight(s,n).reflowTransition(n||null),r&&r.position("absolute").left(this._blockWidth-s,n).top(s+this._blockMargin,n).width(s,n).height(s,n).pieceMargin(this._blockMargin,n).pieceWidth(s,n).pieceHeight(s,n).reflowTransition(n||null),o&&o.position("absolute").left(0,n).top(this._blockHeight-a,n).width(this._blockWidth,n).height(a,n).pieceMargin(this._blockMargin,n).pieceWidth(this._blockWidth,n).pieceHeight(a,n).reflowTransition(n||null)},e.create=function(){return new e(document.createElement("div")).className("block")},e}(tu),od=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e}(eu),nd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"block"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=rd.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new od,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){var n=$c.Global.castView(i.toValue(),r,o);return n?(e.addPiece(n),n):t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(iu);Aa.addGlobal(nd.Form);var sd=function(t){function e(e){var i=t.call(this,e)||this;return i._blockMarginScale=Dn.linear(320,540,8,16),i._blockAspectRatio=Math.sqrt(2),i._minBlockWidth=480,i._maxColCount=4,i._reflowTransition=new fs(250,pn.quadOut),i._transitionEnd=0,i._blockMargin=NaN,i._blockWidth=NaN,i._blockHeight=NaN,i._colCount=NaN,i.flexGrow(1),i}return u(e,t),e.prototype.blockMarginScale=function(t){return void 0===t?this._blockMarginScale:(this._blockMarginScale!==t&&(this._blockMarginScale=t,this.requireResize()),this)},e.prototype.blockAspectRatio=function(t){return void 0===t?this._blockAspectRatio:(this._blockAspectRatio!==t&&(this._blockAspectRatio=t,this.requireResize()),this)},e.prototype.minBlockWidth=function(t){return void 0===t?this._minBlockWidth:(this._minBlockWidth!==t&&(this._minBlockWidth=t,this.requireResize()),this)},e.prototype.maxColCount=function(t){return void 0===t?this._maxColCount:(this._maxColCount!==t&&(this._maxColCount=t,this.requireResize()),this)},e.prototype.reflowTransition=function(t){return void 0===t?this._reflowTransition||null:(this._reflowTransition=t||void 0,this)},e.prototype.blocks=function(){for(var t=[],e=0;e<this._childViews.length;e+=1){var i=this._childViews[e];i instanceof rd&&t.push(i)}return t},e.prototype.addBlock=function(t){this.append(t)},e.prototype.removeBlock=function(t){this.remove(t)},e.prototype.willResize=function(){t.prototype.willResize.call(this),this.reflow()},e.prototype.reflow=function(){for(var t=this.node.offsetWidth,e=Math.round(this._blockMarginScale.clampScale(t)),i=NaN,r=1;;){var o=i;if(!((i=Math.round((t-e*(r+1))/r))>=this._minBlockWidth&&r<this._maxColCount)){r>1&&(i=o,r-=1);break}r+=1}if(isFinite(e)&&isFinite(i)){var n=Math.round(i*this._blockAspectRatio),s=void 0;if(this._reflowTransition){var a=Date.now();this._colCount!==r&&(this._transitionEnd=a+(this._reflowTransition.duration()||0)),a<this._transitionEnd&&(s=this._reflowTransition.duration(this._transitionEnd-a))}this._blockMargin=e,this._blockWidth=i,this._blockHeight=n,this._colCount=r;for(var u=e,h=e,l=0;l<this._childViews.length;){var p=this._childViews[l];p instanceof rd&&(p.position("absolute").left(u,s).top(h,s).width(i,s).height(n,s).blockMargin(e,s).blockWidth(i).blockHeight(n).reflowTransition(s||null),(l+=1)%r!=0?u+=i+e:(u=e,h+=n+e))}l%r!=0&&(h+=n+e),this.height(h)}},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("blockAspectRatio").numberValue();void 0!==r&&this.blockAspectRatio(r);var o=e.get("blockMarginScale").cast(Mn.Form);o&&this.blockMarginScale(o);var n=e.get("minBlockWidth").numberValue();void 0!==n&&this.minBlockWidth(n);var s=e.get("maxColCount").numberValue();void 0!==s&&this.minBlockWidth(s);var a=e.get("reflowTransition").cast(fs.Form);a&&this.reflowTransition(a)},e.create=function(){return new e(document.createElement("div")).className("quilt")},e.applyTheme=function(t){var e=L.empty().slot("marginTop","4px").slot("marginRight","8px").slot("marginBottom","8px").slot("marginLeft","4px").slot("titleSize","12px").slot("titleColor",B.get("textColor")).slot("subtitleSize","10px").slot("subtitleColor",B.get("textColor")),i=L.empty().slot("card",e);t.set("quilt",i)},e}(tu);sd.applyTheme(sd.Theme);var ad=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=eu.Params.concat([new Ca("blockMarginScale",B.get("blockMarginScale").or(B.get("quilt").get("blockMarginScale"))),new Ca("blockAspectRatio",B.get("blockAspectRatio").or(B.get("quilt").get("blockAspectRatio"))),new Ca("minBlockWidth",B.get("minBlockWidth").or(B.get("quilt").get("minBlockWidth"))),new Ca("maxColCount",B.get("maxColCount").or(B.get("quilt").get("maxColCount"))),new Ca("reflowTransition",B.get("reflowTransition").or(B.get("quilt").get("reflowTransition")))]),e}(eu),ud=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"quilt"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=sd.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new ad,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){var n=nd.Form.castView(i.toValue(),r,o);return n?(e.addBlock(n),n):t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(iu);Aa.addGlobal(ud.Form);var hd=function(t){function e(e){var i=t.call(this,e)||this;return i.display("flex").position("relative").flexDirection("column").flexGrow(1).flexBasis(0).width("100%").height("100%"),i._contentView=i.append("div").display("flex").position("relative").flexGrow(1).flexBasis(0),i._bodyView=null,i}return u(e,t),e.prototype.bodyView=function(t){return void 0===t?this._bodyView:(this._bodyView!==t&&(this._bodyView&&this._bodyView.remove(),this._bodyView=t,this._bodyView&&this._contentView.append(this._bodyView)),this)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("backgroundColor").cast(Qo.Form);r&&this.backgroundColor(r);var o=e.get("paddingTop").cast(qo.Form);o&&this.paddingTop(o);var n=e.get("paddingRight").cast(qo.Form);n&&this.paddingRight(n);var s=e.get("paddingBottom").cast(qo.Form);s&&this.paddingBottom(s);var a=e.get("paddingLeft").cast(qo.Form);a&&this.paddingLeft(a)},e.create=function(){return new e(document.createElement("div")).className("tile")},e.applyTheme=function(t){var e=L.empty().slot("paddingTop","8px").slot("paddingRight","8px").slot("paddingBottom","8px").slot("paddingLeft","8px");t.set("tile",e)},e}(tu);hd.applyTheme(hd.Theme);var ld=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=eu.Params.concat([new Ca("backgroundColor",B.get("backgroundColor").or(B.get("tile").get("backgroundColor"))),new Ca("paddingTop",B.get("paddingTop").or(B.get("tile").get("paddingTop"))),new Ca("paddingRight",B.get("paddingRight").or(B.get("tile").get("paddingRight"))),new Ca("paddingBottom",B.get("paddingBottom").or(B.get("tile").get("paddingBottom"))),new Ca("paddingLeft",B.get("paddingLeft").or(B.get("tile").get("paddingLeft")))]),e}(eu),pd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"tile"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=hd.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new ld,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){if(i.key instanceof I&&"body"===i.key.value){var n=o.castView(i.toValue(),r,o);if(n)return e.bodyView(n),e.bodyView()}return t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(iu);Aa.addGlobal(pd.Form);var cd=function(t){function e(e){var i=t.call(this,e)||this;return i._itemSize=qo.px(32),i._itemSpacing=qo.zero(),i.display("flex").justifyContent("flex-start").alignItems("center").position("relative"),i}return u(e,t),e.prototype.itemSize=function(t){return void 0===t?this._itemSize:(t=qo.fromAny(t),this._itemSize.equals(t)||(this._itemSize=t,this.requireResize()),this)},e.prototype.itemSpacing=function(t){return void 0===t?this._itemSpacing:(t=qo.fromAny(t),this._itemSpacing.equals(t)||(this._itemSpacing=t,this.requireResize()),this)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("toolbarHeight").cast(qo.Form);r&&this.height(r);var o=e.get("itemSize").cast(qo.Form);o&&this.itemSize(o);var n=e.get("itemSpacing").cast(qo.Form);n&&this.itemSpacing(n)},e.prototype.didResize=function(){t.prototype.didResize.call(this);var e=this._itemSpacing.pxValue();this.paddingLeft(e/2).paddingRight(e/2);for(var i=0;i<this._childViews.length;i+=1){var r=this._childViews[i];r instanceof tu&&r.flexGrow(0).width(this._itemSize).height(this._itemSize).marginLeft(e/2).marginRight(e/2)}},e.create=function(){return new e(document.createElement("div")).className("toolbar")},e.applyTheme=function(t){var e=L.empty().slot("height","64px").slot("itemSize","32px").slot("itemSpacing","16px");t.set("toolbar",e)},e}(tu);cd.applyTheme(cd.Theme);var dd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=eu.Params.concat([new Ca("toolbarHeight",B.get("toolbarHeight").or(B.get("toolbar").get("height"))),new Ca("itemSize",B.get("itemSize").or(B.get("toolbar").get("itemSize"))),new Ca("itemSpacing",B.get("itemSpacing").or(B.get("toolbar").get("itemSpacing")))]),e}(eu),fd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"toolbar"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=cd.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new dd,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){var n=o.castView(i.toValue(),r,o);return n instanceof ba&&e.append(n),t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(iu);Aa.addGlobal(fd.Form);var yd=function(t){function e(e){var i=t.call(this,e)||this;return i._spacing=qo.zero(),i._desiredWidth=qo.zero(),i._minVisibleWidth=qo.zero(),i.display("none").position("relative"),i}return u(e,t),e.prototype.spacing=function(t){return void 0===t?this._spacing:(t=qo.fromAny(t),this._spacing.equals(t)||(this._spacing=t,this.requireResize()),this)},e.prototype.desiredWidth=function(t){return void 0===t?this._desiredWidth:(t=qo.fromAny(t),this._desiredWidth.equals(t)||(this._desiredWidth=t,this.requireResize()),this)},e.prototype.minVisibleWidth=function(t){return void 0===t?this._minVisibleWidth:(t=qo.fromAny(t),this._minVisibleWidth.equals(t)||(this._minVisibleWidth=t,this.requireResize()),this)},e.prototype.didSetState=function(e,i){t.prototype.didSetState.call(this,e,i);var r=e.get("spacing").cast(qo.Form);r&&this.spacing(r);var o=e.get("desiredWidth").cast(qo.Form);o&&this.desiredWidth(o);var n=e.get("minVisibleWidth").cast(qo.Form);n&&this.minVisibleWidth(n)},e.prototype.willResize=function(){t.prototype.willResize.call(this);var e=this._childViews.length;if(e>0){var i=this.node.parentNode,r=i instanceof HTMLElement?i.offsetWidth:0,o=i instanceof HTMLElement?i.offsetHeight:0,n=this._desiredWidth.pxValue(r),s=this._spacing.pxValue(n),a=Math.max(0,n-2*s);if(a*e+s*(e+1)>o&&(n=(a=Math.max(0,(o-s*(e+1))/e))+2*s),n>=this._minVisibleWidth.pxValue(r)){this.display("block").width(n).flexBasis(null);for(var u=e-1,h=0;h<e;h+=1){var l=this._childViews[h];l instanceof tu&&(l.position("absolute").left(s).right(s).bottom(u*a+(u+1)*s).width(a).height(a).boxSizing("border-box"),u-=1)}}else this.display("none")}},e.create=function(){return new e(document.createElement("div")).className("totem")},e}(tu),md=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),e.Params=eu.Params.concat([new Ca("spacing",B.get("spacing").or(B.get("totem").get("spacing"))),new Ca("desiredWidth",B.get("desiredWidth").or(B.get("totem").get("desiredWidth"))),new Ca("minVisibleWidth",B.get("minVisibleWidth").or(B.get("totem").get("minVisibleWidth")))]),e}(eu),vd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return u(e,t),Object.defineProperty(e.prototype,"tag",{get:function(){return"totem"},enumerable:!0,configurable:!0}),e.prototype.castView=function(t,e,i){if(t.tag===this.tag){var r=yd.create(),o=this.materializeView(r,t,e,i);return r.setModel(o),r}},e.prototype.castModel=function(t,e,i){if(t.tag===this.tag){var r=new md,o=this.materializeModel(r,t,e,i);return r.setData(o),r}},e.prototype.materializeViewParam=function(e,i,r,o){var n=o.castView(i.toValue(),r,o);return n instanceof ba?(e.append(n),n):t.prototype.materializeViewParam.call(this,e,i,r,o)},e.prototype.materializeModelParam=function(e,i,r,o){return i instanceof R&&i.key.value===this.tag?w.Absent:t.prototype.materializeModelParam.call(this,e,i,r,o)},e.Form=new e,e}(iu);Aa.addGlobal(vd.Form),"undefined"!=typeof document&&document.addEventListener("DOMContentLoaded",function(t){Aa.Global.materializeScripts()}),"function"==typeof importScripts&&new Xu,t.Text=I,t.Recon=Xe,t.StringOutput=g,t.RecordScope=Qe,t.UriAuthority=Zt,t.Extant=Lt,t.UriUser=Jt,t.UriHost=$t,t.STree=ii,t.Func=Z,t.Slot=T,t.Iteratee=_,t.Input=m,t.RecordMapView=z,t.Data=k,t.EvalStack=D,t.BTreePage=Je,t.Num=U,t.HashGenCacheMap=zt,t.StringInput=v,t.FormPairCursor=Ae,t.Random=C,t.UriQueryBuilder=de,t.UriParser=Ut,t.UriPort=oe,t.Field=M,t.FormCursor=xe,t.STreePage=ri,t.RecordMap=F,t.Bool=W,t.Cursor=h,t.UriPath=ne,t.Absent=Ft,t.UriQuery=le,t.Murmur3=n,t.Value=b,t.UriCache=hi,t.Uri=Kt,t.Item=w,t.BTree=Ze,t.UriScheme=Qt,t.Form=ye,t.DynamicValue=O,t.UriFragment=fe,t.Record=L,t.UriPathBuilder=he,t.equal=S,t.Attr=R,t.compare=V,t.Selector=B,t.IdentitySelector=q,t.LiteralSelector=G,t.GetSelector=H,t.GetAttrSelector=N,t.GetItemSelector=j,t.KeysSelector=Y,t.ChildrenSelector=X,t.DescendantsSelector=K,t.FilterSelector=Q,t.AddExpr=St,t.PrefixExpr=mt,t.InfixExpr=yt,t.GtExpr=Ct,t.AndExpr=wt,t.SubExpr=Vt,t.MulExpr=Mt,t.NotExpr=bt,t.OrExpr=gt,t.GeExpr=Et,t.ModExpr=Tt,t.EqExpr=At,t.NegExpr=Dt,t.InvokeExpr=Pt,t.Expr=ft,t.NeExpr=kt,t.LtExpr=_t,t.DivExpr=Rt,t.CondExpr=vt,t.LeExpr=xt,t.client=Ji,t.isOnline=$i,t.keepOnline=tr,t.downlink=er,t.downlinkList=ir,t.downlinkMap=rr,t.downlinkValue=or,t.hostRef=nr,t.nodeRef=sr,t.laneRef=ar,t.authenticate=ur,t.command=hr,t.DeauthRequest=ki,t.ValueDownlink=Wi,t.SyncedResponse=wi,t.LinkRequest=mi,t.MapDownlink=zi,t.SyncRequest=gi,t.AuthRequest=xi,t.Envelope=li,t.Client=Zi,t.AuthedResponse=Ai,t.Downlink=Vi,t.ValueDownlinkRecord=Oi,t.EventMessage=fi,t.ListDownlink=Pi,t.NodeRef=Gi,t.LinkedResponse=vi,t.ListDownlinkRecord=Li,t.EventDownlink=Ri,t.LaneRef=Hi,t.RemoteHost=Ci,t.DeauthedResponse=Ei,t.UnlinkRequest=bi,t.DownlinkScope=Ni,t.CommandMessage=yi,t.MapDownlinkRecord=Ii,t.HostRef=qi,t.UnlinkedResponse=_i,t.ScaleTransformInterpolator=Nn,t.TextModel=Ba,t.TimeScaleInterpolator=$n,t.TickForm=uh,t.UiStateEnvelope=va,t.TransformPathInterpolator=Qn,t.LengthInterpolator=Wn,t.ElemForm=Ya,t.ScaleInterpolator=Zn,t.UiViewEnvelope=ca,t.SvgForm=cu,t.TimeZone=xr,t.StyleForm=$u,t.GradAngle=Lo,t.EachDirective=ih,t.DateTime=oo,t.Path=Gs,t.MouseKinematic=Fs,t.UiInsertEnvelope=ya,t.EmLength=Ho,t.Model=Sa,t.ContinuousScale=Mn,t.LetForm=eh,t.Angle=To,t.ViewForm=za,t.PopoverModel=Wu,t.Arc=Xs,t.EachForm=oh,t.MatrixTransformInterpolator=Xn,t.SkewTransform=gn,t.KinematicScaleHorizontal=Us,t.TextView=Oa,t.UiValue=Zs,t.TransformListInterpolator=Kn,t.Directive=Ia,t.RotateTransformInterpolator=jn,t.TransformListParser=Sn,t.Color=Qo,t.View=wa,t.ViewController=Ea,t.ElemView=Na,t.PctLength=jo,t.InjectForm=sh,t.LinearScaleInterpolator=Jn,t.InterpolatorInterpolator=es,t.toAttributeString=ms,t.ResizeObserver=cr,t.KinematicScaleVertical=Ws,t.DateInterpolator=In,t.NodeModel=Ua,t.AttrsDirective=Qu,t.RemLength=No,t.Hsl=Jo,t.LinearScale=Rn,t.RotateTransform=vn,t.Transition=fs,t.Popover=Qs,t.ChildFrameAnimator=xs,t.AttrsForm=Zu,t.UiFunc=ha,t.TimeInterval=ho,t.KinematicEvent=Ds,t.Animator=gs,t.TransformInterpolator=Gn,t.Ease=pn,t.ReconInterpolator=rs,t.TweenAnimator=_s,t.NodeView=ba,t.SINumberFormat=Do,t.HslInterpolator=qn,t.AngleInterpolator=Un,t.TextAnimator=Cs,t.AngleParser=Io,t.MatrixTransform=wn,t.TurnAngle=zo,t.KinematicScale=Is,t.TimeScale=Tn,t.ColorInterpolator=On,t.BoxShadowParser=hn,t.Rgb=Zo,t.TweenFrameAnimator=As,t.StyleDirective=Ju,t.IdentityTransform=fn,t.PopoverView=Uu,t.LetDirective=th,t.UiEnvelope=la,t.StyleAnimator=Es,t.TransformParser=Cn,t.Transform=dn,t.UiRemoveEnvelope=ma,t.ShadowBoxView=Bu,t.Interpolator=Ln,t.TranslateTransform=yn,t.NodeForm=Wa,t.CustomEvent=lr,t.HMSDurationFormat=Co,t.DateTimeFormat=Er,t.UiTreeEnvelope=pa,t.InjectDirective=nh,t.Kinematic=Ts,t.SvgModel=pu,t.ArcView=_u,t.PolyUiForm=ka,t.SkewTransformInterpolator=Yn,t.DurationFormat=Ao,t.ColorParser=sn,t.ElemModel=ja,t.TouchKinematic=Ls,t.UiForm=Aa,t.PxLength=Go,t.UiModelEnvelope=ga,t.TranslateTransformInterpolator=Hn,t.TickDirective=ah,t.AppModel=Xu,t.KinematicScaleEvent=zs,t.UnitlessLength=Yo,t.LengthParser=Xo,t.Length=qo,t.Scale=Dn,t.TransformList=bn,t.TextForm=Ha,t.ChildAnimator=bs,t.AppView=Ku,t.BoxShadow=un,t.RadAngle=Fo,t.AttributeAnimator=ks,t.SvgView=Xa,t.UiAppendEnvelope=da,t.UnitTimeInterval=po,t.DateTimeLocale=kr,t.FrameAnimator=ws,t.DirectiveForm=_a,t.PolyDirectiveForm=xa,t.RgbInterpolator=Bn,t.NumberFormat=So,t.UiPrependEnvelope=fa,t.NumberInterpolator=zn,t.ScaleTransform=mn,t.toStyleString=vs,t.DegAngle=Po,t.ModelParam=Ca,t.PointerKinematic=Ps,t.HtmlView=tu,t.HtmlModel=eu,t.HtmlForm=iu,t.HtmlElementForm=ru,t.HtmlNativeElementForm=ou,t.HtmlCustomElementForm=nu,t.StylesheetView=su,t.StylesheetModel=au,t.StylesheetForm=uu,t.LayoutEditor=$a,t.LayoutDataHandler=Ja,t.LayoutRenderView=Za,t.AuthenticatedView=hh,t.AuthenticatedModel=lh,t.AuthenticatedForm=ch,t.AccountPopoverView=dh,t.AccountPopoverModel=fh,t.AccountPopoverForm=yh,t.AccountButtonView=mh,t.AccountButtonModel=vh,t.AccountButtonForm=gh,t.BoardView=wh,t.BoardModel=bh,t.BoardForm=_h,t.AreaPlotView=zl,t.TimeTickGenerator=Oh,t.AreaPlotForm=Ul,t.ChartView=Yl,t.PlotPointView=ll,t.PlotPointForm=cl,t.AreaPlotModel=Il,t.CirclePlotForm=Tl,t.ChartForm=Kl,t.CirclePlotView=Ml,t.TickGenerator=Uh,t.AxisForm=ul,t.TopAxis=qh,t.PlotPointModel=pl,t.CirclePlotModel=Rl,t.AxisView=sl,t.CirclePlot=El,t.PlotModel=fl,t.NumberTickGenerator=Wh,t.RightAxis=Gh,t.LinePlotModel=Al,t.Axis=Bh,t.AreaPlot=Pl,t.LinePlotView=xl,t.Chart=Wl,t.LinePlot=ml,t.AxisModel=al,t.ChartModel=Xl,t.BottomAxis=Hh,t.LinePlotForm=kl,t.PlotView=hl,t.Plot=dl,t.LeftAxis=Nh,t.PlotForm=yl,t.Gauge=Ql,t.GaugeView=up,t.GaugeModel=hp,t.GaugeForm=lp,t.Kpi=pp,t.KpiView=Rp,t.KpiModel=Tp,t.KpiForm=Pp,t.MapboxPointForm=oc,t.MapboxMapForm=tc,t.MapboxGeometryModel=ec,t.MapboxPopoverModel=Np,t.MapboxGeometryForm=Jp,t.MapboxLayerForm=$p,t.MapboxMapView=Kp,t.GeometryView=Ip,t.LayerView=Up,t.MapboxMapModel=Qp,t.MapboxLayerView=Xp,t.MapboxPolygonView=nc,t.MapboxPolygonForm=ac,t.GeometryForm=qp,t.MapboxPopoverView=Hp,t.LayerForm=Op,t.MapboxLayerModel=Zp,t.MapboxPolygonModel=sc,t.GeometryModel=Bp,t.MapView=Lp,t.LayerModel=Wp,t.MapboxPointView=ic,t.MapForm=zp,t.MapModel=Fp,t.MapboxPointModel=rc,t.MapboxPopoverForm=jp,t.MapboxGeometryView=Yp,t.Mapbox=Gp,t.Wedge=cc,t.WedgeView=Fc,t.WedgeModel=zc,t.WedgeForm=Ic,t.Pie=Uc,t.PieView=Nc,t.PieModel=jc,t.PieForm=Yc,t.PlacardView=Xc,t.PlacardModel=Kc,t.PlacardForm=Qc,t.PieceView=Zc,t.PieceModel=Jc,t.PieceForm=$c,t.PieceCardView=td,t.PieceCardModel=ed,t.PieceCardForm=id,t.BlockView=rd,t.BlockModel=od,t.BlockForm=nd,t.QuiltView=sd,t.QuiltModel=ad,t.QuiltForm=ud,t.TileView=hd,t.TileModel=ld,t.TileForm=pd,t.ToolbarView=cd,t.ToolbarModel=dd,t.ToolbarForm=fd,t.TotemView=yd,t.TotemModel=md,t.TotemForm=vd,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=swim-app.min.js.map